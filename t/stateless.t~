#!/usr/bin/perl

use strict;
use Test::More;
use Test::Differences;
use lib 't';
use Test_Netspoc;

my ($title, $in, $out);

############################################################
$title = 'Optimize reverse rules';
############################################################

$in = <<'END';
network:x = { ip = 10.1.1.0/24; 
}
router:r = {
 model = IOS;
 managed;
 interface:x = { ip = 10.1.1.1; hardware = e0; }
 interface:y = { ip = 10.2.2.2; hardware = e1; }
}
network:y = { ip = 10.2.2.0/24; 
 host:y = { ip = 10.2.2.9; } 
}

protcol:ip_reversed = ip, reversed;
protcolgroup:ip_both = ip, ip_reversed;

service:test1 = {
 user = network:x;
 permit src = user; dst = network:y; prt = ip;
}
service:test2 = {
 user = network:x;
 permit src = user; dst = host:y; prt = ip_both;
}
END
