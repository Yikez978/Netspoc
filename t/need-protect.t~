#!/usr/bin/perl

use strict;
use Test::More;
use Test::Differences;
use lib 't';
use Test_Netspoc;

my ($title, $topo, $in, $out1, $head1, $out2, $head2, $out3, $head3);

############################################################
$title = "Supernet to extern";
############################################################

$in = <<END;
$topo
service:Test = {
 user = any:[ip = 10.60.0.0/14 & network:n1, network:trans];
 permit src = user;
        dst = network:extern;
        prt = tcp 80;
}
END

$out1 = <<END;
object-group network g0
 network-object 10.62.0.0 255.255.248.0
 network-object 10.62.241.0 255.255.255.0
access-list vlan1_in extended deny ip any object-group g0
access-list vlan1_in extended permit ip any any
access-group vlan1_in in interface vlan1
END

$head1 = (split /\n/, $out1)[0];

eq_or_diff(get_block(compile($in), $head1), $out1, $title);

############################################################
done_testing;
