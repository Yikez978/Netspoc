<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.17
Devel::Cover is copyright 2001-2012, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: bin/print-group</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">bin/print-group</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">47.2%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#!/usr/bin/perl</td></tr>
<tr><td class="h">2</td><td colspan="7"></td></tr><tr><td class="h">3 - 78</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

print-group - Show elements of a netspoc group definition

=head1 SYNOPSIS

print-group [options] FILE|DIR &#39;group:name,...&#39;

=head1 DESCRIPTION

This program prints the elements of a netspoc group definition.&nbsp;&nbsp;By default it
shows a line with IP/prefixlen and name for each element separated by tab
character. Group is a simple group, some automatic group, or a union or
intersection or complement of simpler groups.

=head1 OPTIONS

=over 4

=item B&lt;-nat&gt; name

Uses network:name as reference when resolving IP address in a NAT environment.

=item B&lt;-unused&gt; 

Show only elements not used in any rules.

=item B&lt;-name&gt;

Show only name of elements

=item B&lt;-ip&gt;

Show only IP address of elements

=item B&lt;-owner&gt;

Show owner of elements.

=item B&lt;-quiet&gt;

Don&#39;t print progress messages.

=item B&lt;-help&gt;

Prints a brief help message and exits.

=item B&lt;-man&gt;

Prints the manual page and exits.

=back

=head1 COPYRIGHT AND DISCLAIMER

(c) 2015 by Heinz Knutzen &lt;heinz.knutzen@googlemail.com&gt;

This program uses module Netspoc.pm,
a Network Security Policy Compiler,
http://hknutzen.github.com/Netspoc

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp;&nbsp;See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

=cut</pre></td></tr>
<tr><td class="h">79</td><td colspan="7"></td></tr><tr><td class="h">80</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L80">6</a></div></td><td></td><td><div>24</div><div>7</div><div>148</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">81</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L81">6</a></div></td><td></td><td><div>21</div><div>5</div><div>126</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">82</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L82">6</a></div></td><td></td><td><div>1098</div><div>9</div><div>19</div></td><td class="s">use open qw(:std :utf8);</td></tr>
<tr><td class="h">83</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L83">6</a></div></td><td></td><td><div>12883</div><div>11</div><div>1998</div></td><td class="s">use Netspoc;</td></tr>
<tr><td class="h">84</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L84">6</a></div></td><td></td><td><div>26</div><div>6</div><div>26</div></td><td class="s">use Getopt::Long;</td></tr>
<tr><td class="h">85</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L85">6</a></div></td><td></td><td><div>26</div><div>6</div><div>14068</div></td><td class="s">use Pod::Usage;</td></tr>
<tr><td class="h">86</td><td colspan="7"></td></tr><tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># VERSION: inserted by DZP::OurPkgVersion</td></tr>
<tr><td class="h">88</td><td colspan="7"></td></tr><tr><td class="h">89</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Take higher bits from network NAT, lower bits from original IP.</td></tr>
<tr><td class="h">90</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This works with and without NAT.</td></tr>
<tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub nat {</td></tr>
<tr><td class="h">92</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="bin-print-group--subroutine.html#L92">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $network) = @_;</td></tr>
<tr><td class="h">93</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return($network-&gt;{ip} | $ip &amp; Netspoc::complement_32bit ($network-&gt;{mask}));</td></tr>
<tr><td class="h">94</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">95</td><td colspan="7"></td></tr><tr><td class="h">96</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Print IP address of $obj in context of $no_nat_set.</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_address {</td></tr>
<tr><td class="h">98</td><td><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="bin-print-group--subroutine.html#L98">13</a></div></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $no_nat_set) = @_;</td></tr>
<tr><td class="h">99</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">100</td><td><div class="c3">13</div></td><td><div class="c0" title="T/-"><a href="bin-print-group--branch.html#L100">50</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L100">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L100">0</a></div></td><td><div class="c0"><a href="bin-print-group--condition.html#L100">0</a></div></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">101</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj = Netspoc::get_nat_network($obj, $no_nat_set);</td></tr>
<tr><td class="h">102</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $obj-&gt;{ip};</td></tr>
<tr><td class="h">103</td><td><div class="c3">13</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L103">50</a></div><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L103">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">104</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $ip;</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($obj-&gt;{hidden}) {</td></tr>
<tr><td class="h">107</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &#39;hidden&#39;;</td></tr>
<tr><td class="h">108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">110</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = Netspoc::mask2prefix($obj-&gt;{mask});</td></tr>
<tr><td class="h">111</td><td><div class="c3">13</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L111">50</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return print_ip($ip) . ($prefix == 32 ? &#39;&#39; : &quot;/$prefix&quot;);</td></tr>
<tr><td class="h">112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Host&#39; or $type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">115</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = Netspoc::get_nat_network($obj-&gt;{network}, $no_nat_set);</td></tr>
<tr><td class="h">116</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L116">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L116">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L116">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L116">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L116">0</a></div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $nat_tag = $network-&gt;{dynamic}) {</td></tr>
<tr><td class="h">117</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L117">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L117">0</a></div></td><td><div class="c0"><a href="bin-print-group--condition.html#L117">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{nat} and (my $ip = $obj-&gt;{nat}-&gt;{$nat_tag})) {</td></tr>
<tr><td class="h">118</td><td colspan="7"></td></tr><tr><td class="h">119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single static NAT IP for this object.</td></tr>
<tr><td class="h">120</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Netspoc::print_ip($ip);</td></tr>
<tr><td class="h">121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($network-&gt;{hidden}) {</td></tr>
<tr><td class="h">123</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &#39;hidden&#39;;</td></tr>
<tr><td class="h">124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">126</td><td colspan="7"></td></tr><tr><td class="h">127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Dynamic NAT, take whole network.</td></tr>
<tr><td class="h">128</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $network-&gt;{ip};</td></tr>
<tr><td class="h">129</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = Netspoc::mask2prefix($network-&gt;{mask});</td></tr>
<tr><td class="h">130</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L130">0</a></div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return print_ip($ip) . ($prefix == 32 ? &#39;&#39; : &quot;/$prefix&quot;);</td></tr>
<tr><td class="h">131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($network-&gt;{isolated}) {</td></tr>
<tr><td class="h">134</td><td colspan="7"></td></tr><tr><td class="h">135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# NAT not allowed for isolated ports. </td></tr>
<tr><td class="h">136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take no bits from network, because secondary isolated ports </td></tr>
<tr><td class="h">137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# don&#39;t match network.</td></tr>
<tr><td class="h">138</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Netspoc::print_ip($obj-&gt;{ip});</td></tr>
<tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $range = $obj-&gt;{range}) {</td></tr>
<tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </td></tr>
<tr><td class="h">142</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;-&#39;, map { Netspoc::print_ip(nat($_, $network)) } @$range);</td></tr>
<tr><td class="h">143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($obj-&gt;{ip} =~ /unnumbered|short|bridged/) {</td></tr>
<tr><td class="h">145</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $obj-&gt;{ip};</td></tr>
<tr><td class="h">146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($obj-&gt;{ip} eq &#39;negotiated&#39;) {</td></tr>
<tr><td class="h">148</td><td colspan="7"></td></tr><tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take whole network.</td></tr>
<tr><td class="h">150</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $network-&gt;{ip};</td></tr>
<tr><td class="h">151</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = Netspoc::mask2prefix($network-&gt;{mask});</td></tr>
<tr><td class="h">152</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L152">0</a></div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return print_ip($ip) . ($prefix == 32 ? &#39;&#39; : &quot;/$prefix&quot;);</td></tr>
<tr><td class="h">153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">155</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Netspoc::print_ip(nat($obj-&gt;{ip}, $network));</td></tr>
<tr><td class="h">156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Autointerface&#39;) {</td></tr>
<tr><td class="h">159</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &#39;unknown&#39;;</td></tr>
<tr><td class="h">160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">162</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Netspoc::internal_err &quot;Unexpected object $obj-&gt;{name}&quot;;</td></tr>
<tr><td class="h">163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">164</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return; # unused; only for perlcritic</td></tr>
<tr><td class="h">165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">166</td><td colspan="7"></td></tr><tr><td class="h">167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Argument processing</td></tr>
<tr><td class="h">169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">170</td><td colspan="7"></td></tr><tr><td class="h">171</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">my $nat_net;</td></tr>
<tr><td class="h">172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $show_unused;</td></tr>
<tr><td class="h">173</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $show_ip;</td></tr>
<tr><td class="h">174</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $show_name;</td></tr>
<tr><td class="h">175</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $show_owner;</td></tr>
<tr><td class="h">176</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $quiet;</td></tr>
<tr><td class="h">177</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $help;</td></tr>
<tr><td class="h">178</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $man;</td></tr>
<tr><td class="h">179</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L179">50</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">GetOptions ( &#39;nat=s&#39;&nbsp;&nbsp;=&gt; \$nat_net,</td></tr>
<tr><td class="h">180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;unused&#39; =&gt; \$show_unused,</td></tr>
<tr><td class="h">181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ip!&#39;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; \$show_ip,</td></tr>
<tr><td class="h">182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;name!&#39;&nbsp;&nbsp;=&gt; \$show_name,</td></tr>
<tr><td class="h">183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;owner!&#39; =&gt; \$show_owner,</td></tr>
<tr><td class="h">184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;quiet!&#39; =&gt; \$quiet,</td></tr>
<tr><td class="h">185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;help|?&#39; =&gt; \$help,</td></tr>
<tr><td class="h">186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;man =&gt; \$man,</td></tr>
<tr><td class="h">187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) or pod2usage(2);</td></tr>
<tr><td class="h">188</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L188">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">pod2usage(1) if $help;</td></tr>
<tr><td class="h">189</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L189">50</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">pod2usage(-exitstatus =&gt; 0, -verbose =&gt; 2) if $man;</td></tr>
<tr><td class="h">190</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="bin-print-group--branch.html#L190">50</a></div></td><td><div class="c0"><a href="bin-print-group--condition.html#L190">33</a></div></td><td></td><td></td><td><div>27</div></td><td class="s">$show_ip or $show_name or $show_ip = $show_name = 1;</td></tr>
<tr><td class="h">191</td><td colspan="7"></td></tr><tr><td class="h">192</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L192">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">my $in_path = shift @ARGV or pod2usage(2);</td></tr>
<tr><td class="h">193</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L193">50</a></div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">my $name = shift @ARGV or pod2usage(2);</td></tr>
<tr><td class="h">194</td><td colspan="7"></td></tr><tr><td class="h">195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Main program</td></tr>
<tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">198</td><td colspan="7"></td></tr><tr><td class="h">199</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">my $file_config = &amp;read_config($in_path);</td></tr>
<tr><td class="h">200</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&amp;set_config($file_config, { verbose =&gt; !$quiet });</td></tr>
<tr><td class="h">201</td><td colspan="7"></td></tr><tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parse group definition(s).</td></tr>
<tr><td class="h">203</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">$Netspoc::input = $name;</td></tr>
<tr><td class="h">204</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">$Netspoc::current_file = &#39;group definition&#39;;</td></tr>
<tr><td class="h">205</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">$Netspoc::line = 1;</td></tr>
<tr><td class="h">206</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">my @parsed;</td></tr>
<tr><td class="h">207</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">Netspoc::skip_space_and_comment();</td></tr>
<tr><td class="h">208</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">while (1) {</td></tr>
<tr><td class="h">209</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @parsed, Netspoc::read_intersection;</td></tr>
<tr><td class="h">210</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Netspoc::skip_space_and_comment;</td></tr>
<tr><td class="h">211</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="bin-print-group--branch.html#L211">50</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;last if pos $Netspoc::input == length $Netspoc::input;</td></tr>
<tr><td class="h">212</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Netspoc::check(&#39;,&#39;);</td></tr>
<tr><td class="h">213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">214</td><td colspan="7"></td></tr><tr><td class="h">215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Read and process Netspoc configuration file or directory.</td></tr>
<tr><td class="h">216</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&amp;read_file_or_dir($in_path);</td></tr>
<tr><td class="h">217</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&amp;link_topology();</td></tr>
<tr><td class="h">218</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&amp;mark_disabled();</td></tr>
<tr><td class="h">219</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&amp;set_zone();</td></tr>
<tr><td class="h">220</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&amp;distribute_nat_info();</td></tr>
<tr><td class="h">221</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&amp;setpath();</td></tr>
<tr><td class="h">222</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">Netspoc::find_subnets_in_zone();</td></tr>
<tr><td class="h">223</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">Netspoc::convert_hosts();</td></tr>
<tr><td class="h">224</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L224">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">if ($show_owner) {</td></tr>
<tr><td class="h">225</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Netspoc::propagate_owners();</td></tr>
<tr><td class="h">226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">227</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&amp;abort_on_error();</td></tr>
<tr><td class="h">228</td><td colspan="7"></td></tr><tr><td class="h">229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find network for resolving NAT addresses.</td></tr>
<tr><td class="h">230</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">my $no_nat_set;</td></tr>
<tr><td class="h">231</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L231">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">if($nat_net) {</td></tr>
<tr><td class="h">232</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L232">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $net = $networks{$nat_net} or </td></tr>
<tr><td class="h">233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Unknown network:$nat_net of option &#39;-n&#39;\n&quot;;</td></tr>
<tr><td class="h">234</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$no_nat_set = $net-&gt;{nat_domain}-&gt;{no_nat_set};</td></tr>
<tr><td class="h">235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">236</td><td colspan="7"></td></tr><tr><td class="h">237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Expand group definition(s).</td></tr>
<tr><td class="h">238</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">my $elements = </td></tr>
<tr><td class="h">239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Netspoc::expand_group_in_rule(\@parsed, &#39;print-group&#39;, 0);</td></tr>
<tr><td class="h">240</td><td colspan="7"></td></tr><tr><td class="h">241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find unused objects by marking used objects.</td></tr>
<tr><td class="h">242</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L242">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">if ($show_unused) {</td></tr>
<tr><td class="h">243</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;order_protocols();</td></tr>
<tr><td class="h">244</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;expand_services(0);</td></tr>
<tr><td class="h">245</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;abort_on_error();</td></tr>
<tr><td class="h">246</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $type (&#39;deny&#39;, &#39;supernet&#39;, &#39;permit&#39;) {</td></tr>
<tr><td class="h">247</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $expanded_rules{$type} }) {</td></tr>
<tr><td class="h">248</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $where (&#39;src&#39;, &#39;dst&#39;) {</td></tr>
<tr><td class="h">249</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $rule-&gt;{$where};</td></tr>
<tr><td class="h">250</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L250">0</a></div><div class="c0" title="-/-"><a href="bin-print-group--branch.html#L250">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_host $obj) {</td></tr>
<tr><td class="h">251</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $subnet (@{ $obj-&gt;{subnets} }) {</td></tr>
<tr><td class="h">252</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">254</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{network}-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_interface $obj) {</td></tr>
<tr><td class="h">257</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">258</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{network}-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">261</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">266</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$elements = [ grep { not($_-&gt;{is_used}) } @$elements ];</td></tr>
<tr><td class="h">267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">268</td><td colspan="7"></td></tr><tr><td class="h">269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect IP address, name, owner.</td></tr>
<tr><td class="h">270</td><td><div class="c3">6</div><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>21</div></td><td class="s">my @info = map { my $v = [ print_address($_, $no_nat_set),</td></tr>
<tr><td class="h">271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_-&gt;{name} ];</td></tr>
<tr><td class="h">272</td><td><div class="c3">13</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L272">50</a></div></td><td><div class="c0"><a href="bin-print-group--condition.html#L272">33</a></div></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$v, $_-&gt;{owner}-&gt;{name} if $show_owner &amp;&amp; $_-&gt;{owner};</td></tr>
<tr><td class="h">273</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$v } @$elements;</td></tr>
<tr><td class="h">274</td><td colspan="7"></td></tr><tr><td class="h">275</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">abort_on_error();</td></tr>
<tr><td class="h">276</td><td colspan="7"></td></tr><tr><td class="h">277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Sort by IP address and print results.</td></tr>
<tr><td class="h">278</td><td><div class="c3">6</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>16</div><div>15</div></td><td class="s">for my $aref (sort { $a-&gt;[0] cmp $b-&gt;[0] } @info) {</td></tr>
<tr><td class="h">279</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($address, $name, $owner) = @$aref;</td></tr>
<tr><td class="h">280</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">281</td><td><div class="c3">13</div></td><td><div class="c0" title="T/-"><a href="bin-print-group--branch.html#L281">50</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($show_ip) {</td></tr>
<tr><td class="h">282</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $address;</td></tr>
<tr><td class="h">283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">284</td><td><div class="c3">13</div></td><td><div class="c0" title="T/-"><a href="bin-print-group--branch.html#L284">50</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($show_name) {</td></tr>
<tr><td class="h">285</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $name;</td></tr>
<tr><td class="h">286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">287</td><td><div class="c3">13</div></td><td><div class="c0" title="-/F"><a href="bin-print-group--branch.html#L287">50</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($show_owner) {</td></tr>
<tr><td class="h">288</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="bin-print-group--condition.html#L288">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner ||= &#39;none&#39;;</td></tr>
<tr><td class="h">289</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $owner;</td></tr>
<tr><td class="h">290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">291</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print join(&quot;\t&quot;, @result), &quot;\n&quot;;</td></tr>
<tr><td class="h">292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">293</td><td colspan="7"></td></tr><tr><td class="h">294</td><td colspan="7"></td></tr></table>
</body>
</html>
