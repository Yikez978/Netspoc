{"digest":"56719d18f559be0a20390b058362b7ad","pod":[[43,"create_ip_obj"],[49,"create_prt_obj"],[69,"setup_ip_net_relation"],[119,"mark_supernets_of_need_protect"],[131,"add_tcp_udp_icmp"],[143,"order_ranges"],[224,"setup_prt_relation"],[268,"optimize_redundant_rules"],[326,"optimize_rules"],[417,"join_ranges"],[554,"move_rules_esp_ah"],[594,"add_local_deny_rules"],[645,"find_objectgroups"],[762,"add_protect_rules"],[827,"check_final_permit"],[837,"add_final_permit_deny_rule"],[856,"iptables_prt_code"],[930,"add_bintree"],[1020,"gen_addr_bintree"],[1062,"gen_prt_bintree"],[1310,"find_chains"],[1629,"prefix_code"],[1640,"print_chains"],[1733,"iptables_acl_line"],[1756,"print_iptables_acl"],[1767,"expand_rule"],[1784,"convert_rule_objects"],[1815,"prepare_acls"],[1893,"cisco_acl_addr"],[1924,"print_object_groups"],[1959,"cisco_prt_code"],[2025,"print_cisco_std_acl"],[2050,"print_cisco_acl"],[2107,"print_acl"],[2128,"print_combined"],[2170,"check_prev"],[2182,"pass2"],[2228,"compile"]],"statement":[29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,43,44,45,49,50,51,53,54,55,58,59,60,61,65,69,70,71,74,75,75,76,81,82,85,87,89,91,95,97,98,99,102,109,109,110,111,112,119,120,121,122,123,124,131,132,133,134,143,153,144,150,160,209,163,164,165,166,167,167,171,175,178,179,180,181,182,183,184,190,195,196,197,200,201,207,211,212,213,214,215,216,216,217,218,220,224,225,226,227,228,229,230,230,231,232,233,236,240,246,250,251,253,254,257,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,297,298,299,302,306,310,314,318,319,322,326,327,330,333,334,337,336,338,339,340,341,342,343,346,347,348,349,351,354,356,359,360,362,363,364,366,366,367,368,371,372,374,375,379,384,385,386,389,390,395,400,401,403,404,406,409,410,410,412,417,418,419,421,423,422,427,429,430,431,435,438,441,444,445,448,455,456,457,458,459,461,461,464,474,473,477,478,479,480,480,481,482,483,483,484,487,491,492,497,501,502,504,505,512,513,514,517,521,522,523,527,528,529,533,535,536,539,542,544,554,555,556,557,558,559,560,561,563,564,565,566,569,572,575,581,581,581,582,582,583,587,589,594,595,596,596,597,598,600,603,623,606,607,608,613,616,618,619,619,620,621,624,631,632,633,638,639,645,646,649,650,655,658,659,660,664,665,666,667,668,669,670,671,672,674,679,682,684,696,697,740,703,704,710,708,709,713,714,718,717,719,722,723,727,731,734,737,737,738,738,739,743,744,745,746,747,749,750,751,753,755,757,758,762,763,764,764,774,776,776,777,778,779,780,781,783,784,785,788,789,789,789,794,795,795,796,797,798,799,800,801,802,808,809,813,816,816,827,828,829,830,830,831,831,832,837,838,839,841,841,842,843,844,845,846,849,849,851,856,857,859,860,881,864,865,865,866,867,870,873,876,879,882,883,884,885,886,887,890,891,892,895,899,903,930,931,931,932,932,933,938,949,953,954,955,956,959,962,968,969,970,971,972,973,975,980,981,982,985,988,988,995,993,996,997,998,999,1000,1001,1002,1004,1005,1006,1011,1012,1013,1015,1020,1026,1023,1026,1024,1030,1035,1036,1037,1042,1045,1062,1064,1066,1072,1073,1074,1075,1078,1083,1084,1092,1093,1093,1095,1097,1101,1102,1102,1107,1114,1142,1116,1117,1118,1121,1122,1123,1130,1134,1133,1137,1138,1139,1140,1182,1144,1145,1146,1147,1150,1153,1159,1158,1160,1164,1169,1170,1171,1176,1183,1184,1185,1189,1190,1190,1191,1192,1197,1198,1203,1204,1205,1210,1211,1212,1212,1231,1219,1229,1221,1222,1234,1237,1237,1238,1239,1243,1244,1247,1256,1257,1262,1263,1266,1270,1271,1272,1279,1282,1284,1288,1289,1290,1297,1300,1305,1306,1310,1311,1312,1313,1314,1321,1322,1323,1324,1325,1329,1334,1335,1336,1338,1339,1340,1344,1349,1353,1384,1368,1369,1370,1371,1371,1376,1377,1378,1381,1383,1388,1422,1393,1396,1397,1398,1402,1401,1403,1404,1407,1412,1413,1418,1418,1419,1442,1425,1428,1429,1430,1435,1436,1440,1441,1451,1446,1447,1448,1449,1449,1450,1453,1531,1455,1456,1457,1460,1461,1463,1462,1464,1465,1466,1467,1469,1476,1477,1478,1482,1483,1484,1486,1489,1493,1494,1495,1500,1499,1504,1507,1510,1513,1514,1515,1518,1525,1526,1529,1535,1537,1538,1541,1542,1543,1544,1545,1546,1547,1548,1552,1553,1555,1563,1563,1562,1563,1565,1566,1567,1568,1570,1569,1572,1571,1573,1575,1578,1579,1580,1581,1584,1587,1588,1589,1592,1593,1597,1598,1599,1604,1605,1606,1607,1608,1609,1610,1613,1620,1622,1623,1629,1630,1630,1631,1632,1633,1640,1641,1642,1644,1645,1646,1647,1648,1649,1652,1653,1654,1658,1659,1660,1663,1663,1664,1665,1688,1689,1690,1691,1692,1695,1696,1697,1702,1702,1703,1704,1705,1706,1707,1708,1716,1718,1728,1729,1733,1735,1734,1736,1740,1741,1742,1743,1745,1746,1748,1749,1751,1752,1756,1757,1758,1759,1760,1761,1762,1767,1768,1769,1770,1771,1772,1773,1774,1775,1780,1784,1785,1786,1788,1789,1790,1791,1792,1793,1794,1796,1797,1798,1800,1801,1802,1804,1805,1808,1808,1810,1815,1816,1818,1817,1820,1824,1825,1827,1829,1828,1833,1835,1836,1837,1838,1839,1840,1845,1846,1848,1849,1851,1852,1855,1856,1858,1859,1862,1863,1864,1869,1870,1872,1874,1875,1877,1878,1880,1881,1884,1888,1893,1894,1894,1897,1898,1899,1902,1905,1908,1909,1910,1915,1916,1917,1920,1924,1925,1926,1929,1931,1932,1933,1933,1937,1941,1942,1943,1944,1947,1950,1959,1960,1962,1963,1984,1967,1968,1968,1969,1970,1973,1976,1979,1982,1985,1986,1987,1988,1991,1994,1995,1998,1999,2000,2005,2008,2012,2016,2020,2025,2026,2027,2028,2029,2030,2031,2034,2037,2039,2040,2040,2041,2042,2043,2044,2046,2050,2052,2053,2054,2057,2058,2059,2060,2061,2062,2063,2064,2067,2068,2071,2074,2077,2080,2082,2081,2083,2084,2086,2087,2088,2089,2090,2092,2093,2097,2098,2099,2101,2103,2107,2108,2110,2113,2114,2115,2117,2120,2121,2123,2128,2132,2134,2136,2137,2137,2141,2142,2145,2148,2149,2151,2156,2160,2161,2164,2170,2171,2172,2173,2174,2175,2176,2178,2182,2183,2184,2185,2185,2186,2188,2189,2190,2191,2192,2193,2196,2199,2200,2202,2204,2205,2209,2210,2211,2212,2213,2214,2220,2221,2228,2229,2230,2231,2232,2234,2235],"condition":[[53,{"right":"$proto eq 'udp'","left":"$proto eq 'tcp'","op":"or","type":"or_3"}],[70,{"left":"$$ip_net2obj{'0.0.0.0/0'}","right":"create_ip_obj('0.0.0.0/0')","op":"||=","type":"or_3"}],[132,{"op":"||=","type":"or_3","left":"$$prt2obj{'tcp 1 65535'}","right":"create_prt_obj('tcp 1 65535')"}],[133,{"right":"create_prt_obj('udp 1 65535')","left":"$$prt2obj{'udp 1 65535'}","op":"||=","type":"or_3"}],[134,{"right":"create_prt_obj('icmp')","left":"$$prt2obj{'icmp'}","op":"||=","type":"or_3"}],[225,{"type":"or_3","op":"||=","right":"create_prt_obj('ip')","left":"$$prt2obj{'ip'}"}],[226,{"left":"$$prt2obj{'icmp'}","right":"$prt_ip","type":"or_3","op":"||"}],[233,{"type":"or_3","op":"||","left":"$$prt2obj{\"icmp $type\"}","right":"$icmp_up"}],[254,{"left":"$$prt2obj{'tcp 1 65535'}","right":"$prt_ip","op":"||","type":"or_3"}],[290,{"left":"$$chg_rule{'log'}","right":"''","op":"||","type":"or_2"}],[293,{"right":"''","left":"$$cmp_rule{'log'}","type":"or_2","op":"||"}],[294,{"right":"$cmp_log eq $chg_log","left":"$cmp_rule ne $chg_rule","op":"and","type":"and_3"}],[338,{"type":"or_2","op":"||=","left":"$deny","right":"''"}],[339,{"type":"or_3","op":"||=","left":"$src_range","right":"$prt_ip"}],[356,{"left":"$changed","right":"$changed2","op":"||=","type":"or_3"}],[374,{"left":"my $supernet = $$dst{'opt_networks'}","right":"not $$dst{'need_protect'}","type":"and_3","op":"and"}],[403,{"right":"$changed2","left":"$changed","type":"or_3","op":"||="}],[406,{"right":"$changed2","left":"$changed","type":"or_3","op":"||="}],[429,{"right":"''","left":"$deny","op":"||=","type":"or_2"}],[430,{"right":"''","left":"$src_range","type":"or_2","op":"||="}],[558,{"op":"or","type":"or_3","left":"$prt_esp","right":"$prt_ah"}],[565,{"left":"$prt_esp","right":"$$rule{'prt'} eq $prt_esp","op":"and","type":"and_3"}],[565,{"left":"$prt_ah","right":"$$rule{'prt'} eq $prt_ah","type":"and_3","op":"and"}],[583,{"op":"or","type":"or_3","right":"$$s_a{'ip'} <=> $$s_b{'ip'}","left":"$$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'}"}],[583,{"type":"or_3","op":"or","left":"$$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'} or $$s_a{'ip'} <=> $$s_b{'ip'}","right":"$$s_a{'mask'} <=> $$s_b{'mask'}"}],[583,{"right":"$$d_a{'ip'} <=> $$d_b{'ip'}","left":"$$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'} or $$s_a{'ip'} <=> $$s_b{'ip'} or $$s_a{'mask'} <=> $$s_b{'mask'}","op":"or","type":"or_3"}],[649,{"left":"$$router_data{'obj_groups_hash'}","right":"{}","type":"or_2","op":"||="}],[650,{"type":"or_2","op":"||=","left":"$$router_data{'obj_group_counter'}","right":"0"}],[665,{"left":"$$rule{'deny'}","right":"''","op":"||","type":"or_2"}],[668,{"left":"$$rule{'src_range'}","right":"''","type":"or_2","op":"||"}],[809,{"right":"$has_final_permit","left":"$need_protect{$interface}","type":"or_3","op":"||"}],[809,{"type":"or_3","op":"or","left":"$no_protect{$interface}","right":"not $need_protect{$interface} || $has_final_permit"}],[829,{"left":"$rules","right":"@$rules","type":"and_3","op":"and"}],[832,{"op":"&&","type":"and_3","right":"$prt eq $prt_ip","left":"!$deny && $src eq $net_00 && $dst eq $net_00"}],[839,{"right":"$$acl_info{'add_permit'}","left":"$$acl_info{'add_deny'}","type":"or_3","op":"or"}],[859,{"op":"or","type":"or_3","right":"$proto eq 'udp'","left":"$proto eq 'tcp'"}],[866,{"type":"and_3","op":"and","left":"$v1 == 1","right":"$v2 == 65535"}],[883,{"op":"&&","type":"and_3","right":"&$port_code($src_range)","left":"$src_range"}],[938,{"op":"and","type":"and_3","left":"$tree_mask < $node_mask","right":"match_ip($node_ip, $tree_ip, $tree_mask)"}],[949,{"type":"and_3","op":"&&","right":"$$node{'subtree'}","left":"$$tree{'subtree'}"}],[949,{"op":"or","type":"or_3","left":"not $$tree{'subtree'} && $$node{'subtree'}","right":"$$tree{'subtree'} ne $$node{'subtree'}"}],[938,{"left":"$tree_mask == $node_mask","right":"$tree_ip == $node_ip","op":"and","type":"and_3"}],[968,{"op":"||","type":"or_2","right":"''","left":"$$tree{'subtree'}"}],[969,{"right":"''","left":"$$node{'subtree'}","op":"||","type":"or_2"}],[1001,{"type":"and_3","op":"and","left":"$$lo{'subtree'}","right":"$$hi{'subtree'}"}],[1153,{"right":"$$lo{'subtree'}","left":"$$lo{'range'}[1] + 1 == $$hi{'range'}[0]","op":"and","type":"and_3"}],[1153,{"left":"$$lo{'range'}[1] + 1 == $$hi{'range'}[0] and $$lo{'subtree'}","right":"$$hi{'subtree'}","type":"and_3","op":"and"}],[1153,{"op":"and","type":"and_3","left":"$$lo{'range'}[1] + 1 == $$hi{'range'}[0] and $$lo{'subtree'} and $$hi{'subtree'}","right":"$$lo{'subtree'} eq $$hi{'subtree'}"}],[1329,{"left":"$$router_data{'chain_counter'}","right":"1","op":"||=","type":"or_2"}],[1404,{"right":"$$subtree2{$key} ne $$subtree{$key}","left":"not $$subtree2{$key}","type":"or_3","op":"or"}],[1464,{"op":"and","type":"and_3","right":"not @$seq","left":"$seq"}],[1482,{"op":"and","type":"and_3","left":"@$rules > 1","right":"not $$bintree{'noop'}"}],[1518,{"type":"and_3","op":"and","right":"not $$tree{'noop'}","left":"@rules > 1"}],[1605,{"type":"or_3","op":"||=","left":"$$rule{'src'}","right":"$network_00"}],[1606,{"left":"$$rule{'dst'}","right":"$network_00","type":"or_3","op":"||="}],[1609,{"right":"$src_range","left":"$prt","type":"or_3","op":"||"}],[1704,{"type":"or_3","op":"or","right":"$prt","left":"$src_range"}],[1705,{"op":"and","type":"and_3","right":"$$prt{'proto'} eq 'ip'","left":"$prt"}],[1794,{"left":"$$ip_net2obj{$ip_net}","right":"create_ip_obj($ip_net)","type":"or_3","op":"||="}],[1798,{"left":"$$ip_net2obj{$ip_net}","right":"create_ip_obj($ip_net)","type":"or_3","op":"||="}],[1802,{"op":"||=","type":"or_3","left":"$$prt2obj{$prt}","right":"create_prt_obj($prt)"}],[1805,{"right":"create_prt_obj($prt)","left":"$$prt2obj{$prt}","type":"or_3","op":"||="}],[1828,{"type":"or_3","op":"||=","right":"create_ip_obj($_)","left":"$$ip_net2obj{$_}"}],[1838,{"op":"||=","type":"or_3","right":"create_ip_obj($ip_net)","left":"$$ip_net2obj{$ip_net}"}],[1875,{"right":"$$acl_info{'add_permit'}","left":"$has_final_permit","op":"||","type":"or_3"}],[1877,{"right":"not $$acl_info{'is_crypto_acl'}","left":"$do_objectgroup","type":"and_3","op":"and"}],[1962,{"type":"or_3","op":"or","right":"$proto eq 'udp'","left":"$proto eq 'tcp'"}],[1969,{"op":"and","type":"and_3","right":"$v2 == 65535","left":"$v1 == 1"}],[1994,{"right":"&$port_code($src_range)","left":"$src_range","type":"and_3","op":"&&"}],[2057,{"right":"[]","left":"$$acl_info{'intf_rules'}","op":"||","type":"or_2"}],[2062,{"type":"or_3","op":"or","right":"$model eq 'ACE'","left":"$model eq 'ASA'"}],[2196,{"right":"check_prev($code_file, $prev_file)","left":"$has_prev","op":"and","type":"and_3"}],[2196,{"left":"$has_prev and check_prev($code_file, $prev_file)","right":"system(\"cp -p $prev_file $code_file\") == 0","type":"and_3","op":"and"}],[2220,{"left":"$has_prev","right":"not -l $prev","type":"and_3","op":"and"}],[2230,{"op":"||","type":"or_3","left":"$$Netspoc::Compiler::Pass2::config{'start_time'}","right":"time"}]],"branch":[[55,{"text":"if $established"}],[60,{"text":"if (defined $i2)"}],[58,{"text":"if (defined $i1)"}],[53,{"text":"if ($proto eq 'tcp' or $proto eq 'udp') { }"}],[53,{"text":"elsif ($proto eq 'icmp') { }"}],[85,{"text":"unless @mask_list"}],[98,{"text":"unless my $bignet = $mask_ip_hash{$m}{$i}"}],[110,{"text":"unless my $up = $$obj{'up'}"}],[111,{"text":"if (my $opt_networks = $$up{'opt_networks'})"}],[144,{"text":"unless $$a{'range'}[0] <=> $$b{'range'}[0]"}],[150,{"text":"if $$_{'proto'} eq $proto"}],[165,{"text":"if $i == @sorted"}],[182,{"text":"unless $a2 + 1 == $c1"}],[171,{"text":"if ($a2 + 1 == $b1)"}],[190,{"text":"if $a2 < $b1"}],[200,{"text":"unless $i"}],[195,{"text":"if ($a2 >= $b2)"}],[211,{"text":"unless @sorted"}],[218,{"text":"unless $index = &$check_subrange($a, $a1, $a2, $index)"}],[232,{"text":"if (defined $$prt{'code'}) { }"}],[231,{"text":"if (defined $type) { }"}],[229,{"text":"if ($proto eq 'icmp') { }"}],[229,{"text":"elsif ($proto =~ /^\\d+$/) { }"}],[253,{"text":"if (my $tcp_establ = $$prt2obj{'tcp 1 65535 established'})"}],[288,{"text":"if $$chg_rule{'deleted'}"}],[294,{"text":"if ($cmp_rule ne $chg_rule and $cmp_log eq $chg_log)"}],[292,{"text":"if (my $cmp_rule = $$cmp_hash{$$prt{'name'}})"}],[302,{"text":"unless $prt = $$prt{'up'}"}],[286,{"text":"if (my $cmp_hash = $$cmp_hash{$$dst{'name'}})"}],[306,{"text":"unless $dst = $$dst{'up'}"}],[282,{"text":"if (my $cmp_hash = $$cmp_hash{$$src{'name'}})"}],[310,{"text":"unless $src = $$src{'up'}"}],[278,{"text":"if (my $cmp_hash = $$cmp_hash{$$src_range{'name'}})"}],[314,{"text":"unless $src_range = $$src_range{'up'}"}],[274,{"text":"if (my $cmp_hash = $$cmp_hash{$deny})"}],[318,{"text":"if $deny"}],[346,{"text":"if ($rule_tree{$deny}{$src_range}{$src}{$dst}{$prt})"}],[363,{"text":"unless $$rule{'opt_secondary'}"}],[364,{"text":"if $$rule{'deleted'}"}],[367,{"text":"if $$src{'no_opt_addrs'}"}],[368,{"text":"if $$dst{'no_opt_addrs'}"}],[371,{"text":"if (my $supernet = $$src{'opt_networks'})"}],[374,{"text":"if (my $supernet = $$dst{'opt_networks'} and not $$dst{'need_protect'})"}],[386,{"text":"if ($secondary_tree{''}{$ip_key}{$src}{$dst}{$ip_key}) { }"}],[400,{"text":"if (keys %secondary_tree)"}],[409,{"text":"if ($changed)"}],[427,{"text":"unless $$prt{'has_neighbor'}"}],[448,{"text":"if values %$href == 1"}],[458,{"text":"if (my $log = $$rule{'log'})"}],[477,{"text":"unless @sorted >= 2"}],[487,{"text":"if (my $range = delete $$rule_a{'range'}) { }"}],[484,{"text":"if ($a2 + 1 == $b1)"}],[517,{"text":"if delete $$rule{'deleted'}"}],[528,{"text":"unless ($new_prt)"}],[521,{"text":"if (my $range = delete $$rule{'range'}) { }"}],[512,{"text":"if ($changed)"}],[558,{"text":"unless $prt_esp or $prt_ah"}],[560,{"text":"unless my $rules = $$acl_info{$what}"}],[565,{"text":"if ($$rule{'deny'}) { }"}],[565,{"text":"elsif ($prt_esp and $$rule{'prt'} eq $prt_esp) { }"}],[565,{"text":"elsif ($prt_ah and $$rule{'prt'} eq $prt_ah) { }"}],[583,{"text":"unless $$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'} or $$s_a{'ip'} <=> $$s_b{'ip'} or $$s_a{'mask'} <=> $$s_b{'mask'} or $$d_a{'ip'} <=> $$d_b{'ip'}"}],[600,{"text":"$$acl_info{'filter_any_src'} ? :"}],[607,{"text":"if (1 == @$obj_list) { }"}],[607,{"text":"elsif (my $group = $$router_data{'filter_only_group'}) { }"}],[603,{"text":"if ($do_objectgroup) { }"}],[659,{"text":"$this eq 'src' ? :"}],[671,{"text":"if (my $log = $$rule{'log'})"}],[682,{"text":"unless keys %$href >= $min_object_group_size"}],[708,{"text":"unless $$a{'ip'} <=> $$b{'ip'}"}],[723,{"text":"unless $$href{$key}"}],[746,{"text":"if ($$glue{'active'})"}],[745,{"text":"if (my $glue = delete $$rule{'group_glue'})"}],[763,{"text":"unless my $need_protect = $$acl_info{'need_protect'}"}],[777,{"text":"if $$rule{'deny'}"}],[778,{"text":"if $$rule{'src'} ne $network_00"}],[779,{"text":"if $$rule{'prt'} ne $prt_ip"}],[781,{"text":"if $$dst{'need_protect'}"}],[783,{"text":"if ($has_final_permit)"}],[788,{"text":"if ($changed)"}],[796,{"text":"if $$rule{'deny'}"}],[797,{"text":"if $$rule{'prt'}{'established'}"}],[799,{"text":"unless my $hash = $$dst{'is_supernet_of_need_protect'}"}],[801,{"text":"if ($$hash{$intf})"}],[809,{"text":"if ($no_protect{$interface} or not $need_protect{$interface} || $has_final_permit)"}],[829,{"text":"unless $rules and @$rules"}],[839,{"text":"unless $$acl_info{'add_deny'} or $$acl_info{'add_permit'}"}],[845,{"text":"if (my $log_deny = $$router_data{'log_deny'})"}],[843,{"text":"if ($$acl_info{'add_deny'})"}],[866,{"text":"if ($v1 == $v2) { }"}],[866,{"text":"elsif ($v1 == 1 and $v2 == 65535) { }"}],[866,{"text":"elsif ($v2 == 65535) { }"}],[866,{"text":"elsif ($v1 == 1) { }"}],[884,{"text":"if $sport"}],[886,{"text":"if $dport"}],[891,{"text":"if (defined(my $code = $$prt{'code'})) { }"}],[890,{"text":"if (defined(my $type = $$prt{'type'})) { }"}],[859,{"text":"if ($proto eq 'ip') { }"}],[859,{"text":"elsif ($proto eq 'tcp' or $proto eq 'udp') { }"}],[859,{"text":"elsif ($proto eq 'icmp') { }"}],[954,{"text":"match_ip($node_ip, $tree_ip, $mask) ? :"}],[955,{"text":"if (my $subtree = $$tree{$branch}) { }"}],[949,{"text":"if (not $$tree{'subtree'} && $$node{'subtree'} or $$tree{'subtree'} ne $$node{'subtree'})"}],[970,{"text":"if ($sub1 ne $sub2)"}],[982,{"text":"if ($node_ip & $tree_mask) == ($tree_ip & $tree_mask)"}],[988,{"text":"$node_ip < $tree_ip ? :"}],[938,{"text":"if ($tree_mask < $node_mask and match_ip($node_ip, $tree_ip, $tree_mask)) { }"}],[938,{"text":"elsif ($tree_mask == $node_mask and $tree_ip == $node_ip) { }"}],[993,{"text":"if $$result{'subtree'}"}],[996,{"text":"unless my $lo = $$result{'lo'}"}],[997,{"text":"unless my $hi = $$result{'hi'}"}],[999,{"text":"unless $$lo{'mask'} == $mask"}],[1000,{"text":"unless $$hi{'mask'} == $mask"}],[1001,{"text":"unless $$lo{'subtree'} and $$hi{'subtree'}"}],[1002,{"text":"unless $$lo{'subtree'} eq $$hi{'subtree'}"}],[1005,{"text":"if $$lo{$key}"}],[1006,{"text":"if $$hi{$key}"}],[1023,{"text":"unless $$b{'mask'} <=> $$a{'mask'}"}],[1042,{"text":"if $$bintree{'mask'} == 0"}],[1092,{"text":"if ($$tree{$$prt{'name'}} ne $subtree)"}],[1084,{"text":"if (my $subtree = $$tree{$$up{'name'}})"}],[1101,{"text":"$proto =~ /^\\d+$/ ? :"}],[1074,{"text":"if ($proto eq 'ip') { }"}],[1117,{"text":"if (not $prt_aref) { }"}],[1117,{"text":"elsif (@$prt_aref == 1) { }"}],[1146,{"text":"unless $hi"}],[1169,{"text":"if @hilo"}],[1170,{"text":"if @hilo"}],[1160,{"text":"if (@hilo <= 2)"}],[1153,{"text":"if ($$lo{'range'}[1] + 1 == $$hi{'range'}[0] and $$lo{'subtree'} and $$hi{'subtree'} and $$lo{'subtree'} eq $$hi{'subtree'})"}],[1184,{"text":"unless $top_prt{$what}"}],[1189,{"text":"if (my $aref = $top_prt{'proto'})"}],[1203,{"text":"unless (defined $$icmp_aref[0]{'type'})"}],[1262,{"text":"if (my $aref3 = $sub_prt{$prt})"}],[1243,{"text":"if (@$aref2 > 1) { }"}],[1271,{"text":"if ($icmp_any) { }"}],[1271,{"text":"elsif (@seq2 > 1) { }"}],[1197,{"text":"if (my $icmp_aref = $top_prt{'icmp'})"}],[1289,{"text":"if ($ip_prt) { }"}],[1289,{"text":"elsif (@seq > 1) { }"}],[1305,{"text":"if $$bintree{'proto'} eq 'ip'"}],[1336,{"text":"$$rule{'deny'} ? :"}],[1335,{"text":"unless ($$rule{'action'})"}],[1344,{"text":"$proto eq 'icmp' ? :"}],[1344,{"text":"$proto eq 'udp' ? :"}],[1344,{"text":"$proto eq 'tcp' ? :"}],[1339,{"text":"unless ($src_range)"}],[1377,{"text":"if ($ref2x eq $ip_net2obj) { }"}],[1404,{"text":"if (not $$subtree2{$key} or $$subtree2{$key} ne $$subtree{$key})"}],[1464,{"text":"if $seq and not @$seq"}],[1466,{"text":"if $hi"}],[1467,{"text":"if $lo"}],[1465,{"text":"unless ($seq)"}],[1478,{"text":"$depth + 1 >= @$order ? :"}],[1482,{"text":"if (@$rules > 1 and not $$bintree{'noop'})"}],[1477,{"text":"unless ($rules)"}],[1493,{"text":"if $seq"}],[1494,{"text":"unless $$bintree{'noop'}"}],[1495,{"text":"if (@add_keys) { }"}],[1469,{"text":"if ($subtree)"}],[1507,{"text":"unless $seq"}],[1518,{"text":"if (@rules > 1 and not $$tree{'noop'}) { }"}],[1579,{"text":"unless $action"}],[1548,{"text":"if ($action eq $prev_action) { }"}],[1537,{"text":"if (@$rules)"}],[1597,{"text":"if ($i != $#rule_trees)"}],[1613,{"text":"$$src_range{'proto'} eq 'icmp' ? :"}],[1613,{"text":"$$src_range{'proto'} eq 'udp' ? :"}],[1613,{"text":"$$src_range{'proto'} eq 'tcp' ? :"}],[1609,{"text":"if (not $prt || $src_range) { }"}],[1609,{"text":"elsif (not $prt) { }"}],[1633,{"text":"$prefix_code == 32 ? :"}],[1642,{"text":"unless @$chains"}],[1665,{"text":"$action eq 'permit' ? :"}],[1665,{"text":"ref $action ? :"}],[1688,{"text":"$$rule{'goto'} ? :"}],[1691,{"text":"if ($$src{'mask'})"}],[1690,{"text":"if (my $src = $$rule{'src'})"}],[1696,{"text":"if ($$dst{'mask'})"}],[1695,{"text":"if (my $dst = $$rule{'dst'})"}],[1704,{"text":"unless $src_range or $prt"}],[1705,{"text":"if $prt and $$prt{'proto'} eq 'ip'"}],[1707,{"text":"if $$src_range{'proto'} eq 'ip'"}],[1708,{"text":"$$src_range{'proto'} eq 'icmp' ? :"}],[1708,{"text":"$$src_range{'proto'} eq 'udp' ? :"}],[1708,{"text":"$$src_range{'proto'} eq 'tcp' ? :"}],[1706,{"text":"unless ($prt)"}],[1736,{"text":"$action eq 'permit' ? :"}],[1736,{"text":"ref $action ? :"}],[1740,{"text":"$$rule{'goto'} ? :"}],[1742,{"text":"if ($$src{'mask'})"}],[1745,{"text":"if ($$dst{'mask'})"}],[1748,{"text":"if ($$prt{'proto'} ne 'ip')"}],[1789,{"text":"unless my $rules = $$acl_info{$what}"}],[1804,{"text":"if (my $prt = $$rule{'src_range'})"}],[1827,{"text":"if ($filter_only)"}],[1836,{"text":"if (my $list = $$acl_info{$what})"}],[1848,{"text":"if (my $need_protect = $$acl_info{'need_protect'})"}],[1851,{"text":"if ($model eq 'Linux')"}],[1863,{"text":"unless my $rules = $$acl_info{$what}"}],[1877,{"text":"if ($do_objectgroup and not $$acl_info{'is_crypto_acl'})"}],[1880,{"text":"if ($filter_only) { }"}],[1880,{"text":"elsif (not $has_final_permit) { }"}],[1858,{"text":"if ($model eq 'Linux') { }"}],[1898,{"text":"$model eq 'NX-OS' ? :"}],[1915,{"text":"if $model =~ /^(:?NX-OS|IOS)$/"}],[1909,{"text":"if (4294967295 == $mask) { }"}],[1897,{"text":"if (not defined $ip) { }"}],[1897,{"text":"elsif ($mask == 0) { }"}],[1897,{"text":"elsif ($model eq 'NX-OS') { }"}],[1926,{"text":"$model eq 'NX-OS' ? :"}],[1937,{"text":"if 0 == $$element{'mask'}"}],[1942,{"text":"if ($model eq 'NX-OS') { }"}],[1942,{"text":"elsif ($model eq 'ACE') { }"}],[1969,{"text":"if ($v1 == $v2) { }"}],[1969,{"text":"elsif ($v1 == 1 and $v2 == 65535) { }"}],[1969,{"text":"elsif ($v2 == 65535) { }"}],[1969,{"text":"elsif ($v1 == 1) { }"}],[1987,{"text":"if (defined $dst_prt) { }"}],[1986,{"text":"if (my $established = $$prt{'established'})"}],[2000,{"text":"if ($model =~ /^(:?ASA|PIX)$/) { }"}],[1999,{"text":"if (defined(my $code = $$prt{'code'})) { }"}],[1998,{"text":"if (defined(my $type = $$prt{'type'})) { }"}],[1962,{"text":"if ($proto eq 'ip') { }"}],[1962,{"text":"elsif ($proto eq 'tcp' or $proto eq 'udp') { }"}],[1962,{"text":"elsif ($proto eq 'icmp') { }"}],[2029,{"text":"if ($model eq 'IOS') { }"}],[2029,{"text":"elsif ($model eq 'ASA') { }"}],[2041,{"text":"$deny ? :"}],[2052,{"text":"if ($$acl_info{'is_std_acl'})"}],[2062,{"text":"if ($model eq 'IOS') { }"}],[2062,{"text":"elsif ($model eq 'NX-OS') { }"}],[2062,{"text":"elsif ($model eq 'ASA' or $model eq 'ACE') { }"}],[2062,{"text":"elsif ($model eq 'PIX') { }"}],[2083,{"text":"$deny ? :"}],[2088,{"text":"if defined $src_port_code"}],[2090,{"text":"if defined $dst_port_code"}],[2092,{"text":"if (my $log = $$rule{'log'})"}],[2097,{"text":"if ($model eq 'NX-OS')"}],[2113,{"text":"if ($$router_data{'chains'})"}],[2120,{"text":"if (my $groups = $$acl_info{'object_groups'})"}],[2110,{"text":"if ($model eq 'Linux') { }"}],[2132,{"text":"unless open my $out_fd, '>', $out_path"}],[2149,{"text":"unless my $acl_info = $acl_hash{$acl_name}"}],[2148,{"text":"if (my($acl_name) = $line =~ /^#insert (.*)\\n$/) { }"}],[2161,{"text":"unless close $out_fd"}],[2171,{"text":"unless -f \"$prev_file\""}],[2175,{"text":"unless -f $pass1prev"}],[2176,{"text":"unless system(\"cmp -s $pass1name $pass1prev\") == 0"}],[2196,{"text":"if ($has_prev and check_prev($code_file, $prev_file) and system(\"cp -p $prev_file $code_file\") == 0)"}],[2204,{"text":"if ($reused)"}],[2209,{"text":"if ($count = @pass2_list)"}],[2221,{"text":"unless system(\"rm -rf $prev\") == 0"}],[2220,{"text":"if ($has_prev and not -l $prev)"}],[2231,{"text":"if ($dir)"}]],"file":"lib/Netspoc/Compiler/Pass2.pm","start":{"36":{"BEGIN":[{"condition":null,"subroutine":7,"pod":null,"statement":21,"time":null,"branch":null}]},"1640":{"print_chains":[{"pod":22,"statement":768,"time":null,"branch":172,"condition":56,"subroutine":42}]},"1733":{"iptables_acl_line":[{"condition":58,"subroutine":43,"pod":23,"statement":807,"time":null,"branch":187}]},"49":{"create_prt_obj":[{"pod":1,"statement":27,"branch":null,"time":null,"condition":null,"subroutine":9}]},"594":{"add_local_deny_rules":[{"branch":62,"time":null,"statement":297,"pod":11,"subroutine":20,"condition":26}]},"69":{"setup_ip_net_relation":[{"statement":38,"pod":2,"branch":5,"time":null,"condition":1,"subroutine":10}]},"554":{"move_rules_esp_ah":[{"condition":20,"subroutine":19,"statement":274,"pod":10,"time":null,"branch":56}]},"837":{"add_final_permit_deny_rule":[{"time":null,"branch":86,"pod":15,"statement":420,"subroutine":26,"condition":34}]},"1756":{"print_iptables_acl":[{"statement":821,"pod":24,"time":null,"branch":193,"condition":58,"subroutine":44}]},"2170":{"check_prev":[{"subroutine":56,"condition":71,"branch":246,"time":null,"pod":35,"statement":1036}]},"1310":{"find_chains":[{"statement":610,"pod":20,"branch":141,"time":null,"condition":48,"subroutine":35}]},"31":{"BEGIN":[{"condition":null,"subroutine":2,"pod":null,"statement":6,"time":null,"branch":null}]},"326":{"optimize_rules":[{"pod":8,"statement":165,"time":null,"branch":36,"condition":12,"subroutine":17}]},"1446":{"__ANON__":[{"condition":56,"subroutine":39,"statement":762,"pod":21,"time":null,"branch":171}]},"1425":{"__ANON__":[{"time":null,"branch":171,"statement":762,"pod":21,"subroutine":38,"condition":56}]},"29":{"BEGIN":[{"branch":null,"time":null,"statement":null,"pod":null,"subroutine":null,"condition":null}]},"1219":{"__ANON__":[{"subroutine":34,"condition":48,"time":null,"branch":141,"pod":20,"statement":610}]},"703":{"__ANON__":[{"subroutine":23,"condition":30,"time":null,"branch":73,"statement":378,"pod":13}]},"1959":{"cisco_prt_code":[{"subroutine":50,"condition":66,"branch":214,"time":null,"statement":930,"pod":30}]},"2228":{"compile":[{"subroutine":58,"condition":74,"branch":254,"time":null,"statement":1070,"pod":37}]},"827":{"check_final_permit":[{"time":null,"branch":85,"statement":412,"pod":14,"subroutine":25,"condition":32}]},"224":{"setup_prt_relation":[{"condition":5,"subroutine":15,"statement":109,"pod":6,"time":null,"branch":19}]},"2050":{"print_cisco_acl":[{"branch":229,"time":null,"pod":32,"statement":976,"subroutine":53,"condition":69}]},"2128":{"print_combined":[{"subroutine":55,"condition":71,"time":null,"branch":242,"statement":1020,"pod":34}]},"2107":{"print_acl":[{"subroutine":54,"condition":71,"branch":239,"time":null,"statement":1010,"pod":33}]},"2025":{"print_cisco_std_acl":[{"condition":69,"subroutine":52,"statement":959,"pod":31,"branch":226,"time":null}]},"2182":{"pass2":[{"branch":249,"time":null,"pod":36,"statement":1044,"subroutine":57,"condition":71}]},"33":{"BEGIN":[{"subroutine":4,"condition":null,"time":null,"branch":null,"statement":12,"pod":null}]},"1393":{"__ANON__":[{"condition":56,"subroutine":37,"statement":762,"pod":21,"branch":171,"time":null}]},"1784":{"convert_rule_objects":[{"condition":58,"subroutine":46,"statement":838,"pod":26,"branch":193,"time":null}]},"645":{"find_objectgroups":[{"condition":26,"subroutine":22,"statement":322,"pod":12,"branch":66,"time":null}]},"856":{"iptables_prt_code":[{"branch":89,"time":null,"statement":433,"pod":16,"subroutine":27,"condition":35}]},"417":{"join_ranges":[{"time":null,"branch":46,"pod":9,"statement":214,"subroutine":18,"condition":18}]},"1144":{"__ANON__":[{"condition":48,"subroutine":33,"statement":610,"pod":20,"branch":141,"time":null}]},"1893":{"cisco_acl_addr":[{"time":null,"branch":204,"statement":900,"pod":28,"subroutine":48,"condition":66}]},"1020":{"gen_addr_bintree":[{"condition":45,"subroutine":30,"statement":502,"pod":18,"time":null,"branch":117}]},"762":{"add_protect_rules":[{"branch":73,"time":null,"statement":378,"pod":13,"subroutine":24,"condition":30}]},"930":{"add_bintree":[{"subroutine":29,"condition":38,"branch":100,"time":null,"pod":17,"statement":459}]},"864":{"__ANON__":[{"condition":38,"subroutine":28,"statement":459,"pod":17,"time":null,"branch":100}]},"30":{"BEGIN":[{"statement":3,"pod":null,"branch":null,"time":null,"condition":null,"subroutine":1}]},"35":{"BEGIN":[{"pod":null,"statement":18,"branch":null,"time":null,"condition":null,"subroutine":6}]},"1629":{"prefix_code":[{"time":null,"branch":171,"statement":762,"pod":21,"subroutine":41,"condition":56}]},"1967":{"__ANON__":[{"subroutine":51,"condition":69,"time":null,"branch":226,"pod":31,"statement":959}]},"-1":{"__COVER__":[{"condition":75,"subroutine":59,"statement":1077,"pod":38,"time":null,"branch":255}]},"1767":{"expand_rule":[{"pod":25,"statement":828,"branch":193,"time":null,"condition":58,"subroutine":45}]},"34":{"BEGIN":[{"condition":null,"subroutine":5,"statement":15,"pod":null,"time":null,"branch":null}]},"131":{"add_tcp_udp_icmp":[{"pod":4,"statement":67,"time":null,"branch":9,"condition":2,"subroutine":12}]},"268":{"optimize_redundant_rules":[{"condition":9,"subroutine":16,"statement":128,"pod":7,"time":null,"branch":24}]},"43":{"create_ip_obj":[{"branch":null,"time":null,"pod":null,"statement":24,"subroutine":8,"condition":null}]},"1116":{"__ANON__":[{"pod":20,"statement":610,"time":null,"branch":141,"condition":48,"subroutine":32}]},"32":{"BEGIN":[{"condition":null,"subroutine":3,"statement":9,"pod":null,"time":null,"branch":null}]},"1815":{"prepare_acls":[{"statement":859,"pod":27,"branch":195,"time":null,"condition":62,"subroutine":47}]},"163":{"__ANON__":[{"time":null,"branch":19,"statement":109,"pod":6,"subroutine":14,"condition":5}]},"1062":{"gen_prt_bintree":[{"statement":513,"pod":19,"branch":119,"time":null,"condition":45,"subroutine":31}]},"1924":{"print_object_groups":[{"time":null,"branch":210,"pod":29,"statement":915,"subroutine":49,"condition":66}]},"143":{"order_ranges":[{"condition":5,"subroutine":13,"pod":5,"statement":71,"time":null,"branch":9}]},"1455":{"__ANON__":[{"branch":171,"time":null,"pod":21,"statement":762,"subroutine":40,"condition":56}]},"1368":{"__ANON__":[{"time":null,"branch":171,"statement":762,"pod":21,"subroutine":36,"condition":56}]},"606":{"__ANON__":[{"condition":26,"subroutine":21,"statement":322,"pod":12,"time":null,"branch":66}]},"119":{"mark_supernets_of_need_protect":[{"branch":9,"time":null,"statement":61,"pod":3,"subroutine":11,"condition":2}]}},"subroutine":[[29,"BEGIN"],[30,"BEGIN"],[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[36,"BEGIN"],[43,"create_ip_obj"],[49,"create_prt_obj"],[69,"setup_ip_net_relation"],[119,"mark_supernets_of_need_protect"],[131,"add_tcp_udp_icmp"],[143,"order_ranges"],[163,"__ANON__"],[224,"setup_prt_relation"],[268,"optimize_redundant_rules"],[326,"optimize_rules"],[417,"join_ranges"],[554,"move_rules_esp_ah"],[594,"add_local_deny_rules"],[606,"__ANON__"],[645,"find_objectgroups"],[703,"__ANON__"],[762,"add_protect_rules"],[827,"check_final_permit"],[837,"add_final_permit_deny_rule"],[856,"iptables_prt_code"],[864,"__ANON__"],[930,"add_bintree"],[1020,"gen_addr_bintree"],[1062,"gen_prt_bintree"],[1116,"__ANON__"],[1144,"__ANON__"],[1219,"__ANON__"],[1310,"find_chains"],[1368,"__ANON__"],[1393,"__ANON__"],[1425,"__ANON__"],[1446,"__ANON__"],[1455,"__ANON__"],[1629,"prefix_code"],[1640,"print_chains"],[1733,"iptables_acl_line"],[1756,"print_iptables_acl"],[1767,"expand_rule"],[1784,"convert_rule_objects"],[1815,"prepare_acls"],[1893,"cisco_acl_addr"],[1924,"print_object_groups"],[1959,"cisco_prt_code"],[1967,"__ANON__"],[2025,"print_cisco_std_acl"],[2050,"print_cisco_acl"],[2107,"print_acl"],[2128,"print_combined"],[2170,"check_prev"],[2182,"pass2"],[2228,"compile"]]}