{"file":"lib/Netspoc/Compiler/Pass2.pm","branch":[[55,{"text":"if $established"}],[60,{"text":"if (defined $i2)"}],[58,{"text":"if (defined $i1)"}],[53,{"text":"if ($proto eq 'tcp' or $proto eq 'udp') { }"}],[53,{"text":"elsif ($proto eq 'icmp') { }"}],[85,{"text":"unless @mask_list"}],[98,{"text":"unless my $bignet = $mask_ip_hash{$m}{$i}"}],[110,{"text":"unless my $up = $$obj{'up'}"}],[111,{"text":"unless my $opt_secondary = $$up{'opt_secondary'}"}],[143,{"text":"unless $$a{'range'}[0] <=> $$b{'range'}[0]"}],[149,{"text":"if $$_{'proto'} eq $proto"}],[164,{"text":"if $i == @sorted"}],[181,{"text":"unless $a2 + 1 == $c1"}],[170,{"text":"if ($a2 + 1 == $b1)"}],[189,{"text":"if $a2 < $b1"}],[199,{"text":"unless $i"}],[194,{"text":"if ($a2 >= $b2)"}],[210,{"text":"unless @sorted"}],[217,{"text":"unless $index = &$check_subrange($a, $a1, $a2, $index)"}],[231,{"text":"if (defined $$prt{'code'}) { }"}],[230,{"text":"if (defined $type) { }"}],[228,{"text":"if ($proto eq 'icmp') { }"}],[228,{"text":"elsif ($proto =~ /^\\d+$/) { }"}],[252,{"text":"if (my $tcp_establ = $$prt2obj{'tcp 1 65535 established'})"}],[262,{"text":"$deny ? :"}],[287,{"text":"if $$chg_rule{'deleted'}"}],[293,{"text":"if ($cmp_rule ne $chg_rule and $cmp_log eq $chg_log)"}],[291,{"text":"if (my $cmp_rule = $$cmp_hash{$$prt{'name'}})"}],[301,{"text":"unless $prt = $$prt{'up'}"}],[285,{"text":"if (my $cmp_hash = $$cmp_hash{$$dst{'name'}})"}],[305,{"text":"unless $dst = $$dst{'up'}"}],[281,{"text":"if (my $cmp_hash = $$cmp_hash{$$src{'name'}})"}],[309,{"text":"unless $src = $$src{'up'}"}],[277,{"text":"if (my $cmp_hash = $$cmp_hash{$$src_range{'name'}})"}],[313,{"text":"unless $src_range = $$src_range{'up'}"}],[273,{"text":"if (my $cmp_hash = $$cmp_hash{$deny})"}],[317,{"text":"if $deny"}],[345,{"text":"if ($rule_tree{$deny}{$src_range}{$src}{$dst}{$prt})"}],[362,{"text":"unless $$rule{'opt_secondary'}"}],[363,{"text":"if $$rule{'deleted'}"}],[368,{"text":"if (my $supernet = $$src{'opt_secondary'})"}],[371,{"text":"if (my $supernet = $$dst{'opt_secondary'} and not $$dst{'need_protect'})"}],[383,{"text":"if ($secondary_tree{''}{$ip_key}{$src}{$dst}{$ip_key}) { }"}],[397,{"text":"if (keys %secondary_tree)"}],[406,{"text":"if ($changed)"}],[424,{"text":"unless $$prt{'has_neighbor'}"}],[445,{"text":"if values %$href == 1"}],[455,{"text":"if (my $log = $$rule{'log'})"}],[474,{"text":"unless @sorted >= 2"}],[484,{"text":"if (my $range = delete $$rule_a{'range'}) { }"}],[481,{"text":"if ($a2 + 1 == $b1)"}],[514,{"text":"if delete $$rule{'deleted'}"}],[525,{"text":"unless ($new_prt)"}],[518,{"text":"if (my $range = delete $$rule{'range'}) { }"}],[509,{"text":"if ($changed)"}],[555,{"text":"unless $prt_esp or $prt_ah"}],[557,{"text":"unless my $rules = $$acl_info{$what}"}],[562,{"text":"if ($$rule{'deny'}) { }"}],[562,{"text":"elsif ($prt_esp and $$rule{'prt'} eq $prt_esp) { }"}],[562,{"text":"elsif ($prt_ah and $$rule{'prt'} eq $prt_ah) { }"}],[580,{"text":"unless $$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'} or $$s_a{'ip'} <=> $$s_b{'ip'} or $$s_a{'mask'} <=> $$s_b{'mask'} or $$d_a{'ip'} <=> $$d_b{'ip'}"}],[597,{"text":"$$acl_info{'filter_any_src'} ? :"}],[604,{"text":"if (1 == @$obj_list) { }"}],[604,{"text":"elsif (my $group = $$router_data{'filter_only_group'}) { }"}],[600,{"text":"if ($do_objectgroup) { }"}],[656,{"text":"$this eq 'src' ? :"}],[668,{"text":"if (my $log = $$rule{'log'})"}],[679,{"text":"unless keys %$href >= $min_object_group_size"}],[705,{"text":"unless $$a{'ip'} <=> $$b{'ip'}"}],[720,{"text":"unless $$href{$key}"}],[743,{"text":"if ($$glue{'active'})"}],[742,{"text":"if (my $glue = delete $$rule{'group_glue'})"}],[760,{"text":"unless my $need_protect = $$acl_info{'need_protect'}"}],[774,{"text":"if $$rule{'deny'}"}],[775,{"text":"if $$rule{'src'} ne $network_00"}],[776,{"text":"if $$rule{'prt'} ne $prt_ip"}],[778,{"text":"if $$dst{'need_protect'}"}],[780,{"text":"if ($has_final_permit)"}],[785,{"text":"if ($changed)"}],[793,{"text":"if $$rule{'deny'}"}],[794,{"text":"if $$rule{'prt'}{'established'}"}],[796,{"text":"unless my $hash = $$dst{'is_supernet_of_need_protect'}"}],[798,{"text":"if ($$hash{$intf})"}],[806,{"text":"if ($no_protect{$interface} or not $need_protect{$interface} || $has_final_permit)"}],[826,{"text":"unless $rules and @$rules"}],[836,{"text":"unless $$acl_info{'add_deny'} or $$acl_info{'add_permit'}"}],[842,{"text":"if (my $log_deny = $$router_data{'log_deny'})"}],[840,{"text":"if ($$acl_info{'add_deny'})"}],[863,{"text":"if ($v1 == $v2) { }"}],[863,{"text":"elsif ($v1 == 1 and $v2 == 65535) { }"}],[863,{"text":"elsif ($v2 == 65535) { }"}],[863,{"text":"elsif ($v1 == 1) { }"}],[881,{"text":"if $sport"}],[883,{"text":"if $dport"}],[888,{"text":"if (defined(my $code = $$prt{'code'})) { }"}],[887,{"text":"if (defined(my $type = $$prt{'type'})) { }"}],[856,{"text":"if ($proto eq 'ip') { }"}],[856,{"text":"elsif ($proto eq 'tcp' or $proto eq 'udp') { }"}],[856,{"text":"elsif ($proto eq 'icmp') { }"}],[912,{"text":"$$tree{'subtree'} ? :"}],[951,{"text":"match_ip($node_ip, $tree_ip, $mask) ? :"}],[952,{"text":"if (my $subtree = $$tree{$branch}) { }"}],[946,{"text":"if (not $$tree{'subtree'} && $$node{'subtree'} or $$tree{'subtree'} ne $$node{'subtree'})"}],[967,{"text":"if ($sub1 ne $sub2)"}],[979,{"text":"if ($node_ip & $tree_mask) == ($tree_ip & $tree_mask)"}],[985,{"text":"$node_ip < $tree_ip ? :"}],[935,{"text":"if ($tree_mask < $node_mask and match_ip($node_ip, $tree_ip, $tree_mask)) { }"}],[935,{"text":"elsif ($tree_mask == $node_mask and $tree_ip == $node_ip) { }"}],[990,{"text":"if $$result{'subtree'}"}],[993,{"text":"unless my $lo = $$result{'lo'}"}],[994,{"text":"unless my $hi = $$result{'hi'}"}],[996,{"text":"unless $$lo{'mask'} == $mask"}],[997,{"text":"unless $$hi{'mask'} == $mask"}],[998,{"text":"unless $$lo{'subtree'} and $$hi{'subtree'}"}],[999,{"text":"unless $$lo{'subtree'} eq $$hi{'subtree'}"}],[1002,{"text":"if $$lo{$key}"}],[1003,{"text":"if $$hi{$key}"}],[1020,{"text":"unless $$b{'mask'} <=> $$a{'mask'}"}],[1039,{"text":"if $$bintree{'mask'} == 0"}],[1089,{"text":"if ($$tree{$$prt{'name'}} ne $subtree)"}],[1081,{"text":"if (my $subtree = $$tree{$$up{'name'}})"}],[1098,{"text":"$proto =~ /^\\d+$/ ? :"}],[1071,{"text":"if ($proto eq 'ip') { }"}],[1114,{"text":"if (not $prt_aref) { }"}],[1114,{"text":"elsif (@$prt_aref == 1) { }"}],[1143,{"text":"unless $hi"}],[1166,{"text":"if @hilo"}],[1167,{"text":"if @hilo"}],[1157,{"text":"if (@hilo <= 2)"}],[1150,{"text":"if ($$lo{'range'}[1] + 1 == $$hi{'range'}[0] and $$lo{'subtree'} and $$hi{'subtree'} and $$lo{'subtree'} eq $$hi{'subtree'})"}],[1181,{"text":"unless $top_prt{$what}"}],[1186,{"text":"if (my $aref = $top_prt{'proto'})"}],[1200,{"text":"unless (defined $$icmp_aref[0]{'type'})"}],[1259,{"text":"if (my $aref3 = $sub_prt{$prt})"}],[1240,{"text":"if (@$aref2 > 1) { }"}],[1268,{"text":"if ($icmp_any) { }"}],[1268,{"text":"elsif (@seq2 > 1) { }"}],[1194,{"text":"if (my $icmp_aref = $top_prt{'icmp'})"}],[1286,{"text":"if ($ip_prt) { }"}],[1286,{"text":"elsif (@seq > 1) { }"}],[1302,{"text":"if $$bintree{'proto'} eq 'ip'"}],[1333,{"text":"$$rule{'deny'} ? :"}],[1332,{"text":"unless ($$rule{'action'})"}],[1341,{"text":"$proto eq 'icmp' ? :"}],[1341,{"text":"$proto eq 'udp' ? :"}],[1341,{"text":"$proto eq 'tcp' ? :"}],[1336,{"text":"unless ($src_range)"}],[1358,{"text":"if ($depth < $#$order)"}],[1374,{"text":"if ($ref2x eq $ip_net2obj) { }"}],[1401,{"text":"if (not $$subtree2{$key} or $$subtree2{$key} ne $$subtree{$key})"}],[1461,{"text":"if $seq and not @$seq"}],[1463,{"text":"if $hi"}],[1464,{"text":"if $lo"}],[1462,{"text":"unless ($seq)"}],[1475,{"text":"$depth + 1 >= @$order ? :"}],[1479,{"text":"if (@$rules > 1 and not $$bintree{'noop'})"}],[1474,{"text":"unless ($rules)"}],[1490,{"text":"if $seq"}],[1491,{"text":"unless $$bintree{'noop'}"}],[1492,{"text":"if (@add_keys) { }"}],[1466,{"text":"if ($subtree)"}],[1504,{"text":"unless $seq"}],[1515,{"text":"if (@rules > 1 and not $$tree{'noop'}) { }"}],[1576,{"text":"unless $action"}],[1545,{"text":"if ($action eq $prev_action) { }"}],[1534,{"text":"if (@$rules)"}],[1594,{"text":"if ($i != $#rule_trees)"}],[1610,{"text":"$$src_range{'proto'} eq 'icmp' ? :"}],[1610,{"text":"$$src_range{'proto'} eq 'udp' ? :"}],[1610,{"text":"$$src_range{'proto'} eq 'tcp' ? :"}],[1606,{"text":"if (not $prt || $src_range) { }"}],[1606,{"text":"elsif (not $prt) { }"}],[1630,{"text":"$prefix_code == 32 ? :"}],[1639,{"text":"unless @$chains"}],[1662,{"text":"$action eq 'permit' ? :"}],[1662,{"text":"ref $action ? :"}],[1685,{"text":"$$rule{'goto'} ? :"}],[1688,{"text":"if ($$src{'mask'})"}],[1687,{"text":"if (my $src = $$rule{'src'})"}],[1693,{"text":"if ($$dst{'mask'})"}],[1692,{"text":"if (my $dst = $$rule{'dst'})"}],[1701,{"text":"unless $src_range or $prt"}],[1702,{"text":"if $prt and $$prt{'proto'} eq 'ip'"}],[1704,{"text":"if $$src_range{'proto'} eq 'ip'"}],[1705,{"text":"$$src_range{'proto'} eq 'icmp' ? :"}],[1705,{"text":"$$src_range{'proto'} eq 'udp' ? :"}],[1705,{"text":"$$src_range{'proto'} eq 'tcp' ? :"}],[1703,{"text":"unless ($prt)"}],[1733,{"text":"$action eq 'permit' ? :"}],[1733,{"text":"ref $action ? :"}],[1737,{"text":"$$rule{'goto'} ? :"}],[1739,{"text":"if ($$src{'mask'})"}],[1742,{"text":"if ($$dst{'mask'})"}],[1745,{"text":"if ($$prt{'proto'} ne 'ip')"}],[1776,{"text":"if ($filter_only)"}],[1783,{"text":"unless my $rules = $$acl_info{$what}"}],[1791,{"text":"if (my $prt = $$rule{'src_range'})"}],[1797,{"text":"if (my $opt_secondary = $$acl_info{'opt_secondary'})"}],[1804,{"text":"if (my $need_protect = $$acl_info{'need_protect'})"}],[1815,{"text":"if (my $need_protect = $$acl_info{'need_protect'})"}],[1818,{"text":"if ($model eq 'Linux')"}],[1830,{"text":"unless my $rules = $$acl_info{$what}"}],[1844,{"text":"if ($do_objectgroup and not $$acl_info{'is_crypto_acl'})"}],[1847,{"text":"if ($filter_only) { }"}],[1847,{"text":"elsif (not $has_final_permit) { }"}],[1825,{"text":"if ($model eq 'Linux') { }"}],[1865,{"text":"$model eq 'NX-OS' ? :"}],[1882,{"text":"if $model =~ /^(:?NX-OS|IOS)$/"}],[1876,{"text":"if (4294967295 == $mask) { }"}],[1864,{"text":"if (not defined $ip) { }"}],[1864,{"text":"elsif ($mask == 0) { }"}],[1864,{"text":"elsif ($model eq 'NX-OS') { }"}],[1893,{"text":"$model eq 'NX-OS' ? :"}],[1904,{"text":"if 0 == $$element{'mask'}"}],[1909,{"text":"if ($model eq 'NX-OS') { }"}],[1909,{"text":"elsif ($model eq 'ACE') { }"}],[1936,{"text":"if ($v1 == $v2) { }"}],[1936,{"text":"elsif ($v1 == 1 and $v2 == 65535) { }"}],[1936,{"text":"elsif ($v2 == 65535) { }"}],[1936,{"text":"elsif ($v1 == 1) { }"}],[1954,{"text":"if (defined $dst_prt) { }"}],[1953,{"text":"if (my $established = $$prt{'established'})"}],[1967,{"text":"if ($model =~ /^(:?ASA|PIX)$/) { }"}],[1966,{"text":"if (defined(my $code = $$prt{'code'})) { }"}],[1965,{"text":"if (defined(my $type = $$prt{'type'})) { }"}],[1929,{"text":"if ($proto eq 'ip') { }"}],[1929,{"text":"elsif ($proto eq 'tcp' or $proto eq 'udp') { }"}],[1929,{"text":"elsif ($proto eq 'icmp') { }"}],[1996,{"text":"if ($model eq 'IOS') { }"}],[1996,{"text":"elsif ($model eq 'ASA') { }"}],[2008,{"text":"$deny ? :"}],[2019,{"text":"if ($$acl_info{'is_std_acl'})"}],[2029,{"text":"if ($model eq 'IOS') { }"}],[2029,{"text":"elsif ($model eq 'NX-OS') { }"}],[2029,{"text":"elsif ($model eq 'ASA' or $model eq 'ACE') { }"}],[2029,{"text":"elsif ($model eq 'PIX') { }"}],[2050,{"text":"$deny ? :"}],[2055,{"text":"if defined $src_port_code"}],[2057,{"text":"if defined $dst_port_code"}],[2059,{"text":"if (my $log = $$rule{'log'})"}],[2064,{"text":"if ($model eq 'NX-OS')"}],[2080,{"text":"if ($$router_data{'chains'})"}],[2087,{"text":"if (my $groups = $$acl_info{'object_groups'})"}],[2077,{"text":"if ($model eq 'Linux') { }"}],[2099,{"text":"unless open my $out_fd, '>', $out_path"}],[2116,{"text":"unless my $acl_info = $acl_hash{$acl_name}"}],[2115,{"text":"if (my($acl_name) = $line =~ /^#insert (.*)\\n$/) { }"}],[2128,{"text":"unless close $out_fd"}],[2138,{"text":"unless -f \"$prev_file\""}],[2142,{"text":"unless -f $pass1prev"}],[2143,{"text":"unless system(\"cmp -s $pass1name $pass1prev\") == 0"}],[2163,{"text":"if ($has_prev and check_prev($code_file, $prev_file) and system(\"cp -p $prev_file $code_file\") == 0)"}],[2171,{"text":"if ($reused)"}],[2176,{"text":"if ($count = @pass2_list)"}],[2188,{"text":"unless system(\"rm -rf $prev\") == 0"}],[2187,{"text":"if ($has_prev and not -l $prev)"}],[2198,{"text":"if ($dir)"}]],"pod":[[43,"create_ip_obj"],[49,"create_prt_obj"],[69,"setup_ip_net_relation"],[118,"mark_supernets_of_need_protect"],[130,"add_tcp_udp_icmp"],[142,"order_ranges"],[223,"setup_prt_relation"],[260,"print_rule"],[267,"optimize_redundant_rules"],[325,"optimize_rules"],[414,"join_ranges"],[551,"move_rules_esp_ah"],[591,"add_local_deny_rules"],[642,"find_objectgroups"],[759,"add_protect_rules"],[824,"check_final_permit"],[834,"add_final_permit_deny_rule"],[853,"iptables_prt_code"],[908,"debug_bintree"],[927,"add_bintree"],[1017,"gen_addr_bintree"],[1059,"gen_prt_bintree"],[1307,"find_chains"],[1626,"prefix_code"],[1637,"print_chains"],[1730,"iptables_acl_line"],[1753,"print_iptables_acl"],[1764,"prepare_acls"],[1860,"cisco_acl_addr"],[1891,"print_object_groups"],[1926,"cisco_prt_code"],[1992,"print_cisco_std_acl"],[2017,"print_cisco_acl"],[2074,"print_acl"],[2095,"print_combined"],[2137,"check_prev"],[2149,"pass2"],[2195,"compile"]],"digest":"97e16cb63e704fdd15a126c019287f27","statement":[29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,43,44,45,49,50,51,53,54,55,58,59,60,61,65,69,70,71,74,75,75,76,81,82,85,87,89,91,95,97,98,99,102,109,109,110,111,112,118,119,120,121,122,123,130,131,132,133,142,152,143,149,159,208,162,163,164,165,166,166,170,174,177,178,179,180,181,182,183,189,194,195,196,199,200,206,210,211,212,213,214,215,215,216,217,219,223,224,225,226,227,228,229,229,230,231,232,235,239,245,249,250,252,253,256,260,261,261,262,263,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,296,297,298,301,305,309,313,317,318,321,325,326,329,332,333,336,335,337,338,339,340,341,342,345,346,347,348,350,353,355,358,359,361,362,363,365,365,368,369,371,372,376,381,382,383,386,387,392,397,398,400,401,403,406,407,407,409,414,415,416,418,420,419,424,426,427,428,432,435,438,441,442,445,452,453,454,455,456,458,458,461,471,470,474,475,476,477,477,478,479,480,480,481,484,488,489,494,498,499,501,502,509,510,511,514,518,519,520,524,525,526,530,532,533,536,539,541,551,552,553,554,555,556,557,558,560,561,562,563,566,569,572,578,578,578,579,579,580,584,586,591,592,593,593,594,595,597,600,620,603,604,605,610,613,615,616,616,617,618,621,628,629,630,635,636,642,643,646,647,652,655,656,657,661,662,663,664,665,666,667,668,669,671,676,679,681,693,694,737,700,701,707,705,706,710,711,715,714,716,719,720,724,728,731,734,734,735,735,736,740,741,742,743,744,746,747,748,750,752,754,755,759,760,761,761,771,773,773,774,775,776,777,778,780,781,782,785,786,786,786,791,792,792,793,794,795,796,797,798,799,805,806,810,813,813,824,825,826,827,827,828,828,829,834,835,836,838,838,839,840,841,842,843,846,846,848,853,854,856,857,878,861,862,862,863,864,867,870,873,876,879,880,881,882,883,884,887,888,889,892,896,900,908,909,910,911,912,917,927,928,928,929,929,930,935,946,950,951,952,953,956,959,965,966,967,968,969,970,972,977,978,979,982,985,985,992,990,993,994,995,996,997,998,999,1001,1002,1003,1008,1009,1010,1012,1017,1023,1020,1023,1021,1027,1032,1033,1034,1039,1042,1059,1061,1063,1069,1070,1071,1072,1075,1080,1081,1089,1090,1090,1092,1094,1098,1099,1099,1104,1111,1139,1113,1114,1115,1118,1119,1120,1127,1131,1130,1134,1135,1136,1137,1179,1141,1142,1143,1144,1147,1150,1156,1155,1157,1161,1166,1167,1168,1173,1180,1181,1182,1186,1187,1187,1188,1189,1194,1195,1200,1201,1202,1207,1208,1209,1209,1228,1216,1226,1218,1219,1231,1234,1234,1235,1236,1240,1241,1244,1253,1254,1259,1260,1263,1267,1268,1269,1276,1279,1281,1285,1286,1287,1294,1297,1302,1303,1307,1308,1309,1310,1311,1318,1319,1320,1321,1322,1326,1331,1332,1333,1335,1336,1337,1341,1346,1350,1362,1354,1355,1358,1359,1381,1365,1366,1367,1368,1368,1373,1374,1375,1378,1380,1385,1419,1390,1393,1394,1395,1399,1398,1400,1401,1404,1409,1410,1415,1415,1416,1439,1422,1425,1426,1427,1432,1433,1437,1438,1448,1443,1444,1445,1446,1446,1447,1450,1528,1452,1453,1454,1457,1458,1460,1459,1461,1462,1463,1464,1466,1473,1474,1475,1479,1480,1481,1483,1486,1490,1491,1492,1497,1496,1501,1504,1507,1510,1511,1512,1515,1522,1523,1526,1532,1534,1535,1538,1539,1540,1541,1542,1543,1544,1545,1549,1550,1552,1560,1560,1559,1560,1562,1563,1564,1565,1567,1566,1569,1568,1570,1572,1575,1576,1577,1578,1581,1584,1585,1586,1589,1590,1594,1595,1596,1601,1602,1603,1604,1605,1606,1607,1610,1617,1619,1620,1626,1627,1627,1628,1629,1630,1637,1638,1639,1641,1642,1643,1644,1645,1646,1649,1650,1651,1655,1656,1657,1660,1660,1661,1662,1685,1686,1687,1688,1689,1692,1693,1694,1699,1699,1700,1701,1702,1703,1704,1705,1713,1715,1725,1726,1730,1732,1731,1733,1737,1738,1739,1740,1742,1743,1745,1746,1748,1749,1753,1754,1755,1756,1757,1758,1759,1764,1765,1767,1766,1769,1773,1774,1776,1778,1777,1782,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1797,1798,1799,1800,1801,1804,1805,1806,1807,1808,1812,1813,1815,1816,1818,1819,1822,1823,1825,1826,1829,1830,1831,1836,1837,1839,1841,1842,1844,1845,1847,1848,1851,1855,1860,1861,1861,1864,1865,1866,1869,1872,1875,1876,1877,1882,1883,1884,1887,1891,1892,1893,1896,1898,1899,1900,1900,1904,1908,1909,1910,1911,1914,1917,1926,1927,1929,1930,1951,1934,1935,1935,1936,1937,1940,1943,1946,1949,1952,1953,1954,1955,1958,1961,1962,1965,1966,1967,1972,1975,1979,1983,1987,1992,1993,1994,1995,1996,1997,1998,2001,2004,2006,2007,2007,2008,2009,2010,2011,2013,2017,2019,2020,2021,2024,2025,2026,2027,2028,2029,2030,2031,2034,2035,2038,2041,2044,2047,2049,2048,2050,2051,2053,2054,2055,2056,2057,2059,2060,2064,2065,2066,2068,2070,2074,2075,2077,2080,2081,2082,2084,2087,2088,2090,2095,2099,2101,2103,2104,2104,2108,2109,2112,2115,2116,2118,2123,2127,2128,2131,2137,2138,2139,2140,2141,2142,2143,2145,2149,2150,2151,2152,2152,2153,2155,2156,2157,2158,2159,2160,2163,2166,2167,2169,2171,2172,2176,2177,2178,2179,2180,2181,2187,2188,2195,2196,2197,2198,2199,2201,2202],"condition":[[53,{"right":"$proto eq 'udp'","type":"or_3","left":"$proto eq 'tcp'","op":"or"}],[70,{"left":"$$ip_net2obj{'0.0.0.0/0'}","op":"||=","right":"create_ip_obj('0.0.0.0/0')","type":"or_3"}],[131,{"op":"||=","left":"$$prt2obj{'tcp 1 65535'}","right":"create_prt_obj('tcp 1 65535')","type":"or_3"}],[132,{"left":"$$prt2obj{'udp 1 65535'}","op":"||=","right":"create_prt_obj('udp 1 65535')","type":"or_3"}],[133,{"type":"or_3","right":"create_prt_obj('icmp')","op":"||=","left":"$$prt2obj{'icmp'}"}],[224,{"op":"||=","left":"$$prt2obj{'ip'}","right":"create_prt_obj('ip')","type":"or_3"}],[225,{"type":"or_3","right":"$prt_ip","left":"$$prt2obj{'icmp'}","op":"||"}],[232,{"right":"$icmp_up","type":"or_3","op":"||","left":"$$prt2obj{\"icmp $type\"}"}],[253,{"right":"$prt_ip","type":"or_3","op":"||","left":"$$prt2obj{'tcp 1 65535'}"}],[289,{"right":"''","type":"or_2","op":"||","left":"$$chg_rule{'log'}"}],[292,{"left":"$$cmp_rule{'log'}","op":"||","type":"or_2","right":"''"}],[293,{"type":"and_3","right":"$cmp_log eq $chg_log","op":"and","left":"$cmp_rule ne $chg_rule"}],[337,{"right":"''","type":"or_2","op":"||=","left":"$deny"}],[338,{"type":"or_3","right":"$prt_ip","op":"||=","left":"$src_range"}],[355,{"right":"$changed2","type":"or_3","left":"$changed","op":"||="}],[371,{"op":"and","left":"my $supernet = $$dst{'opt_secondary'}","type":"and_3","right":"not $$dst{'need_protect'}"}],[400,{"left":"$changed","op":"||=","right":"$changed2","type":"or_3"}],[403,{"right":"$changed2","type":"or_3","left":"$changed","op":"||="}],[426,{"right":"''","type":"or_2","op":"||=","left":"$deny"}],[427,{"op":"||=","left":"$src_range","right":"''","type":"or_2"}],[555,{"op":"or","left":"$prt_esp","type":"or_3","right":"$prt_ah"}],[562,{"type":"and_3","right":"$$rule{'prt'} eq $prt_esp","op":"and","left":"$prt_esp"}],[562,{"type":"and_3","right":"$$rule{'prt'} eq $prt_ah","left":"$prt_ah","op":"and"}],[580,{"type":"or_3","right":"$$s_a{'ip'} <=> $$s_b{'ip'}","op":"or","left":"$$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'}"}],[580,{"type":"or_3","right":"$$s_a{'mask'} <=> $$s_b{'mask'}","left":"$$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'} or $$s_a{'ip'} <=> $$s_b{'ip'}","op":"or"}],[580,{"right":"$$d_a{'ip'} <=> $$d_b{'ip'}","type":"or_3","left":"$$a{'prt'}{'proto'} <=> $$b{'prt'}{'proto'} or $$s_a{'ip'} <=> $$s_b{'ip'} or $$s_a{'mask'} <=> $$s_b{'mask'}","op":"or"}],[646,{"right":"{}","type":"or_2","op":"||=","left":"$$router_data{'obj_groups_hash'}"}],[647,{"right":"0","type":"or_2","op":"||=","left":"$$router_data{'obj_group_counter'}"}],[662,{"op":"||","left":"$$rule{'deny'}","type":"or_2","right":"''"}],[665,{"left":"$$rule{'src_range'}","op":"||","type":"or_2","right":"''"}],[806,{"left":"$need_protect{$interface}","op":"||","right":"$has_final_permit","type":"or_3"}],[806,{"right":"not $need_protect{$interface} || $has_final_permit","type":"or_3","op":"or","left":"$no_protect{$interface}"}],[826,{"left":"$rules","op":"and","type":"and_3","right":"@$rules"}],[829,{"left":"!$deny && $src eq $net_00 && $dst eq $net_00","op":"&&","right":"$prt eq $prt_ip","type":"and_3"}],[836,{"op":"or","left":"$$acl_info{'add_deny'}","right":"$$acl_info{'add_permit'}","type":"or_3"}],[856,{"type":"or_3","right":"$proto eq 'udp'","left":"$proto eq 'tcp'","op":"or"}],[863,{"right":"$v2 == 65535","type":"and_3","op":"and","left":"$v1 == 1"}],[880,{"type":"and_3","right":"&$port_code($src_range)","op":"&&","left":"$src_range"}],[909,{"op":"||=","left":"$depth","right":"''","type":"or_2"}],[935,{"left":"$tree_mask < $node_mask","op":"and","type":"and_3","right":"match_ip($node_ip, $tree_ip, $tree_mask)"}],[946,{"left":"$$tree{'subtree'}","op":"&&","right":"$$node{'subtree'}","type":"and_3"}],[946,{"right":"$$tree{'subtree'} ne $$node{'subtree'}","type":"or_3","op":"or","left":"not $$tree{'subtree'} && $$node{'subtree'}"}],[935,{"right":"$tree_ip == $node_ip","type":"and_3","op":"and","left":"$tree_mask == $node_mask"}],[965,{"op":"||","left":"$$tree{'subtree'}","right":"''","type":"or_2"}],[966,{"type":"or_2","right":"''","left":"$$node{'subtree'}","op":"||"}],[998,{"right":"$$hi{'subtree'}","type":"and_3","left":"$$lo{'subtree'}","op":"and"}],[1150,{"right":"$$lo{'subtree'}","type":"and_3","op":"and","left":"$$lo{'range'}[1] + 1 == $$hi{'range'}[0]"}],[1150,{"left":"$$lo{'range'}[1] + 1 == $$hi{'range'}[0] and $$lo{'subtree'}","op":"and","type":"and_3","right":"$$hi{'subtree'}"}],[1150,{"right":"$$lo{'subtree'} eq $$hi{'subtree'}","type":"and_3","op":"and","left":"$$lo{'range'}[1] + 1 == $$hi{'range'}[0] and $$lo{'subtree'} and $$hi{'subtree'}"}],[1326,{"op":"||=","left":"$$router_data{'chain_counter'}","type":"or_2","right":"1"}],[1401,{"left":"not $$subtree2{$key}","op":"or","type":"or_3","right":"$$subtree2{$key} ne $$subtree{$key}"}],[1461,{"op":"and","left":"$seq","right":"not @$seq","type":"and_3"}],[1479,{"right":"not $$bintree{'noop'}","type":"and_3","op":"and","left":"@$rules > 1"}],[1515,{"right":"not $$tree{'noop'}","type":"and_3","op":"and","left":"@rules > 1"}],[1602,{"op":"||=","left":"$$rule{'src'}","type":"or_3","right":"$network_00"}],[1603,{"type":"or_3","right":"$network_00","op":"||=","left":"$$rule{'dst'}"}],[1606,{"left":"$prt","op":"||","right":"$src_range","type":"or_3"}],[1701,{"left":"$src_range","op":"or","right":"$prt","type":"or_3"}],[1702,{"right":"$$prt{'proto'} eq 'ip'","type":"and_3","left":"$prt","op":"and"}],[1777,{"op":"||=","left":"$$ip_net2obj{$_}","right":"create_ip_obj($_)","type":"or_3"}],[1786,{"type":"or_3","right":"create_ip_obj($ip_net)","left":"$$ip_net2obj{$ip_net}","op":"||="}],[1788,{"left":"$$ip_net2obj{$ip_net}","op":"||=","right":"create_ip_obj($ip_net)","type":"or_3"}],[1790,{"left":"$$prt2obj{$prt}","op":"||=","type":"or_3","right":"create_prt_obj($prt)"}],[1792,{"right":"create_prt_obj($prt)","type":"or_3","left":"$$prt2obj{$prt}","op":"||="}],[1799,{"op":"||=","left":"$$ip_net2obj{$ip_net}","right":"create_ip_obj($ip_net)","type":"or_3"}],[1806,{"left":"$$ip_net2obj{$ip_net}","op":"||=","right":"create_ip_obj($ip_net)","type":"or_3"}],[1842,{"left":"$has_final_permit","op":"||","right":"$$acl_info{'add_permit'}","type":"or_3"}],[1844,{"op":"and","left":"$do_objectgroup","type":"and_3","right":"not $$acl_info{'is_crypto_acl'}"}],[1929,{"type":"or_3","right":"$proto eq 'udp'","op":"or","left":"$proto eq 'tcp'"}],[1936,{"left":"$v1 == 1","op":"and","right":"$v2 == 65535","type":"and_3"}],[1961,{"type":"and_3","right":"&$port_code($src_range)","op":"&&","left":"$src_range"}],[2024,{"right":"[]","type":"or_2","op":"||","left":"$$acl_info{'intf_rules'}"}],[2029,{"right":"$model eq 'ACE'","type":"or_3","left":"$model eq 'ASA'","op":"or"}],[2163,{"type":"and_3","right":"check_prev($code_file, $prev_file)","op":"and","left":"$has_prev"}],[2163,{"right":"system(\"cp -p $prev_file $code_file\") == 0","type":"and_3","op":"and","left":"$has_prev and check_prev($code_file, $prev_file)"}],[2187,{"right":"not -l $prev","type":"and_3","op":"and","left":"$has_prev"}],[2197,{"type":"or_3","right":"time","op":"||","left":"$$Netspoc::Compiler::Pass2::config{'start_time'}"}]],"start":{"603":{"__ANON__":[{"condition":26,"branch":65,"time":null,"subroutine":22,"statement":325,"pod":13}]},"1934":{"__ANON__":[{"time":null,"branch":228,"condition":71,"pod":31,"statement":956,"subroutine":52}]},"1891":{"print_object_groups":[{"statement":912,"subroutine":50,"pod":29,"branch":212,"condition":68,"time":null}]},"1637":{"print_chains":[{"branch":173,"condition":57,"time":null,"statement":782,"subroutine":45,"pod":24}]},"43":{"create_ip_obj":[{"pod":null,"subroutine":8,"statement":24,"time":null,"condition":null,"branch":null}]},"325":{"optimize_rules":[{"statement":170,"subroutine":18,"pod":9,"branch":37,"condition":12,"time":null}]},"1992":{"print_cisco_std_acl":[{"branch":228,"condition":71,"time":null,"statement":956,"subroutine":53,"pod":31}]},"2137":{"check_prev":[{"pod":35,"statement":1033,"subroutine":57,"time":null,"branch":248,"condition":73}]},"36":{"BEGIN":[{"subroutine":7,"statement":21,"pod":null,"condition":null,"branch":null,"time":null}]},"32":{"BEGIN":[{"time":null,"condition":null,"branch":null,"pod":null,"subroutine":3,"statement":9}]},"700":{"__ANON__":[{"subroutine":24,"statement":381,"pod":14,"condition":30,"branch":72,"time":null}]},"142":{"order_ranges":[{"subroutine":13,"statement":71,"pod":5,"condition":5,"branch":9,"time":null}]},"267":{"optimize_redundant_rules":[{"pod":8,"subroutine":17,"statement":133,"time":null,"condition":9,"branch":25}]},"33":{"BEGIN":[{"branch":null,"condition":null,"time":null,"statement":12,"subroutine":4,"pod":null}]},"414":{"join_ranges":[{"time":null,"branch":45,"condition":18,"pod":10,"statement":217,"subroutine":19}]},"824":{"check_final_permit":[{"time":null,"branch":84,"condition":32,"pod":15,"statement":415,"subroutine":26}]},"-1":{"__COVER__":[{"branch":257,"condition":77,"time":null,"statement":1074,"subroutine":60,"pod":38}]},"853":{"iptables_prt_code":[{"statement":436,"subroutine":28,"pod":17,"branch":88,"condition":35,"time":null}]},"118":{"mark_supernets_of_need_protect":[{"time":null,"branch":9,"condition":2,"pod":3,"statement":61,"subroutine":11}]},"1626":{"prefix_code":[{"time":null,"condition":57,"branch":172,"pod":23,"subroutine":44,"statement":776}]},"162":{"__ANON__":[{"pod":6,"statement":109,"subroutine":14,"time":null,"branch":19,"condition":5}]},"2149":{"pass2":[{"pod":36,"statement":1041,"subroutine":58,"time":null,"branch":251,"condition":73}]},"1141":{"__ANON__":[{"time":null,"branch":141,"condition":49,"pod":22,"statement":619,"subroutine":35}]},"1390":{"__ANON__":[{"time":null,"branch":172,"condition":57,"pod":23,"statement":776,"subroutine":40}]},"1307":{"find_chains":[{"time":null,"condition":49,"branch":141,"pod":22,"subroutine":37,"statement":619}]},"223":{"setup_prt_relation":[{"pod":6,"subroutine":15,"statement":109,"time":null,"condition":5,"branch":19}]},"1730":{"iptables_acl_line":[{"subroutine":46,"statement":821,"pod":25,"condition":59,"branch":188,"time":null}]},"35":{"BEGIN":[{"subroutine":6,"statement":18,"pod":null,"condition":null,"branch":null,"time":null}]},"927":{"add_bintree":[{"pod":19,"statement":468,"subroutine":31,"time":null,"branch":100,"condition":39}]},"2095":{"print_combined":[{"statement":1017,"subroutine":56,"pod":34,"branch":244,"condition":73,"time":null}]},"1443":{"__ANON__":[{"subroutine":42,"statement":776,"pod":23,"condition":57,"branch":172,"time":null}]},"2195":{"compile":[{"subroutine":59,"statement":1067,"pod":37,"condition":76,"branch":256,"time":null}]},"551":{"move_rules_esp_ah":[{"branch":55,"condition":20,"time":null,"statement":277,"subroutine":20,"pod":11}]},"30":{"BEGIN":[{"branch":null,"condition":null,"time":null,"statement":3,"subroutine":1,"pod":null}]},"1017":{"gen_addr_bintree":[{"pod":20,"subroutine":32,"statement":511,"time":null,"condition":46,"branch":117}]},"759":{"add_protect_rules":[{"condition":30,"branch":72,"time":null,"subroutine":25,"statement":381,"pod":14}]},"1860":{"cisco_acl_addr":[{"time":null,"branch":206,"condition":68,"pod":28,"statement":897,"subroutine":49}]},"130":{"add_tcp_udp_icmp":[{"time":null,"branch":9,"condition":2,"pod":4,"statement":67,"subroutine":12}]},"1113":{"__ANON__":[{"condition":49,"branch":141,"time":null,"subroutine":34,"statement":619,"pod":22}]},"642":{"find_objectgroups":[{"time":null,"condition":26,"branch":65,"pod":13,"subroutine":23,"statement":325}]},"861":{"__ANON__":[{"time":null,"condition":38,"branch":99,"pod":18,"subroutine":29,"statement":462}]},"1452":{"__ANON__":[{"statement":776,"subroutine":43,"pod":23,"branch":172,"condition":57,"time":null}]},"1354":{"__ANON__":[{"pod":23,"subroutine":38,"statement":776,"time":null,"condition":57,"branch":172}]},"2017":{"print_cisco_acl":[{"condition":71,"branch":231,"time":null,"subroutine":54,"statement":973,"pod":32}]},"1365":{"__ANON__":[{"pod":23,"statement":776,"subroutine":39,"time":null,"branch":172,"condition":57}]},"908":{"debug_bintree":[{"time":null,"branch":99,"condition":38,"pod":18,"statement":462,"subroutine":30}]},"260":{"print_rule":[{"subroutine":16,"statement":128,"pod":7,"condition":9,"branch":24,"time":null}]},"1422":{"__ANON__":[{"statement":776,"subroutine":41,"pod":23,"branch":172,"condition":57,"time":null}]},"69":{"setup_ip_net_relation":[{"subroutine":10,"statement":38,"pod":2,"condition":1,"branch":5,"time":null}]},"1059":{"gen_prt_bintree":[{"condition":46,"branch":119,"time":null,"subroutine":33,"statement":522,"pod":21}]},"591":{"add_local_deny_rules":[{"time":null,"branch":61,"condition":26,"pod":12,"statement":300,"subroutine":21}]},"1753":{"print_iptables_acl":[{"branch":194,"condition":59,"time":null,"statement":835,"subroutine":47,"pod":26}]},"34":{"BEGIN":[{"statement":15,"subroutine":5,"pod":null,"branch":null,"condition":null,"time":null}]},"1216":{"__ANON__":[{"subroutine":36,"statement":619,"pod":22,"condition":49,"branch":141,"time":null}]},"834":{"add_final_permit_deny_rule":[{"branch":85,"condition":34,"time":null,"statement":423,"subroutine":27,"pod":16}]},"29":{"BEGIN":[{"pod":null,"subroutine":null,"statement":null,"time":null,"condition":null,"branch":null}]},"31":{"BEGIN":[{"pod":null,"statement":6,"subroutine":2,"time":null,"branch":null,"condition":null}]},"49":{"create_prt_obj":[{"time":null,"condition":null,"branch":null,"pod":1,"subroutine":9,"statement":27}]},"1926":{"cisco_prt_code":[{"condition":68,"branch":216,"time":null,"subroutine":51,"statement":927,"pod":30}]},"1764":{"prepare_acls":[{"subroutine":48,"statement":842,"pod":27,"condition":59,"branch":194,"time":null}]},"2074":{"print_acl":[{"statement":1007,"subroutine":55,"pod":33,"branch":241,"condition":73,"time":null}]}},"subroutine":[[29,"BEGIN"],[30,"BEGIN"],[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[34,"BEGIN"],[35,"BEGIN"],[36,"BEGIN"],[43,"create_ip_obj"],[49,"create_prt_obj"],[69,"setup_ip_net_relation"],[118,"mark_supernets_of_need_protect"],[130,"add_tcp_udp_icmp"],[142,"order_ranges"],[162,"__ANON__"],[223,"setup_prt_relation"],[260,"print_rule"],[267,"optimize_redundant_rules"],[325,"optimize_rules"],[414,"join_ranges"],[551,"move_rules_esp_ah"],[591,"add_local_deny_rules"],[603,"__ANON__"],[642,"find_objectgroups"],[700,"__ANON__"],[759,"add_protect_rules"],[824,"check_final_permit"],[834,"add_final_permit_deny_rule"],[853,"iptables_prt_code"],[861,"__ANON__"],[908,"debug_bintree"],[927,"add_bintree"],[1017,"gen_addr_bintree"],[1059,"gen_prt_bintree"],[1113,"__ANON__"],[1141,"__ANON__"],[1216,"__ANON__"],[1307,"find_chains"],[1354,"__ANON__"],[1365,"__ANON__"],[1390,"__ANON__"],[1422,"__ANON__"],[1443,"__ANON__"],[1452,"__ANON__"],[1626,"prefix_code"],[1637,"print_chains"],[1730,"iptables_acl_line"],[1753,"print_iptables_acl"],[1764,"prepare_acls"],[1860,"cisco_acl_addr"],[1891,"print_object_groups"],[1926,"cisco_prt_code"],[1934,"__ANON__"],[1992,"print_cisco_std_acl"],[2017,"print_cisco_acl"],[2074,"print_acl"],[2095,"print_combined"],[2137,"check_prev"],[2149,"pass2"],[2195,"compile"]]}