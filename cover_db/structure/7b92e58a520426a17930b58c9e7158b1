{"subroutine":[[27,"BEGIN"],[28,"BEGIN"],[29,"BEGIN"],[30,"BEGIN"],[31,"BEGIN"],[32,"BEGIN"],[33,"BEGIN"],[36,"usage"],[53,"abort"],[58,"internal_err"],[63,"create_dirs"],[81,"export"],[89,"by_name"],[94,"nat"],[99,"ip_nat_for_object"],[110,"__ANON__"],[143,"__ANON__"],[180,"__ANON__"],[242,"setup_zones"],[259,"owner_for_object"],[268,"part_owners_for_object"],[276,"extended_owners_for_object"],[288,"owners_for_objects"],[299,"part_owners_for_objects"],[310,"extended_owners_for_objects"],[321,"expand_auto_intf"],[342,"proto_descr"],[350,"__ANON__"],[414,"find_visibility"],[445,"setup_service_info"],[541,"setup_part_owners"],[571,"__ANON__"],[615,"find_master_owner"],[633,"export_no_nat_set"],[695,"add_subnetworks"],[706,"export_assets"],[710,"__ANON__"],[743,"__ANON__"],[810,"export_services"],[921,"zone_and_subnet"],[943,"export_objects"],[967,"export_owners"],[1032,"copy_policy_file"]],"branch":[[41,{"text":"unless GetOptions 'quiet!', \\$quiet"}],[42,{"text":"unless my $netspoc_data = shift @ARGV"}],[43,{"text":"unless my $out_dir = shift @ARGV"}],[69,{"text":"if ($file eq '') { }"}],[66,{"text":"if (@$err)"}],[83,{"text":"unless open my $fh, '>', $path"}],[85,{"text":"unless close $fh"}],[111,{"text":"if ($$obj{'hidden'}) { }"}],[111,{"text":"elsif ($$obj{'ip'} eq 'unnumbered') { }"}],[111,{"text":"elsif ($$obj{'loopback'}) { }"}],[111,{"text":"elsif ($$obj{'is_aggregate'} and $$obj{'mask'} == 0) { }"}],[134,{"text":"if (my $hash = $$obj{'nat'})"}],[145,{"text":"if ($$obj{'nat'} and my $ip = $$obj{'nat'}{$nat_tag}) { }"}],[145,{"text":"elsif ($$network{'hidden'}) { }"}],[161,{"text":"if (my $range = $$obj{'range'}) { }"}],[144,{"text":"if (my $nat_tag = $$network{'dynamic'}) { }"}],[171,{"text":"if (my $hash = $$network{'nat'})"}],[182,{"text":"if (my $ip = $$obj{'nat'}{$nat_tag}) { }"}],[182,{"text":"elsif ($$network{'hidden'}) { }"}],[181,{"text":"if (my $nat_tag = $$network{'dynamic'}) { }"}],[181,{"text":"elsif ($$network{'isolated'}) { }"}],[181,{"text":"elsif ($$obj{'ip'} =~ /unnumbered|short|bridged/) { }"}],[181,{"text":"elsif ($$obj{'ip'} eq 'negotiated') { }"}],[219,{"text":"if (my $hash = $$network{'nat'})"}],[108,{"text":"if ($type eq 'Network') { }"}],[108,{"text":"elsif ($type eq 'Host') { }"}],[108,{"text":"elsif ($type eq 'Interface') { }"}],[229,{"text":"$nat ? :"}],[245,{"text":"if $$network{'disabled'}"}],[247,{"text":"if $seen{$zone}++"}],[260,{"text":"if (my $owner_obj = $$object{'owner'})"}],[269,{"text":"if (my $aref = $$object{'part_owners'})"}],[280,{"text":"if (my $list = $$owner_obj{'extended_by'})"}],[278,{"text":"if (my $owner_obj = $$object{'extended_owner'})"}],[291,{"text":"if (my $name = owner_for_object($object))"}],[324,{"text":"unless Netspoc::is_autointerface($src)"}],[329,{"text":"unless ($seen{$interface}++)"}],[352,{"text":"if ($v1 == $v2) { }"}],[352,{"text":"elsif ($v1 == 1 and $v2 == 65535) { }"}],[365,{"text":"if ($sport) { }"}],[365,{"text":"elsif ($dport) { }"}],[375,{"text":"if (defined(my $code = $$protocol{'code'})) { }"}],[374,{"text":"if (defined(my $type = $$protocol{'type'}))"}],[348,{"text":"if ($ptype eq 'tcp' or $ptype eq 'udp') { }"}],[348,{"text":"elsif ($ptype eq 'icmp') { }"}],[386,{"text":"if $key eq 'stateless_icmp'"}],[387,{"text":"if $key eq 'overlaps'"}],[388,{"text":"if $key eq 'no_check_supernet_rules'"}],[389,{"text":"if ($key eq 'src' or $key eq 'dst') { }"}],[384,{"text":"if (my $flags = $$protocol{'flags'})"}],[403,{"text":"unless $$a[1] cmp $$b[1] or $$a[2] <=> $$b[2]"}],[431,{"text":"if (@DA_extra >= 3)"}],[422,{"text":"if (not @$owners || @$uowners) { }"}],[422,{"text":"elsif (not @extra_uowners) { }"}],[422,{"text":"elsif (@other_extra <= 2) { }"}],[447,{"text":"if $$service{'disabled'}"}],[464,{"text":"if ($has_user eq 'both')"}],[470,{"text":"if $what eq $has_user"}],[497,{"text":"if (@objects) { }"}],[496,{"text":"if ($is_coupling) { }"}],[515,{"text":"if ($$service{'sub_owner'})"}],[530,{"text":"if $$service{'visible'}"}],[548,{"text":"if $$network{'disabled'}"}],[551,{"text":"unless my $owner = $$host{'owner'}"}],[552,{"text":"if ($owner ne $net_owner)"}],[562,{"text":"if $$network{'disabled'}"}],[564,{"text":"if (my $hash = $$network{'part_owners'})"}],[567,{"text":"if (my $net_owner = $$network{'owner'})"}],[574,{"text":"if ($owner ne $obj_owner)"}],[590,{"text":"if $$network{'disabled'}"}],[591,{"text":"if (my $hash = $$network{'part_owners'})"}],[596,{"text":"if (my $hash = $$zone{'part_owners'})"}],[604,{"text":"unless $$obj{'is_aggregate'}"}],[600,{"text":"if (my $hash = $$obj{'part_owners'})"}],[616,{"text":"if ($$owner{'show_all'})"}],[636,{"text":"if $$network{'disabled'}"}],[656,{"text":"unless (@nat_domains)"}],[698,{"text":"if (my $sub = $$network{'networks'})"}],[702,{"text":"@sub_networks ? :"}],[713,{"text":"if $$net{'disabled'}"}],[714,{"text":"if $$net{'ip'} eq 'tunnel'"}],[716,{"text":"if $$net{'loopback'}"}],[727,{"text":"if $o"}],[725,{"text":"if ($net_owner ne $owner)"}],[723,{"text":"unless ($own_zone)"}],[749,{"text":"if $$zone{'disabled'}"}],[750,{"text":"if $$zone{'loopback'}"}],[758,{"text":"unless @{$$zone{'networks'};}"}],[762,{"text":"$any ? :"}],[788,{"text":"if ($master_owner)"}],[814,{"text":"if $$service{'disabled'}"}],[815,{"text":"if ($master_owner)"}],[829,{"text":"unless ($owner2type2shash{$owner}{'owner'}{$service})"}],[837,{"text":"if ($$service{'visible'} and $owner =~ /^$$service{'visible'}/)"}],[834,{"text":"unless ($owner2type2shash{$owner}{'owner'}{$service} or $owner2type2shash{$owner}{'user'}{$service})"}],[845,{"text":"unless @$exported_owners"}],[850,{"text":"if ($$service{'sub_owner'})"}],[887,{"text":"if $type eq 'visible'"}],[895,{"text":"if ($uowner and $uowner eq $owner or grep {$_ eq $owner;} part_owners_for_object($user) or grep {$_ eq $owner;} extended_owners_for_object($user))"}],[889,{"text":"if ($type eq 'owner') { }"}],[889,{"text":"elsif ($type eq 'user') { }"}],[922,{"text":"if (is_interface($obj) and $$obj{'loopback'})"}],[925,{"text":"unless is_network($obj)"}],[928,{"text":"if (my $cluster = $$zone{'zone_cluster'})"}],[927,{"text":"if ($$obj{'is_aggregate'})"}],[936,{"text":"$any ? :"}],[939,{"text":"$is_supernet ? :"}],[993,{"text":"unless (grep {$_ eq $m_owner;} @$extended)"}],[991,{"text":"if ($master_owner and $name ne $master_owner)"}],[1023,{"text":"if (my $alias = $$owner{'alias'})"}],[1034,{"text":"unless system(\"cp -pf $policy_file $out_dir\") == 0"}],[1032,{"text":"if (-f $policy_file)"}]],"start":{"414":{"find_visibility":[{"subroutine":28,"pod":null,"branch":51,"statement":231,"condition":8,"time":null}]},"967":{"export_owners":[{"subroutine":41,"pod":null,"branch":107,"condition":25,"statement":512,"time":null}]},"63":{"create_dirs":[{"branch":3,"pod":null,"subroutine":10,"time":null,"condition":null,"statement":58}]},"710":{"__ANON__":[{"branch":90,"pod":null,"subroutine":36,"time":null,"statement":428,"condition":16}]},"33":{"BEGIN":[{"branch":3,"pod":null,"subroutine":6,"time":null,"statement":50,"condition":null}]},"28":{"BEGIN":[{"branch":3,"pod":null,"subroutine":1,"time":null,"condition":null,"statement":35}]},"53":{"abort":[{"subroutine":8,"pod":null,"branch":3,"statement":54,"condition":null,"time":null}]},"810":{"export_services":[{"branch":90,"pod":null,"subroutine":38,"time":null,"statement":428,"condition":16}]},"921":{"zone_and_subnet":[{"time":null,"statement":495,"condition":24,"pod":null,"branch":101,"subroutine":39}]},"89":{"by_name":[{"time":null,"statement":74,"condition":null,"branch":7,"pod":null,"subroutine":12}]},"633":{"export_no_nat_set":[{"time":null,"condition":12,"statement":337,"pod":null,"branch":75,"subroutine":33}]},"242":{"setup_zones":[{"pod":null,"branch":28,"subroutine":18,"time":null,"condition":2,"statement":130}]},"32":{"BEGIN":[{"statement":47,"condition":null,"time":null,"subroutine":5,"branch":3,"pod":null}]},"58":{"internal_err":[{"time":null,"statement":56,"condition":null,"pod":null,"branch":3,"subroutine":9}]},"27":{"BEGIN":[{"subroutine":null,"pod":null,"branch":3,"condition":null,"statement":32,"time":null}]},"110":{"__ANON__":[{"branch":28,"pod":null,"subroutine":15,"time":null,"condition":2,"statement":130}]},"180":{"__ANON__":[{"subroutine":17,"pod":null,"branch":28,"condition":2,"statement":130,"time":null}]},"706":{"export_assets":[{"time":null,"condition":14,"statement":373,"branch":79,"pod":null,"subroutine":35}]},"94":{"nat":[{"branch":7,"pod":null,"subroutine":13,"time":null,"statement":75,"condition":null}]},"321":{"expand_auto_intf":[{"pod":null,"branch":35,"subroutine":25,"time":null,"statement":177,"condition":2}]},"445":{"setup_service_info":[{"time":null,"condition":9,"statement":246,"branch":55,"pod":null,"subroutine":29}]},"99":{"ip_nat_for_object":[{"subroutine":14,"pod":null,"branch":7,"condition":null,"statement":77,"time":null}]},"268":{"part_owners_for_object":[{"time":null,"statement":143,"condition":2,"pod":null,"branch":31,"subroutine":20}]},"743":{"__ANON__":[{"statement":428,"condition":16,"time":null,"subroutine":37,"branch":90,"pod":null}]},"288":{"owners_for_objects":[{"subroutine":22,"branch":34,"pod":null,"statement":159,"condition":2,"time":null}]},"1032":{"copy_policy_file":[{"condition":27,"statement":555,"time":null,"subroutine":42,"branch":110,"pod":null}]},"36":{"usage":[{"subroutine":7,"pod":null,"branch":3,"condition":null,"statement":53,"time":null}]},"541":{"setup_part_owners":[{"condition":10,"statement":290,"time":null,"subroutine":30,"pod":null,"branch":62}]},"29":{"BEGIN":[{"subroutine":2,"branch":3,"pod":null,"condition":null,"statement":38,"time":null}]},"615":{"find_master_owner":[{"time":null,"statement":330,"condition":12,"branch":74,"pod":null,"subroutine":32}]},"30":{"BEGIN":[{"time":null,"statement":41,"condition":null,"pod":null,"branch":3,"subroutine":3}]},"571":{"__ANON__":[{"condition":12,"statement":330,"time":null,"subroutine":31,"pod":null,"branch":74}]},"299":{"part_owners_for_objects":[{"subroutine":23,"branch":35,"pod":null,"statement":165,"condition":2,"time":null}]},"81":{"export":[{"subroutine":11,"pod":null,"branch":5,"condition":null,"statement":68,"time":null}]},"143":{"__ANON__":[{"time":null,"condition":2,"statement":130,"pod":null,"branch":28,"subroutine":16}]},"943":{"export_objects":[{"subroutine":40,"pod":null,"branch":107,"statement":507,"condition":25,"time":null}]},"-1":{"__COVER__":[{"branch":112,"pod":null,"subroutine":43,"time":null,"statement":559,"condition":27}]},"342":{"proto_descr":[{"time":null,"condition":2,"statement":188,"branch":37,"pod":null,"subroutine":26}]},"276":{"extended_owners_for_object":[{"branch":32,"pod":null,"subroutine":21,"time":null,"condition":2,"statement":149}]},"31":{"BEGIN":[{"time":null,"statement":44,"condition":null,"branch":3,"pod":null,"subroutine":4}]},"310":{"extended_owners_for_objects":[{"pod":null,"branch":35,"subroutine":24,"time":null,"condition":2,"statement":171}]},"695":{"add_subnetworks":[{"statement":366,"condition":14,"time":null,"subroutine":34,"branch":77,"pod":null}]},"259":{"owner_for_object":[{"subroutine":19,"branch":30,"pod":null,"statement":138,"condition":2,"time":null}]},"350":{"__ANON__":[{"condition":8,"statement":231,"time":null,"subroutine":27,"branch":51,"pod":null}]}},"file":"bin/export-netspoc","condition":[[111,{"left":"$$obj{'is_aggregate'}","type":"and_3","right":"$$obj{'mask'} == 0","op":"and"}],[145,{"left":"$$obj{'nat'}","type":"and_3","right":"my $ip = $$obj{'nat'}{$nat_tag}","op":"and"}],[348,{"op":"or","right":"$ptype eq 'udp'","left":"$ptype eq 'tcp'","type":"or_3"}],[352,{"type":"and_3","left":"$v1 == 1","right":"$v2 == 65535","op":"and"}],[363,{"type":"and_3","left":"$src_range","right":"&$port_code($src_range)","op":"&&"}],[389,{"left":"$key eq 'src'","type":"or_3","right":"$key eq 'dst'","op":"or"}],[399,{"right":"0","op":"||=","type":"or_2","left":"$num"}],[403,{"op":"or","right":"$$a[2] <=> $$b[2]","left":"$$a[1] cmp $$b[1]","type":"or_3"}],[422,{"right":"@$uowners","op":"||","left":"@$owners","type":"or_3"}],[529,{"right":"find_visibility($owners, $uowners)","op":"||=","left":"$$service{'visible'}","type":"or_3"}],[549,{"left":"$$network{'owner'}","type":"or_2","right":"''","op":"||"}],[572,{"right":"''","op":"||","left":"$$obj{'owner'}","type":"or_2"}],[648,{"right":"{}","op":"||=","left":"$owner2net{$_}","type":"or_2"}],[680,{"op":"||","right":"\\@all_nat_tags","left":"$owner2no_nat_set{$owner_name}","type":"or_2"}],[724,{"right":"''","op":"||","left":"owner_for_object($net)","type":"or_2"}],[796,{"type":"or_2","left":"$result{$_}","op":"||=","right":"{}"}],[818,{"left":"$$service{'sub_owner'}","type":"or_3","op":"||","right":"()"}],[834,{"left":"$owner2type2shash{$owner}{'owner'}{$service}","type":"or_3","right":"$owner2type2shash{$owner}{'user'}{$service}","op":"or"}],[837,{"left":"$$service{'visible'}","type":"and_3","right":"$owner =~ /^$$service{'visible'}/","op":"and"}],[876,{"left":"$owner2type2shash{$_}","type":"or_2","right":"{}","op":"||="}],[878,{"left":"$owner2type2shash{$owner}","type":"or_2","right":"{}","op":"||"}],[895,{"left":"$uowner","type":"and_3","right":"$uowner eq $owner","op":"and"}],[895,{"op":"or","right":"grep {$_ eq $owner;} part_owners_for_object($user)","type":"or_3","left":"$uowner and $uowner eq $owner"}],[895,{"right":"grep {$_ eq $owner;} extended_owners_for_object($user)","op":"or","left":"$uowner and $uowner eq $owner or grep {$_ eq $owner;} part_owners_for_object($user)","type":"or_3"}],[922,{"right":"$$obj{'loopback'}","op":"and","type":"and_3","left":"is_interface($obj)"}],[987,{"left":"$$owner{'extended_by'}","type":"or_2","op":"||","right":"[]"}],[991,{"left":"$master_owner","type":"and_3","op":"and","right":"$name ne $master_owner"}]],"statement":[38,41,42,43,46,50,239,612,1043,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1065,1066,1067,1068,1069,1070,1071,1072,27,27,27,28,28,28,29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,36,53,54,58,59,63,64,65,66,67,68,69,70,73,77,81,82,83,84,85,86,89,94,95,99,100,107,108,132,110,111,112,115,121,127,130,133,134,135,136,137,168,143,144,145,148,151,156,161,162,162,165,169,170,171,172,173,174,216,180,181,182,185,188,193,202,205,210,214,217,218,219,220,221,222,227,229,242,243,244,245,246,247,249,251,259,260,261,262,264,268,269,270,270,270,272,276,277,278,279,280,281,281,284,284,284,288,289,290,291,292,295,299,300,301,302,303,306,310,311,312,313,314,317,321,322,323,324,325,327,328,329,330,336,338,342,343,344,345,346,347,348,361,350,351,351,352,353,356,359,362,363,364,365,366,369,370,374,375,376,379,381,384,385,386,387,388,389,390,390,391,395,399,400,406,403,403,410,414,415,416,416,417,417,418,418,419,419,422,431,432,436,438,445,446,447,448,450,454,457,459,459,460,461,464,465,466,468,470,473,471,478,482,484,488,496,497,498,501,503,504,507,511,514,515,516,517,519,520,521,523,524,525,526,529,530,532,541,547,548,549,550,550,551,552,553,561,562,563,564,565,567,568,579,571,572,573,574,575,580,581,582,583,585,589,590,591,592,595,596,597,599,599,600,604,605,609,615,616,617,618,619,620,623,633,634,635,636,637,643,646,648,649,650,651,651,652,653,655,656,660,661,672,672,672,675,676,678,679,680,681,682,684,695,696,697,698,699,699,702,706,707,737,710,711,712,713,714,715,716,717,720,720,720,723,724,725,727,726,727,732,733,733,734,736,746,743,744,744,748,749,750,753,753,754,758,758,761,762,764,765,769,774,779,779,777,783,788,789,796,797,798,799,800,802,810,811,813,814,815,816,818,818,819,820,823,825,825,825,826,829,830,833,834,837,838,844,845,846,850,851,867,864,859,863,863,864,860,868,869,871,873,876,877,878,879,881,882,882,883,884,885,886,887,888,889,890,890,893,893,894,895,895,896,901,905,905,906,909,910,911,913,921,922,923,925,926,927,928,932,935,936,937,939,943,945,944,958,959,967,968,969,970,971,973,974,975,975,976,977,979,979,982,983,987,991,992,993,993,994,997,1000,1000,1000,1001,1003,1004,1008,1007,1010,1009,1012,1011,1016,1018,1020,1021,1022,1023,1024,1027,1028,1032,1033,1034,1037],"digest":"7b92e58a520426a17930b58c9e7158b1"}