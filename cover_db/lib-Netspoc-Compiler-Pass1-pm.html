<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.17
Devel::Cover is copyright 2001-2012, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: lib/Netspoc/Compiler/Pass1.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">lib/Netspoc/Compiler/Pass1.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c1">82.7%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package Netspoc::Compiler::Pass1;</td></tr>
<tr><td class="h">2</td><td colspan="7"></td></tr><tr><td class="h">3 - 27</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

Netspoc - A Network Security Policy Compiler

=head1 COPYRIGHT AND DISCLAIMER

(c) 2015 by Heinz Knutzen &lt;heinz.knutzen@googlemail.com&gt;

http://hknutzen.github.com/Netspoc

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp;&nbsp;See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

=cut</pre></td></tr>
<tr><td class="h">28</td><td colspan="7"></td></tr><tr><td class="h">29</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L29">144</a></div></td><td></td><td><div>4422920</div><div>205</div><div>3375</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">30</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L30">144</a></div></td><td></td><td><div>551</div><div>132</div><div>2839</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">31</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L31">144</a></div></td><td></td><td><div>523</div><div>203</div><div>11493</div></td><td class="s">use JSON;</td></tr>
<tr><td class="h">32</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L32">144</a></div></td><td></td><td><div>14096</div><div>174</div><div>5920</div></td><td class="s">use Netspoc::Compiler::GetArgs qw(get_args);</td></tr>
<tr><td class="h">33</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L33">144</a></div></td><td></td><td><div>11355</div><div>174</div><div>18204</div></td><td class="s">use Netspoc::Compiler::Common;</td></tr>
<tr><td class="h">34</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L34">144</a></div></td><td></td><td><div>574</div><div>141</div><div>439</div></td><td class="s">use open qw(:std :utf8);</td></tr>
<tr><td class="h">35</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L35">144</a></div></td><td></td><td><div>10450</div><div>157</div><div>11484</div></td><td class="s">use Encode;</td></tr>
<tr><td class="h">36</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $filename_encode = &#39;UTF-8&#39;;</td></tr>
<tr><td class="h">37</td><td colspan="7"></td></tr><tr><td class="h">38</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># VERSION: inserted by DZP::OurPkgVersion</td></tr>
<tr><td class="h">39</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $program = &#39;Netspoc&#39;;</td></tr>
<tr><td class="h">40</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $version = __PACKAGE__-&gt;VERSION || &#39;devel&#39;;</td></tr>
<tr><td class="h">41</td><td colspan="7"></td></tr><tr><td class="h">42</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L42">144</a></div></td><td></td><td><div>566</div><div>144</div><div>3400011</div></td><td class="s">use Exporter;</td></tr>
<tr><td class="h">43</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our @ISA&nbsp;&nbsp;&nbsp;&nbsp;= qw(Exporter);</td></tr>
<tr><td class="h">44</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our @EXPORT = qw(</td></tr>
<tr><td class="h">45</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%routers</td></tr>
<tr><td class="h">46</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%interfaces</td></tr>
<tr><td class="h">47</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%networks</td></tr>
<tr><td class="h">48</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%hosts</td></tr>
<tr><td class="h">49</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%aggregates</td></tr>
<tr><td class="h">50</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%owners</td></tr>
<tr><td class="h">51</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%areas</td></tr>
<tr><td class="h">52</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%pathrestrictions</td></tr>
<tr><td class="h">53</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%groups</td></tr>
<tr><td class="h">54</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%protocols</td></tr>
<tr><td class="h">55</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%protocolgroups</td></tr>
<tr><td class="h">56</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%services</td></tr>
<tr><td class="h">57</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%isakmp</td></tr>
<tr><td class="h">58</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%ipsec</td></tr>
<tr><td class="h">59</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%crypto</td></tr>
<tr><td class="h">60</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%global_type</td></tr>
<tr><td class="h">61</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;%expanded_rules</td></tr>
<tr><td class="h">62</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;@pathrestrictions</td></tr>
<tr><td class="h">63</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;*input</td></tr>
<tr><td class="h">64</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;$current_file</td></tr>
<tr><td class="h">65</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;$line</td></tr>
<tr><td class="h">66</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;$error_counter</td></tr>
<tr><td class="h">67</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;store_description</td></tr>
<tr><td class="h">68</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;fast_mode</td></tr>
<tr><td class="h">69</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;init_global_vars</td></tr>
<tr><td class="h">70</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;abort_on_error</td></tr>
<tr><td class="h">71</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;set_abort_immediately</td></tr>
<tr><td class="h">72</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;syntax_err</td></tr>
<tr><td class="h">73</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;internal_err</td></tr>
<tr><td class="h">74</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">75</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;fatal_err</td></tr>
<tr><td class="h">76</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;unique</td></tr>
<tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;equal</td></tr>
<tr><td class="h">78</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;read_ip</td></tr>
<tr><td class="h">79</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;print_ip</td></tr>
<tr><td class="h">80</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;mask2prefix</td></tr>
<tr><td class="h">81</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;complement_32bit</td></tr>
<tr><td class="h">82</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;show_version</td></tr>
<tr><td class="h">83</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;split_typed_name</td></tr>
<tr><td class="h">84</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;skip_space_and_comment</td></tr>
<tr><td class="h">85</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;check</td></tr>
<tr><td class="h">86</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;skip</td></tr>
<tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;check_typed_name</td></tr>
<tr><td class="h">88</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;read_intersection</td></tr>
<tr><td class="h">89</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_network</td></tr>
<tr><td class="h">90</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_router</td></tr>
<tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_interface</td></tr>
<tr><td class="h">92</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_host</td></tr>
<tr><td class="h">93</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_subnet</td></tr>
<tr><td class="h">94</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_every</td></tr>
<tr><td class="h">95</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_group</td></tr>
<tr><td class="h">96</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_protocolgroup</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_objectgroup</td></tr>
<tr><td class="h">98</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_chain</td></tr>
<tr><td class="h">99</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;is_autointerface</td></tr>
<tr><td class="h">100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;get_intf</td></tr>
<tr><td class="h">101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;read_netspoc</td></tr>
<tr><td class="h">102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;read_file</td></tr>
<tr><td class="h">103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;read_file_or_dir</td></tr>
<tr><td class="h">104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;show_read_statistics</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;order_protocols</td></tr>
<tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;link_topology</td></tr>
<tr><td class="h">107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;mark_disabled</td></tr>
<tr><td class="h">108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;set_zone</td></tr>
<tr><td class="h">109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;set_service_owner</td></tr>
<tr><td class="h">110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;link_reroute_permit</td></tr>
<tr><td class="h">111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;expand_protocols</td></tr>
<tr><td class="h">112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;expand_group</td></tr>
<tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;expand_group_in_rule</td></tr>
<tr><td class="h">114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;expand_services</td></tr>
<tr><td class="h">115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;expand_crypto</td></tr>
<tr><td class="h">116</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;check_unused_groups</td></tr>
<tr><td class="h">117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;setpath</td></tr>
<tr><td class="h">118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;find_subnets_in_zone</td></tr>
<tr><td class="h">119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;find_subnets_in_nat_domain</td></tr>
<tr><td class="h">120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;convert_hosts</td></tr>
<tr><td class="h">121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;propagate_owners</td></tr>
<tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;find_dists_and_loops</td></tr>
<tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;process_loops</td></tr>
<tr><td class="h">124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;check_pathrestrictions</td></tr>
<tr><td class="h">125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;optimize_pathrestrictions</td></tr>
<tr><td class="h">126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;single_path_walk</td></tr>
<tr><td class="h">127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;path_auto_interfaces</td></tr>
<tr><td class="h">128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;check_supernet_rules</td></tr>
<tr><td class="h">129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;optimize_and_warn_deleted</td></tr>
<tr><td class="h">130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;distribute_nat_info</td></tr>
<tr><td class="h">131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;get_nat_network</td></tr>
<tr><td class="h">132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;gen_reverse_rules</td></tr>
<tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;mark_secondary_rules</td></tr>
<tr><td class="h">134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;rules_distribution</td></tr>
<tr><td class="h">135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;local_optimization</td></tr>
<tr><td class="h">136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;check_output_dir</td></tr>
<tr><td class="h">137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;address</td></tr>
<tr><td class="h">138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;print_code</td></tr>
<tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">140</td><td colspan="7"></td></tr><tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Modified only by sub store_description.</td></tr>
<tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $new_store_description;</td></tr>
<tr><td class="h">143</td><td colspan="7"></td></tr><tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub store_description {</td></tr>
<tr><td class="h">145</td><td><div class="c3">26</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L145">26</a></div></td><td><div class="c0">0</div></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($set) = @_;</td></tr>
<tr><td class="h">146</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L146">100</a></div></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined $set) {</td></tr>
<tr><td class="h">147</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($new_store_description = $set);</td></tr>
<tr><td class="h">148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">150</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $new_store_description;</td></tr>
<tr><td class="h">151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">153</td><td colspan="7"></td></tr><tr><td class="h">154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $fast_mode;</td></tr>
<tr><td class="h">155</td><td colspan="7"></td></tr><tr><td class="h">156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub fast_mode {</td></tr>
<tr><td class="h">157</td><td><div class="c3">1624</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L157">1624</a></div></td><td><div class="c0">0</div></td><td><div>1628</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($set) = @_;</td></tr>
<tr><td class="h">158</td><td><div class="c3">1624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L158">100</a></div></td><td></td><td></td><td></td><td><div>2285</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined $set) {</td></tr>
<tr><td class="h">159</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>839</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($fast_mode = $set);</td></tr>
<tr><td class="h">160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">162</td><td><div class="c3">954</div></td><td></td><td></td><td></td><td></td><td><div>2130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $fast_mode;</td></tr>
<tr><td class="h">163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">165</td><td colspan="7"></td></tr><tr><td class="h">166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Use non-local function exit for efficiency.</td></tr>
<tr><td class="h">167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Perl profiler doesn&#39;t work if this is active.</td></tr>
<tr><td class="h">168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $use_nonlocal_exit =&gt; 1;</td></tr>
<tr><td class="h">169</td><td colspan="7"></td></tr><tr><td class="h">170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Attributes of supported router models</td></tr>
<tr><td class="h">172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %router_info = (</td></tr>
<tr><td class="h">174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;IOS =&gt; {</td></tr>
<tr><td class="h">175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;IOS&#39;,</td></tr>
<tr><td class="h">176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;IOS&#39;,</td></tr>
<tr><td class="h">177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_self&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_icmp&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inversed_acl_mask =&gt; 1,</td></tr>
<tr><td class="h">181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_vrf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_log_deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_modifiers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { &#39;log-input&#39; =&gt; &#39;:subst&#39; },</td></tr>
<tr><td class="h">184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_out_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need_protect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crypto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;IOS&#39;,</td></tr>
<tr><td class="h">187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_interface&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;!&#39;,</td></tr>
<tr><td class="h">189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extension&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {</td></tr>
<tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EZVPN =&gt; { crypto&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;EZVPN&#39; },</td></tr>
<tr><td class="h">191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FW&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { stateless =&gt; 0 },</td></tr>
<tr><td class="h">192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;NX-OS&#39; =&gt; {</td></tr>
<tr><td class="h">195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;NX-OS&#39;,</td></tr>
<tr><td class="h">196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;NX-OS&#39;,</td></tr>
<tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_self&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_icmp&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_objectgroup&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inversed_acl_mask =&gt; 1,</td></tr>
<tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_vrf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_log_deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_modifiers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_out_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need_protect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_interface&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;!&#39;,</td></tr>
<tr><td class="h">210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;ACE&#39; =&gt; {</td></tr>
<tr><td class="h">212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;IOS&#39;,</td></tr>
<tr><td class="h">213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;ACE&#39;,</td></tr>
<tr><td class="h">214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_self&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_icmp&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_objectgroup&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inversed_acl_mask =&gt; 0,</td></tr>
<tr><td class="h">219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use_prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_vrf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_log_deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">222</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_modifiers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_vip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_out_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need_protect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_interface&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">227</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;!&#39;,</td></tr>
<tr><td class="h">228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;PIX =&gt; {</td></tr>
<tr><td class="h">230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;PIX&#39;,</td></tr>
<tr><td class="h">231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;PIX&#39;,</td></tr>
<tr><td class="h">232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_icmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_objectgroup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;!&#39;,</td></tr>
<tr><td class="h">235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_interface_level =&gt; 1,</td></tr>
<tr><td class="h">236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need_identity_nat&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_filter_icmp_code =&gt; 1,</td></tr>
<tr><td class="h">238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">240</td><td colspan="7"></td></tr><tr><td class="h">241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Like PIX, but without identity NAT.</td></tr>
<tr><td class="h">242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASA =&gt; {</td></tr>
<tr><td class="h">243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;PIX&#39;,</td></tr>
<tr><td class="h">244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;PIX&#39;,</td></tr>
<tr><td class="h">245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_modifiers =&gt; {</td></tr>
<tr><td class="h">246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emergencies&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alerts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;critical&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 2,</td></tr>
<tr><td class="h">249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 3,</td></tr>
<tr><td class="h">250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnings&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 4,</td></tr>
<tr><td class="h">251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notifications =&gt; 5,</td></tr>
<tr><td class="h">252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;informational =&gt; 6,</td></tr>
<tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debugging&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 7,</td></tr>
<tr><td class="h">254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;disable&#39;,</td></tr>
<tr><td class="h">255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_icmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_out_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_objectgroup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_dyn_crypto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crypto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;ASA&#39;,</td></tr>
<tr><td class="h">261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_crypto_filter&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;!&#39;,</td></tr>
<tr><td class="h">263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_filter_icmp_code =&gt; 1,</td></tr>
<tr><td class="h">264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;need_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extension&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {</td></tr>
<tr><td class="h">266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VPN =&gt; {</td></tr>
<tr><td class="h">267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crypto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;ASA_VPN&#39;,</td></tr>
<tr><td class="h">268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless_tunnel =&gt; 1,</td></tr>
<tr><td class="h">269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_auth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EZVPN =&gt; { crypto =&gt; &#39;ASA_EZVPN&#39; },</td></tr>
<tr><td class="h">272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Linux =&gt; {</td></tr>
<tr><td class="h">275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;iproute&#39;,</td></tr>
<tr><td class="h">276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;iptables&#39;,</td></tr>
<tr><td class="h">277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_io_acl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;#&#39;,</td></tr>
<tr><td class="h">279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can_managed_host =&gt; 1,</td></tr>
<tr><td class="h">280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">for my $model (keys %router_info) {</td></tr>
<tr><td class="h">283</td><td colspan="7"></td></tr><tr><td class="h">284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Is changed for model with extension. Used in error messages.</td></tr>
<tr><td class="h">285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router_info{$model}-&gt;{name} = $model;</td></tr>
<tr><td class="h">286</td><td colspan="7"></td></tr><tr><td class="h">287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Is left unchanged with extensions. Used in header of generated files.</td></tr>
<tr><td class="h">288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router_info{$model}-&gt;{class} = $model;</td></tr>
<tr><td class="h">289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">290</td><td colspan="7"></td></tr><tr><td class="h">291</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Use this if src or dst port isn&#39;t defined.</td></tr>
<tr><td class="h">292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Don&#39;t allocate memory again and again.</td></tr>
<tr><td class="h">293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $aref_tcp_any = [ 1, 65535 ];</td></tr>
<tr><td class="h">294</td><td colspan="7"></td></tr><tr><td class="h">295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Definition of dynamic routing protocols.</td></tr>
<tr><td class="h">296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Protocols get {up} relation in order_protocols.</td></tr>
<tr><td class="h">297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %routing_info;</td></tr>
<tr><td class="h">298</td><td colspan="7"></td></tr><tr><td class="h">299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Definition of redundancy protocols.</td></tr>
<tr><td class="h">300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Protocols get {up} relation in order_protocols.</td></tr>
<tr><td class="h">301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %xxrp_info;</td></tr>
<tr><td class="h">302</td><td colspan="7"></td></tr><tr><td class="h">303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">## no critic (RequireArgUnpacking)</td></tr>
<tr><td class="h">304</td><td colspan="7"></td></tr><tr><td class="h">305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># All arguments are &#39;eq&#39;.</td></tr>
<tr><td class="h">306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub equal {</td></tr>
<tr><td class="h">307</td><td><div class="c3">134</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L307">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L307">134</a></div></td><td><div class="c0">0</div></td><td><div>262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if not @_;</td></tr>
<tr><td class="h">308</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $first = shift;</td></tr>
<tr><td class="h">309</td><td><div class="c3">114</div><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>133</div><div>449</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return not grep { $_ ne $first } @_;</td></tr>
<tr><td class="h">310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">311</td><td colspan="7"></td></tr><tr><td class="h">312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Unique union of all elements.</td></tr>
<tr><td class="h">313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Preserves original order.</td></tr>
<tr><td class="h">314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub unique {</td></tr>
<tr><td class="h">315</td><td><div class="c3">3722</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L315">3722</a></div></td><td><div class="c0">0</div></td><td><div>5060</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">316</td><td><div class="c3">3722</div><div class="c3">4640</div></td><td></td><td></td><td></td><td></td><td><div>5093</div><div>16285</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return grep { !$seen{$_}++ } @_;</td></tr>
<tr><td class="h">317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">318</td><td colspan="7"></td></tr><tr><td class="h">319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_duplicates {</td></tr>
<tr><td class="h">320</td><td><div class="c3">134</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L320">134</a></div></td><td><div class="c0">0</div></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %dupl;</td></tr>
<tr><td class="h">321</td><td><div class="c3">134</div></td><td></td><td></td><td></td><td></td><td><div>373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$dupl{$_}++ for @_;</td></tr>
<tr><td class="h">322</td><td><div class="c3">134</div><div class="c3">154</div></td><td></td><td></td><td></td><td></td><td><div>238</div><div>599</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return grep { $dupl{$_} &gt; 1 } keys %dupl;</td></tr>
<tr><td class="h">323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">324</td><td colspan="7"></td></tr><tr><td class="h">325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub intersect {</td></tr>
<tr><td class="h">326</td><td><div class="c3">26</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L326">26</a></div></td><td><div class="c0">0</div></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aref1, $aref2) = @_;</td></tr>
<tr><td class="h">327</td><td><div class="c3">26</div><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>30</div><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen = map { $_ =&gt; 1 } @$aref1;</td></tr>
<tr><td class="h">328</td><td><div class="c3">26</div><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>33</div><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return grep { $seen{$_} } @$aref2;</td></tr>
<tr><td class="h">329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">330</td><td colspan="7"></td></tr><tr><td class="h">331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub max {</td></tr>
<tr><td class="h">332</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L332">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $max = shift(@_);</td></tr>
<tr><td class="h">333</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $el (@_) {</td></tr>
<tr><td class="h">334</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L334">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max = $el if $max &lt; $el;</td></tr>
<tr><td class="h">335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">336</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $max;</td></tr>
<tr><td class="h">337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">338</td><td colspan="7"></td></tr><tr><td class="h">339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Delete an element from an array reference.</td></tr>
<tr><td class="h">340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Return 1 if found, undef otherwise.</td></tr>
<tr><td class="h">341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub aref_delete {</td></tr>
<tr><td class="h">342</td><td><div class="c3">342</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L342">342</a></div></td><td><div class="c0">0</div></td><td><div>321</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aref, $elt) = @_;</td></tr>
<tr><td class="h">343</td><td><div class="c3">342</div></td><td></td><td></td><td></td><td></td><td><div>598</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for (my $i = 0 ; $i &lt; @$aref ; $i++) {</td></tr>
<tr><td class="h">344</td><td><div class="c3">421</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L344">100</a></div></td><td></td><td></td><td></td><td><div>928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($aref-&gt;[$i] eq $elt) {</td></tr>
<tr><td class="h">345</td><td><div class="c3">342</div></td><td></td><td></td><td></td><td></td><td><div>369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice @$aref, $i, 1;</td></tr>
<tr><td class="h">346</td><td colspan="7"></td></tr><tr><td class="h">347</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#debug(&quot;aref_delete: $elt-&gt;{name}&quot;);</td></tr>
<tr><td class="h">348</td><td><div class="c3">342</div></td><td></td><td></td><td></td><td></td><td><div>612</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">353</td><td colspan="7"></td></tr><tr><td class="h">354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Compare two array references element wise.</td></tr>
<tr><td class="h">355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub aref_eq {</td></tr>
<tr><td class="h">356</td><td><div class="c3">3497</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L356">3497</a></div></td><td><div class="c0">0</div></td><td><div>3166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($a1, $a2) = @_;</td></tr>
<tr><td class="h">357</td><td><div class="c3">3497</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L357">100</a></div></td><td></td><td></td><td></td><td><div>6607</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@$a1 == @$a2 or return;</td></tr>
<tr><td class="h">358</td><td><div class="c3">2971</div></td><td></td><td></td><td></td><td></td><td><div>4968</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for (my $i = 0 ; $i &lt; @$a1 ; $i++) {</td></tr>
<tr><td class="h">359</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L359">100</a></div></td><td></td><td></td><td></td><td><div>206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $a1-&gt;[$i] ne $a2-&gt;[$i];</td></tr>
<tr><td class="h">360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">361</td><td><div class="c3">2933</div></td><td></td><td></td><td></td><td></td><td><div>4707</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">363</td><td colspan="7"></td></tr><tr><td class="h">364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub keys_eq {</td></tr>
<tr><td class="h">365</td><td><div class="c3">72</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L365">72</a></div></td><td><div class="c0">0</div></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($href1, $href2) = @_;</td></tr>
<tr><td class="h">366</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L366">100</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;keys %$href1 == keys %$href2 or return;</td></tr>
<tr><td class="h">367</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$href1) {</td></tr>
<tr><td class="h">368</td><td><div class="c3">55</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L368">100</a></div></td><td></td><td></td><td></td><td><div>149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exists $href2-&gt;{$key} or return;</td></tr>
<tr><td class="h">369</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">370</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">372</td><td colspan="7"></td></tr><tr><td class="h">373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warn_msg {</td></tr>
<tr><td class="h">374</td><td><div class="c3">150</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L374">150</a></div></td><td><div class="c0">0</div></td><td><div>3083</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print STDERR &quot;Warning: &quot;, @_, &quot;\n&quot;;</td></tr>
<tr><td class="h">375</td><td><div class="c3">150</div></td><td></td><td></td><td></td><td></td><td><div>340</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">377</td><td colspan="7"></td></tr><tr><td class="h">378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">## use critic</td></tr>
<tr><td class="h">379</td><td colspan="7"></td></tr><tr><td class="h">380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Name of current input file.</td></tr>
<tr><td class="h">381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $current_file;</td></tr>
<tr><td class="h">382</td><td colspan="7"></td></tr><tr><td class="h">383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Rules and objects read from directories and files with</td></tr>
<tr><td class="h">384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># special name &#39;xxx.private&#39; are marked with attribute {private} = &#39;xxx&#39;.</td></tr>
<tr><td class="h">385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This variable is used to propagate the value from directories to its</td></tr>
<tr><td class="h">386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># files and sub-directories.</td></tr>
<tr><td class="h">387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $private;</td></tr>
<tr><td class="h">388</td><td colspan="7"></td></tr><tr><td class="h">389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Content of current file.</td></tr>
<tr><td class="h">390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $input;</td></tr>
<tr><td class="h">391</td><td colspan="7"></td></tr><tr><td class="h">392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Current line number of input file.</td></tr>
<tr><td class="h">393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $line;</td></tr>
<tr><td class="h">394</td><td colspan="7"></td></tr><tr><td class="h">395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub context {</td></tr>
<tr><td class="h">396</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L396">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $context;</td></tr>
<tr><td class="h">397</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L397">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (pos $input == length $input) {</td></tr>
<tr><td class="h">398</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$context = &#39;at EOF&#39;;</td></tr>
<tr><td class="h">399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">401</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($pre, $post) =</td></tr>
<tr><td class="h">402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/([^ \t\n,;={}]*[,;={} \t]*)\G([,;={} \t]*[^ \t\n,;={}]*)/;</td></tr>
<tr><td class="h">403</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$context = qq/near &quot;$pre&lt;--HERE--&gt;$post&quot;/;</td></tr>
<tr><td class="h">404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">405</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return qq/ at line $line of $current_file, $context\n/;</td></tr>
<tr><td class="h">406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">407</td><td colspan="7"></td></tr><tr><td class="h">408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub at_line {</td></tr>
<tr><td class="h">409</td><td><div class="c3">24</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L409">24</a></div></td><td><div class="c0">0</div></td><td><div>577</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return qq/ at line $line of $current_file\n/;</td></tr>
<tr><td class="h">410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">411</td><td colspan="7"></td></tr><tr><td class="h">412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $error_counter;</td></tr>
<tr><td class="h">413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $abort_immediately;</td></tr>
<tr><td class="h">414</td><td colspan="7"></td></tr><tr><td class="h">415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_abort {</td></tr>
<tr><td class="h">416</td><td><div class="c3">254</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L416">254</a></div></td><td><div class="c0">0</div></td><td><div>218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$error_counter++;</td></tr>
<tr><td class="h">417</td><td><div class="c3">254</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L417">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L417">50</a></div></td><td></td><td></td><td></td><td><div>747</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($error_counter == $config-&gt;{max_errors}) {</td></tr>
<tr><td class="h">418</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Aborted after $error_counter errors\n&quot;;</td></tr>
<tr><td class="h">419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($abort_immediately) {</td></tr>
<tr><td class="h">421</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Aborted\n&quot;;</td></tr>
<tr><td class="h">422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">424</td><td colspan="7"></td></tr><tr><td class="h">425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub abort_on_error {</td></tr>
<tr><td class="h">426</td><td><div class="c3">1178</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L426">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L426">1178</a></div></td><td><div class="c0">0</div></td><td><div>2798</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Aborted with $error_counter error(s)\n&quot; if $error_counter;</td></tr>
<tr><td class="h">427</td><td><div class="c3">986</div></td><td></td><td></td><td></td><td></td><td><div>845</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">429</td><td colspan="7"></td></tr><tr><td class="h">430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_abort_immediately {</td></tr>
<tr><td class="h">431</td><td><div class="c3">468</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L431">468</a></div></td><td><div class="c0">0</div></td><td><div>435</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$abort_immediately = 1;</td></tr>
<tr><td class="h">432</td><td><div class="c3">468</div></td><td></td><td></td><td></td><td></td><td><div>398</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">433</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">434</td><td colspan="7"></td></tr><tr><td class="h">435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub error_atline {</td></tr>
<tr><td class="h">436</td><td><div class="c3">24</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L436">24</a></div></td><td><div class="c0">0</div></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my (@args) = @_;</td></tr>
<tr><td class="h">437</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print STDERR &quot;Error: &quot;, @args, at_line();</td></tr>
<tr><td class="h">438</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_abort();</td></tr>
<tr><td class="h">439</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">441</td><td colspan="7"></td></tr><tr><td class="h">442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub err_msg {</td></tr>
<tr><td class="h">443</td><td><div class="c3">230</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L443">230</a></div></td><td><div class="c0">0</div></td><td><div>384</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my (@args) = @_;</td></tr>
<tr><td class="h">444</td><td><div class="c3">230</div></td><td></td><td></td><td></td><td></td><td><div>5847</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print STDERR &quot;Error: &quot;, @args, &quot;\n&quot;;</td></tr>
<tr><td class="h">445</td><td><div class="c3">230</div></td><td></td><td></td><td></td><td></td><td><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_abort();</td></tr>
<tr><td class="h">446</td><td><div class="c3">230</div></td><td></td><td></td><td></td><td></td><td><div>514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">448</td><td colspan="7"></td></tr><tr><td class="h">449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub syntax_err {</td></tr>
<tr><td class="h">450</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L450">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my (@args) = @_;</td></tr>
<tr><td class="h">451</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Syntax error: &quot;, @args, context();</td></tr>
<tr><td class="h">452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">453</td><td colspan="7"></td></tr><tr><td class="h">454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub internal_err {</td></tr>
<tr><td class="h">455</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L455">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my (@args) = @_;</td></tr>
<tr><td class="h">456</td><td colspan="7"></td></tr><tr><td class="h">457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t show inherited error.</td></tr>
<tr><td class="h">458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Abort immediately, if other errors have already occured.</td></tr>
<tr><td class="h">459</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L459">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($error_counter) {</td></tr>
<tr><td class="h">460</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Aborted after $error_counter errors\n&quot;;</td></tr>
<tr><td class="h">461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">462</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my (undef, $file, $line) = caller;</td></tr>
<tr><td class="h">463</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $sub = (caller 1)[3];</td></tr>
<tr><td class="h">464</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &quot;Internal error in $sub&quot;;</td></tr>
<tr><td class="h">465</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L465">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$msg .= &quot;: @args&quot; if @args;</td></tr>
<tr><td class="h">466</td><td colspan="7"></td></tr><tr><td class="h">467</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;die &quot;$msg\n at $file line $line\n&quot;;</td></tr>
<tr><td class="h">468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">469</td><td colspan="7"></td></tr><tr><td class="h">470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Helper functions for reading configuration</td></tr>
<tr><td class="h">472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">473</td><td colspan="7"></td></tr><tr><td class="h">474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $input is used as input buffer, it holds content of current input file.</td></tr>
<tr><td class="h">475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Progressive matching is used. \G is used to match current position.</td></tr>
<tr><td class="h">476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub skip_space_and_comment {</td></tr>
<tr><td class="h">477</td><td colspan="7"></td></tr><tr><td class="h">478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore trailing white space and comments.</td></tr>
<tr><td class="h">479</td><td><div class="c3">318360</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L479">318360</a></div></td><td><div class="c0">0</div></td><td><div>809784</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ($input =~ m&#39;\G[ \t]*(?:[#].*)?(?:\n|$)&#39;gc) {</td></tr>
<tr><td class="h">480</td><td><div class="c3">25671</div></td><td></td><td></td><td></td><td></td><td><div>61812</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$line++;</td></tr>
<tr><td class="h">481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">482</td><td colspan="7"></td></tr><tr><td class="h">483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore leading white space.</td></tr>
<tr><td class="h">484</td><td><div class="c3">318360</div></td><td></td><td></td><td></td><td></td><td><div>338443</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/\G[ \t]*/gc;</td></tr>
<tr><td class="h">485</td><td><div class="c3">318360</div></td><td></td><td></td><td></td><td></td><td><div>269488</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">487</td><td colspan="7"></td></tr><tr><td class="h">488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Optimize use of CORE:regcomp. Build regex only once for each token.</td></tr>
<tr><td class="h">489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %token2regex;</td></tr>
<tr><td class="h">490</td><td colspan="7"></td></tr><tr><td class="h">491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check for a string and skip if available.</td></tr>
<tr><td class="h">492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check {</td></tr>
<tr><td class="h">493</td><td><div class="c3">272215</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L493">272215</a></div></td><td><div class="c0">0</div></td><td><div>216802</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $token = shift;</td></tr>
<tr><td class="h">494</td><td><div class="c3">272215</div></td><td></td><td></td><td></td><td></td><td><div>285560</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">495</td><td><div class="c3">272215</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L495">67</a></div></td><td></td><td></td><td><div>695157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $regex = $token2regex{$token} ||= qr/\G$token/;</td></tr>
<tr><td class="h">496</td><td><div class="c3">272215</div></td><td></td><td></td><td></td><td></td><td><div>1173543</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $input =~ /$regex/gc;</td></tr>
<tr><td class="h">497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">498</td><td colspan="7"></td></tr><tr><td class="h">499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Skip a string.</td></tr>
<tr><td class="h">500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub skip {</td></tr>
<tr><td class="h">501</td><td><div class="c3">52801</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L501">52801</a></div></td><td><div class="c0">0</div></td><td><div>45626</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $token = shift;</td></tr>
<tr><td class="h">502</td><td><div class="c3">52801</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L502">50</a></div></td><td></td><td></td><td><div>56837</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return (check $token or syntax_err(&quot;Expected &#39;$token&#39;&quot;));</td></tr>
<tr><td class="h">503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">504</td><td colspan="7"></td></tr><tr><td class="h">505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check, if an integer is available.</td></tr>
<tr><td class="h">506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_int {</td></tr>
<tr><td class="h">507</td><td><div class="c3">4449</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L507">4449</a></div></td><td><div class="c0">0</div></td><td><div>4730</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">508</td><td><div class="c3">4449</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L508">100</a></div></td><td></td><td></td><td></td><td><div>7733</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G(\d+)/gc) {</td></tr>
<tr><td class="h">509</td><td><div class="c3">4393</div></td><td></td><td></td><td></td><td></td><td><div>8854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">512</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">513</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">515</td><td colspan="7"></td></tr><tr><td class="h">516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_int {</td></tr>
<tr><td class="h">517</td><td><div class="c3">3385</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L517">3385</a></div></td><td><div class="c0">0</div></td><td><div>3735</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = check_int();</td></tr>
<tr><td class="h">518</td><td><div class="c3">3385</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L518">50</a></div></td><td></td><td></td><td></td><td><div>5528</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $result or syntax_err(&quot;Integer expected&quot;);</td></tr>
<tr><td class="h">519</td><td><div class="c3">3385</div></td><td></td><td></td><td></td><td></td><td><div>7460</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">521</td><td colspan="7"></td></tr><tr><td class="h">522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Read IP address. Internally it is stored as an integer.</td></tr>
<tr><td class="h">523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_ip {</td></tr>
<tr><td class="h">524</td><td><div class="c3">7919</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L524">7919</a></div></td><td><div class="c0">0</div></td><td><div>8344</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">525</td><td><div class="c3">7919</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L525">50</a></div></td><td></td><td></td><td></td><td><div>22980</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G(\d+)\.(\d+)\.(\d+)\.(\d+)/gc) {</td></tr>
<tr><td class="h">526</td><td><div class="c3">7919</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L526">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L526">20</a></div></td><td></td><td></td><td><div>59742</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($1 &gt; 255 or $2 &gt; 255 or $3 &gt; 255 or $4 &gt; 255) {</td></tr>
<tr><td class="h">527</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid IP address&quot;);</td></tr>
<tr><td class="h">528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">529</td><td><div class="c3">7919</div></td><td></td><td></td><td></td><td></td><td><div>24125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return unpack &#39;N&#39;, pack &#39;C4&#39;, $1, $2, $3, $4;</td></tr>
<tr><td class="h">530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">532</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">535</td><td colspan="7"></td></tr><tr><td class="h">536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_ip {</td></tr>
<tr><td class="h">537</td><td><div class="c3">7919</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L537">7919</a></div></td><td><div class="c0">0</div></td><td><div>8884</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = check_ip();</td></tr>
<tr><td class="h">538</td><td><div class="c3">7919</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L538">50</a></div></td><td></td><td></td><td></td><td><div>13053</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $result or syntax_err(&quot;IP address expected&quot;);</td></tr>
<tr><td class="h">539</td><td><div class="c3">7919</div></td><td></td><td></td><td></td><td></td><td><div>8780</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">541</td><td colspan="7"></td></tr><tr><td class="h">542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Read IP address and prefix length.</td></tr>
<tr><td class="h">543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># x.x.x.x/n</td></tr>
<tr><td class="h">544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_ip_prefix {</td></tr>
<tr><td class="h">545</td><td><div class="c3">3299</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L545">3299</a></div></td><td><div class="c0">0</div></td><td><div>3828</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip = read_ip;</td></tr>
<tr><td class="h">546</td><td><div class="c3">3299</div></td><td></td><td></td><td></td><td></td><td><div>4226</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip(&#39;/&#39;);</td></tr>
<tr><td class="h">547</td><td><div class="c3">3299</div></td><td></td><td></td><td></td><td></td><td><div>4619</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mask = prefix2mask(read_int());</td></tr>
<tr><td class="h">548</td><td><div class="c3">3299</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L548">50</a></div></td><td></td><td></td><td></td><td><div>5382</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $mask or syntax_err(&#39;Invalid prefix&#39;);</td></tr>
<tr><td class="h">549</td><td><div class="c3">3299</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L549">100</a></div></td><td></td><td></td><td></td><td><div>5065</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;match_ip($ip, $ip, $mask) or error_atline(&quot;IP and mask don&#39;t match&quot;);</td></tr>
<tr><td class="h">550</td><td colspan="7"></td></tr><tr><td class="h">551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">552</td><td><div class="c3">3299</div></td><td></td><td></td><td></td><td></td><td><div>3174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ip &amp;= $mask;</td></tr>
<tr><td class="h">553</td><td><div class="c3">3299</div></td><td></td><td></td><td></td><td></td><td><div>5386</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $ip, $mask;</td></tr>
<tr><td class="h">554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">555</td><td colspan="7"></td></tr><tr><td class="h">556</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_ip_prefix_pair {</td></tr>
<tr><td class="h">557</td><td><div class="c3">172</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L557">172</a></div></td><td><div class="c0">0</div></td><td><div>208</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = read_ip_prefix();</td></tr>
<tr><td class="h">558</td><td><div class="c3">172</div></td><td></td><td></td><td></td><td></td><td><div>287</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ $ip, $mask ];</td></tr>
<tr><td class="h">559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">560</td><td colspan="7"></td></tr><tr><td class="h">561</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub gen_ip {</td></tr>
<tr><td class="h">562</td><td><div class="c3">8832</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L562">8832</a></div></td><td><div class="c0">0</div></td><td><div>7749</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($byte1, $byte2, $byte3, $byte4) = @_;</td></tr>
<tr><td class="h">563</td><td><div class="c3">8832</div></td><td></td><td></td><td></td><td></td><td><div>17725</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unpack &#39;N&#39;, pack(&#39;C4&#39;, $byte1, $byte2, $byte3, $byte4);</td></tr>
<tr><td class="h">564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">565</td><td colspan="7"></td></tr><tr><td class="h">566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Convert IP address from internal integer representation to</td></tr>
<tr><td class="h">567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># readable string.</td></tr>
<tr><td class="h">568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_ip {</td></tr>
<tr><td class="h">569</td><td><div class="c3">7414</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L569">7414</a></div></td><td><div class="c0">0</div></td><td><div>8697</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip = shift;</td></tr>
<tr><td class="h">570</td><td><div class="c3">7414</div></td><td></td><td></td><td></td><td></td><td><div>21208</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return sprintf &quot;%vd&quot;, pack &#39;N&#39;, $ip;</td></tr>
<tr><td class="h">571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">572</td><td colspan="7"></td></tr><tr><td class="h">573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_identifier {</td></tr>
<tr><td class="h">574</td><td><div class="c3">3148</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L574">3148</a></div></td><td><div class="c0">0</div></td><td><div>3506</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">575</td><td><div class="c3">3148</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L575">50</a></div></td><td></td><td></td><td></td><td><div>6903</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/(\G[\w-]+)/gc) {</td></tr>
<tr><td class="h">576</td><td><div class="c3">3148</div></td><td></td><td></td><td></td><td></td><td><div>6271</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">579</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Identifier expected&quot;);</td></tr>
<tr><td class="h">580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">582</td><td colspan="7"></td></tr><tr><td class="h">583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Pattrern for attribute &quot;visible&quot;: &quot;*&quot; or &quot;name*&quot;.</td></tr>
<tr><td class="h">584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_owner_pattern {</td></tr>
<tr><td class="h">585</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L585">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">586</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L586">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/ ( \G [\w-]* [*] ) /gcx) {</td></tr>
<tr><td class="h">587</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">588</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">590</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Pattern &#39;*&#39; or &#39;name*&#39; expected&quot;);</td></tr>
<tr><td class="h">591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">593</td><td colspan="7"></td></tr><tr><td class="h">594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Used for reading hardware name, model, admins, watchers.</td></tr>
<tr><td class="h">595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_name {</td></tr>
<tr><td class="h">596</td><td><div class="c3">5439</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L596">5439</a></div></td><td><div class="c0">0</div></td><td><div>6167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">597</td><td><div class="c3">5439</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L597">50</a></div></td><td></td><td></td><td></td><td><div>11915</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/(\G[^;,\s&quot;&quot;&#39;&#39;]+)/gc) {</td></tr>
<tr><td class="h">598</td><td><div class="c3">5439</div></td><td></td><td></td><td></td><td></td><td><div>10900</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">601</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;String expected&quot;);</td></tr>
<tr><td class="h">602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">604</td><td colspan="7"></td></tr><tr><td class="h">605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Used for reading alias name or radius attributes.</td></tr>
<tr><td class="h">606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_string {</td></tr>
<tr><td class="h">607</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L607">70</a></div></td><td><div class="c0">0</div></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">608</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L608">50</a></div></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G([^;,&quot;&quot;&#39;&#39;\n]+)/gc) {</td></tr>
<tr><td class="h">609</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">612</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;String expected&quot;);</td></tr>
<tr><td class="h">613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">615</td><td colspan="7"></td></tr><tr><td class="h">616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Object representing &#39;user&#39;.</td></tr>
<tr><td class="h">617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This is only &#39;active&#39; while parsing src or dst of the rule of a service.</td></tr>
<tr><td class="h">618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $user_object = { active =&gt; 0, refcount =&gt; 0, elements =&gt; undef };</td></tr>
<tr><td class="h">619</td><td colspan="7"></td></tr><tr><td class="h">620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_union {</td></tr>
<tr><td class="h">621</td><td><div class="c3">2050</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L621">2050</a></div></td><td><div class="c0">0</div></td><td><div>1934</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($delimiter) = @_;</td></tr>
<tr><td class="h">622</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>1618</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @vals;</td></tr>
<tr><td class="h">623</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>1887</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $count = $user_object-&gt;{refcount};</td></tr>
<tr><td class="h">624</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>2490</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @vals, read_intersection();</td></tr>
<tr><td class="h">625</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>2724</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $has_user_ref&nbsp;&nbsp;&nbsp;= $user_object-&gt;{refcount} &gt; $count;</td></tr>
<tr><td class="h">626</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>1705</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user_ref_error = 0;</td></tr>
<tr><td class="h">627</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>1563</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">628</td><td><div class="c3">2090</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L628">100</a></div></td><td></td><td></td><td></td><td><div>2501</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check $delimiter;</td></tr>
<tr><td class="h">629</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $comma_seen = check &#39;,&#39;;</td></tr>
<tr><td class="h">630</td><td colspan="7"></td></tr><tr><td class="h">631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Allow trailing comma.</td></tr>
<tr><td class="h">632</td><td><div class="c3">40</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L632">50</a></div></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check $delimiter;</td></tr>
<tr><td class="h">633</td><td colspan="7"></td></tr><tr><td class="h">634</td><td><div class="c3">40</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L634">50</a></div></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$comma_seen or syntax_err(&quot;Comma expected in union of values&quot;);</td></tr>
<tr><td class="h">635</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count = $user_object-&gt;{refcount};</td></tr>
<tr><td class="h">636</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @vals, read_intersection();</td></tr>
<tr><td class="h">637</td><td><div class="c3">40</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L637">33</a></div></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_ref_error ||=</td></tr>
<tr><td class="h">638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_user_ref != ($user_object-&gt;{refcount} &gt; $count);</td></tr>
<tr><td class="h">639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$user_ref_error</td></tr>
<tr><td class="h">641</td><td><div class="c3">2050</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L641">50</a></div></td><td></td><td></td><td></td><td><div>3240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(</td></tr>
<tr><td class="h">642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;The sub-expressions of union equally must\n&quot;,</td></tr>
<tr><td class="h">643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; either reference &#39;user&#39; or must not reference &#39;user&#39;&quot;</td></tr>
<tr><td class="h">644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">645</td><td><div class="c3">2050</div></td><td></td><td></td><td></td><td></td><td><div>3532</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @vals;</td></tr>
<tr><td class="h">646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">647</td><td colspan="7"></td></tr><tr><td class="h">648</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check for xxx:xxx | router:xx@xx | network:xx/xx | interface:xx/xx</td></tr>
<tr><td class="h">649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_typed_name {</td></tr>
<tr><td class="h">650</td><td><div class="c3">16182</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L650">16182</a></div></td><td><div class="c0">0</div></td><td><div>17215</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">651</td><td><div class="c3">16182</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L651">100</a></div></td><td></td><td></td><td></td><td><div>46211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/ \G (\w+) : /gcx or return;</td></tr>
<tr><td class="h">652</td><td><div class="c3">11274</div></td><td></td><td></td><td></td><td></td><td><div>17432</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = $1;</td></tr>
<tr><td class="h">653</td><td><div class="c3">11274</div></td><td></td><td></td><td></td><td></td><td><div>8697</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $separator);</td></tr>
<tr><td class="h">654</td><td><div class="c3">11274</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L654">50</a></div></td><td></td><td></td><td></td><td><div>29260</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m&#39; \G ( [\w-]+ (?: ( [@/] ) [\w-]+ )? ) &#39;gcx) {</td></tr>
<tr><td class="h">655</td><td><div class="c3">11274</div></td><td></td><td></td><td></td><td></td><td><div>13578</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $1;</td></tr>
<tr><td class="h">656</td><td><div class="c3">11274</div></td><td></td><td></td><td></td><td></td><td><div>11651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$separator = $2;</td></tr>
<tr><td class="h">657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">659</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Invalid token&quot;);</td></tr>
<tr><td class="h">660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">661</td><td colspan="7"></td></tr><tr><td class="h">662</td><td><div class="c3">11274</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L662">100</a></div></td><td></td><td></td><td></td><td><div>15884</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($separator) {</td></tr>
<tr><td class="h">663</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L663">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L663">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L663">67</a></div></td><td></td><td></td><td><div>328</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;router&#39;) {</td></tr>
<tr><td class="h">664</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L664">50</a></div></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$separator eq &#39;@&#39; or syntax_err(&quot;Invalid token&quot;);</td></tr>
<tr><td class="h">665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;network&#39; or $type eq &#39;interface&#39;) {</td></tr>
<tr><td class="h">667</td><td><div class="c3">90</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L667">50</a></div></td><td></td><td></td><td></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$separator eq &#39;/&#39; or syntax_err(&quot;Invalid token&quot;);</td></tr>
<tr><td class="h">668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">670</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Invalid token&quot;);</td></tr>
<tr><td class="h">671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">673</td><td><div class="c3">11274</div></td><td></td><td></td><td></td><td></td><td><div>30825</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ $type, $name ];</td></tr>
<tr><td class="h">674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">675</td><td colspan="7"></td></tr><tr><td class="h">676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_typed_name {</td></tr>
<tr><td class="h">677</td><td><div class="c3">4984</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L677">33</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L677">4984</a></div></td><td><div class="c0">0</div></td><td><div>5483</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return check_typed_name || syntax_err(&quot;Typed name expected&quot;);</td></tr>
<tr><td class="h">678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">679</td><td colspan="7"></td></tr><tr><td class="h">680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">681</td><td colspan="7"></td></tr><tr><td class="h">682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# user@domain or @domain</td></tr>
<tr><td class="h">683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $domain_regex&nbsp;&nbsp;&nbsp;= qr/(?:[\w-]+\.)+[\w-]+/;</td></tr>
<tr><td class="h">684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user_regex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= qr/[\w-]+(?:\.[\w-]+)*/;</td></tr>
<tr><td class="h">685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user_id_regex&nbsp;&nbsp;= qr/$user_regex[@]$domain_regex/;</td></tr>
<tr><td class="h">686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $id_regex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= qr/$user_id_regex|[@]?$domain_regex/;</td></tr>
<tr><td class="h">687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hostname_regex = qr/(?: id:$id_regex | [\w-]+ )/x;</td></tr>
<tr><td class="h">688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $network_regex&nbsp;&nbsp;= qr/(?: [\w-]+ (?: \/ [\w-]+ )? )/x;</td></tr>
<tr><td class="h">689</td><td colspan="7"></td></tr><tr><td class="h">690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check for xxx:xxx or xxx:[xxx:xxx, ...]</td></tr>
<tr><td class="h">691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:xxx.xxx</td></tr>
<tr><td class="h">692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:xxx.xxx.xxx</td></tr>
<tr><td class="h">693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:xxx.[xxx]</td></tr>
<tr><td class="h">694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:r@v. ...</td></tr>
<tr><td class="h">695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:....xxx/ppp...</td></tr>
<tr><td class="h">696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:[xxx:xxx, ...].[xxx]</td></tr>
<tr><td class="h">697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or interface:[managed &amp; xxx:xxx, ...].[xxx]</td></tr>
<tr><td class="h">698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or host:[managed &amp; xxx:xxx, ...]</td></tr>
<tr><td class="h">699</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or any:[ ip = n.n.n.n/len &amp; xxx:xxx, ...]</td></tr>
<tr><td class="h">700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or network:xxx/ppp</td></tr>
<tr><td class="h">701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or host:id:user@domain.network</td></tr>
<tr><td class="h">702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or host:id:[@]domain.network</td></tr>
<tr><td class="h">703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub read_extended_name {</td></tr>
<tr><td class="h">705</td><td colspan="7"></td></tr><tr><td class="h">706</td><td><div class="c3">3414</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L706">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L706">3414</a></div></td><td><div class="c0">0</div></td><td><div>3804</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;user&#39;) {</td></tr>
<tr><td class="h">707</td><td colspan="7"></td></tr><tr><td class="h">708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Global variable for linking occurrences of &#39;user&#39;.</td></tr>
<tr><td class="h">709</td><td><div class="c3">936</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L709">50</a></div></td><td></td><td></td><td></td><td><div>1649</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_object-&gt;{active}</td></tr>
<tr><td class="h">710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Unexpected reference to &#39;user&#39;&quot;);</td></tr>
<tr><td class="h">711</td><td><div class="c3">936</div></td><td></td><td></td><td></td><td></td><td><div>872</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_object-&gt;{refcount}++;</td></tr>
<tr><td class="h">712</td><td><div class="c3">936</div></td><td></td><td></td><td></td><td></td><td><div>2027</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ &#39;user&#39;, $user_object ];</td></tr>
<tr><td class="h">713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">714</td><td><div class="c3">2478</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L714">50</a></div></td><td></td><td></td><td></td><td><div>10261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/\G([\w-]+):/gc or syntax_err(&quot;Type expected&quot;);</td></tr>
<tr><td class="h">715</td><td><div class="c3">2478</div></td><td></td><td></td><td></td><td></td><td><div>3595</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $1;</td></tr>
<tr><td class="h">716</td><td><div class="c3">2478</div></td><td></td><td></td><td></td><td></td><td><div>2695</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $interface = $type eq &#39;interface&#39;;</td></tr>
<tr><td class="h">717</td><td><div class="c3">2478</div></td><td></td><td></td><td></td><td></td><td><div>1926</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name;</td></tr>
<tr><td class="h">718</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ext;</td></tr>
<tr><td class="h">719</td><td><div class="c3">2478</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L719">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L719">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L719">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L719">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L719">40</a></div></td><td></td><td></td><td><div>8860</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/ \G \[ /gcox) {</td></tr>
<tr><td class="h">720</td><td><div class="c3">230</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L720">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L720">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L720">100</a></div><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L720">100</a></div></td><td></td><td></td><td><div>1350</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($interface || $type eq &#39;host&#39;) &amp;&amp; check(&#39;managed&#39;)) {</td></tr>
<tr><td class="h">721</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext = 1;</td></tr>
<tr><td class="h">722</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;&amp;&#39;;</td></tr>
<tr><td class="h">723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;any&#39; &amp;&amp; check(&#39;ip&#39;)) {</td></tr>
<tr><td class="h">725</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">726</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext = read_ip_prefix_pair();</td></tr>
<tr><td class="h">727</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;&amp;&#39;;</td></tr>
<tr><td class="h">728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">729</td><td><div class="c3">230</div></td><td></td><td></td><td></td><td></td><td><div>412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = [ read_union(&#39;]&#39;) ];</td></tr>
<tr><td class="h">730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;host&#39;) {</td></tr>
<tr><td class="h">732</td><td><div class="c3">228</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L732">50</a></div></td><td></td><td></td><td></td><td><div>11632</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/ \G ( $hostname_regex ) /gcox</td></tr>
<tr><td class="h">733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Name or ID-name expected&quot;);</td></tr>
<tr><td class="h">734</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>886</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = $1;</td></tr>
<tr><td class="h">735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;network&#39;) {</td></tr>
<tr><td class="h">737</td><td><div class="c3">1530</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L737">50</a></div></td><td></td><td></td><td></td><td><div>23636</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/ \G ( $network_regex ) /gcox</td></tr>
<tr><td class="h">738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Name or bridged name expected&quot;);</td></tr>
<tr><td class="h">739</td><td><div class="c3">1530</div></td><td></td><td></td><td></td><td></td><td><div>2607</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = $1;</td></tr>
<tr><td class="h">740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($interface &amp;&amp; $input =~ m/ \G ( [\w-]+ (?: \@ [\w-]+ ) ) /gcx</td></tr>
<tr><td class="h">742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $input =~ m/ \G ( [\w-]+ ) /gcx)</td></tr>
<tr><td class="h">743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">744</td><td><div class="c3">490</div></td><td></td><td></td><td></td><td></td><td><div>729</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = $1;</td></tr>
<tr><td class="h">745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">747</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Identifier or &#39;[&#39; expected&quot;);</td></tr>
<tr><td class="h">748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">749</td><td><div class="c3">2478</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L749">100</a></div></td><td></td><td></td><td></td><td><div>4057</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface) {</td></tr>
<tr><td class="h">750</td><td><div class="c3">422</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L750">50</a></div></td><td></td><td></td><td></td><td><div>941</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/ \G \. /gcox or syntax_err(&quot;Expected &#39;.&#39;&quot;);</td></tr>
<tr><td class="h">751</td><td><div class="c3">422</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L751">100</a></div></td><td></td><td></td><td></td><td><div>665</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/ \G \[ /gcox) {</td></tr>
<tr><td class="h">752</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $selector = read_identifier;</td></tr>
<tr><td class="h">753</td><td><div class="c3">62</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L753">50</a></div></td><td></td><td></td><td></td><td><div>228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$selector =~ /^(auto|all)$/</td></tr>
<tr><td class="h">754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Expected [auto|all]&quot;);</td></tr>
<tr><td class="h">755</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext = [ $selector, $ext ];</td></tr>
<tr><td class="h">756</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\]&#39;;</td></tr>
<tr><td class="h">757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">759</td><td><div class="c3">360</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L759">50</a></div></td><td></td><td></td><td></td><td><div>549</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext and syntax_err(&quot;Keyword &#39;managed&#39; not allowed&quot;);</td></tr>
<tr><td class="h">760</td><td><div class="c3">360</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L760">50</a></div></td><td></td><td></td><td></td><td><div>11946</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/ \G ( $network_regex ) /gcox</td></tr>
<tr><td class="h">761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Name or bridged name expected&quot;);</td></tr>
<tr><td class="h">762</td><td><div class="c3">360</div></td><td></td><td></td><td></td><td></td><td><div>723</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext = $1;</td></tr>
<tr><td class="h">763</td><td colspan="7"></td></tr><tr><td class="h">764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ID of secondary interface.</td></tr>
<tr><td class="h">765</td><td><div class="c3">360</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L765">100</a></div></td><td></td><td></td><td></td><td><div>764</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/ \G \. /gcox) {</td></tr>
<tr><td class="h">766</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext .= &#39;.&#39; . read_identifier;</td></tr>
<tr><td class="h">767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">770</td><td><div class="c3">2478</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L770">100</a></div></td><td></td><td></td><td></td><td><div>7921</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $ext ? [ $type, $name, $ext ] : [ $type, $name ];</td></tr>
<tr><td class="h">771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">772</td><td colspan="7"></td></tr><tr><td class="h">773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># user@domain</td></tr>
<tr><td class="h">774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub read_user_id {</td></tr>
<tr><td class="h">775</td><td><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L775">21</a></div></td><td><div class="c0">0</div></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">776</td><td><div class="c3">21</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L776">50</a></div></td><td></td><td></td><td></td><td><div>924</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G($user_id_regex)/gco) {</td></tr>
<tr><td class="h">777</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">778</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">780</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Id expected (&#39;user\@domain&#39; or &#39;user&#39;)&quot;);</td></tr>
<tr><td class="h">781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">783</td><td colspan="7"></td></tr><tr><td class="h">784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># host:xxx or host:id:user@domain or host:id:[@]domain</td></tr>
<tr><td class="h">785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub check_hostname {</td></tr>
<tr><td class="h">786</td><td><div class="c3">733</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L786">733</a></div></td><td><div class="c0">0</div></td><td><div>905</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">787</td><td><div class="c3">733</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L787">100</a></div></td><td></td><td></td><td></td><td><div>1578</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G host:/gcx) {</td></tr>
<tr><td class="h">788</td><td><div class="c3">473</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L788">50</a></div></td><td></td><td></td><td></td><td><div>26992</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G($hostname_regex)/gco) {</td></tr>
<tr><td class="h">789</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>1391</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">792</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&#39;Hostname expected&#39;);</td></tr>
<tr><td class="h">793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">796</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">800</td><td colspan="7"></td></tr><tr><td class="h">801</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_complement {</td></tr>
<tr><td class="h">802</td><td><div class="c3">3414</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L802">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L802">3414</a></div></td><td><div class="c0">0</div></td><td><div>4170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;!&#39;) {</td></tr>
<tr><td class="h">803</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ &#39;!&#39;, read_extended_name() ];</td></tr>
<tr><td class="h">804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">806</td><td><div class="c3">3400</div></td><td></td><td></td><td></td><td></td><td><div>5325</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return read_extended_name();</td></tr>
<tr><td class="h">807</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">809</td><td colspan="7"></td></tr><tr><td class="h">810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_intersection {</td></tr>
<tr><td class="h">811</td><td><div class="c3">3398</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L811">3398</a></div></td><td><div class="c0">0</div></td><td><div>3969</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result = read_complement();</td></tr>
<tr><td class="h">812</td><td><div class="c3">3398</div></td><td></td><td></td><td></td><td></td><td><div>6177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (check &#39;&amp;&#39;) {</td></tr>
<tr><td class="h">813</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, read_complement();</td></tr>
<tr><td class="h">814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">815</td><td><div class="c3">3398</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L815">100</a></div></td><td></td><td></td><td></td><td><div>5237</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@result == 1) {</td></tr>
<tr><td class="h">816</td><td><div class="c3">3382</div></td><td></td><td></td><td></td><td></td><td><div>5291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $result[0];</td></tr>
<tr><td class="h">817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">819</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ &#39;&amp;&#39;, \@result ];</td></tr>
<tr><td class="h">820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">822</td><td colspan="7"></td></tr><tr><td class="h">823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Setup standard time units with different names and plural forms.</td></tr>
<tr><td class="h">824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %timeunits = (sec =&gt; 1, min =&gt; 60, hour =&gt; 3600, day =&gt; 86400,);</td></tr>
<tr><td class="h">825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$timeunits{second} = $timeunits{sec};</td></tr>
<tr><td class="h">826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$timeunits{minute} = $timeunits{min};</td></tr>
<tr><td class="h">827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">for my $key (keys %timeunits) {</td></tr>
<tr><td class="h">828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$timeunits{&quot;${key}s&quot;} = $timeunits{$key};</td></tr>
<tr><td class="h">829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">830</td><td colspan="7"></td></tr><tr><td class="h">831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Read time value in different units, return seconds.</td></tr>
<tr><td class="h">832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_time_val {</td></tr>
<tr><td class="h">833</td><td><div class="c3">86</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L833">86</a></div></td><td><div class="c0">0</div></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $int&nbsp;&nbsp;&nbsp;&nbsp;= read_int();</td></tr>
<tr><td class="h">834</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $unit&nbsp;&nbsp;&nbsp;= read_identifier();</td></tr>
<tr><td class="h">835</td><td><div class="c3">86</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L835">50</a></div></td><td></td><td></td><td></td><td><div>189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $factor = $timeunits{$unit} or syntax_err(&quot;Invalid time unit&quot;);</td></tr>
<tr><td class="h">836</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>151</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $int * $factor;</td></tr>
<tr><td class="h">837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">838</td><td colspan="7"></td></tr><tr><td class="h">839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_description {</td></tr>
<tr><td class="h">840</td><td><div class="c3">10697</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L840">10697</a></div></td><td><div class="c0">0</div></td><td><div>9803</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">841</td><td><div class="c3">10697</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L841">100</a></div></td><td></td><td></td><td></td><td><div>11566</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check &#39;description&#39; or return;</td></tr>
<tr><td class="h">842</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">843</td><td colspan="7"></td></tr><tr><td class="h">844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Read up to end of line, but ignore &#39;;&#39; at EOL.</td></tr>
<tr><td class="h">845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# We must use &#39;$&#39; here to match EOL,</td></tr>
<tr><td class="h">846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# otherwise $line would be out of sync.</td></tr>
<tr><td class="h">847</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$input =~ m/\G[ \t]*(.*?)[ \t]*;?[ \t]*$/gcm;</td></tr>
<tr><td class="h">848</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L848">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (store_description()) {</td></tr>
<tr><td class="h">849</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{description} = $1;</td></tr>
<tr><td class="h">850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">851</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">853</td><td colspan="7"></td></tr><tr><td class="h">854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check if one of the keywords &#39;permit&#39; or &#39;deny&#39; is available.</td></tr>
<tr><td class="h">855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_permit_deny {</td></tr>
<tr><td class="h">856</td><td><div class="c3">910</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L856">910</a></div></td><td><div class="c0">0</div></td><td><div>1048</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment();</td></tr>
<tr><td class="h">857</td><td><div class="c3">910</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L857">50</a></div></td><td></td><td></td><td></td><td><div>2224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G(permit|deny)/gc) {</td></tr>
<tr><td class="h">858</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>2278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">861</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">864</td><td colspan="7"></td></tr><tr><td class="h">865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_nat_name {</td></tr>
<tr><td class="h">866</td><td><div class="c3">284</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L866">284</a></div></td><td><div class="c0">0</div></td><td><div>334</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip_space_and_comment;</td></tr>
<tr><td class="h">867</td><td><div class="c3">284</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L867">50</a></div></td><td></td><td></td><td></td><td><div>916</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($input =~ m/\G nat:([\w-]+)/gcx) {</td></tr>
<tr><td class="h">868</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">871</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">874</td><td colspan="7"></td></tr><tr><td class="h">875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub split_typed_name {</td></tr>
<tr><td class="h">876</td><td><div class="c3">433</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L876">433</a></div></td><td><div class="c0">0</div></td><td><div>475</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">877</td><td colspan="7"></td></tr><tr><td class="h">878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Split at first colon; the name may contain further colons.</td></tr>
<tr><td class="h">879</td><td><div class="c3">433</div></td><td></td><td></td><td></td><td></td><td><div>1332</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return split /[:]/, $name, 2;</td></tr>
<tr><td class="h">880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">881</td><td colspan="7"></td></tr><tr><td class="h">882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_flag {</td></tr>
<tr><td class="h">883</td><td><div class="c3">47901</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L883">47901</a></div></td><td><div class="c0">0</div></td><td><div>39516</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $token = shift;</td></tr>
<tr><td class="h">884</td><td><div class="c3">47901</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L884">100</a></div></td><td></td><td></td><td></td><td><div>49937</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check $token) {</td></tr>
<tr><td class="h">885</td><td><div class="c3">494</div></td><td></td><td></td><td></td><td></td><td><div>684</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip(&#39;;&#39;);</td></tr>
<tr><td class="h">886</td><td><div class="c3">494</div></td><td></td><td></td><td></td><td></td><td><div>969</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">889</td><td><div class="c3">47407</div></td><td></td><td></td><td></td><td></td><td><div>87981</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">892</td><td colspan="7"></td></tr><tr><td class="h">893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_assign {</td></tr>
<tr><td class="h">894</td><td><div class="c3">41616</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L894">41616</a></div></td><td><div class="c0">0</div></td><td><div>39214</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($token, $fun) = @_;</td></tr>
<tr><td class="h">895</td><td><div class="c3">41616</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L895">100</a></div></td><td></td><td></td><td></td><td><div>43779</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check($token)) {</td></tr>
<tr><td class="h">896</td><td><div class="c3">8141</div></td><td></td><td></td><td></td><td></td><td><div>10324</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">897</td><td><div class="c3">8141</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L897">100</a></div></td><td></td><td></td><td></td><td><div>11778</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (wantarray) {</td></tr>
<tr><td class="h">898</td><td><div class="c3">3127</div></td><td></td><td></td><td></td><td></td><td><div>3719</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @val = &amp;$fun;</td></tr>
<tr><td class="h">899</td><td><div class="c3">3127</div></td><td></td><td></td><td></td><td></td><td><div>3785</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip(&#39;;&#39;);</td></tr>
<tr><td class="h">900</td><td><div class="c3">3127</div></td><td></td><td></td><td></td><td></td><td><div>8409</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @val;</td></tr>
<tr><td class="h">901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">903</td><td><div class="c3">5014</div></td><td></td><td></td><td></td><td></td><td><div>5773</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val = &amp;$fun;</td></tr>
<tr><td class="h">904</td><td><div class="c3">5014</div></td><td></td><td></td><td></td><td></td><td><div>6763</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip(&#39;;&#39;);</td></tr>
<tr><td class="h">905</td><td><div class="c3">5014</div></td><td></td><td></td><td></td><td></td><td><div>11602</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $val;</td></tr>
<tr><td class="h">906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">908</td><td><div class="c3">33475</div></td><td></td><td></td><td></td><td></td><td><div>78904</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">909</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">910</td><td colspan="7"></td></tr><tr><td class="h">911</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_list {</td></tr>
<tr><td class="h">912</td><td><div class="c3">7878</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L912">7878</a></div></td><td><div class="c0">0</div></td><td><div>7036</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($fun) = @_;</td></tr>
<tr><td class="h">913</td><td><div class="c3">7878</div></td><td></td><td></td><td></td><td></td><td><div>6042</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @vals;</td></tr>
<tr><td class="h">914</td><td><div class="c3">7878</div></td><td></td><td></td><td></td><td></td><td><div>5956</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">915</td><td><div class="c3">8518</div></td><td></td><td></td><td></td><td></td><td><div>9690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @vals, &amp;$fun;</td></tr>
<tr><td class="h">916</td><td><div class="c3">8518</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L916">100</a></div></td><td></td><td></td><td></td><td><div>10927</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check(&#39;;&#39;);</td></tr>
<tr><td class="h">917</td><td><div class="c3">698</div></td><td></td><td></td><td></td><td></td><td><div>998</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $comma_seen = check &#39;,&#39;;</td></tr>
<tr><td class="h">918</td><td colspan="7"></td></tr><tr><td class="h">919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Allow trailing comma.</td></tr>
<tr><td class="h">920</td><td><div class="c3">698</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L920">100</a></div></td><td></td><td></td><td></td><td><div>1036</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check(&#39;;&#39;);</td></tr>
<tr><td class="h">921</td><td colspan="7"></td></tr><tr><td class="h">922</td><td><div class="c3">640</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L922">50</a></div></td><td></td><td></td><td></td><td><div>1074</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$comma_seen or syntax_err(&quot;Comma expected in list of values&quot;);</td></tr>
<tr><td class="h">923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">924</td><td><div class="c3">7878</div></td><td></td><td></td><td></td><td></td><td><div>21054</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @vals;</td></tr>
<tr><td class="h">925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">926</td><td colspan="7"></td></tr><tr><td class="h">927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_list_or_null {</td></tr>
<tr><td class="h">928</td><td><div class="c3">22</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L928">22</a></div></td><td><div class="c0">0</div></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($fun) = @_;</td></tr>
<tr><td class="h">929</td><td><div class="c3">22</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L929">50</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return () if check(&#39;;&#39;);</td></tr>
<tr><td class="h">930</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return read_list($fun);</td></tr>
<tr><td class="h">931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">932</td><td colspan="7"></td></tr><tr><td class="h">933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_assign_list {</td></tr>
<tr><td class="h">934</td><td><div class="c3">910</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L934">910</a></div></td><td><div class="c0">0</div></td><td><div>959</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($token, $fun) = @_;</td></tr>
<tr><td class="h">935</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>1088</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip $token;</td></tr>
<tr><td class="h">936</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>1308</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">937</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>1369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return read_list($fun);</td></tr>
<tr><td class="h">938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">939</td><td colspan="7"></td></tr><tr><td class="h">940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_assign_list {</td></tr>
<tr><td class="h">941</td><td><div class="c3">34998</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L941">34998</a></div></td><td><div class="c0">0</div></td><td><div>33238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($token, $fun) = @_;</td></tr>
<tr><td class="h">942</td><td><div class="c3">34998</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L942">100</a></div></td><td></td><td></td><td></td><td><div>36938</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check $token) {</td></tr>
<tr><td class="h">943</td><td><div class="c3">6064</div></td><td></td><td></td><td></td><td></td><td><div>7465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">944</td><td><div class="c3">6064</div></td><td></td><td></td><td></td><td></td><td><div>8862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &amp;read_list($fun);</td></tr>
<tr><td class="h">945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">946</td><td><div class="c3">28934</div></td><td></td><td></td><td></td><td></td><td><div>71511</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ();</td></tr>
<tr><td class="h">947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">948</td><td colspan="7"></td></tr><tr><td class="h">949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_assign_pair {</td></tr>
<tr><td class="h">950</td><td><div class="c3">210</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L950">210</a></div></td><td><div class="c0">0</div></td><td><div>237</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($token, $delimiter, $fun) = @_;</td></tr>
<tr><td class="h">951</td><td><div class="c3">210</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L951">100</a></div></td><td></td><td></td><td></td><td><div>244</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check $token) {</td></tr>
<tr><td class="h">952</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">953</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v1 = &amp;$fun;</td></tr>
<tr><td class="h">954</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip $delimiter;</td></tr>
<tr><td class="h">955</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v2 = &amp;$fun;</td></tr>
<tr><td class="h">956</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip(&#39;;&#39;);</td></tr>
<tr><td class="h">957</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $v1, $v2;</td></tr>
<tr><td class="h">958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">959</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>411</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ();</td></tr>
<tr><td class="h">960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">961</td><td colspan="7"></td></tr><tr><td class="h">962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Creation of typed structures</td></tr>
<tr><td class="h">964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Currently we don&#39;t use OO features;</td></tr>
<tr><td class="h">965</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># We use &#39;bless&#39; only to give each structure a distinct type.</td></tr>
<tr><td class="h">966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">967</td><td colspan="7"></td></tr><tr><td class="h">968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Create a new structure of given type;</td></tr>
<tr><td class="h">969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># initialize it with key / value pairs.</td></tr>
<tr><td class="h">970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">971</td><td><div class="c3">19478</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L971">19478</a></div></td><td><div class="c0">0</div></td><td><div>32236</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($type, @pairs) = @_;</td></tr>
<tr><td class="h">972</td><td><div class="c3">19478</div></td><td></td><td></td><td></td><td></td><td><div>33140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = {@pairs};</td></tr>
<tr><td class="h">973</td><td><div class="c3">19478</div></td><td></td><td></td><td></td><td></td><td><div>53135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return bless $self, $type;</td></tr>
<tr><td class="h">974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">975</td><td colspan="7"></td></tr><tr><td class="h">976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_attribute {</td></tr>
<tr><td class="h">977</td><td><div class="c3">17593</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L977">17593</a></div></td><td><div class="c0">0</div></td><td><div>18819</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $key, $value) = @_;</td></tr>
<tr><td class="h">978</td><td><div class="c3">17593</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L978">50</a></div></td><td></td><td></td><td></td><td><div>29200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $obj-&gt;{$key} and error_atline(&quot;Duplicate attribute &#39;$key&#39;&quot;);</td></tr>
<tr><td class="h">979</td><td><div class="c3">17593</div></td><td></td><td></td><td></td><td></td><td><div>20995</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{$key} = $value;</td></tr>
<tr><td class="h">980</td><td><div class="c3">17593</div></td><td></td><td></td><td></td><td></td><td><div>24150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">982</td><td colspan="7"></td></tr><tr><td class="h">983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %hosts;</td></tr>
<tr><td class="h">984</td><td colspan="7"></td></tr><tr><td class="h">985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_radius_attributes {</td></tr>
<tr><td class="h">986</td><td><div class="c3">5359</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L986">5359</a></div></td><td><div class="c0">0</div></td><td><div>5184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = {};</td></tr>
<tr><td class="h">987</td><td><div class="c3">5359</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L987">100</a></div></td><td></td><td></td><td></td><td><div>6330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check &#39;radius_attributes&#39; or return;</td></tr>
<tr><td class="h">988</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">989</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">990</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">991</td><td><div class="c3">110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L991">100</a></div></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">992</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = read_identifier();</td></tr>
<tr><td class="h">993</td><td><div class="c3">64</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L993">50</a></div></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val = check(&#39;=&#39;) ? read_string : undef;</td></tr>
<tr><td class="h">994</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;;&#39;;</td></tr>
<tr><td class="h">995</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($result, $key =&gt; $val);</td></tr>
<tr><td class="h">996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">997</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">998</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">999</td><td colspan="7"></td></tr><tr><td class="h">1000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_routing {</td></tr>
<tr><td class="h">1001</td><td><div class="c3">4914</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1001">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1001">4914</a></div></td><td><div class="c0">0</div></td><td><div>6752</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $protocol = check_assign(&#39;routing&#39;, \&amp;read_identifier) or return;</td></tr>
<tr><td class="h">1002</td><td><div class="c3">306</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1002">50</a></div></td><td></td><td></td><td></td><td><div>790</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $routing = $routing_info{$protocol}</td></tr>
<tr><td class="h">1003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&#39;Unknown routing protocol&#39;);</td></tr>
<tr><td class="h">1004</td><td><div class="c3">306</div></td><td></td><td></td><td></td><td></td><td><div>551</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $routing;</td></tr>
<tr><td class="h">1005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1006</td><td colspan="7"></td></tr><tr><td class="h">1007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_managed {</td></tr>
<tr><td class="h">1008</td><td><div class="c3">7998</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1008">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1008">7998</a></div></td><td><div class="c0">0</div></td><td><div>8652</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check(&#39;managed&#39;) or return;</td></tr>
<tr><td class="h">1009</td><td><div class="c3">1463</div></td><td></td><td></td><td></td><td></td><td><div>1430</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $managed;</td></tr>
<tr><td class="h">1010</td><td><div class="c3">1463</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1010">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1010">50</a></div></td><td></td><td></td><td></td><td><div>1802</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;;&#39;) {</td></tr>
<tr><td class="h">1011</td><td><div class="c3">1318</div></td><td></td><td></td><td></td><td></td><td><div>1401</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$managed = &#39;standard&#39;;</td></tr>
<tr><td class="h">1012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (check &#39;=&#39;) {</td></tr>
<tr><td class="h">1014</td><td><div class="c3">145</div></td><td></td><td></td><td></td><td></td><td><div>207</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = read_identifier;</td></tr>
<tr><td class="h">1015</td><td><div class="c3">145</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1015">50</a></div></td><td></td><td></td><td></td><td><div>479</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">1016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value =~ /^(?:secondary|standard|full|primary|</td></tr>
<tr><td class="h">1017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local|local_secondary|routing_only)$/x</td></tr>
<tr><td class="h">1018</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">1019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">1020</td><td><div class="c3">145</div></td><td></td><td></td><td></td><td></td><td><div>151</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$managed = $value;</td></tr>
<tr><td class="h">1021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1023</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(</td></tr>
<tr><td class="h">1024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Expected value:&quot;,</td></tr>
<tr><td class="h">1025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; secondary|standard|full|primary&quot;,</td></tr>
<tr><td class="h">1026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;|local|local_secondary|routing_only&quot;</td></tr>
<tr><td class="h">1027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1029</td><td><div class="c3">145</div></td><td></td><td></td><td></td><td></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check &#39;;&#39;;</td></tr>
<tr><td class="h">1030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1032</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected &#39;;&#39; or &#39;=&#39;&quot;);</td></tr>
<tr><td class="h">1033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1034</td><td><div class="c3">1463</div></td><td></td><td></td><td></td><td></td><td><div>2625</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $managed;</td></tr>
<tr><td class="h">1035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1036</td><td colspan="7"></td></tr><tr><td class="h">1037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_model {</td></tr>
<tr><td class="h">1038</td><td><div class="c3">6473</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1038">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1038">6473</a></div></td><td><div class="c0">0</div></td><td><div>8631</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($model, @attributes) = check_assign_list(&#39;model&#39;, \&amp;read_name)</td></tr>
<tr><td class="h">1039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or return;</td></tr>
<tr><td class="h">1040</td><td><div class="c3">1487</div></td><td></td><td></td><td></td><td></td><td><div>2204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $info = $router_info{$model};</td></tr>
<tr><td class="h">1041</td><td><div class="c3">1487</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1041">100</a></div></td><td></td><td></td><td></td><td><div>2233</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $info) {</td></tr>
<tr><td class="h">1042</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Unknown router model&quot;);</td></tr>
<tr><td class="h">1043</td><td colspan="7"></td></tr><tr><td class="h">1044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">1045</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return { name =&gt; $model };</td></tr>
<tr><td class="h">1046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1047</td><td><div class="c3">1485</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1047">100</a></div></td><td></td><td></td><td><div>2937</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $extension_info = $info-&gt;{extension} || {};</td></tr>
<tr><td class="h">1048</td><td colspan="7"></td></tr><tr><td class="h">1049</td><td><div class="c3">224</div></td><td></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @ext_list = map {</td></tr>
<tr><td class="h">1050</td><td><div class="c3">1485</div></td><td></td><td></td><td></td><td></td><td><div>2025</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ext = $extension_info-&gt;{$_};</td></tr>
<tr><td class="h">1051</td><td><div class="c3">224</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1051">100</a></div></td><td></td><td></td><td></td><td><div>393</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext or error_atline(&quot;Unknown extension $_&quot;);</td></tr>
<tr><td class="h">1052</td><td><div class="c3">224</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1052">100</a></div></td><td></td><td></td><td></td><td><div>804</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext ? %$ext : ();</td></tr>
<tr><td class="h">1053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} @attributes;</td></tr>
<tr><td class="h">1054</td><td><div class="c3">1485</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1054">100</a></div></td><td></td><td></td><td></td><td><div>2599</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@ext_list) {</td></tr>
<tr><td class="h">1055</td><td><div class="c3">220</div></td><td></td><td></td><td></td><td></td><td><div>1843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info = { %$info, @ext_list };</td></tr>
<tr><td class="h">1056</td><td><div class="c3">220</div></td><td></td><td></td><td></td><td></td><td><div>453</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $info-&gt;{extension};</td></tr>
<tr><td class="h">1057</td><td><div class="c3">220</div></td><td></td><td></td><td></td><td></td><td><div>582</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info-&gt;{name} = join(&#39;, &#39;, $model, sort @attributes);</td></tr>
<tr><td class="h">1058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1059</td><td><div class="c3">1485</div></td><td></td><td></td><td></td><td></td><td><div>3027</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $info;</td></tr>
<tr><td class="h">1060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1061</td><td colspan="7"></td></tr><tr><td class="h">1062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @managed_routers;</td></tr>
<tr><td class="h">1063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @router_fragments;</td></tr>
<tr><td class="h">1064</td><td colspan="7"></td></tr><tr><td class="h">1065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Managed host is stored internally as an interface.</td></tr>
<tr><td class="h">1066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># The interface gets an artificial router.</td></tr>
<tr><td class="h">1067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Both, router and interface get name &quot;host:xx&quot;.</td></tr>
<tr><td class="h">1068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub host_as_interface {</td></tr>
<tr><td class="h">1069</td><td><div class="c3">40</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1069">40</a></div></td><td><div class="c0">0</div></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($host)&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">1070</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;&nbsp;= $host-&gt;{name};</td></tr>
<tr><td class="h">1071</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;= delete $host-&gt;{model};</td></tr>
<tr><td class="h">1072</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hw_name = delete $host-&gt;{hardware};</td></tr>
<tr><td class="h">1073</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1073">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1073">50</a></div></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$model) {</td></tr>
<tr><td class="h">1074</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Missing &#39;model&#39; for managed $host-&gt;{name}&quot;);</td></tr>
<tr><td class="h">1075</td><td colspan="7"></td></tr><tr><td class="h">1076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">1077</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$model = $host-&gt;{model} = { name =&gt; &#39;unknown&#39; };</td></tr>
<tr><td class="h">1078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (!$model-&gt;{can_managed_host}) {</td></tr>
<tr><td class="h">1080</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Must not use model $model-&gt;{name} at managed $name&quot;);</td></tr>
<tr><td class="h">1081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1082</td><td><div class="c3">40</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1082">50</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$hw_name) {</td></tr>
<tr><td class="h">1083</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Missing &#39;hardware&#39; for $name&quot;);</td></tr>
<tr><td class="h">1084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1085</td><td colspan="7"></td></tr><tr><td class="h">1086</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use device_name with &quot;host:..&quot; prefix to prevent name clash with</td></tr>
<tr><td class="h">1087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# real routers.</td></tr>
<tr><td class="h">1088</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1088">100</a></div></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $device_name =</td></tr>
<tr><td class="h">1089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{server_name} ? &quot;host:$host-&gt;{server_name}&quot; : $name;</td></tr>
<tr><td class="h">1090</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = new(&#39;Router&#39;, name =&gt; $name, device_name =&gt; $device_name);</td></tr>
<tr><td class="h">1091</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed} = delete $host-&gt;{managed};</td></tr>
<tr><td class="h">1092</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{model}&nbsp;&nbsp;&nbsp;= $model;</td></tr>
<tr><td class="h">1093</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $interface = new(&#39;Interface&#39;, %$host);</td></tr>
<tr><td class="h">1094</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{router} = $router;</td></tr>
<tr><td class="h">1095</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hardware = { name =&gt; $hw_name, interfaces =&gt; [$interface] };</td></tr>
<tr><td class="h">1096</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hardware}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $hardware;</td></tr>
<tr><td class="h">1097</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{routing}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $routing_info{manual};</td></tr>
<tr><td class="h">1098</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{is_managed_host} = 1;</td></tr>
<tr><td class="h">1099</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{interfaces}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [$interface];</td></tr>
<tr><td class="h">1100</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{hardware}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [$hardware];</td></tr>
<tr><td class="h">1101</td><td colspan="7"></td></tr><tr><td class="h">1102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t add to %routers</td></tr>
<tr><td class="h">1103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - Name lookup isn&#39;t needed.</td></tr>
<tr><td class="h">1104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - Linking with network isn&#39;t needed.</td></tr>
<tr><td class="h">1105</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @managed_routers, $router;</td></tr>
<tr><td class="h">1106</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $interface;</td></tr>
<tr><td class="h">1107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1108</td><td colspan="7"></td></tr><tr><td class="h">1109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_host {</td></tr>
<tr><td class="h">1110</td><td><div class="c3">473</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1110">473</a></div></td><td><div class="c0">0</div></td><td><div>577</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $network_name) = @_;</td></tr>
<tr><td class="h">1111</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>631</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $host = new(&#39;Host&#39;);</td></tr>
<tr><td class="h">1112</td><td><div class="c3">473</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1112">50</a></div></td><td></td><td></td><td></td><td><div>824</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">1113</td><td><div class="c3">473</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1113">100</a></div></td><td></td><td></td><td></td><td><div>1145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my ($id) = ($name =~ /^host:id:(.*)$/)) {</td></tr>
<tr><td class="h">1114</td><td colspan="7"></td></tr><tr><td class="h">1115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make ID unique by appending name of enclosing network.</td></tr>
<tr><td class="h">1116</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = &quot;$name.$network_name&quot;;</td></tr>
<tr><td class="h">1117</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{id} = $id;</td></tr>
<tr><td class="h">1118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1119</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>710</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{name} = $name;</td></tr>
<tr><td class="h">1120</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>613</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1121</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>703</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1122</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>1612</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($host);</td></tr>
<tr><td class="h">1123</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>460</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1124</td><td><div class="c3">1110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1124">100</a></div></td><td></td><td></td><td></td><td><div>1335</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1125</td><td><div class="c3">637</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1125">50</a></div></td><td></td><td></td><td></td><td><div>1090</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = check_assign &#39;ip&#39;, \&amp;read_ip) {</td></tr>
<tr><td class="h">1126</td><td><div class="c3">427</div></td><td></td><td></td><td></td><td></td><td><div>625</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, ip =&gt; $ip);</td></tr>
<tr><td class="h">1127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my ($ip1, $ip2) = check_assign_pair(&#39;range&#39;, &#39;-&#39;, \&amp;read_ip)) {</td></tr>
<tr><td class="h">1129</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1129">50</a></div></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ip1 &lt;= $ip2 or error_atline(&quot;Invalid IP range&quot;);</td></tr>
<tr><td class="h">1130</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, range =&gt; [ $ip1, $ip2 ]);</td></tr>
<tr><td class="h">1131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1132</td><td colspan="7"></td></tr><tr><td class="h">1133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Currently, only simple &#39;managed&#39; attribute,</td></tr>
<tr><td class="h">1134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because &#39;secondary&#39; and &#39;local&#39; isn&#39;t supported by Linux.</td></tr>
<tr><td class="h">1135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $managed = check_managed()) {</td></tr>
<tr><td class="h">1136</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1136">100</a></div></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$managed eq &#39;standard&#39;</td></tr>
<tr><td class="h">1137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;Only &#39;managed=standard&#39; is supported&quot;);</td></tr>
<tr><td class="h">1138</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, managed =&gt; $managed);</td></tr>
<tr><td class="h">1139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $model = check_model()) {</td></tr>
<tr><td class="h">1141</td><td><div class="c3">40</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1141">50</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{model} and error_atline(&quot;Duplicate attribute &#39;model&#39;&quot;);</td></tr>
<tr><td class="h">1142</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, model =&gt; $model);</td></tr>
<tr><td class="h">1143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $hardware = check_assign(&#39;hardware&#39;, \&amp;read_name)) {</td></tr>
<tr><td class="h">1145</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, hardware =&gt; $hardware);</td></tr>
<tr><td class="h">1146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $server_name = check_assign(&#39;server_name&#39;, \&amp;read_name)) {</td></tr>
<tr><td class="h">1148</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, server_name =&gt; $server_name);</td></tr>
<tr><td class="h">1149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1151</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, owner =&gt; $owner);</td></tr>
<tr><td class="h">1152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $radius_attributes = check_radius_attributes) {</td></tr>
<tr><td class="h">1154</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($host, radius_attributes =&gt; $radius_attributes);</td></tr>
<tr><td class="h">1155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair = check_typed_name) {</td></tr>
<tr><td class="h">1157</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @$pair;</td></tr>
<tr><td class="h">1158</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1158">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;nat&#39;) {</td></tr>
<tr><td class="h">1159</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1160</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1161</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;ip&#39;;</td></tr>
<tr><td class="h">1162</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1163</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_ip = read_ip;</td></tr>
<tr><td class="h">1164</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;;&#39;;</td></tr>
<tr><td class="h">1165</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\}&#39;;</td></tr>
<tr><td class="h">1166</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1166">50</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{nat}-&gt;{$name}</td></tr>
<tr><td class="h">1167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Duplicate NAT definition&quot;);</td></tr>
<tr><td class="h">1168</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{nat}-&gt;{$name} = $nat_ip;</td></tr>
<tr><td class="h">1169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1171</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected NAT definition&quot;);</td></tr>
<tr><td class="h">1172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1175</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Unexpected attribute&quot;);</td></tr>
<tr><td class="h">1176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1178</td><td><div class="c3">473</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1178">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1178">75</a></div></td><td></td><td></td><td><div>2092</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{ip} xor $host-&gt;{range}</td></tr>
<tr><td class="h">1179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;Exactly one of attributes &#39;ip&#39; and &#39;range&#39; is needed&quot;);</td></tr>
<tr><td class="h">1180</td><td colspan="7"></td></tr><tr><td class="h">1181</td><td><div class="c3">473</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1181">100</a></div></td><td></td><td></td><td></td><td><div>1698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($host-&gt;{managed}) {</td></tr>
<tr><td class="h">1182</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %ok = (</td></tr>
<tr><td class="h">1183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;managed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hardware&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server_name =&gt; 1</td></tr>
<tr><td class="h">1192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1193</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %$host) {</td></tr>
<tr><td class="h">1194</td><td><div class="c3">202</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1194">100</a></div></td><td></td><td></td><td></td><td><div>328</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $ok{$key};</td></tr>
<tr><td class="h">1195</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(</td></tr>
<tr><td class="h">1196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Managed $host-&gt;{name} must not have attribute &#39;$key&#39;&quot;);</td></tr>
<tr><td class="h">1197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1198</td><td><div class="c3">40</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1198">100</a></div></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{ip} ||= &#39;short&#39;;</td></tr>
<tr><td class="h">1199</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return host_as_interface($host);</td></tr>
<tr><td class="h">1200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1201</td><td><div class="c3">433</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1201">100</a></div></td><td></td><td></td><td></td><td><div>1567</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($host-&gt;{id}) {</td></tr>
<tr><td class="h">1202</td><td><div class="c3">52</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1202">100</a></div></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{radius_attributes} ||= {};</td></tr>
<tr><td class="h">1203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1205</td><td><div class="c3">381</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1205">50</a></div></td><td></td><td></td><td></td><td><div>661</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{radius_attributes}</td></tr>
<tr><td class="h">1206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and warn_msg(&quot;Ignoring &#39;radius_attributes&#39; at $name&quot;);</td></tr>
<tr><td class="h">1207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1208</td><td><div class="c3">433</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1208">100</a></div></td><td></td><td></td><td></td><td><div>700</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($host-&gt;{nat}) {</td></tr>
<tr><td class="h">1209</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1209">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($host-&gt;{range}) {</td></tr>
<tr><td class="h">1210</td><td colspan="7"></td></tr><tr><td class="h">1211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Before changing this,</td></tr>
<tr><td class="h">1212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - look at print_pix_static,</td></tr>
<tr><td class="h">1213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - add consistency tests in convert_hosts.</td></tr>
<tr><td class="h">1214</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;No NAT supported for host with &#39;range&#39;&quot;);</td></tr>
<tr><td class="h">1215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1217</td><td><div class="c3">433</div></td><td></td><td></td><td></td><td></td><td><div>559</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $host;</td></tr>
<tr><td class="h">1218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1219</td><td colspan="7"></td></tr><tr><td class="h">1220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_nat {</td></tr>
<tr><td class="h">1221</td><td><div class="c3">284</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1221">284</a></div></td><td><div class="c0">0</div></td><td><div>292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">1222</td><td colspan="7"></td></tr><tr><td class="h">1223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Currently this needs not to be blessed.</td></tr>
<tr><td class="h">1224</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>466</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nat = { name =&gt; $name };</td></tr>
<tr><td class="h">1225</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>897</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(my $nat_tag = $name) =~ s/^nat://;</td></tr>
<tr><td class="h">1226</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>428</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1227</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1228</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>269</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1229</td><td><div class="c3">651</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1229">100</a></div></td><td></td><td></td><td></td><td><div>779</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1230</td><td><div class="c3">367</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1230">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1230">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1230">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1230">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1230">50</a></div></td><td></td><td></td><td></td><td><div>632</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($ip, $mask) = check_assign &#39;ip&#39;, \&amp;read_ip_prefix) {</td></tr>
<tr><td class="h">1231</td><td><div class="c3">188</div></td><td></td><td></td><td></td><td></td><td><div>276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($nat, ip&nbsp;&nbsp;&nbsp;=&gt; $ip);</td></tr>
<tr><td class="h">1232</td><td><div class="c3">188</div></td><td></td><td></td><td></td><td></td><td><div>213</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($nat, mask =&gt; $mask);</td></tr>
<tr><td class="h">1233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;hidden&#39;) {</td></tr>
<tr><td class="h">1235</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>138</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{hidden} = 1;</td></tr>
<tr><td class="h">1236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;identity&#39;) {</td></tr>
<tr><td class="h">1238</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{identity} = 1;</td></tr>
<tr><td class="h">1239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;dynamic&#39;) {</td></tr>
<tr><td class="h">1241</td><td colspan="7"></td></tr><tr><td class="h">1242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $nat_tag is used later to look up static translation</td></tr>
<tr><td class="h">1243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of hosts inside a dynamically translated network.</td></tr>
<tr><td class="h">1244</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{dynamic} = $nat_tag;</td></tr>
<tr><td class="h">1245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair = check_assign &#39;subnet_of&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">1247</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($nat, subnet_of =&gt; $pair);</td></tr>
<tr><td class="h">1248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1250</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected some valid NAT attribute&quot;);</td></tr>
<tr><td class="h">1251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1253</td><td><div class="c3">284</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1253">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1253">100</a></div></td><td></td><td></td><td></td><td><div>662</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($nat-&gt;{hidden}) {</td></tr>
<tr><td class="h">1254</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$nat) {</td></tr>
<tr><td class="h">1255</td><td><div class="c3">156</div><div class="c3">312</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1255">50</a></div></td><td></td><td></td><td></td><td><div>154</div><div>594</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if grep { $key eq $_ } qw( name hidden );</td></tr>
<tr><td class="h">1256</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Hidden NAT must not use attribute $key&quot;);</td></tr>
<tr><td class="h">1257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1258</td><td colspan="7"></td></tr><tr><td class="h">1259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This simplifies error checks for overlapping addresses.</td></tr>
<tr><td class="h">1260</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{dynamic} = $nat_tag;</td></tr>
<tr><td class="h">1261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nat-&gt;{identity}) {</td></tr>
<tr><td class="h">1263</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$nat) {</td></tr>
<tr><td class="h">1264</td><td><div class="c3">36</div><div class="c3">72</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1264">50</a></div></td><td></td><td></td><td></td><td><div>37</div><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if grep { $key eq $_ } qw( name identity );</td></tr>
<tr><td class="h">1265</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Identity NAT must not use attribute $key&quot;);</td></tr>
<tr><td class="h">1266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1267</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{dynamic} = $nat_tag;</td></tr>
<tr><td class="h">1268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1270</td><td><div class="c3">188</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1270">50</a></div></td><td></td><td></td><td></td><td><div>362</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined($nat-&gt;{ip}) or error_atline(&#39;Missing IP address&#39;);</td></tr>
<tr><td class="h">1271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1272</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>349</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $nat;</td></tr>
<tr><td class="h">1273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1274</td><td colspan="7"></td></tr><tr><td class="h">1275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %networks;</td></tr>
<tr><td class="h">1276</td><td colspan="7"></td></tr><tr><td class="h">1277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_network {</td></tr>
<tr><td class="h">1278</td><td><div class="c3">2913</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1278">2913</a></div></td><td><div class="c0">0</div></td><td><div>2698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">1279</td><td colspan="7"></td></tr><tr><td class="h">1280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Network name without prefix &quot;network:&quot; is needed to build</td></tr>
<tr><td class="h">1281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# name of ID-hosts.</td></tr>
<tr><td class="h">1282</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>8615</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(my $net_name = $name) =~ s/^network://;</td></tr>
<tr><td class="h">1283</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>4533</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $network = new(&#39;Network&#39;, name =&gt; $name);</td></tr>
<tr><td class="h">1284</td><td><div class="c3">2913</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1284">100</a></div></td><td></td><td></td><td></td><td><div>4533</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">1285</td><td><div class="c3">2913</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1285">100</a></div></td><td></td><td></td><td></td><td><div>5371</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($net_name =~ m,^(.*)/,) {</td></tr>
<tr><td class="h">1286</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{bridged} = $1;</td></tr>
<tr><td class="h">1287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1288</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>3540</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1289</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>4010</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1290</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>4410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($network);</td></tr>
<tr><td class="h">1291</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>2651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1292</td><td><div class="c3">6774</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1292">100</a></div></td><td></td><td></td><td></td><td><div>7974</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1293</td><td><div class="c3">3861</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1293">50</a></div></td><td></td><td></td><td></td><td><div>6693</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($ip, $mask) = check_assign &#39;ip&#39;, \&amp;read_ip_prefix) {</td></tr>
<tr><td class="h">1294</td><td><div class="c3">2891</div></td><td></td><td></td><td></td><td></td><td><div>3879</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($network, ip&nbsp;&nbsp;&nbsp;=&gt; $ip);</td></tr>
<tr><td class="h">1295</td><td><div class="c3">2891</div></td><td></td><td></td><td></td><td></td><td><div>3200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($network, mask =&gt; $mask);</td></tr>
<tr><td class="h">1296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">1298</td><td><div class="c3">22</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1298">50</a></div></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined $network-&gt;{ip} and error_atline(&quot;Duplicate IP address&quot;);</td></tr>
<tr><td class="h">1299</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{ip} = &#39;unnumbered&#39;;</td></tr>
<tr><td class="h">1300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;has_subnets&#39;) {</td></tr>
<tr><td class="h">1302</td><td colspan="7"></td></tr><tr><td class="h">1303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Duplicate use of this flag doesn&#39;t matter.</td></tr>
<tr><td class="h">1304</td><td><div class="c3">75</div></td><td></td><td></td><td></td><td></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{has_subnets} = 1;</td></tr>
<tr><td class="h">1305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;crosslink&#39;) {</td></tr>
<tr><td class="h">1307</td><td colspan="7"></td></tr><tr><td class="h">1308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Duplicate use of this flag doesn&#39;t matter.</td></tr>
<tr><td class="h">1309</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{crosslink} = 1;</td></tr>
<tr><td class="h">1310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair = check_assign &#39;subnet_of&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">1312</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($network, subnet_of =&gt; $pair);</td></tr>
<tr><td class="h">1313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1315</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($network, owner =&gt; $owner);</td></tr>
<tr><td class="h">1316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $radius_attributes = check_radius_attributes) {</td></tr>
<tr><td class="h">1318</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($network, radius_attributes =&gt; $radius_attributes);</td></tr>
<tr><td class="h">1319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $host_name = check_hostname()) {</td></tr>
<tr><td class="h">1321</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>1130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $host = read_host(&quot;host:$host_name&quot;, $net_name);</td></tr>
<tr><td class="h">1322</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{network} = $network;</td></tr>
<tr><td class="h">1323</td><td><div class="c3">473</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1323">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1323">50</a></div></td><td></td><td></td><td></td><td><div>689</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_host($host)) {</td></tr>
<tr><td class="h">1324</td><td><div class="c3">433</div><div class="c3">433</div></td><td></td><td></td><td></td><td></td><td><div>362</div><div>724</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $network-&gt;{hosts} }, $host;</td></tr>
<tr><td class="h">1325</td><td><div class="c3">433</div></td><td></td><td></td><td></td><td></td><td><div>711</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host_name = (split_typed_name($host-&gt;{name}))[1];</td></tr>
<tr><td class="h">1326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1327</td><td colspan="7"></td></tr><tr><td class="h">1328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Managed host is stored as interface internally.</td></tr>
<tr><td class="h">1329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_interface($host)) {</td></tr>
<tr><td class="h">1330</td><td><div class="c3">40</div><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>32</div><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $network-&gt;{interfaces} }, $host;</td></tr>
<tr><td class="h">1331</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_interface_ip($host, $network);</td></tr>
<tr><td class="h">1332</td><td colspan="7"></td></tr><tr><td class="h">1333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For use in expand_group.</td></tr>
<tr><td class="h">1334</td><td><div class="c3">40</div><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>31</div><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $network-&gt;{managed_hosts} }, $host;</td></tr>
<tr><td class="h">1335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1337</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err;</td></tr>
<tr><td class="h">1338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1339</td><td><div class="c3">473</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1339">50</a></div></td><td></td><td></td><td></td><td><div>1121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $hosts{$host_name}) {</td></tr>
<tr><td class="h">1340</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $current_file;</td></tr>
<tr><td class="h">1341</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other_net = $other-&gt;{network};</td></tr>
<tr><td class="h">1342</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1342">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($other_net ne $network) {</td></tr>
<tr><td class="h">1343</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$where .= &quot; $other_net-&gt;{file}&quot;;</td></tr>
<tr><td class="h">1344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1345</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Duplicate definition of host:$host_name in $where&quot;);</td></tr>
<tr><td class="h">1346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1347</td><td><div class="c3">473</div></td><td></td><td></td><td></td><td></td><td><div>2770</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hosts{$host_name} = $host;</td></tr>
<tr><td class="h">1348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $nat_tag = check_nat_name()) {</td></tr>
<tr><td class="h">1350</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = read_nat(&quot;nat:$nat_tag&quot;);</td></tr>
<tr><td class="h">1351</td><td><div class="c3">260</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1351">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1351">67</a></div></td><td></td><td></td><td><div>678</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($network-&gt;{nat} &amp;&amp; $network-&gt;{nat}-&gt;{$nat_tag})</td></tr>
<tr><td class="h">1352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Duplicate NAT definition&quot;);</td></tr>
<tr><td class="h">1353</td><td colspan="7"></td></tr><tr><td class="h">1354</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>590</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{name} .= &quot;($name)&quot;;</td></tr>
<tr><td class="h">1355</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>704</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{nat}-&gt;{$nat_tag} = $nat;</td></tr>
<tr><td class="h">1356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1358</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected some valid attribute&quot;);</td></tr>
<tr><td class="h">1359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1361</td><td colspan="7"></td></tr><tr><td class="h">1362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Network needs at least IP and mask to be defined.</td></tr>
<tr><td class="h">1363</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>3812</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $network-&gt;{ip};</td></tr>
<tr><td class="h">1364</td><td colspan="7"></td></tr><tr><td class="h">1365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use &#39;defined&#39; here because IP may have value &#39;0&#39;.</td></tr>
<tr><td class="h">1366</td><td><div class="c3">2913</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1366">50</a></div></td><td></td><td></td><td></td><td><div>4363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $ip or syntax_err(&quot;Missing network IP&quot;);</td></tr>
<tr><td class="h">1367</td><td colspan="7"></td></tr><tr><td class="h">1368</td><td><div class="c3">2913</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1368">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1368">100</a></div></td><td></td><td></td><td></td><td><div>6119</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($ip eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">1369</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %ok = (ip =&gt; 1, name =&gt; 1, crosslink =&gt; 1, private =&gt; 1);</td></tr>
<tr><td class="h">1370</td><td colspan="7"></td></tr><tr><td class="h">1371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Unnumbered network must not have any other attributes.</td></tr>
<tr><td class="h">1372</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$network) {</td></tr>
<tr><td class="h">1373</td><td><div class="c3">44</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1373">50</a></div></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $ok{$key};</td></tr>
<tr><td class="h">1374</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1374">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1374">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(</td></tr>
<tr><td class="h">1375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unnumbered $network-&gt;{name} must not have &quot;,</td></tr>
<tr><td class="h">1376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($key eq &#39;hosts&#39;) ? &quot;host definition&quot;</td></tr>
<tr><td class="h">1377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ($key eq &#39;nat&#39;) ? &quot;nat definition&quot;</td></tr>
<tr><td class="h">1378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;attribute &#39;$key&#39;&quot;</td></tr>
<tr><td class="h">1379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($network-&gt;{bridged}) {</td></tr>
<tr><td class="h">1383</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %ok = (</td></tr>
<tr><td class="h">1384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bridged&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">1391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crosslink =&gt; 1</td></tr>
<tr><td class="h">1392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1393</td><td colspan="7"></td></tr><tr><td class="h">1394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Bridged network must not have any other attributes.</td></tr>
<tr><td class="h">1395</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$network) {</td></tr>
<tr><td class="h">1396</td><td><div class="c3">130</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1396">50</a></div></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $ok{$key};</td></tr>
<tr><td class="h">1397</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1397">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(</td></tr>
<tr><td class="h">1398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Bridged $network-&gt;{name} must not have &quot;,</td></tr>
<tr><td class="h">1399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($key eq &#39;hosts&#39;)</td></tr>
<tr><td class="h">1400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? &quot;host definition (not implemented)&quot;</td></tr>
<tr><td class="h">1401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: &quot;attribute &#39;$key&#39;&quot;</td></tr>
<tr><td class="h">1402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1404</td><td><div class="c3">32</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1404">50</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $network-&gt;{nat}) {</td></tr>
<tr><td class="h">1405</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$hash) {</td></tr>
<tr><td class="h">1406</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1406">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hash-&gt;{$nat_tag}-&gt;{identity} and next;</td></tr>
<tr><td class="h">1407</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $hash-&gt;{$nat_tag};</td></tr>
<tr><td class="h">1408</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">1409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Only identity NAT allowed for bridged $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">1410</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">1411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1415</td><td><div class="c3">2859</div></td><td></td><td></td><td></td><td></td><td><div>2720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = $network-&gt;{mask};</td></tr>
<tr><td class="h">1416</td><td><div class="c3">2859</div><div class="c3">2859</div></td><td></td><td></td><td></td><td></td><td><div>2216</div><div>5558</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">1417</td><td colspan="7"></td></tr><tr><td class="h">1418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check compatibility of host IP and network IP/mask.</td></tr>
<tr><td class="h">1419</td><td><div class="c3">433</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1419">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1419">50</a></div></td><td></td><td></td><td></td><td><div>764</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $host_ip = $host-&gt;{ip}) {</td></tr>
<tr><td class="h">1420</td><td><div class="c3">391</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1420">50</a></div></td><td></td><td></td><td></td><td><div>1330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not(match_ip($host_ip, $ip, $mask))) {</td></tr>
<tr><td class="h">1421</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;$host-&gt;{name}&#39;s IP doesn&#39;t match&quot;</td></tr>
<tr><td class="h">1422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; network IP/mask&quot;);</td></tr>
<tr><td class="h">1423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($host-&gt;{range}) {</td></tr>
<tr><td class="h">1426</td><td><div class="c3">42</div><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>39</div><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip1, $ip2) = @{ $host-&gt;{range} };</td></tr>
<tr><td class="h">1427</td><td><div class="c3">42</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1427">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1427">33</a></div></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">1428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not(&nbsp;&nbsp;&nbsp;&nbsp;match_ip($ip1, $ip, $mask)</td></tr>
<tr><td class="h">1429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and match_ip($ip2, $ip, $mask))</td></tr>
<tr><td class="h">1430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">1431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">1432</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;$host-&gt;{name}&#39;s IP range doesn&#39;t match&quot;,</td></tr>
<tr><td class="h">1433</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; network IP/mask&quot;);</td></tr>
<tr><td class="h">1434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1437</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err();</td></tr>
<tr><td class="h">1438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1439</td><td colspan="7"></td></tr><tr><td class="h">1440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Compatibility of host and network NAT will be checked later,</td></tr>
<tr><td class="h">1441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# after inherited NAT definitions have been processed.</td></tr>
<tr><td class="h">1442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1443</td><td><div class="c3">2859</div><div class="c3">2859</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1443">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1443">100</a></div></td><td></td><td></td><td><div>2482</div><div>6319</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@{ $network-&gt;{hosts} } and $network-&gt;{crosslink}) {</td></tr>
<tr><td class="h">1444</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Crosslink network must not have host definitions&quot;);</td></tr>
<tr><td class="h">1445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1446</td><td><div class="c3">2859</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1446">100</a></div></td><td></td><td></td><td></td><td><div>4511</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{nat}) {</td></tr>
<tr><td class="h">1447</td><td colspan="7"></td></tr><tr><td class="h">1448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check NAT definitions.</td></tr>
<tr><td class="h">1449</td><td><div class="c3">204</div><div class="c3">204</div></td><td></td><td></td><td></td><td></td><td><div>168</div><div>425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat (values %{ $network-&gt;{nat} }) {</td></tr>
<tr><td class="h">1450</td><td><div class="c3">260</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1450">100</a></div></td><td></td><td></td><td></td><td><div>529</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat-&gt;{dynamic};</td></tr>
<tr><td class="h">1451</td><td><div class="c3">109</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1451">50</a></div></td><td></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{mask} == $mask</td></tr>
<tr><td class="h">1452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(</td></tr>
<tr><td class="h">1453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Mask for non dynamic $nat-&gt;{name}&quot;,</td></tr>
<tr><td class="h">1454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must be equal to network mask&quot;</td></tr>
<tr><td class="h">1455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1458</td><td colspan="7"></td></tr><tr><td class="h">1459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check and mark networks with ID-hosts.</td></tr>
<tr><td class="h">1460</td><td><div class="c3">2859</div><div class="c3">433</div><div class="c3">2859</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1460">100</a></div></td><td></td><td></td><td></td><td><div>2165</div><div>832</div><div>4681</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $id_hosts_count = grep { $_-&gt;{id} } @{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">1461</td><td colspan="7"></td></tr><tr><td class="h">1462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If one host has ID, all hosts must have ID.</td></tr>
<tr><td class="h">1463</td><td><div class="c3">26</div><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1463">50</a></div></td><td></td><td></td><td></td><td><div>22</div><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $network-&gt;{hosts} } == $id_hosts_count</td></tr>
<tr><td class="h">1464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;All hosts must have ID in $name&quot;);</td></tr>
<tr><td class="h">1465</td><td colspan="7"></td></tr><tr><td class="h">1466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark network.</td></tr>
<tr><td class="h">1467</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{has_id_hosts} = 1;</td></tr>
<tr><td class="h">1468</td><td><div class="c3">26</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1468">100</a></div></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{radius_attributes} ||= {};</td></tr>
<tr><td class="h">1469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1471</td><td><div class="c3">2833</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1471">50</a></div></td><td></td><td></td><td></td><td><div>4674</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{radius_attributes}</td></tr>
<tr><td class="h">1472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and warn_msg(&quot;Ignoring &#39;radius_attributes&#39; at $name&quot;);</td></tr>
<tr><td class="h">1473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1475</td><td><div class="c3">2913</div></td><td></td><td></td><td></td><td></td><td><div>3670</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $network;</td></tr>
<tr><td class="h">1476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1477</td><td colspan="7"></td></tr><tr><td class="h">1478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %interfaces;</td></tr>
<tr><td class="h">1479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @virtual_interfaces;</td></tr>
<tr><td class="h">1480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $global_active_pathrestriction = new(</td></tr>
<tr><td class="h">1481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;Pathrestriction&#39;,</td></tr>
<tr><td class="h">1482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;global_pathrestriction&#39;,</td></tr>
<tr><td class="h">1483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;active_path =&gt; 1</td></tr>
<tr><td class="h">1484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">1485</td><td colspan="7"></td></tr><tr><td class="h">1486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Tunnel networks which are already attached to tunnel interfaces</td></tr>
<tr><td class="h">1487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># at spoke devices. Key is crypto name, not crypto object.</td></tr>
<tr><td class="h">1488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %crypto2spokes;</td></tr>
<tr><td class="h">1489</td><td colspan="7"></td></tr><tr><td class="h">1490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Real interfaces at crypto hub, where tunnels are attached.</td></tr>
<tr><td class="h">1491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Key is crypto name, not crypto object.</td></tr>
<tr><td class="h">1492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %crypto2hubs;</td></tr>
<tr><td class="h">1493</td><td colspan="7"></td></tr><tr><td class="h">1494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_interface {</td></tr>
<tr><td class="h">1495</td><td><div class="c3">4464</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1495">4464</a></div></td><td><div class="c0">0</div></td><td><div>4032</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">1496</td><td><div class="c3">4464</div></td><td></td><td></td><td></td><td></td><td><div>5375</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $interface = new(&#39;Interface&#39;, name =&gt; $name);</td></tr>
<tr><td class="h">1497</td><td colspan="7"></td></tr><tr><td class="h">1498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Short form of interface definition.</td></tr>
<tr><td class="h">1499</td><td><div class="c3">4464</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1499">100</a></div></td><td></td><td></td><td></td><td><div>5404</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not check &#39;=&#39;) {</td></tr>
<tr><td class="h">1500</td><td><div class="c3">393</div></td><td></td><td></td><td></td><td></td><td><div>542</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;;&#39;;</td></tr>
<tr><td class="h">1501</td><td><div class="c3">393</div></td><td></td><td></td><td></td><td></td><td><div>592</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{ip} = &#39;short&#39;;</td></tr>
<tr><td class="h">1502</td><td><div class="c3">393</div></td><td></td><td></td><td></td><td></td><td><div>637</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $interface;</td></tr>
<tr><td class="h">1503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1504</td><td colspan="7"></td></tr><tr><td class="h">1505</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>4654</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @secondary_interfaces = ();</td></tr>
<tr><td class="h">1506</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>3071</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $virtual;</td></tr>
<tr><td class="h">1507</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>4861</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1508</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>5928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($interface);</td></tr>
<tr><td class="h">1509</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>3668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1510</td><td><div class="c3">12205</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1510">100</a></div></td><td></td><td></td><td></td><td><div>13978</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1511</td><td><div class="c3">8134</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1511">50</a></div></td><td></td><td></td><td></td><td><div>13047</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @ip = check_assign_list &#39;ip&#39;, \&amp;read_ip) {</td></tr>
<tr><td class="h">1512</td><td><div class="c3">3922</div></td><td></td><td></td><td></td><td></td><td><div>5555</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, ip =&gt; shift(@ip));</td></tr>
<tr><td class="h">1513</td><td colspan="7"></td></tr><tr><td class="h">1514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Build interface objects for secondary IP addresses.</td></tr>
<tr><td class="h">1515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# These objects are named interface:router.name.2, ...</td></tr>
<tr><td class="h">1516</td><td><div class="c3">3922</div></td><td></td><td></td><td></td><td></td><td><div>3457</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $counter = 2;</td></tr>
<tr><td class="h">1517</td><td><div class="c3">3922</div></td><td></td><td></td><td></td><td></td><td><div>6857</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ip (@ip) {</td></tr>
<tr><td class="h">1518</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @secondary_interfaces,</td></tr>
<tr><td class="h">1519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new(&#39;Interface&#39;, name =&gt; &quot;$name.$counter&quot;, ip =&gt; $ip);</td></tr>
<tr><td class="h">1520</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$counter++;</td></tr>
<tr><td class="h">1521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">1524</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, ip =&gt; &#39;unnumbered&#39;);</td></tr>
<tr><td class="h">1525</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;negotiated&#39;) {</td></tr>
<tr><td class="h">1527</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, ip =&gt; &#39;negotiated&#39;);</td></tr>
<tr><td class="h">1528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;loopback&#39;) {</td></tr>
<tr><td class="h">1530</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{loopback} = 1;</td></tr>
<tr><td class="h">1531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;vip&#39;) {</td></tr>
<tr><td class="h">1533</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{vip} = 1;</td></tr>
<tr><td class="h">1534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;no_in_acl&#39;) {</td></tr>
<tr><td class="h">1536</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{no_in_acl} = 1;</td></tr>
<tr><td class="h">1537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;dhcp_server&#39;) {</td></tr>
<tr><td class="h">1539</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{dhcp_server} = 1;</td></tr>
<tr><td class="h">1540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1541</td><td colspan="7"></td></tr><tr><td class="h">1542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Needed for the implicitly defined network of &#39;loopback&#39;.</td></tr>
<tr><td class="h">1543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair = check_assign &#39;subnet_of&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">1544</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, subnet_of =&gt; $pair);</td></tr>
<tr><td class="h">1545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my @pairs = check_assign_list &#39;hub&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">1547</td><td><div class="c3">39</div></td><td></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@pairs) {</td></tr>
<tr><td class="h">1548</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name2) = @$pair;</td></tr>
<tr><td class="h">1549</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1549">50</a></div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type eq &#39;crypto&#39; or error_atline(&quot;Expected type &#39;crypto&#39;&quot;);</td></tr>
<tr><td class="h">1550</td><td><div class="c3">49</div><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>43</div><div>237</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $interface-&gt;{hub} }, &quot;$type:$name2&quot;;</td></tr>
<tr><td class="h">1551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($pair = check_assign &#39;spoke&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">1554</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name2) = @$pair;</td></tr>
<tr><td class="h">1555</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1555">50</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type eq &#39;crypto&#39; or error_atline(&quot;Expected type crypto&quot;);</td></tr>
<tr><td class="h">1556</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, spoke =&gt; &quot;$type:$name2&quot;);</td></tr>
<tr><td class="h">1557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $id = check_assign &#39;id&#39;, \&amp;read_user_id) {</td></tr>
<tr><td class="h">1559</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, id =&gt; $id);</td></tr>
<tr><td class="h">1560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1561</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (defined(my $level = check_assign &#39;security_level&#39;, \&amp;read_int)) {</td></tr>
<tr><td class="h">1562</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1562">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$level &gt; 100</td></tr>
<tr><td class="h">1563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Maximum value for attribute security_level&quot;,</td></tr>
<tr><td class="h">1564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; is 100&quot;);</td></tr>
<tr><td class="h">1565</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, security_level =&gt; $level);</td></tr>
<tr><td class="h">1566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($pair = check_typed_name) {</td></tr>
<tr><td class="h">1568</td><td><div class="c3">25</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name2) = @$pair;</td></tr>
<tr><td class="h">1569</td><td><div class="c3">25</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1569">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1569">50</a></div></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;nat&#39;) {</td></tr>
<tr><td class="h">1570</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1571</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1572</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;ip&#39;;</td></tr>
<tr><td class="h">1573</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1574</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_ip = read_ip;</td></tr>
<tr><td class="h">1575</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;;&#39;;</td></tr>
<tr><td class="h">1576</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\}&#39;;</td></tr>
<tr><td class="h">1577</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1577">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{nat}-&gt;{$name2}</td></tr>
<tr><td class="h">1578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Duplicate NAT definition&quot;);</td></tr>
<tr><td class="h">1579</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{nat}-&gt;{$name2} = $nat_ip;</td></tr>
<tr><td class="h">1580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;secondary&#39;) {</td></tr>
<tr><td class="h">1582</td><td colspan="7"></td></tr><tr><td class="h">1583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Build new interface for secondary IP addresses.</td></tr>
<tr><td class="h">1584</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $secondary = new(&#39;Interface&#39;, name =&gt; &quot;$name.$name2&quot;);</td></tr>
<tr><td class="h">1585</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1586</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1587</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1588</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1588">100</a></div></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1589</td><td><div class="c3">18</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1589">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = check_assign &#39;ip&#39;, \&amp;read_ip) {</td></tr>
<tr><td class="h">1590</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($secondary, ip =&gt; $ip);</td></tr>
<tr><td class="h">1591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1593</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected attribute IP&quot;);</td></tr>
<tr><td class="h">1594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1596</td><td><div class="c3">18</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1596">50</a></div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($secondary-&gt;{ip}) {</td></tr>
<tr><td class="h">1597</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @secondary_interfaces, $secondary;</td></tr>
<tr><td class="h">1598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1600</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Missing IP address&quot;);</td></tr>
<tr><td class="h">1601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1604</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected nat or secondary interface definition&quot;);</td></tr>
<tr><td class="h">1605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check &#39;virtual&#39;) {</td></tr>
<tr><td class="h">1608</td><td><div class="c3">144</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1608">50</a></div></td><td></td><td></td><td></td><td><div>249</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$virtual and error_atline(&quot;Duplicate virtual interface&quot;);</td></tr>
<tr><td class="h">1609</td><td colspan="7"></td></tr><tr><td class="h">1610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Read attributes of redundancy protocol (VRRP/HSRP).</td></tr>
<tr><td class="h">1611</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>372</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$virtual = new(</td></tr>
<tr><td class="h">1612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Interface&#39;,</td></tr>
<tr><td class="h">1613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &quot;$name.virtual&quot;,</td></tr>
<tr><td class="h">1614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redundant =&gt; 1</td></tr>
<tr><td class="h">1615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1616</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1617</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1618</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1619</td><td><div class="c3">316</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1619">100</a></div></td><td></td><td></td><td></td><td><div>369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1620</td><td><div class="c3">172</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1620">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1620">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1620">0</a></div></td><td></td><td></td><td></td><td><div>303</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = check_assign &#39;ip&#39;, \&amp;read_ip) {</td></tr>
<tr><td class="h">1621</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>207</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($virtual, ip =&gt; $ip);</td></tr>
<tr><td class="h">1622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1623</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $type = check_assign &#39;type&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1624</td><td><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1624">50</a></div></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$xxrp_info{$type}</td></tr>
<tr><td class="h">1625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;unknown redundancy protocol&quot;);</td></tr>
<tr><td class="h">1626</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($virtual, redundancy_type =&gt; $type);</td></tr>
<tr><td class="h">1627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $id = check_assign &#39;id&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1629</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1629">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id =~ /^\d+$/</td></tr>
<tr><td class="h">1630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;Redundancy ID must be numeric&quot;);</td></tr>
<tr><td class="h">1631</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1631">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id &lt; 256 or error_atline(&quot;Redundancy ID must be &lt; 256&quot;);</td></tr>
<tr><td class="h">1632</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($virtual, redundancy_id =&gt; $id);</td></tr>
<tr><td class="h">1633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1634</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1635</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected valid attribute for virtual IP&quot;);</td></tr>
<tr><td class="h">1636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1638</td><td><div class="c3">144</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1638">50</a></div></td><td></td><td></td><td></td><td><div>297</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$virtual-&gt;{ip} or error_atline(&quot;Missing virtual IP&quot;);</td></tr>
<tr><td class="h">1639</td><td><div class="c3">144</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1639">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1639">33</a></div></td><td></td><td></td><td><div>432</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($virtual-&gt;{redundancy_id} &amp;&amp; !$virtual-&gt;{redundancy_type})</td></tr>
<tr><td class="h">1640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</td></tr>
<tr><td class="h">1641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Redundancy ID is given without redundancy protocol&quot;);</td></tr>
<tr><td class="h">1642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my @tags = check_assign_list &#39;bind_nat&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1644</td><td><div class="c3">226</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1644">50</a></div></td><td></td><td></td><td></td><td><div>436</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{bind_nat} and error_atline(&quot;Duplicate NAT binding&quot;);</td></tr>
<tr><td class="h">1645</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>407</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{bind_nat} = [ unique sort @tags ];</td></tr>
<tr><td class="h">1646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $hardware = check_assign &#39;hardware&#39;, \&amp;read_name) {</td></tr>
<tr><td class="h">1648</td><td><div class="c3">3534</div></td><td></td><td></td><td></td><td></td><td><div>4698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, hardware =&gt; $hardware);</td></tr>
<tr><td class="h">1649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1651</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, owner =&gt; $owner);</td></tr>
<tr><td class="h">1652</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1653</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $routing = check_routing()) {</td></tr>
<tr><td class="h">1654</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, routing =&gt; $routing);</td></tr>
<tr><td class="h">1655</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (@pairs = check_assign_list &#39;reroute_permit&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">1657</td><td><div class="c3">2</div><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1657">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1657">50</a></div></td><td></td><td></td><td></td><td><div>4</div><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_-&gt;[0] ne &#39;network&#39; || ref $_-&gt;[1] } @pairs) {</td></tr>
<tr><td class="h">1658</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline &quot;Must only use network names in &#39;reroute_permit&#39;&quot;;</td></tr>
<tr><td class="h">1659</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@pairs = ();</td></tr>
<tr><td class="h">1660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1661</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($interface, reroute_permit =&gt; \@pairs);</td></tr>
<tr><td class="h">1662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;disabled&#39;) {</td></tr>
<tr><td class="h">1664</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">1665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;no_check&#39;) {</td></tr>
<tr><td class="h">1667</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{no_check} = 1;</td></tr>
<tr><td class="h">1668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1670</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&#39;Expected some valid attribute&#39;);</td></tr>
<tr><td class="h">1671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1673</td><td colspan="7"></td></tr><tr><td class="h">1674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Interface at bridged network</td></tr>
<tr><td class="h">1675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - without IP is interface of bridge,</td></tr>
<tr><td class="h">1676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - with IP is interface of router.</td></tr>
<tr><td class="h">1677</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1677">100</a></div></td><td></td><td></td><td></td><td><div>7814</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($name =~ m,/,) {</td></tr>
<tr><td class="h">1678</td><td><div class="c3">54</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1678">100</a></div></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{ip} ||= &#39;bridged&#39;;</td></tr>
<tr><td class="h">1679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1680</td><td colspan="7"></td></tr><tr><td class="h">1681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Swap virtual interface and main interface</td></tr>
<tr><td class="h">1682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# or take virtual interface as main interface if no main IP available.</td></tr>
<tr><td class="h">1683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Subsequent code becomes simpler if virtual interface is main interface.</td></tr>
<tr><td class="h">1684</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1684">100</a></div></td><td></td><td></td><td></td><td><div>4957</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($virtual) {</td></tr>
<tr><td class="h">1685</td><td><div class="c3">144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1685">100</a></div></td><td></td><td></td><td></td><td><div>278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = $interface-&gt;{ip}) {</td></tr>
<tr><td class="h">1686</td><td><div class="c3">128</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1686">50</a></div></td><td></td><td></td><td></td><td><div>308</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip =~ /^(unnumbered|negotiated|short|bridged)$/) {</td></tr>
<tr><td class="h">1687</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;No virtual IP supported for $ip interface&quot;);</td></tr>
<tr><td class="h">1688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1689</td><td colspan="7"></td></tr><tr><td class="h">1690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Move main IP to secondary.</td></tr>
<tr><td class="h">1691</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $secondary =</td></tr>
<tr><td class="h">1692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new(&#39;Interface&#39;, name =&gt; $interface-&gt;{name}, ip =&gt; $ip);</td></tr>
<tr><td class="h">1693</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @secondary_interfaces, $secondary;</td></tr>
<tr><td class="h">1694</td><td colspan="7"></td></tr><tr><td class="h">1695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# But we need the original main interface</td></tr>
<tr><td class="h">1696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# when handling auto interfaces.</td></tr>
<tr><td class="h">1697</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{orig_main} = $secondary;</td></tr>
<tr><td class="h">1698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1699</td><td><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>327</div><div>219</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$interface}{qw(name ip redundant redundancy_type redundancy_id)} =</td></tr>
<tr><td class="h">1700</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$virtual}{qw(name ip redundant redundancy_type redundancy_id)};</td></tr>
<tr><td class="h">1701</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @virtual_interfaces, $interface;</td></tr>
<tr><td class="h">1702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1704</td><td><div class="c3">3927</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1704">100</a></div></td><td></td><td></td><td><div>7071</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{ip} ||= &#39;short&#39;;</td></tr>
<tr><td class="h">1705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1706</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1706">100</a></div></td><td></td><td></td><td></td><td><div>6446</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{nat}) {</td></tr>
<tr><td class="h">1707</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1707">50</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} =~ /^(unnumbered|negotiated|short|bridged)$/) {</td></tr>
<tr><td class="h">1708</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;No NAT supported for $interface-&gt;{ip} interface&quot;);</td></tr>
<tr><td class="h">1709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1711</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1711">100</a></div></td><td></td><td></td><td></td><td><div>5850</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{vip}) {</td></tr>
<tr><td class="h">1712</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{loopback} = 1;</td></tr>
<tr><td class="h">1713</td><td><div class="c3">10</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1713">50</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hardware}</td></tr>
<tr><td class="h">1714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</td></tr>
<tr><td class="h">1715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;&#39;vip&#39; interface must not have attribute &#39;hardware&#39;&quot;);</td></tr>
<tr><td class="h">1716</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hardware} = &#39;VIP&#39;;</td></tr>
<tr><td class="h">1717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1718</td><td><div class="c3">4071</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1718">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1718">67</a></div></td><td></td><td></td><td><div>6736</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{owner} &amp;&amp; !$interface-&gt;{vip}) {</td></tr>
<tr><td class="h">1719</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Must use attribute &#39;owner&#39; only at &#39;vip&#39; interface&quot;);</td></tr>
<tr><td class="h">1720</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{owner};</td></tr>
<tr><td class="h">1721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1722</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1722">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1722">50</a></div></td><td></td><td></td><td></td><td><div>7803</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{loopback}) {</td></tr>
<tr><td class="h">1723</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>260</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %copy = %$interface;</td></tr>
<tr><td class="h">1724</td><td colspan="7"></td></tr><tr><td class="h">1725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only these attributes are valid.</td></tr>
<tr><td class="h">1726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete @copy{</td></tr>
<tr><td class="h">1727</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qw(name ip nat bind_nat hardware loopback subnet_of</td></tr>
<tr><td class="h">1728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owner redundant redundancy_type redundancy_id vip)</td></tr>
<tr><td class="h">1729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">1730</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1730">50</a></div></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (keys %copy) {</td></tr>
<tr><td class="h">1731</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attr = join &quot;, &quot;, map { &quot;&#39;$_&#39;&quot; } keys %copy;</td></tr>
<tr><td class="h">1732</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1732">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = $interface-&gt;{vip} ? &quot;&#39;vip&#39;&quot; : &#39;loopback&#39;;</td></tr>
<tr><td class="h">1733</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid attributes $attr for $type interface&quot;);</td></tr>
<tr><td class="h">1734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1735</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1735">50</a></div></td><td></td><td></td><td></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} =~ /^(unnumbered|negotiated|short|bridged)$/) {</td></tr>
<tr><td class="h">1736</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1736">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = $interface-&gt;{vip} ? &quot;&#39;vip&#39;&quot; : &#39;Loopback&#39;;</td></tr>
<tr><td class="h">1737</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;$type interface must not be $interface-&gt;{ip}&quot;);</td></tr>
<tr><td class="h">1738</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">1739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($interface-&gt;{subnet_of}) {</td></tr>
<tr><td class="h">1742</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Attribute &#39;subnet_of&#39; is only valid&quot;,</td></tr>
<tr><td class="h">1743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for loopback interface&quot;);</td></tr>
<tr><td class="h">1744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1745</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1745">100</a></div></td><td></td><td></td><td></td><td><div>7468</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} eq &#39;bridged&#39;) {</td></tr>
<tr><td class="h">1746</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %ok = (ip =&gt; 1, hardware =&gt; 1, name =&gt; 1, bind_nat =&gt; 1);</td></tr>
<tr><td class="h">1747</td><td><div class="c3">32</div><div class="c3">96</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1747">50</a></div></td><td></td><td></td><td></td><td><div>69</div><div>201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @extra = grep { !$ok{$_} } keys %$interface) {</td></tr>
<tr><td class="h">1748</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attr = join &quot;, &quot;, map { &quot;&#39;$_&#39;&quot; } @extra;</td></tr>
<tr><td class="h">1749</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid attributes $attr for bridged interface&quot;);</td></tr>
<tr><td class="h">1750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1752</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1752">100</a></div></td><td></td><td></td><td></td><td><div>5145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $crypto = $interface-&gt;{spoke}) {</td></tr>
<tr><td class="h">1753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@secondary_interfaces</td></tr>
<tr><td class="h">1754</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1754">50</a></div></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(</td></tr>
<tr><td class="h">1755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Interface with attribute &#39;spoke&#39;&quot;,</td></tr>
<tr><td class="h">1756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must not have secondary interfaces&quot;</td></tr>
<tr><td class="h">1757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1758</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1758">50</a></div></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hub}</td></tr>
<tr><td class="h">1759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(</td></tr>
<tr><td class="h">1760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Interface with attribute &#39;spoke&#39;&quot;,</td></tr>
<tr><td class="h">1761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must not have attribute &#39;hub&#39;&quot;</td></tr>
<tr><td class="h">1762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1765</td><td><div class="c3">4018</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1765">50</a></div></td><td></td><td></td><td></td><td><div>5809</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{id}</td></tr>
<tr><td class="h">1766</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</td></tr>
<tr><td class="h">1767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Attribute &#39;id&#39; is only valid for &#39;spoke&#39; interface&quot;);</td></tr>
<tr><td class="h">1768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1769</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1769">100</a></div></td><td></td><td></td><td></td><td><div>5931</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $crypto_list = $interface-&gt;{hub}) {</td></tr>
<tr><td class="h">1770</td><td><div class="c3">39</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1770">50</a></div></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} =~ /^(unnumbered|negotiated|short|bridged)$/) {</td></tr>
<tr><td class="h">1771</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Crypto hub must not be $interface-&gt;{ip} interface&quot;);</td></tr>
<tr><td class="h">1772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1773</td><td><div class="c3">39</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (@$crypto_list) {</td></tr>
<tr><td class="h">1774</td><td><div class="c3">49</div><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>44</div><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $crypto2hubs{$crypto} }, $interface;</td></tr>
<tr><td class="h">1775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1776</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1777</td><td><div class="c3">4071</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1777">100</a></div></td><td></td><td></td><td></td><td><div>5989</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@secondary_interfaces) {</td></tr>
<tr><td class="h">1778</td><td><div class="c3">148</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1778">50</a></div></td><td></td><td></td><td></td><td><div>369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} =~ /^(unnumbered|negotiated|short|bridged)$/) {</td></tr>
<tr><td class="h">1779</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;\u$interface-&gt;{ip} interface must not have&quot;,</td></tr>
<tr><td class="h">1780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; secondary IP address&quot;);</td></tr>
<tr><td class="h">1781</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@secondary_interfaces = ();</td></tr>
<tr><td class="h">1782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1784</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>5541</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $secondary (@secondary_interfaces) {</td></tr>
<tr><td class="h">1785</td><td><div class="c3">156</div></td><td></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$secondary-&gt;{main_interface} = $interface;</td></tr>
<tr><td class="h">1786</td><td><div class="c3">156</div></td><td></td><td></td><td></td><td></td><td><div>178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (qw(hardware bind_nat routing disabled)) {</td></tr>
<tr><td class="h">1787</td><td><div class="c3">624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1787">100</a></div></td><td></td><td></td><td></td><td><div>1278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$secondary-&gt;{$key} = $interface-&gt;{$key} if $interface-&gt;{$key};</td></tr>
<tr><td class="h">1788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1790</td><td><div class="c3">4071</div></td><td></td><td></td><td></td><td></td><td><div>7050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $interface, @secondary_interfaces;</td></tr>
<tr><td class="h">1791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1792</td><td colspan="7"></td></tr><tr><td class="h">1793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># PIX firewalls have a security level associated with each interface.</td></tr>
<tr><td class="h">1794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Use attribute &#39;security_level&#39; or</td></tr>
<tr><td class="h">1795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># try to derive the level from the interface name.</td></tr>
<tr><td class="h">1796</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_pix_interface_level {</td></tr>
<tr><td class="h">1797</td><td><div class="c3">12</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1797">12</a></div></td><td><div class="c0">0</div></td><td><div>444</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">1798</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>10</div><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">1799</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hwname = $hardware-&gt;{name};</td></tr>
<tr><td class="h">1800</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $level;</td></tr>
<tr><td class="h">1801</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1801">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1801">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1801">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1801">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1801">33</a></div></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">1802</td><td><div class="c3">26</div><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>218</div><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @levels = grep { defined($_) }</td></tr>
<tr><td class="h">1803</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{security_level} } @{ $hardware-&gt;{interfaces} }</td></tr>
<tr><td class="h">1804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">1805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">1806</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1806">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L1806">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@levels &gt;= 2 &amp;&amp; !equal(@levels)) {</td></tr>
<tr><td class="h">1807</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Must not use different values&quot;,</td></tr>
<tr><td class="h">1808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for attribute &#39;security_level&#39;\n&quot;,</td></tr>
<tr><td class="h">1809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $router-&gt;{name}, hardware $hwname: &quot;,</td></tr>
<tr><td class="h">1810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;,&#39;, @levels);</td></tr>
<tr><td class="h">1811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1813</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$level = $levels[0];</td></tr>
<tr><td class="h">1814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($hwname =~ &#39;inside&#39;) {</td></tr>
<tr><td class="h">1817</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$level = 100;</td></tr>
<tr><td class="h">1818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1819</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($hwname =~ &#39;outside&#39;) {</td></tr>
<tr><td class="h">1820</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$level = 0;</td></tr>
<tr><td class="h">1821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1822</td><td colspan="7"></td></tr><tr><td class="h">1823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It is not necessary the find the exact level; what we need to know</td></tr>
<tr><td class="h">1824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# is the relation of the security levels to each other.</td></tr>
<tr><td class="h">1825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (($level) = ($hwname =~ /(\d+)$/) and $level &lt;= 100) {</td></tr>
<tr><td class="h">1826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1828</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$level = 50;</td></tr>
<tr><td class="h">1829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1830</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{level} = $level;</td></tr>
<tr><td class="h">1831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1832</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">1833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1834</td><td colspan="7"></td></tr><tr><td class="h">1835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">1836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Moves attribute &#39;no_in_acl&#39; from interfaces to hardware because</td></tr>
<tr><td class="h">1837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACLs operate on hardware, not on logic. Marks hardware needing</td></tr>
<tr><td class="h">1838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoing ACLs.</td></tr>
<tr><td class="h">1839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Not more than 1 &#39;no_in_acl&#39; interface/router allowed.</td></tr>
<tr><td class="h">1840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_no_in_acl {</td></tr>
<tr><td class="h">1841</td><td><div class="c3">1408</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1841">1408</a></div></td><td><div class="c0">0</div></td><td><div>1405</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">1842</td><td><div class="c3">1408</div></td><td></td><td></td><td></td><td></td><td><div>1233</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_in_acl_counter = 0;</td></tr>
<tr><td class="h">1843</td><td colspan="7"></td></tr><tr><td class="h">1844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# At interfaces with no_in_acl move attribute to hardware.</td></tr>
<tr><td class="h">1845</td><td><div class="c3">1408</div><div class="c3">1408</div></td><td></td><td></td><td></td><td></td><td><div>1193</div><div>1800</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">1846</td><td><div class="c3">3174</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1846">100</a></div></td><td></td><td></td><td></td><td><div>5681</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{no_in_acl} or next;</td></tr>
<tr><td class="h">1847</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hardware = $interface-&gt;{hardware};</td></tr>
<tr><td class="h">1848</td><td colspan="7"></td></tr><tr><td class="h">1849</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent duplicate error message.</td></tr>
<tr><td class="h">1850</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1850">100</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hardware-&gt;{no_in_acl};</td></tr>
<tr><td class="h">1851</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{no_in_acl} = 1;</td></tr>
<tr><td class="h">1852</td><td colspan="7"></td></tr><tr><td class="h">1853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure max number of main interfaces at no_in_acl-hardware == 1.</td></tr>
<tr><td class="h">1854</td><td><div class="c3">20</div><div class="c3">22</div><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1854">100</a></div></td><td></td><td></td><td></td><td><div>22</div><div>74</div><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 == grep({ not $_-&gt;{main_interface} } @{ $hardware-&gt;{interfaces} })</td></tr>
<tr><td class="h">1855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">1856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Only one logical interface allowed at hardware&quot;,</td></tr>
<tr><td class="h">1857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;$hardware-&gt;{name}&#39; of $router-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">1858</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; because of attribute &#39;no_in_acl&#39;&quot;</td></tr>
<tr><td class="h">1859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1860</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_in_acl_counter++;</td></tr>
<tr><td class="h">1861</td><td colspan="7"></td></tr><tr><td class="h">1862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reference no_in_acl interface in router attribute.</td></tr>
<tr><td class="h">1863</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_in_acl} = $interface;</td></tr>
<tr><td class="h">1864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1865</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1865">100</a></div></td><td></td><td></td><td></td><td><div>2699</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$no_in_acl_counter or return;</td></tr>
<tr><td class="h">1866</td><td colspan="7"></td></tr><tr><td class="h">1867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Assert maximum number of &#39;no_in_acl&#39; interfaces per router</td></tr>
<tr><td class="h">1868</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1868">100</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;1 == $no_in_acl_counter</td></tr>
<tr><td class="h">1869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;At most one interface of $router-&gt;{name}&quot;,</td></tr>
<tr><td class="h">1870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; may use flag &#39;no_in_acl&#39;&quot;);</td></tr>
<tr><td class="h">1871</td><td colspan="7"></td></tr><tr><td class="h">1872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Assert router to support outgoing ACL</td></tr>
<tr><td class="h">1873</td><td><div class="c3">18</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1873">50</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{model}-&gt;{has_out_acl}</td></tr>
<tr><td class="h">1874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;$router-&gt;{name} doesn&#39;t support outgoing ACL&quot;);</td></tr>
<tr><td class="h">1875</td><td colspan="7"></td></tr><tr><td class="h">1876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Assert router not to take part in crypto tunnels.</td></tr>
<tr><td class="h">1877</td><td><div class="c3">18</div><div class="c3">54</div><div class="c3">18</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1877">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1877">50</a></div></td><td></td><td></td><td></td><td><div>18</div><div>174</div><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_-&gt;{hub} or $_-&gt;{spoke} } @{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">1878</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">1879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Don&#39;t use attribute &#39;no_in_acl&#39; together&quot;,</td></tr>
<tr><td class="h">1880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; with crypto tunnel at $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">1881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1883</td><td colspan="7"></td></tr><tr><td class="h">1884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mark other hardware with attribute &#39;need_out_acl&#39;.</td></tr>
<tr><td class="h">1885</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>21</div><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">1886</td><td><div class="c3">50</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1886">100</a></div></td><td></td><td></td><td></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{no_in_acl}</td></tr>
<tr><td class="h">1887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $hardware-&gt;{need_out_acl} = 1;</td></tr>
<tr><td class="h">1888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1889</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">1890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1891</td><td colspan="7"></td></tr><tr><td class="h">1892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $bind_nat0 = [];</td></tr>
<tr><td class="h">1893</td><td colspan="7"></td></tr><tr><td class="h">1894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %routers;</td></tr>
<tr><td class="h">1895</td><td colspan="7"></td></tr><tr><td class="h">1896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_router {</td></tr>
<tr><td class="h">1897</td><td><div class="c3">1839</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L1897">1839</a></div></td><td><div class="c0">0</div></td><td><div>1734</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">1898</td><td colspan="7"></td></tr><tr><td class="h">1899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Extract</td></tr>
<tr><td class="h">1900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - router name without prefix &quot;router:&quot;, needed to build interface name</td></tr>
<tr><td class="h">1901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - optional vrf name</td></tr>
<tr><td class="h">1902</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>8359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rname, $device_name, $vrf) =</td></tr>
<tr><td class="h">1903</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name =~ /^ router : ( (.*?) (?: \@ (.*) )? ) $/x;</td></tr>
<tr><td class="h">1904</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>2950</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = new(&#39;Router&#39;, name =&gt; $name, device_name =&gt; $device_name);</td></tr>
<tr><td class="h">1905</td><td><div class="c3">1839</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1905">100</a></div></td><td></td><td></td><td></td><td><div>3022</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined $vrf) {</td></tr>
<tr><td class="h">1906</td><td colspan="7"></td></tr><tr><td class="h">1907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# VRF value &quot;0&quot; would be interpreted as false by perl.</td></tr>
<tr><td class="h">1908</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1908">50</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vrf or error_atline(&quot;Must not use &#39;$vrf&#39; as VRF value&quot;);</td></tr>
<tr><td class="h">1909</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{vrf} = $vrf;</td></tr>
<tr><td class="h">1910</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1911</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>2300</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">1912</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>2624</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">1913</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>2739</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($router);</td></tr>
<tr><td class="h">1914</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>1711</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">1915</td><td><div class="c3">9671</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1915">100</a></div></td><td></td><td></td><td></td><td><div>11833</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">1916</td><td><div class="c3">7832</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1916">100</a></div></td><td></td><td></td><td></td><td><div>10609</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed = check_managed()) {</td></tr>
<tr><td class="h">1917</td><td><div class="c3">1423</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1917">50</a></div></td><td></td><td></td><td></td><td><div>2565</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed}</td></tr>
<tr><td class="h">1918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Redefining &#39;managed&#39; attribute&quot;);</td></tr>
<tr><td class="h">1919</td><td><div class="c3">1423</div></td><td></td><td></td><td></td><td></td><td><div>2036</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed} = $managed;</td></tr>
<tr><td class="h">1920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my @filter_only =</td></tr>
<tr><td class="h">1922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_assign_list(&#39;filter_only&#39;, \&amp;read_ip_prefix_pair))</td></tr>
<tr><td class="h">1923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">1924</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, filter_only =&gt; \@filter_only);</td></tr>
<tr><td class="h">1925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $model = check_model()) {</td></tr>
<tr><td class="h">1927</td><td><div class="c3">1447</div></td><td></td><td></td><td></td><td></td><td><div>2024</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, model =&gt; $model);</td></tr>
<tr><td class="h">1928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;no_group_code&#39;) {</td></tr>
<tr><td class="h">1930</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_group_code} = 1;</td></tr>
<tr><td class="h">1931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;no_crypto_filter&#39;) {</td></tr>
<tr><td class="h">1933</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_crypto_filter} = 1;</td></tr>
<tr><td class="h">1934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;no_protect_self&#39;) {</td></tr>
<tr><td class="h">1936</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_protect_self} = 1;</td></tr>
<tr><td class="h">1937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;log_deny&#39;) {</td></tr>
<tr><td class="h">1939</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{log_deny} = 1;</td></tr>
<tr><td class="h">1940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $routing = check_routing()) {</td></tr>
<tr><td class="h">1942</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>402</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, routing =&gt; $routing);</td></tr>
<tr><td class="h">1943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">1945</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, owner =&gt; $owner);</td></tr>
<tr><td class="h">1946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $radius_attributes = check_radius_attributes) {</td></tr>
<tr><td class="h">1948</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, radius_attributes =&gt; $radius_attributes);</td></tr>
<tr><td class="h">1949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair =</td></tr>
<tr><td class="h">1951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_assign(&#39;policy_distribution_point&#39;, \&amp;read_typed_name))</td></tr>
<tr><td class="h">1952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">1953</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, policy_distribution_point =&gt; $pair);</td></tr>
<tr><td class="h">1954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1955</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (</td></tr>
<tr><td class="h">1956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @list = check_assign_list(</td></tr>
<tr><td class="h">1957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;general_permit&#39;, \&amp;read_typed_name_or_simple_protocol</td></tr>
<tr><td class="h">1958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">1959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">1960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">1961</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($router, general_permit =&gt; \@list);</td></tr>
<tr><td class="h">1962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">1964</td><td><div class="c3">4536</div></td><td></td><td></td><td></td><td></td><td><div>5421</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pair = read_typed_name;</td></tr>
<tr><td class="h">1965</td><td><div class="c3">4536</div></td><td></td><td></td><td></td><td></td><td><div>6070</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name2) = @$pair;</td></tr>
<tr><td class="h">1966</td><td><div class="c3">4536</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1966">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1966">50</a></div></td><td></td><td></td><td></td><td><div>9287</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;log&#39;) {</td></tr>
<tr><td class="h">1967</td><td><div class="c3">72</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1967">50</a></div></td><td></td><td></td><td></td><td><div>151</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined($router-&gt;{log}-&gt;{$name2})</td></tr>
<tr><td class="h">1968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Duplicate &#39;log&#39; definition&quot;);</td></tr>
<tr><td class="h">1969</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1969">100</a></div></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $modifier = check(&#39;=&#39;) ? read_identifier() : 0;</td></tr>
<tr><td class="h">1970</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{log}-&gt;{$name2} = $modifier;</td></tr>
<tr><td class="h">1971</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip(&#39;;&#39;);</td></tr>
<tr><td class="h">1972</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">1973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type ne &#39;interface&#39;) {</td></tr>
<tr><td class="h">1975</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected interface or log definition&quot;);</td></tr>
<tr><td class="h">1976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1977</td><td colspan="7"></td></tr><tr><td class="h">1978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Derive interface name from router name.</td></tr>
<tr><td class="h">1979</td><td><div class="c3">4464</div></td><td></td><td></td><td></td><td></td><td><div>7450</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $iname = &quot;$rname.$name2&quot;;</td></tr>
<tr><td class="h">1980</td><td><div class="c3">4464</div></td><td></td><td></td><td></td><td></td><td><div>10134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (read_interface &quot;interface:$iname&quot;) {</td></tr>
<tr><td class="h">1981</td><td><div class="c3">4620</div><div class="c3">4620</div></td><td></td><td></td><td></td><td></td><td><div>3722</div><div>6866</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{interfaces} }, $interface;</td></tr>
<tr><td class="h">1982</td><td><div class="c3">4620</div></td><td></td><td></td><td></td><td></td><td><div>13505</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($iname = $interface-&gt;{name}) =~ s/interface://;</td></tr>
<tr><td class="h">1983</td><td><div class="c3">4620</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1983">100</a></div></td><td></td><td></td><td></td><td><div>9446</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interfaces{$iname}) {</td></tr>
<tr><td class="h">1984</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Redefining $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">1985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1986</td><td colspan="7"></td></tr><tr><td class="h">1987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assign interface to global hash of interfaces.</td></tr>
<tr><td class="h">1988</td><td><div class="c3">4620</div></td><td></td><td></td><td></td><td></td><td><div>7226</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interfaces{$iname} = $interface;</td></tr>
<tr><td class="h">1989</td><td colspan="7"></td></tr><tr><td class="h">1990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Link interface with router object.</td></tr>
<tr><td class="h">1991</td><td><div class="c3">4620</div></td><td></td><td></td><td></td><td></td><td><div>4692</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{router} = $router;</td></tr>
<tr><td class="h">1992</td><td colspan="7"></td></tr><tr><td class="h">1993</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Link interface with network name (will be resolved later).</td></tr>
<tr><td class="h">1994</td><td><div class="c3">4620</div></td><td></td><td></td><td></td><td></td><td><div>5404</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{network} = $name2;</td></tr>
<tr><td class="h">1995</td><td colspan="7"></td></tr><tr><td class="h">1996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set private attribute of interface.</td></tr>
<tr><td class="h">1997</td><td><div class="c3">4620</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L1997">100</a></div></td><td></td><td></td><td></td><td><div>16856</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">1998</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2001</td><td colspan="7"></td></tr><tr><td class="h">2002</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>2433</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">2003</td><td colspan="7"></td></tr><tr><td class="h">2004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Owner at vip interfaces is allowed for managed and unmanaged</td></tr>
<tr><td class="h">2005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# devices and hence must be checked for both.</td></tr>
<tr><td class="h">2006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2007</td><td><div class="c3">1839</div><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>1472</div><div>1437</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $error;</td></tr>
<tr><td class="h">2008</td><td><div class="c3">1839</div><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>1480</div><div>2618</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2009</td><td><div class="c3">4620</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2009">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2009">100</a></div><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2009">100</a></div></td><td></td><td></td><td><div>9388</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{vip} &amp;&amp; !($model &amp;&amp; $model-&gt;{has_vip})) {</td></tr>
<tr><td class="h">2010</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error = 1;</td></tr>
<tr><td class="h">2011</td><td colspan="7"></td></tr><tr><td class="h">2012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">2013</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{vip};</td></tr>
<tr><td class="h">2014</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{owner};</td></tr>
<tr><td class="h">2015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2017</td><td><div class="c3">1839</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2017">100</a></div></td><td></td><td></td><td></td><td><div>3149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($error) {</td></tr>
<tr><td class="h">2018</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $valid = join(</td></tr>
<tr><td class="h">2019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;, &#39;,</td></tr>
<tr><td class="h">2020</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $router_info{$_}-&gt;{has_vip} }</td></tr>
<tr><td class="h">2021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort keys %router_info)</td></tr>
<tr><td class="h">2022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2023</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">2024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not use attribute &#39;vip&#39; at $name\n&quot;,</td></tr>
<tr><td class="h">2025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;vip&#39; is only allowed for model $valid&quot;</td></tr>
<tr><td class="h">2026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2029</td><td colspan="7"></td></tr><tr><td class="h">2030</td><td><div class="c3">1839</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2030">100</a></div></td><td></td><td></td><td></td><td><div>3000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed = $router-&gt;{managed}) {</td></tr>
<tr><td class="h">2031</td><td><div class="c3">1423</div></td><td></td><td></td><td></td><td></td><td><div>1297</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $all_routing = $router-&gt;{routing};</td></tr>
<tr><td class="h">2032</td><td colspan="7"></td></tr><tr><td class="h">2033</td><td><div class="c3">1423</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2033">50</a></div></td><td></td><td></td><td></td><td><div>2221</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($model) {</td></tr>
<tr><td class="h">2034</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Missing &#39;model&#39; for managed $name&quot;);</td></tr>
<tr><td class="h">2035</td><td colspan="7"></td></tr><tr><td class="h">2036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">2037</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{model} = { name =&gt; &#39;unknown&#39; };</td></tr>
<tr><td class="h">2038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2039</td><td colspan="7"></td></tr><tr><td class="h">2040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Router is semi_managed if only routes are generated.</td></tr>
<tr><td class="h">2041</td><td><div class="c3">1423</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2041">100</a></div></td><td></td><td></td><td></td><td><div>2652</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed eq &#39;routing_only&#39;) {</td></tr>
<tr><td class="h">2042</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{semi_managed} = 1;</td></tr>
<tr><td class="h">2043</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{routing_only} = 1;</td></tr>
<tr><td class="h">2044</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $router-&gt;{managed};</td></tr>
<tr><td class="h">2045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2046</td><td colspan="7"></td></tr><tr><td class="h">2047</td><td><div class="c3">1423</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2047">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2047">67</a></div></td><td></td><td></td><td><div>2590</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{vrf}</td></tr>
<tr><td class="h">2048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $model-&gt;{can_vrf}</td></tr>
<tr><td class="h">2049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Must not use VRF at $name&quot;, &quot; of model $model-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2050</td><td colspan="7"></td></tr><tr><td class="h">2051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create objects representing hardware interfaces.</td></tr>
<tr><td class="h">2052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All logical interfaces using the same hardware are linked</td></tr>
<tr><td class="h">2053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to the same hardware object.</td></tr>
<tr><td class="h">2054</td><td><div class="c3">1423</div></td><td></td><td></td><td></td><td></td><td><div>1543</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %hardware;</td></tr>
<tr><td class="h">2055</td><td><div class="c3">1423</div><div class="c3">1423</div></td><td></td><td></td><td></td><td></td><td><div>1138</div><div>1778</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2056</td><td colspan="7"></td></tr><tr><td class="h">2057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Managed router must not have short interface.</td></tr>
<tr><td class="h">2058</td><td><div class="c3">3204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2058">100</a></div></td><td></td><td></td><td></td><td><div>4819</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} eq &#39;short&#39;) {</td></tr>
<tr><td class="h">2059</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Short definition of $interface-&gt;{name} not allowed&quot;;</td></tr>
<tr><td class="h">2060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2061</td><td colspan="7"></td></tr><tr><td class="h">2062</td><td><div class="c3">3204</div></td><td></td><td></td><td></td><td></td><td><div>3641</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hw_name = $interface-&gt;{hardware};</td></tr>
<tr><td class="h">2063</td><td colspan="7"></td></tr><tr><td class="h">2064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Interface of managed router needs to have a hardware</td></tr>
<tr><td class="h">2065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# name.</td></tr>
<tr><td class="h">2066</td><td><div class="c3">3204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2066">100</a></div></td><td></td><td></td><td></td><td><div>4852</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$hw_name) {</td></tr>
<tr><td class="h">2067</td><td colspan="7"></td></tr><tr><td class="h">2068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent duplicate error message.</td></tr>
<tr><td class="h">2069</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2069">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} ne &#39;short&#39;) {</td></tr>
<tr><td class="h">2070</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Missing &#39;hardware&#39; for $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2072</td><td colspan="7"></td></tr><tr><td class="h">2073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">2074</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hw_name = &#39;unknown&#39;;</td></tr>
<tr><td class="h">2075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2076</td><td colspan="7"></td></tr><tr><td class="h">2077</td><td><div class="c3">3204</div></td><td></td><td></td><td></td><td></td><td><div>2805</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hardware;</td></tr>
<tr><td class="h">2078</td><td><div class="c3">3204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2078">100</a></div></td><td></td><td></td><td></td><td><div>4754</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hardware = $hardware{$hw_name}) {</td></tr>
<tr><td class="h">2079</td><td colspan="7"></td></tr><tr><td class="h">2080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All logical interfaces of one hardware interface</td></tr>
<tr><td class="h">2081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# need to use the same NAT binding,</td></tr>
<tr><td class="h">2082</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because NAT operates on hardware, not on logic.</td></tr>
<tr><td class="h">2083</td><td><div class="c3">134</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2083">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2083">67</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2083">67</a></div></td><td></td><td></td><td><div>699</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_eq(</td></tr>
<tr><td class="h">2084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{bind_nat} || $bind_nat0,</td></tr>
<tr><td class="h">2085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{bind_nat}&nbsp;&nbsp;|| $bind_nat0</td></tr>
<tr><td class="h">2086</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">2087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;All logical interfaces of $hw_name\n&quot;,</td></tr>
<tr><td class="h">2088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $name must use identical NAT binding&quot;;</td></tr>
<tr><td class="h">2089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2090</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2091</td><td><div class="c3">3070</div></td><td></td><td></td><td></td><td></td><td><div>5800</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware = { name =&gt; $hw_name, loopback =&gt; 1 };</td></tr>
<tr><td class="h">2092</td><td><div class="c3">3070</div></td><td></td><td></td><td></td><td></td><td><div>3981</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware{$hw_name} = $hardware;</td></tr>
<tr><td class="h">2093</td><td><div class="c3">3070</div><div class="c3">3070</div></td><td></td><td></td><td></td><td></td><td><div>2333</div><div>4007</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{hardware} }, $hardware;</td></tr>
<tr><td class="h">2094</td><td><div class="c3">3070</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2094">100</a></div></td><td></td><td></td><td></td><td><div>4843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $nat = $interface-&gt;{bind_nat}) {</td></tr>
<tr><td class="h">2095</td><td><div class="c3">139</div></td><td></td><td></td><td></td><td></td><td><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{bind_nat} = $nat;</td></tr>
<tr><td class="h">2096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2097</td><td colspan="7"></td></tr><tr><td class="h">2098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Hardware name &#39;VIP&#39; is used internally at loadbalancers.</td></tr>
<tr><td class="h">2099</td><td><div class="c3">3070</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2099">50</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2099">75</a></div></td><td></td><td></td><td><div>5954</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hw_name eq &#39;VIP&#39;</td></tr>
<tr><td class="h">2100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $model-&gt;{has_vip}</td></tr>
<tr><td class="h">2101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $interface-&gt;{vip}</td></tr>
<tr><td class="h">2102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Must not use hardware &#39;VIP&#39; at&quot;,</td></tr>
<tr><td class="h">2103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2105</td><td><div class="c3">3204</div></td><td></td><td></td><td></td><td></td><td><div>3531</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hardware} = $hardware;</td></tr>
<tr><td class="h">2106</td><td colspan="7"></td></tr><tr><td class="h">2107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Hardware keeps attribute {loopback} only if all</td></tr>
<tr><td class="h">2108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interfaces have attribute {loopback}.</td></tr>
<tr><td class="h">2109</td><td><div class="c3">3204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2109">100</a></div></td><td></td><td></td><td></td><td><div>4614</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$interface-&gt;{loopback}) {</td></tr>
<tr><td class="h">2110</td><td><div class="c3">3154</div></td><td></td><td></td><td></td><td></td><td><div>3780</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $hardware-&gt;{loopback};</td></tr>
<tr><td class="h">2111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2112</td><td colspan="7"></td></tr><tr><td class="h">2113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember, which logical interfaces are bound</td></tr>
<tr><td class="h">2114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to which hardware.</td></tr>
<tr><td class="h">2115</td><td><div class="c3">3204</div><div class="c3">3204</div></td><td></td><td></td><td></td><td></td><td><div>2353</div><div>4209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware-&gt;{interfaces} }, $interface;</td></tr>
<tr><td class="h">2116</td><td colspan="7"></td></tr><tr><td class="h">2117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t allow &#39;routing=manual&#39; at single interface, because</td></tr>
<tr><td class="h">2118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# approve would remove manual routes otherwise.</td></tr>
<tr><td class="h">2119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Approve only leaves routes unchanged, if Netspoc generates</td></tr>
<tr><td class="h">2120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# no routes at all.</td></tr>
<tr><td class="h">2121</td><td><div class="c3">3204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2121">100</a></div></td><td></td><td></td><td></td><td><div>4878</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((my $routing = $interface-&gt;{routing})) {</td></tr>
<tr><td class="h">2122</td><td><div class="c3">22</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2122">50</a></div></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$routing-&gt;{name} eq &#39;manual&#39;</td></tr>
<tr><td class="h">2123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and warn_msg(</td></tr>
<tr><td class="h">2124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&#39;routing=manual&#39; must only be applied&quot;,</td></tr>
<tr><td class="h">2125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to router, not to $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">2126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2128</td><td colspan="7"></td></tr><tr><td class="h">2129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Interface inherits routing attribute from router.</td></tr>
<tr><td class="h">2130</td><td><div class="c3">3204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2130">100</a></div></td><td></td><td></td><td></td><td><div>4275</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($all_routing) {</td></tr>
<tr><td class="h">2131</td><td><div class="c3">704</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2131">33</a></div></td><td></td><td></td><td><div>1905</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{routing} ||= $all_routing;</td></tr>
<tr><td class="h">2132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2133</td><td><div class="c3">3204</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2133">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2133">67</a></div></td><td></td><td></td><td><div>10268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((my $routing = $interface-&gt;{routing})</td></tr>
<tr><td class="h">2134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $interface-&gt;{ip} eq &#39;unnumbered&#39;)</td></tr>
<tr><td class="h">2135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2136</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rname = $routing-&gt;{name};</td></tr>
<tr><td class="h">2137</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2137">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rname =~ /^(?:manual|dynamic)$/</td></tr>
<tr><td class="h">2138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(</td></tr>
<tr><td class="h">2139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Routing $rname not supported&quot;,</td></tr>
<tr><td class="h">2140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for unnumbered interface&quot;</td></tr>
<tr><td class="h">2141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2145</td><td><div class="c3">1839</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2145">100</a></div></td><td></td><td></td><td></td><td><div>3018</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed = $router-&gt;{managed}) {</td></tr>
<tr><td class="h">2146</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2146">100</a></div></td><td></td><td></td><td></td><td><div>3064</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed =~ /^local/) {</td></tr>
<tr><td class="h">2147</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2147">100</a></div></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{filter_only}</td></tr>
<tr><td class="h">2148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Missing attribute &#39;filter_only&#39; for $name&quot;);</td></tr>
<tr><td class="h">2149</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2149">50</a></div></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$model-&gt;{has_io_acl}</td></tr>
<tr><td class="h">2150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Must not use &#39;managed = $managed&#39; at $name&quot;,</td></tr>
<tr><td class="h">2151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of model $model-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2153</td><td><div class="c3">1408</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2153">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2153">67</a></div></td><td></td><td></td><td><div>3423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{log_deny}</td></tr>
<tr><td class="h">2154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $model-&gt;{can_log_deny}</td></tr>
<tr><td class="h">2155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Must not use attribute &#39;log_deny&#39; at $name&quot;,</td></tr>
<tr><td class="h">2156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of model $model-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2157</td><td colspan="7"></td></tr><tr><td class="h">2158</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2158">100</a></div></td><td></td><td></td><td></td><td><div>2657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $router-&gt;{log}) {</td></tr>
<tr><td class="h">2159</td><td><div class="c3">42</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2159">50</a></div></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $log_modifiers = $model-&gt;{log_modifiers}) {</td></tr>
<tr><td class="h">2160</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $name2 (sort keys %$hash) {</td></tr>
<tr><td class="h">2161</td><td colspan="7"></td></tr><tr><td class="h">2162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 0: simple unmodified &#39;log&#39; statement.</td></tr>
<tr><td class="h">2163</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2163">100</a></div></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $modifier = $hash-&gt;{$name2} or next;</td></tr>
<tr><td class="h">2164</td><td colspan="7"></td></tr><tr><td class="h">2165</td><td><div class="c3">66</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2165">100</a></div></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_modifiers-&gt;{$modifier} and next;</td></tr>
<tr><td class="h">2166</td><td colspan="7"></td></tr><tr><td class="h">2167</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $valid = join(&#39;|&#39;, sort keys %$log_modifiers);</td></tr>
<tr><td class="h">2168</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $what = &quot;&#39;log:$name2 = $modifier&#39; at $name&quot;</td></tr>
<tr><td class="h">2169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; of model $model-&gt;{name}&quot;;</td></tr>
<tr><td class="h">2170</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2170">100</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($valid) {</td></tr>
<tr><td class="h">2171</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Invalid $what\n Expected one of: $valid&quot;);</td></tr>
<tr><td class="h">2172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2174</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unexpected $what\n Use &#39;log:$name2;&#39; only.&quot;);</td></tr>
<tr><td class="h">2175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2179</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($name2) = sort keys %$hash;</td></tr>
<tr><td class="h">2180</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Must not use attribute &#39;log:$name2&#39; at $name&quot;,</td></tr>
<tr><td class="h">2181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of model $model-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2184</td><td colspan="7"></td></tr><tr><td class="h">2185</td><td><div class="c3">1408</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2185">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2185">67</a></div></td><td></td><td></td><td><div>2659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_protect_self}</td></tr>
<tr><td class="h">2186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $model-&gt;{need_protect}</td></tr>
<tr><td class="h">2187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Must not use attribute &#39;no_protect_self&#39; at $name&quot;,</td></tr>
<tr><td class="h">2188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of model $model-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2189</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2189">100</a></div></td><td></td><td></td><td></td><td><div>2434</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{need_protect}) {</td></tr>
<tr><td class="h">2190</td><td><div class="c3">375</div></td><td></td><td></td><td></td><td></td><td><div>772</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{need_protect} = !delete $router-&gt;{no_protect_self};</td></tr>
<tr><td class="h">2191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2192</td><td colspan="7"></td></tr><tr><td class="h">2193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Detailed interface processing for managed routers.</td></tr>
<tr><td class="h">2194</td><td><div class="c3">1408</div><div class="c3">1408</div></td><td></td><td></td><td></td><td></td><td><div>1118</div><div>2482</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2195</td><td><div class="c3">3174</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2195">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2195">33</a></div></td><td></td><td></td><td><div>5829</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined $interface-&gt;{security_level}</td></tr>
<tr><td class="h">2196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; !$model-&gt;{has_interface_level})</td></tr>
<tr><td class="h">2197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2198</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring attribute &#39;security_level&#39;&quot;,</td></tr>
<tr><td class="h">2199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2201</td><td><div class="c3">3174</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2201">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2201">100</a></div></td><td></td><td></td><td><div>9338</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{hub} or $interface-&gt;{spoke}) {</td></tr>
<tr><td class="h">2202</td><td><div class="c3">48</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2202">50</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$model-&gt;{crypto}</td></tr>
<tr><td class="h">2203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Crypto not supported for $name&quot;,</td></tr>
<tr><td class="h">2204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of model $model-&gt;{name}&quot;;</td></tr>
<tr><td class="h">2205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2206</td><td><div class="c3">3174</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2206">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2206">67</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2206">33</a></div></td><td></td><td></td><td><div>8198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{no_check}</td></tr>
<tr><td class="h">2207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not($interface-&gt;{hub} and $model-&gt;{do_auth}))</td></tr>
<tr><td class="h">2208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2209</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{no_check};</td></tr>
<tr><td class="h">2210</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring attribute &#39;no_check&#39; at $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2213</td><td colspan="7"></td></tr><tr><td class="h">2214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect bridged interfaces of this device and check</td></tr>
<tr><td class="h">2215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# existence of corresponding layer3 device.</td></tr>
<tr><td class="h">2216</td><td><div class="c3">1408</div></td><td></td><td></td><td></td><td></td><td><div>1381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %layer3_seen;</td></tr>
<tr><td class="h">2217</td><td><div class="c3">1408</div><div class="c3">1408</div></td><td></td><td></td><td></td><td></td><td><div>1127</div><div>2156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2218</td><td><div class="c3">3174</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2218">100</a></div></td><td></td><td></td><td></td><td><div>6323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $interface-&gt;{ip} eq &#39;bridged&#39;;</td></tr>
<tr><td class="h">2219</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $layer3_name = $interface-&gt;{name}) =~ s/^interface:(.*)\/.*/$1/;</td></tr>
<tr><td class="h">2220</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $layer3_intf;</td></tr>
<tr><td class="h">2221</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2221">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2221">50</a></div></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (exists $layer3_seen{$layer3_name}) {</td></tr>
<tr><td class="h">2222</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf = $layer3_seen{$layer3_name};</td></tr>
<tr><td class="h">2223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($layer3_intf = $interfaces{$layer3_name}) {</td></tr>
<tr><td class="h">2225</td><td colspan="7"></td></tr><tr><td class="h">2226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark layer3 interface as loopback interface internally,</td></tr>
<tr><td class="h">2227</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because we only have layer2 networks and no layer3 network.</td></tr>
<tr><td class="h">2228</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf-&gt;{loopback} = 1;</td></tr>
<tr><td class="h">2229</td><td colspan="7"></td></tr><tr><td class="h">2230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark layer3 interface as such to prevent warning in</td></tr>
<tr><td class="h">2231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# check_subnets.</td></tr>
<tr><td class="h">2232</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf-&gt;{is_layer3} = 1;</td></tr>
<tr><td class="h">2233</td><td colspan="7"></td></tr><tr><td class="h">2234</td><td><div class="c3">16</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2234">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{class} eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">2235</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2235">50</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf-&gt;{hardware}-&gt;{name} eq &#39;device&#39;</td></tr>
<tr><td class="h">2236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or</td></tr>
<tr><td class="h">2237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Layer3 $interface-&gt;{name} must use &#39;hardware&#39;&quot;,</td></tr>
<tr><td class="h">2238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; named &#39;device&#39; for model &#39;ASA&#39;&quot;);</td></tr>
<tr><td class="h">2239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2240</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2240">50</a></div></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($no_ip) =</td></tr>
<tr><td class="h">2241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf-&gt;{ip} =~</td></tr>
<tr><td class="h">2242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^(unnumbered|negotiated|short|bridged)$/)</td></tr>
<tr><td class="h">2243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2244</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Layer3 $layer3_intf-&gt;{name}&quot;,</td></tr>
<tr><td class="h">2245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must not be $no_ip&quot;);</td></tr>
<tr><td class="h">2246</td><td colspan="7"></td></tr><tr><td class="h">2247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">2248</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">2249</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_intf = undef;</td></tr>
<tr><td class="h">2250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2253</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Must define interface:$layer3_name for corresponding&quot;,</td></tr>
<tr><td class="h">2254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; bridge interfaces&quot;);</td></tr>
<tr><td class="h">2255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2256</td><td colspan="7"></td></tr><tr><td class="h">2257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Link bridged interface to corresponding layer3 interface.</td></tr>
<tr><td class="h">2258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Used in path_auto_interfaces.</td></tr>
<tr><td class="h">2259</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{layer3_interface} = $layer3_intf;</td></tr>
<tr><td class="h">2260</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$layer3_seen{$layer3_name} = $layer3_intf;</td></tr>
<tr><td class="h">2261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2262</td><td colspan="7"></td></tr><tr><td class="h">2263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Delete secondary interface of layer3 interface.</td></tr>
<tr><td class="h">2264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This prevents irritating error messages later.</td></tr>
<tr><td class="h">2265</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2265">100</a></div></td><td></td><td></td><td></td><td><div>3004</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (keys %layer3_seen) {</td></tr>
<tr><td class="h">2266</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $changed;</td></tr>
<tr><td class="h">2267</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2268</td><td><div class="c3">48</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2268">50</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $main = $interface-&gt;{main_interface} or next;</td></tr>
<tr><td class="h">2269</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2269">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($main-&gt;{is_layer3}) {</td></tr>
<tr><td class="h">2270</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">2271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Layer3 $main-&gt;{name} must not have&quot;,</td></tr>
<tr><td class="h">2272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; secondary $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">2273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2274</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface = undef;</td></tr>
<tr><td class="h">2275</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$changed&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">2276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2278</td><td><div class="c3">16</div><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2278">50</a></div></td><td></td><td></td><td></td><td><div>28</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{interfaces} = [ grep { $_ } @{ $router-&gt;{interfaces} } ]</td></tr>
<tr><td class="h">2279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $changed;</td></tr>
<tr><td class="h">2280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2281</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2281">100</a></div></td><td></td><td></td><td></td><td><div>2644</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{has_interface_level}) {</td></tr>
<tr><td class="h">2282</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>456</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_pix_interface_level($router);</td></tr>
<tr><td class="h">2283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2284</td><td colspan="7"></td></tr><tr><td class="h">2285</td><td><div class="c3">1408</div></td><td></td><td></td><td></td><td></td><td><div>1909</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_no_in_acl($router);</td></tr>
<tr><td class="h">2286</td><td colspan="7"></td></tr><tr><td class="h">2287</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2287">100</a></div></td><td></td><td></td><td></td><td><div>2861</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed =~ /^local/) {</td></tr>
<tr><td class="h">2288</td><td><div class="c3">64</div><div class="c3">130</div><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2288">100</a></div></td><td></td><td></td><td></td><td><div>53</div><div>210</div><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{bind_nat} } @{ $router-&gt;{interfaces} }</td></tr>
<tr><td class="h">2289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg &quot;Attribute &#39;bind_nat&#39; is not allowed&quot;,</td></tr>
<tr><td class="h">2290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at interface of $name with &#39;managed = $managed&#39;&quot;;</td></tr>
<tr><td class="h">2291</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2292</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2292">100</a></div></td><td></td><td></td><td></td><td><div>3294</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{do_auth}) {</td></tr>
<tr><td class="h">2293</td><td colspan="7"></td></tr><tr><td class="h">2294</td><td><div class="c3">16</div><div class="c3">28</div><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2294">50</a></div></td><td></td><td></td><td></td><td><div>14</div><div>50</div><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{hub} } @{ $router-&gt;{interfaces} }</td></tr>
<tr><td class="h">2295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Attribute &#39;hub&#39; needs to be defined&quot;,</td></tr>
<tr><td class="h">2296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;at an interface of $name of model $model-&gt;{name}&quot;;</td></tr>
<tr><td class="h">2297</td><td colspan="7"></td></tr><tr><td class="h">2298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t support NAT for VPN, otherwise code generation for VPN</td></tr>
<tr><td class="h">2299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# devices will become more difficult.</td></tr>
<tr><td class="h">2300</td><td><div class="c3">16</div><div class="c3">28</div><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2300">50</a></div></td><td></td><td></td><td></td><td><div>20</div><div>44</div><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{bind_nat} } @{ $router-&gt;{interfaces} }</td></tr>
<tr><td class="h">2301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg &quot;Attribute &#39;bind_nat&#39; is not allowed&quot;,</td></tr>
<tr><td class="h">2302</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at interface of $name of model $model-&gt;{name}&quot;;</td></tr>
<tr><td class="h">2303</td><td colspan="7"></td></tr><tr><td class="h">2304</td><td><div class="c3">16</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2304">50</a></div></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{radius_attributes} ||= {};</td></tr>
<tr><td class="h">2305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2307</td><td><div class="c3">1392</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2307">50</a></div></td><td></td><td></td><td></td><td><div>2222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{radius_attributes}</td></tr>
<tr><td class="h">2308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and warn_msg(&quot;Ignoring &#39;radius_attributes&#39; at $name&quot;);</td></tr>
<tr><td class="h">2309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2310</td><td><div class="c3">1408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2310">100</a></div></td><td></td><td></td><td></td><td><div>2361</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{no_crypto_filter}) {</td></tr>
<tr><td class="h">2311</td><td><div class="c3">971</div></td><td></td><td></td><td></td><td></td><td><div>1678</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_crypto_filter} = 1;</td></tr>
<tr><td class="h">2312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2314</td><td colspan="7"></td></tr><tr><td class="h">2315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Unmanaged device.</td></tr>
<tr><td class="h">2316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2317</td><td><div class="c3">431</div></td><td></td><td></td><td></td><td></td><td><div>448</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $bridged;</td></tr>
<tr><td class="h">2318</td><td><div class="c3">431</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2318">50</a></div></td><td></td><td></td><td></td><td><div>856</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (delete $router-&gt;{owner}) {</td></tr>
<tr><td class="h">2319</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring attribute &#39;owner&#39; at unmanaged $name&quot;);</td></tr>
<tr><td class="h">2320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2321</td><td><div class="c3">431</div><div class="c3">431</div></td><td></td><td></td><td></td><td></td><td><div>361</div><div>587</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2322</td><td><div class="c3">1446</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2322">50</a></div></td><td></td><td></td><td></td><td><div>1965</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{hub}) {</td></tr>
<tr><td class="h">2323</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Interface with attribute &#39;hub&#39; must only be&quot;,</td></tr>
<tr><td class="h">2324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; used at managed device&quot;);</td></tr>
<tr><td class="h">2325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2326</td><td><div class="c3">1446</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2326">50</a></div></td><td></td><td></td><td></td><td><div>2024</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (delete $interface-&gt;{reroute_permit}) {</td></tr>
<tr><td class="h">2327</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">2328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ignoring attribute &#39;reroute_permit&#39;&quot;,</td></tr>
<tr><td class="h">2329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at unmanaged $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">2330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2332</td><td><div class="c3">1446</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2332">50</a></div></td><td></td><td></td><td></td><td><div>2945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} eq &#39;bridged&#39;) {</td></tr>
<tr><td class="h">2333</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bridged = 1;</td></tr>
<tr><td class="h">2334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2336</td><td colspan="7"></td></tr><tr><td class="h">2337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Unmanaged bridge would complicate generation of static routes.</td></tr>
<tr><td class="h">2338</td><td><div class="c3">431</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2338">50</a></div></td><td></td><td></td><td></td><td><div>2526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($bridged) {</td></tr>
<tr><td class="h">2339</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Bridged interfaces must only be used&quot;,</td></tr>
<tr><td class="h">2340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at managed device&quot;);</td></tr>
<tr><td class="h">2341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2343</td><td colspan="7"></td></tr><tr><td class="h">2344</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>1492</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @move_locked;</td></tr>
<tr><td class="h">2345</td><td colspan="7"></td></tr><tr><td class="h">2346</td><td><div class="c3">1839</div><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>1417</div><div>2298</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">2347</td><td colspan="7"></td></tr><tr><td class="h">2348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Automatically create a network for loopback interface.</td></tr>
<tr><td class="h">2349</td><td><div class="c3">4673</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2349">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2349">100</a></div></td><td></td><td></td><td></td><td><div>9567</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{loopback}) {</td></tr>
<tr><td class="h">2350</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name;</td></tr>
<tr><td class="h">2351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_name;</td></tr>
<tr><td class="h">2352</td><td colspan="7"></td></tr><tr><td class="h">2353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Special handling needed for virtual loopback interfaces.</td></tr>
<tr><td class="h">2354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The created network needs to be shared among a group of</td></tr>
<tr><td class="h">2355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interfaces.</td></tr>
<tr><td class="h">2356</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2356">100</a></div></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{redundant}) {</td></tr>
<tr><td class="h">2357</td><td colspan="7"></td></tr><tr><td class="h">2358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Shared virtual loopback network gets name</td></tr>
<tr><td class="h">2359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# &#39;virtual:netname&#39;. Don&#39;t use standard name to prevent</td></tr>
<tr><td class="h">2360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# network from getting referenced from rules.</td></tr>
<tr><td class="h">2361</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net_name = &quot;virtual:$interface-&gt;{network}&quot;;</td></tr>
<tr><td class="h">2362</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;network:$net_name&quot;;</td></tr>
<tr><td class="h">2363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2365</td><td colspan="7"></td></tr><tr><td class="h">2366</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single loopback network needs not to get an unique name.</td></tr>
<tr><td class="h">2367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take an invalid name &#39;router.loopback&#39; to prevent name</td></tr>
<tr><td class="h">2368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# clashes with real networks or other loopback networks.</td></tr>
<tr><td class="h">2369</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = $interface-&gt;{name};</td></tr>
<tr><td class="h">2370</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>251</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($net_name = $name) =~ s/^interface://;</td></tr>
<tr><td class="h">2371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2372</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2372">100</a></div></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $networks{$net_name}) {</td></tr>
<tr><td class="h">2373</td><td><div class="c3">76</div></td><td></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = new(</td></tr>
<tr><td class="h">2374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">2375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $name,</td></tr>
<tr><td class="h">2376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; $interface-&gt;{ip},</td></tr>
<tr><td class="h">2377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; 0xffffffff,</td></tr>
<tr><td class="h">2378</td><td colspan="7"></td></tr><tr><td class="h">2379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark as automatically created.</td></tr>
<tr><td class="h">2380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loopback&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">2381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subnet_of =&gt; delete $interface-&gt;{subnet_of},</td></tr>
<tr><td class="h">2382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layer3 =&gt; $interface-&gt;{is_layer3},</td></tr>
<tr><td class="h">2383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2384</td><td><div class="c3">76</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2384">50</a></div></td><td></td><td></td><td></td><td><div>164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private = $interface-&gt;{private}) {</td></tr>
<tr><td class="h">2385</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{private} = $private;</td></tr>
<tr><td class="h">2386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2387</td><td><div class="c3">76</div></td><td></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$networks{$net_name} = $network;</td></tr>
<tr><td class="h">2388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2389</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{network} = $net_name;</td></tr>
<tr><td class="h">2390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2391</td><td colspan="7"></td></tr><tr><td class="h">2392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Generate tunnel interface.</td></tr>
<tr><td class="h">2393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $crypto = $interface-&gt;{spoke}) {</td></tr>
<tr><td class="h">2394</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_name&nbsp;&nbsp;&nbsp;&nbsp;= &quot;tunnel:$rname&quot;;</td></tr>
<tr><td class="h">2395</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $iname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;$rname.$net_name&quot;;</td></tr>
<tr><td class="h">2396</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tunnel_intf = new(</td></tr>
<tr><td class="h">2397</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Interface&#39;,</td></tr>
<tr><td class="h">2398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &quot;interface:$iname&quot;,</td></tr>
<tr><td class="h">2399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;tunnel&#39;,</td></tr>
<tr><td class="h">2400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $router,</td></tr>
<tr><td class="h">2401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $net_name,</td></tr>
<tr><td class="h">2402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real_interface =&gt; $interface</td></tr>
<tr><td class="h">2403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2404</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (qw(hardware routing private bind_nat id)) {</td></tr>
<tr><td class="h">2405</td><td><div class="c3">265</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2405">100</a></div></td><td></td><td></td><td></td><td><div>436</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{$key}) {</td></tr>
<tr><td class="h">2406</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tunnel_intf-&gt;{$key} = $interface-&gt;{$key};</td></tr>
<tr><td class="h">2407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2409</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2409">50</a></div></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interfaces{$iname}) {</td></tr>
<tr><td class="h">2410</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Redefining $tunnel_intf-&gt;{name}&quot;);</td></tr>
<tr><td class="h">2411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2412</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interfaces{$iname} = $tunnel_intf;</td></tr>
<tr><td class="h">2413</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>41</div><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{interfaces} }, $tunnel_intf;</td></tr>
<tr><td class="h">2414</td><td colspan="7"></td></tr><tr><td class="h">2415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create tunnel network.</td></tr>
<tr><td class="h">2416</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tunnel_net = new(</td></tr>
<tr><td class="h">2417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">2418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;network:$net_name&quot;,</td></tr>
<tr><td class="h">2419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; &#39;tunnel&#39;</td></tr>
<tr><td class="h">2420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2421</td><td><div class="c3">53</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2421">100</a></div></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private = $interface-&gt;{private}) {</td></tr>
<tr><td class="h">2422</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tunnel_net-&gt;{private} = $private;</td></tr>
<tr><td class="h">2423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2424</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$networks{$net_name} = $tunnel_net;</td></tr>
<tr><td class="h">2425</td><td colspan="7"></td></tr><tr><td class="h">2426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Tunnel network will later be attached to crypto hub.</td></tr>
<tr><td class="h">2427</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>43</div><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $crypto2spokes{$crypto} }, $tunnel_net;</td></tr>
<tr><td class="h">2428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2429</td><td colspan="7"></td></tr><tr><td class="h">2430</td><td><div class="c3">4673</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2430">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2430">100</a></div></td><td></td><td></td><td><div>16691</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($interface-&gt;{spoke} || $interface-&gt;{hub})</td></tr>
<tr><td class="h">2431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; !$interface-&gt;{no_check})</td></tr>
<tr><td class="h">2432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2433</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @move_locked, $interface;</td></tr>
<tr><td class="h">2434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2436</td><td colspan="7"></td></tr><tr><td class="h">2437</td><td><div class="c3">1839</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2437">100</a></div></td><td></td><td></td><td></td><td><div>3618</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;move_locked_interfaces(\@move_locked) if @move_locked;</td></tr>
<tr><td class="h">2438</td><td colspan="7"></td></tr><tr><td class="h">2439</td><td><div class="c3">1839</div></td><td></td><td></td><td></td><td></td><td><div>2864</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $router;</td></tr>
<tr><td class="h">2440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2441</td><td colspan="7"></td></tr><tr><td class="h">2442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># No traffic must traverse crypto or secondary interface.</td></tr>
<tr><td class="h">2443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hence split router into separate instances, one instance for each</td></tr>
<tr><td class="h">2444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># crypto/secondary interface.</td></tr>
<tr><td class="h">2445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Splitted routers are tied by identical attribute {device_name}.</td></tr>
<tr><td class="h">2446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub move_locked_interfaces {</td></tr>
<tr><td class="h">2447</td><td><div class="c3">84</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2447">84</a></div></td><td><div class="c0">0</div></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interfaces) = @_;</td></tr>
<tr><td class="h">2448</td><td><div class="c3">84</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$interfaces) {</td></tr>
<tr><td class="h">2449</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $orig_router = $interface-&gt;{router};</td></tr>
<tr><td class="h">2450</td><td colspan="7"></td></tr><tr><td class="h">2451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use different and uniqe name, because name is used as hash</td></tr>
<tr><td class="h">2452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# key in group_rules.</td></tr>
<tr><td class="h">2453</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{name}) =~ s/^interface:/router/;</td></tr>
<tr><td class="h">2454</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_router&nbsp;&nbsp;= new(</td></tr>
<tr><td class="h">2455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Router&#39;,</td></tr>
<tr><td class="h">2456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%$orig_router,</td></tr>
<tr><td class="h">2457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $name,</td></tr>
<tr><td class="h">2458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orig_router =&gt; $orig_router,</td></tr>
<tr><td class="h">2459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interfaces&nbsp;&nbsp;=&gt; [$interface]</td></tr>
<tr><td class="h">2460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2461</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{router} = $new_router;</td></tr>
<tr><td class="h">2462</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @router_fragments, $new_router;</td></tr>
<tr><td class="h">2463</td><td colspan="7"></td></tr><tr><td class="h">2464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t check fragment for reachability.</td></tr>
<tr><td class="h">2465</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $new_router-&gt;{policy_distribution_point};</td></tr>
<tr><td class="h">2466</td><td colspan="7"></td></tr><tr><td class="h">2467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove interface from old router.</td></tr>
<tr><td class="h">2468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Retain copy of original interfaces.</td></tr>
<tr><td class="h">2469</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $interfaces = $orig_router-&gt;{interfaces};</td></tr>
<tr><td class="h">2470</td><td><div class="c3">86</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2470">100</a></div></td><td></td><td></td><td><div>311</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_router-&gt;{orig_interfaces} ||= [@$interfaces];</td></tr>
<tr><td class="h">2471</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_delete($interfaces, $interface);</td></tr>
<tr><td class="h">2472</td><td colspan="7"></td></tr><tr><td class="h">2473</td><td><div class="c3">86</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2473">100</a></div></td><td></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($orig_router-&gt;{managed}) {</td></tr>
<tr><td class="h">2474</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hardware = $interface-&gt;{hardware};</td></tr>
<tr><td class="h">2475</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_router-&gt;{hardware} = [$hardware];</td></tr>
<tr><td class="h">2476</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hw_list = $orig_router-&gt;{hardware};</td></tr>
<tr><td class="h">2477</td><td colspan="7"></td></tr><tr><td class="h">2478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Retain copy of original hardware.</td></tr>
<tr><td class="h">2479</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_router-&gt;{orig_hardware} = [@$hw_list];</td></tr>
<tr><td class="h">2480</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_delete($hw_list, $hardware);</td></tr>
<tr><td class="h">2481</td><td><div class="c3">42</div><div class="c3">42</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2481">50</a></div></td><td></td><td></td><td></td><td><div>35</div><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 == @{ $hardware-&gt;{interfaces} }</td></tr>
<tr><td class="h">2482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Crypto $interface-&gt;{name} must not share hardware&quot;,</td></tr>
<tr><td class="h">2483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; with other interfaces&quot;);</td></tr>
<tr><td class="h">2484</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2484">100</a></div></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $orig_router-&gt;{radius_attributes}) {</td></tr>
<tr><td class="h">2485</td><td colspan="7"></td></tr><tr><td class="h">2486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Copy hash, because it is changed per device later.</td></tr>
<tr><td class="h">2487</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_router-&gt;{radius_attributes} = {%$hash};</td></tr>
<tr><td class="h">2488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2491</td><td><div class="c3">84</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">2492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2493</td><td colspan="7"></td></tr><tr><td class="h">2494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %aggregates;</td></tr>
<tr><td class="h">2495</td><td colspan="7"></td></tr><tr><td class="h">2496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_aggregate {</td></tr>
<tr><td class="h">2497</td><td><div class="c3">106</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2497">106</a></div></td><td><div class="c0">0</div></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">2498</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $aggregate = new(&#39;Network&#39;, name =&gt; $name, is_aggregate =&gt; 1);</td></tr>
<tr><td class="h">2499</td><td><div class="c3">106</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2499">50</a></div></td><td></td><td></td><td></td><td><div>269</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">2500</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2501</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">2502</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($aggregate);</td></tr>
<tr><td class="h">2503</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">2504</td><td><div class="c3">296</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2504">100</a></div></td><td></td><td></td><td></td><td><div>1224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">2505</td><td><div class="c3">190</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2505">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2505">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2505">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2505">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2505">50</a></div></td><td></td><td></td><td></td><td><div>363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($ip, $mask) = check_assign &#39;ip&#39;, \&amp;read_ip_prefix) {</td></tr>
<tr><td class="h">2506</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($aggregate, ip&nbsp;&nbsp;&nbsp;=&gt; $ip);</td></tr>
<tr><td class="h">2507</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($aggregate, mask =&gt; $mask);</td></tr>
<tr><td class="h">2508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">2510</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($aggregate, owner =&gt; $owner);</td></tr>
<tr><td class="h">2511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $link = check_assign &#39;link&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">2513</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($aggregate, link =&gt; $link);</td></tr>
<tr><td class="h">2514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;has_unenforceable&#39;) {</td></tr>
<tr><td class="h">2516</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{has_unenforceable} = 1;</td></tr>
<tr><td class="h">2517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $nat_name = check_nat_name()) {</td></tr>
<tr><td class="h">2519</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = read_nat(&quot;nat:$nat_name&quot;);</td></tr>
<tr><td class="h">2520</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2520">50</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{dynamic} or error_atline(&quot;$nat-&gt;{name} must be dynamic&quot;);</td></tr>
<tr><td class="h">2521</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2521">50</a></div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{nat}-&gt;{$nat_name}</td></tr>
<tr><td class="h">2522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Duplicate NAT definition&quot;);</td></tr>
<tr><td class="h">2523</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{nat}-&gt;{$nat_name} = $nat;</td></tr>
<tr><td class="h">2524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2525</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2526</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected some valid attribute&quot;);</td></tr>
<tr><td class="h">2527</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2529</td><td><div class="c3">106</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2529">50</a></div></td><td></td><td></td><td></td><td><div>259</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{link} or err_msg(&quot;Attribute &#39;link&#39; must be defined for $name&quot;);</td></tr>
<tr><td class="h">2530</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip&nbsp;&nbsp;&nbsp;= $aggregate-&gt;{ip};</td></tr>
<tr><td class="h">2531</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mask = $aggregate-&gt;{mask};</td></tr>
<tr><td class="h">2532</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2532">100</a></div></td><td></td><td></td><td></td><td><div>163</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($ip) {</td></tr>
<tr><td class="h">2533</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$aggregate) {</td></tr>
<tr><td class="h">2534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</td></tr>
<tr><td class="h">2535</td><td><div class="c3">224</div><div class="c3">1568</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2535">50</a></div></td><td></td><td></td><td></td><td><div>221</div><div>2003</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if grep({ $key eq $_ }</td></tr>
<tr><td class="h">2536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qw( name ip mask link is_aggregate private nat));</td></tr>
<tr><td class="h">2537</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Must not use attribute $key if mask is set&quot;);</td></tr>
<tr><td class="h">2538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2541</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{ip} = $aggregate-&gt;{mask} = 0;</td></tr>
<tr><td class="h">2542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2543</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $aggregate;</td></tr>
<tr><td class="h">2544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2545</td><td colspan="7"></td></tr><tr><td class="h">2546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_router_attributes {</td></tr>
<tr><td class="h">2547</td><td><div class="c3">26</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2547">26</a></div></td><td><div class="c0">0</div></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($parent) = @_;</td></tr>
<tr><td class="h">2548</td><td colspan="7"></td></tr><tr><td class="h">2549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Add name for error messages.</td></tr>
<tr><td class="h">2550</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = { name =&gt; &quot;router_attributes of $parent&quot; };</td></tr>
<tr><td class="h">2551</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2551">100</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check &#39;router_attributes&#39; or return;</td></tr>
<tr><td class="h">2552</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2553</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">2554</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">2555</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2555">100</a></div></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">2556</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2556">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2556">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2556">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">2557</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($result, owner =&gt; $owner);</td></tr>
<tr><td class="h">2558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair =</td></tr>
<tr><td class="h">2560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_assign(&#39;policy_distribution_point&#39;, \&amp;read_typed_name))</td></tr>
<tr><td class="h">2561</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2562</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($result, policy_distribution_point =&gt; $pair);</td></tr>
<tr><td class="h">2563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (</td></tr>
<tr><td class="h">2565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @list = check_assign_list(</td></tr>
<tr><td class="h">2566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;general_permit&#39;, \&amp;read_typed_name_or_simple_protocol</td></tr>
<tr><td class="h">2567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">2568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">2569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2570</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($result, general_permit =&gt; \@list);</td></tr>
<tr><td class="h">2571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2573</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Unexpected attribute&quot;);</td></tr>
<tr><td class="h">2574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2576</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">2577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2578</td><td colspan="7"></td></tr><tr><td class="h">2579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %areas;</td></tr>
<tr><td class="h">2580</td><td colspan="7"></td></tr><tr><td class="h">2581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_area {</td></tr>
<tr><td class="h">2582</td><td><div class="c3">132</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2582">132</a></div></td><td><div class="c0">0</div></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">2583</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>193</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $area = new(&#39;Area&#39;, name =&gt; $name);</td></tr>
<tr><td class="h">2584</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2585</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">2586</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($area);</td></tr>
<tr><td class="h">2587</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">2588</td><td><div class="c3">352</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2588">100</a></div></td><td></td><td></td><td></td><td><div>437</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">2589</td><td><div class="c3">220</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2589">50</a></div></td><td></td><td></td><td></td><td><div>415</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @elements = check_assign_list(&#39;border&#39;, \&amp;read_intersection)) {</td></tr>
<tr><td class="h">2590</td><td><div class="c3">80</div><div class="c3">88</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2590">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2590">50</a></div></td><td></td><td></td><td></td><td><div>107</div><div>459</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_-&gt;[0] ne &#39;interface&#39; || ref $_-&gt;[1] } @elements) {</td></tr>
<tr><td class="h">2591</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline &quot;Must only use interface names in border&quot;;</td></tr>
<tr><td class="h">2592</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@elements = ();</td></tr>
<tr><td class="h">2593</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2594</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($area, border =&gt; \@elements);</td></tr>
<tr><td class="h">2595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (@elements =</td></tr>
<tr><td class="h">2597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_assign_list(&#39;inclusive_border&#39;, \&amp;read_intersection))</td></tr>
<tr><td class="h">2598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2599</td><td><div class="c3">24</div><div class="c3">36</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2599">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2599">50</a></div></td><td></td><td></td><td></td><td><div>35</div><div>185</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_-&gt;[0] ne &#39;interface&#39; || ref $_-&gt;[1] } @elements) {</td></tr>
<tr><td class="h">2600</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline &quot;Must only use interface names in border&quot;;</td></tr>
<tr><td class="h">2601</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@elements = ();</td></tr>
<tr><td class="h">2602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2603</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($area, inclusive_border =&gt; \@elements);</td></tr>
<tr><td class="h">2604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;auto_border&#39;) {</td></tr>
<tr><td class="h">2606</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{auto_border} = 1;</td></tr>
<tr><td class="h">2607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $pair = check_assign &#39;anchor&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">2609</td><td><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2609">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2609">33</a></div></td><td></td><td></td><td><div>178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($pair-&gt;[0] ne &#39;network&#39; || ref $pair-&gt;[1]) {</td></tr>
<tr><td class="h">2610</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline &quot;Must only use network name in &#39;anchor&#39;&quot;;</td></tr>
<tr><td class="h">2611</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pair = undef;</td></tr>
<tr><td class="h">2612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2613</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($area, anchor =&gt; $pair);</td></tr>
<tr><td class="h">2614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $owner = check_assign &#39;owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">2616</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($area, owner =&gt; $owner);</td></tr>
<tr><td class="h">2617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $router_attributes = check_router_attributes($name)) {</td></tr>
<tr><td class="h">2619</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($area, router_attributes =&gt; $router_attributes);</td></tr>
<tr><td class="h">2620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $nat_name = check_nat_name()) {</td></tr>
<tr><td class="h">2622</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = read_nat(&quot;nat:$nat_name&quot;);</td></tr>
<tr><td class="h">2623</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2623">50</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{dynamic} or error_atline(&quot;$nat-&gt;{name} must be dynamic&quot;);</td></tr>
<tr><td class="h">2624</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2624">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{nat}-&gt;{$nat_name}</td></tr>
<tr><td class="h">2625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Duplicate NAT definition&quot;);</td></tr>
<tr><td class="h">2626</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{nat}-&gt;{$nat_name} = $nat;</td></tr>
<tr><td class="h">2627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2629</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected some valid attribute&quot;);</td></tr>
<tr><td class="h">2630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2632</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2632">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2632">60</a></div></td><td></td><td></td><td><div>720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(($area-&gt;{border} || $area-&gt;{inclusive_border}) &amp;&amp; $area-&gt;{anchor})</td></tr>
<tr><td class="h">2633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(</td></tr>
<tr><td class="h">2634</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Attribute &#39;anchor&#39; must not be defined together with&quot;,</td></tr>
<tr><td class="h">2635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;border&#39; or &#39;inclusive_border&#39; for $name&quot;</td></tr>
<tr><td class="h">2636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2637</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2637">50</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2637">75</a></div></td><td></td><td></td><td><div>525</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;($area-&gt;{anchor} || $area-&gt;{border} || $area-&gt;{inclusive_border})</td></tr>
<tr><td class="h">2638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;At least one of attributes &#39;border&#39;, &#39;inclusive_border&#39;&quot;,</td></tr>
<tr><td class="h">2639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; or &#39;anchor&#39; must be defined for $name&quot;);</td></tr>
<tr><td class="h">2640</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $area;</td></tr>
<tr><td class="h">2641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2642</td><td colspan="7"></td></tr><tr><td class="h">2643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %groups;</td></tr>
<tr><td class="h">2644</td><td colspan="7"></td></tr><tr><td class="h">2645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_group {</td></tr>
<tr><td class="h">2646</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2646">18</a></div></td><td><div class="c0">0</div></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">2647</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2648</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $group = new(&#39;Group&#39;, name =&gt; $name);</td></tr>
<tr><td class="h">2649</td><td><div class="c3">18</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2649">50</a></div></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$group-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">2650</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($group);</td></tr>
<tr><td class="h">2651</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @elements = read_list_or_null \&amp;read_intersection;</td></tr>
<tr><td class="h">2652</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$group-&gt;{elements} = \@elements;</td></tr>
<tr><td class="h">2653</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $group;</td></tr>
<tr><td class="h">2654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2655</td><td colspan="7"></td></tr><tr><td class="h">2656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %protocolgroups;</td></tr>
<tr><td class="h">2657</td><td colspan="7"></td></tr><tr><td class="h">2658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_protocolgroup {</td></tr>
<tr><td class="h">2659</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2659">4</a></div></td><td><div class="c0">0</div></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">2660</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2661</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @pairs = read_list_or_null \&amp;read_typed_name_or_simple_protocol;</td></tr>
<tr><td class="h">2662</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return new(&#39;Protocolgroup&#39;, name =&gt; $name, elements =&gt; \@pairs);</td></tr>
<tr><td class="h">2663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2664</td><td colspan="7"></td></tr><tr><td class="h">2665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_port_range {</td></tr>
<tr><td class="h">2666</td><td><div class="c3">854</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2666">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2666">854</a></div></td><td><div class="c0">0</div></td><td><div>958</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $port1 = check_int)) {</td></tr>
<tr><td class="h">2667</td><td><div class="c3">814</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2667">50</a></div></td><td></td><td></td><td></td><td><div>1504</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Too large port number $port1&quot;) if $port1 &gt; 65535;</td></tr>
<tr><td class="h">2668</td><td><div class="c3">814</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2668">50</a></div></td><td></td><td></td><td></td><td><div>1218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid port number &#39;0&#39;&quot;) if $port1 == 0;</td></tr>
<tr><td class="h">2669</td><td><div class="c3">814</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2669">100</a></div></td><td></td><td></td><td></td><td><div>1012</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;-&#39;) {</td></tr>
<tr><td class="h">2670</td><td><div class="c3">64</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2670">50</a></div></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $port2 = check_int)) {</td></tr>
<tr><td class="h">2671</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2671">50</a></div></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Too large port number $port2&quot;) if $port2 &gt; 65535;</td></tr>
<tr><td class="h">2672</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2672">50</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid port number &#39;0&#39;&quot;) if $port2 == 0;</td></tr>
<tr><td class="h">2673</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2673">50</a></div></td><td></td><td></td><td></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid port range $port1-$port2&quot;)</td></tr>
<tr><td class="h">2674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $port1 &gt; $port2;</td></tr>
<tr><td class="h">2675</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2675">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2675">67</a></div></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($port1 == 1 &amp;&amp; $port2 == 65535) {</td></tr>
<tr><td class="h">2676</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $aref_tcp_any;</td></tr>
<tr><td class="h">2677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2679</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $port1, $port2 ];</td></tr>
<tr><td class="h">2680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2683</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Missing second port in port range&quot;);</td></tr>
<tr><td class="h">2684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2687</td><td><div class="c3">750</div></td><td></td><td></td><td></td><td></td><td><div>1675</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $port1, $port1 ];</td></tr>
<tr><td class="h">2688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2691</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $aref_tcp_any;</td></tr>
<tr><td class="h">2692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2694</td><td colspan="7"></td></tr><tr><td class="h">2695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_port_ranges {</td></tr>
<tr><td class="h">2696</td><td><div class="c3">838</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2696">838</a></div></td><td><div class="c0">0</div></td><td><div>798</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt) = @_;</td></tr>
<tr><td class="h">2697</td><td><div class="c3">838</div></td><td></td><td></td><td></td><td></td><td><div>1021</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $range = read_port_range;</td></tr>
<tr><td class="h">2698</td><td><div class="c3">838</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2698">100</a></div></td><td></td><td></td><td></td><td><div>1284</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;:&#39;) {</td></tr>
<tr><td class="h">2699</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2699">100</a></div></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($range ne $aref_tcp_any) {</td></tr>
<tr><td class="h">2700</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{src_range} = $range;</td></tr>
<tr><td class="h">2701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2702</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{dst_range} = read_port_range;</td></tr>
<tr><td class="h">2703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2705</td><td><div class="c3">822</div></td><td></td><td></td><td></td><td></td><td><div>1140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{dst_range} = $range;</td></tr>
<tr><td class="h">2706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2707</td><td><div class="c3">838</div></td><td></td><td></td><td></td><td></td><td><div>1041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">2708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2709</td><td colspan="7"></td></tr><tr><td class="h">2710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_icmp_type_code {</td></tr>
<tr><td class="h">2711</td><td><div class="c3">108</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2711">108</a></div></td><td><div class="c0">0</div></td><td><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt) = @_;</td></tr>
<tr><td class="h">2712</td><td><div class="c3">108</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2712">100</a></div></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $type = check_int)) {</td></tr>
<tr><td class="h">2713</td><td><div class="c3">92</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2713">50</a></div></td><td></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Too large ICMP type $type&quot;) if $type &gt; 255;</td></tr>
<tr><td class="h">2714</td><td><div class="c3">92</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2714">100</a></div></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;/&#39;) {</td></tr>
<tr><td class="h">2715</td><td><div class="c3">30</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2715">50</a></div></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $code = check_int)) {</td></tr>
<tr><td class="h">2716</td><td><div class="c3">30</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2716">50</a></div></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Too large ICMP code $code&quot;) if $code &gt; 255;</td></tr>
<tr><td class="h">2717</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{type} = $type;</td></tr>
<tr><td class="h">2718</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{code} = $code;</td></tr>
<tr><td class="h">2719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2721</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected ICMP code&quot;);</td></tr>
<tr><td class="h">2722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2725</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{type} = $type;</td></tr>
<tr><td class="h">2726</td><td><div class="c3">62</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2726">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2726">75</a></div></td><td></td><td></td><td><div>330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type == 0 || $type == 3 || $type == 11) {</td></tr>
<tr><td class="h">2727</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{flags}-&gt;{stateless_icmp} = 1;</td></tr>
<tr><td class="h">2728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2732</td><td colspan="7"></td></tr><tr><td class="h">2733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No type and code given.</td></tr>
<tr><td class="h">2734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2735</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">2736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2737</td><td colspan="7"></td></tr><tr><td class="h">2738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_proto_nr {</td></tr>
<tr><td class="h">2739</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2739">8</a></div></td><td><div class="c0">0</div></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt) = @_;</td></tr>
<tr><td class="h">2740</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2740">50</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $nr = check_int)) {</td></tr>
<tr><td class="h">2741</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2741">50</a></div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Too large protocol number $nr&quot;) if $nr &gt; 255;</td></tr>
<tr><td class="h">2742</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2742">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Invalid protocol number &#39;0&#39;&quot;)&nbsp;&nbsp;&nbsp;if $nr == 0;</td></tr>
<tr><td class="h">2743</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2743">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2743">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2743">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nr == 1) {</td></tr>
<tr><td class="h">2744</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{proto} = &#39;icmp&#39;;</td></tr>
<tr><td class="h">2745</td><td colspan="7"></td></tr><tr><td class="h">2746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No ICMP type and code given.</td></tr>
<tr><td class="h">2747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nr == 4) {</td></tr>
<tr><td class="h">2749</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{proto}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &#39;tcp&#39;;</td></tr>
<tr><td class="h">2750</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{dst_range} = $aref_tcp_any;</td></tr>
<tr><td class="h">2751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nr == 17) {</td></tr>
<tr><td class="h">2753</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{proto}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &#39;udp&#39;;</td></tr>
<tr><td class="h">2754</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{dst_range} = $aref_tcp_any;</td></tr>
<tr><td class="h">2755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2757</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{proto} = $nr;</td></tr>
<tr><td class="h">2758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2761</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected protocol number&quot;);</td></tr>
<tr><td class="h">2762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2763</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">2764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2765</td><td colspan="7"></td></tr><tr><td class="h">2766</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub gen_protocol_name {</td></tr>
<tr><td class="h">2767</td><td><div class="c3">962</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2767">962</a></div></td><td><div class="c0">0</div></td><td><div>804</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($protocol) = @_;</td></tr>
<tr><td class="h">2768</td><td><div class="c3">962</div></td><td></td><td></td><td></td><td></td><td><div>1010</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $protocol-&gt;{proto};</td></tr>
<tr><td class="h">2769</td><td><div class="c3">962</div></td><td></td><td></td><td></td><td></td><td><div>832</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $proto;</td></tr>
<tr><td class="h">2770</td><td colspan="7"></td></tr><tr><td class="h">2771</td><td><div class="c3">962</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2771">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2771">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2771">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2771">100</a></div></td><td></td><td></td><td><div>2707</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($proto eq &#39;ip&#39;) {</td></tr>
<tr><td class="h">2772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;tcp&#39; or $proto eq &#39;udp&#39;) {</td></tr>
<tr><td class="h">2774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $port_name = sub {</td></tr>
<tr><td class="h">2775</td><td><div class="c3">808</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2775">808</a></div></td><td></td><td><div>1198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($v1, $v2) = @_;</td></tr>
<tr><td class="h">2776</td><td><div class="c3">808</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2776">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2776">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2776">67</a></div></td><td></td><td></td><td><div>1315</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($v1 == $v2) {</td></tr>
<tr><td class="h">2777</td><td><div class="c3">716</div></td><td></td><td></td><td></td><td></td><td><div>1101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($v1);</td></tr>
<tr><td class="h">2778</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($v1 == 1 and $v2 == 65535) {</td></tr>
<tr><td class="h">2780</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (&#39;&#39;);</td></tr>
<tr><td class="h">2781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2783</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (&quot;$v1-$v2&quot;);</td></tr>
<tr><td class="h">2784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2785</td><td><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>2488</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">2786</td><td><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>915</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range = $protocol-&gt;{src_range};</td></tr>
<tr><td class="h">2787</td><td><div class="c3">808</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2787">33</a></div></td><td></td><td></td><td><div>1293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_port&nbsp;&nbsp;= $src_range &amp;&amp; $port_name-&gt;(@$src_range);</td></tr>
<tr><td class="h">2788</td><td><div class="c3">808</div><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>650</div><div>1407</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_port&nbsp;&nbsp;= $port_name-&gt;(@{ $protocol-&gt;{dst_range} });</td></tr>
<tr><td class="h">2789</td><td><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>725</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $port;</td></tr>
<tr><td class="h">2790</td><td><div class="c3">808</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2790">50</a></div></td><td></td><td></td><td></td><td><div>1212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$port = &quot;$src_port:&quot; if $src_port;</td></tr>
<tr><td class="h">2791</td><td><div class="c3">808</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2791">100</a></div></td><td></td><td></td><td></td><td><div>1636</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$port .= &quot;$dst_port&quot; if $dst_port;</td></tr>
<tr><td class="h">2792</td><td><div class="c3">808</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2792">100</a></div></td><td></td><td></td><td></td><td><div>3542</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name .= &quot; $port&quot;&nbsp;&nbsp;&nbsp;&nbsp;if $port;</td></tr>
<tr><td class="h">2793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;icmp&#39;) {</td></tr>
<tr><td class="h">2795</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2795">100</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $type = $protocol-&gt;{type})) {</td></tr>
<tr><td class="h">2796</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2796">100</a></div></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $code = $protocol-&gt;{code})) {</td></tr>
<tr><td class="h">2797</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = &quot;$proto $type/$code&quot;;</td></tr>
<tr><td class="h">2798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2800</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = &quot;$proto $type&quot;;</td></tr>
<tr><td class="h">2801</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2803</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2805</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = &quot;proto $proto&quot;;</td></tr>
<tr><td class="h">2806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2807</td><td><div class="c3">962</div></td><td></td><td></td><td></td><td></td><td><div>1365</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $name;</td></tr>
<tr><td class="h">2808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2809</td><td colspan="7"></td></tr><tr><td class="h">2810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %protocols;</td></tr>
<tr><td class="h">2811</td><td colspan="7"></td></tr><tr><td class="h">2812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cache_anonymous_protocol {</td></tr>
<tr><td class="h">2813</td><td><div class="c3">962</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2813">962</a></div></td><td><div class="c0">0</div></td><td><div>884</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($protocol) = @_;</td></tr>
<tr><td class="h">2814</td><td><div class="c3">962</div></td><td></td><td></td><td></td><td></td><td><div>1167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = gen_protocol_name($protocol);</td></tr>
<tr><td class="h">2815</td><td><div class="c3">962</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2815">100</a></div></td><td></td><td></td><td></td><td><div>1833</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $cached = $protocols{$name}) {</td></tr>
<tr><td class="h">2816</td><td><div class="c3">258</div></td><td></td><td></td><td></td><td></td><td><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $cached;</td></tr>
<tr><td class="h">2817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2819</td><td><div class="c3">704</div></td><td></td><td></td><td></td><td></td><td><div>972</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{name}&nbsp;&nbsp;&nbsp;&nbsp;= $name;</td></tr>
<tr><td class="h">2820</td><td><div class="c3">704</div></td><td></td><td></td><td></td><td></td><td><div>1702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">2821</td><td><div class="c3">704</div></td><td></td><td></td><td></td><td></td><td><div>954</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocols{$name}&nbsp;&nbsp;&nbsp;&nbsp;= $protocol;</td></tr>
<tr><td class="h">2822</td><td><div class="c3">704</div></td><td></td><td></td><td></td><td></td><td><div>944</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $protocol;</td></tr>
<tr><td class="h">2823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2825</td><td colspan="7"></td></tr><tr><td class="h">2826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_simple_protocol {</td></tr>
<tr><td class="h">2827</td><td><div class="c3">1012</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2827">1012</a></div></td><td><div class="c0">0</div></td><td><div>993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">2828</td><td><div class="c3">1012</div></td><td></td><td></td><td></td><td></td><td><div>1083</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $protocol = {};</td></tr>
<tr><td class="h">2829</td><td><div class="c3">1012</div></td><td></td><td></td><td></td><td></td><td><div>1263</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $proto&nbsp;&nbsp;&nbsp;&nbsp;= read_identifier();</td></tr>
<tr><td class="h">2830</td><td><div class="c3">1012</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2830">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2830">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2830">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2830">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2830">50</a></div></td><td></td><td></td><td></td><td><div>2436</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($proto eq &#39;ip&#39;) {</td></tr>
<tr><td class="h">2831</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{proto} = &#39;ip&#39;;</td></tr>
<tr><td class="h">2832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;tcp&#39;) {</td></tr>
<tr><td class="h">2834</td><td><div class="c3">798</div></td><td></td><td></td><td></td><td></td><td><div>1264</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{proto} = &#39;tcp&#39;;</td></tr>
<tr><td class="h">2835</td><td><div class="c3">798</div></td><td></td><td></td><td></td><td></td><td><div>1095</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_port_ranges($protocol);</td></tr>
<tr><td class="h">2836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;udp&#39;) {</td></tr>
<tr><td class="h">2838</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{proto} = &#39;udp&#39;;</td></tr>
<tr><td class="h">2839</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_port_ranges $protocol;</td></tr>
<tr><td class="h">2840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;icmp&#39;) {</td></tr>
<tr><td class="h">2842</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{proto} = &#39;icmp&#39;;</td></tr>
<tr><td class="h">2843</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_icmp_type_code $protocol;</td></tr>
<tr><td class="h">2844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;proto&#39;) {</td></tr>
<tr><td class="h">2846</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_proto_nr $protocol;</td></tr>
<tr><td class="h">2847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2849</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Unknown protocol &#39;$proto&#39;&quot;);</td></tr>
<tr><td class="h">2850</td><td colspan="7"></td></tr><tr><td class="h">2851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">2852</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{proto} = &#39;ip&#39;;</td></tr>
<tr><td class="h">2853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2854</td><td><div class="c3">1012</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2854">100</a></div></td><td></td><td></td><td></td><td><div>1256</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($name) {</td></tr>
<tr><td class="h">2855</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{name} = $name;</td></tr>
<tr><td class="h">2856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2858</td><td><div class="c3">962</div></td><td></td><td></td><td></td><td></td><td><div>1278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol = cache_anonymous_protocol($protocol);</td></tr>
<tr><td class="h">2859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2860</td><td><div class="c3">1012</div></td><td></td><td></td><td></td><td></td><td><div>2584</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $protocol;</td></tr>
<tr><td class="h">2861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2862</td><td colspan="7"></td></tr><tr><td class="h">2863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_protocol_flags {</td></tr>
<tr><td class="h">2864</td><td><div class="c3">50</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2864">50</a></div></td><td><div class="c0">0</div></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($protocol) = @_;</td></tr>
<tr><td class="h">2865</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (check &#39;,&#39;) {</td></tr>
<tr><td class="h">2866</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $flag = read_identifier;</td></tr>
<tr><td class="h">2867</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2867">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2867">50</a></div></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($flag =~ /^(src|dst)_(net|any)$/) {</td></tr>
<tr><td class="h">2868</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{flags}-&gt;{$1}-&gt;{$2} = 1;</td></tr>
<tr><td class="h">2869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($flag =~</td></tr>
<tr><td class="h">2871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^(?:stateless|reversed|oneway|overlaps|no_check_supernet_rules)/)</td></tr>
<tr><td class="h">2872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">2873</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol-&gt;{flags}-&gt;{$flag} = 1;</td></tr>
<tr><td class="h">2874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2876</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Unknown flag &#39;$flag&#39;&quot;);</td></tr>
<tr><td class="h">2877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2879</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">2880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2881</td><td colspan="7"></td></tr><tr><td class="h">2882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_typed_name_or_simple_protocol {</td></tr>
<tr><td class="h">2883</td><td><div class="c3">1016</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2883">67</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2883">1016</a></div></td><td><div class="c0">0</div></td><td><div>1214</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return (check_typed_name() || read_simple_protocol());</td></tr>
<tr><td class="h">2884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2885</td><td colspan="7"></td></tr><tr><td class="h">2886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_protocol {</td></tr>
<tr><td class="h">2887</td><td><div class="c3">50</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2887">50</a></div></td><td><div class="c0">0</div></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">2888</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2889</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $protocol = read_simple_protocol($name);</td></tr>
<tr><td class="h">2890</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_protocol_flags($protocol);</td></tr>
<tr><td class="h">2891</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;;&#39;;</td></tr>
<tr><td class="h">2892</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $protocol;</td></tr>
<tr><td class="h">2893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2894</td><td colspan="7"></td></tr><tr><td class="h">2895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %services;</td></tr>
<tr><td class="h">2896</td><td colspan="7"></td></tr><tr><td class="h">2897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub assign_union_allow_user {</td></tr>
<tr><td class="h">2898</td><td><div class="c3">1820</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2898">1820</a></div></td><td><div class="c0">0</div></td><td><div>1762</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">2899</td><td><div class="c3">1820</div></td><td></td><td></td><td></td><td></td><td><div>2006</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip $name;</td></tr>
<tr><td class="h">2900</td><td><div class="c3">1820</div></td><td></td><td></td><td></td><td></td><td><div>2499</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2901</td><td><div class="c3">1820</div></td><td></td><td></td><td></td><td></td><td><div>3010</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $user_object-&gt;{active} = 1;</td></tr>
<tr><td class="h">2902</td><td><div class="c3">1820</div></td><td></td><td></td><td></td><td></td><td><div>1768</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$user_object-&gt;{refcount} = 0;</td></tr>
<tr><td class="h">2903</td><td><div class="c3">1820</div></td><td></td><td></td><td></td><td></td><td><div>2300</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result = read_union &#39;;&#39;;</td></tr>
<tr><td class="h">2904</td><td><div class="c3">1820</div></td><td></td><td></td><td></td><td></td><td><div>3851</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@result, $user_object-&gt;{refcount};</td></tr>
<tr><td class="h">2905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2906</td><td colspan="7"></td></tr><tr><td class="h">2907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_service {</td></tr>
<tr><td class="h">2908</td><td><div class="c3">818</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2908">818</a></div></td><td><div class="c0">0</div></td><td><div>854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">2909</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $service = { name =&gt; $name, rules =&gt; [] };</td></tr>
<tr><td class="h">2910</td><td><div class="c3">818</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2910">50</a></div></td><td></td><td></td><td></td><td><div>1385</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">2911</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>991</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2912</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">2913</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($service);</td></tr>
<tr><td class="h">2914</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>798</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">2915</td><td><div class="c3">834</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2915">100</a></div></td><td></td><td></td><td></td><td><div>1059</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;user&#39;;</td></tr>
<tr><td class="h">2916</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2916">0</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $sub_owner = check_assign &#39;sub_owner&#39;, \&amp;read_identifier) {</td></tr>
<tr><td class="h">2917</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($service, sub_owner =&gt; $sub_owner);</td></tr>
<tr><td class="h">2918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my @other = check_assign_list &#39;overlaps&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">2920</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($service, overlaps =&gt; \@other);</td></tr>
<tr><td class="h">2921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $visible = check_assign(&#39;visible&#39;, \&amp;read_owner_pattern)) {</td></tr>
<tr><td class="h">2923</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($service, visible =&gt; $visible);</td></tr>
<tr><td class="h">2924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag(&#39;multi_owner&#39;)) {</td></tr>
<tr><td class="h">2926</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{multi_owner} = 1;</td></tr>
<tr><td class="h">2927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag(&#39;unknown_owner&#39;)) {</td></tr>
<tr><td class="h">2929</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{unknown_owner} = 1;</td></tr>
<tr><td class="h">2930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag(&#39;has_unenforceable&#39;)) {</td></tr>
<tr><td class="h">2932</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{has_unenforceable} = 1;</td></tr>
<tr><td class="h">2933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag(&#39;disabled&#39;)) {</td></tr>
<tr><td class="h">2935</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">2936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2938</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected some valid attribute or definition of &#39;user&#39;&quot;);</td></tr>
<tr><td class="h">2939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2941</td><td colspan="7"></td></tr><tr><td class="h">2942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# &#39;user&#39; has already been read above.</td></tr>
<tr><td class="h">2943</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2944</td><td><div class="c3">818</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2944">100</a></div></td><td></td><td></td><td></td><td><div>1159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (check &#39;foreach&#39;) {</td></tr>
<tr><td class="h">2945</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{foreach} = 1;</td></tr>
<tr><td class="h">2946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2947</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1440</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @elements = read_list \&amp;read_intersection;</td></tr>
<tr><td class="h">2948</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{user} = \@elements;</td></tr>
<tr><td class="h">2949</td><td colspan="7"></td></tr><tr><td class="h">2950</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>716</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">2951</td><td><div class="c3">1728</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2951">100</a></div></td><td></td><td></td><td></td><td><div>2175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">2952</td><td><div class="c3">910</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2952">50</a></div></td><td></td><td></td><td></td><td><div>1359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $action = check_permit_deny) {</td></tr>
<tr><td class="h">2953</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>1203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $src_user) = assign_union_allow_user &#39;src&#39;;</td></tr>
<tr><td class="h">2954</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>1216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($dst, $dst_user) = assign_union_allow_user &#39;dst&#39;;</td></tr>
<tr><td class="h">2955</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>1583</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt =</td></tr>
<tr><td class="h">2956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ read_assign_list(&#39;prt&#39;, \&amp;read_typed_name_or_simple_protocol) ];</td></tr>
<tr><td class="h">2957</td><td><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $log;</td></tr>
<tr><td class="h">2958</td><td><div class="c3">910</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2958">100</a></div></td><td></td><td></td><td></td><td><div>1515</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @list = check_assign_list(&#39;log&#39;, \&amp;read_identifier)) {</td></tr>
<tr><td class="h">2959</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log = \@list;</td></tr>
<tr><td class="h">2960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2961</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_user</td></tr>
<tr><td class="h">2962</td><td><div class="c3">910</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2962">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2962">67</a></div></td><td></td><td></td><td><div>1948</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $dst_user</td></tr>
<tr><td class="h">2963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;Rule must use keyword &#39;user&#39;&quot;);</td></tr>
<tr><td class="h">2964</td><td><div class="c3">910</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2964">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2964">67</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L2964">33</a></div></td><td></td><td></td><td><div>1837</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($service-&gt;{foreach} and not($src_user and $dst_user)) {</td></tr>
<tr><td class="h">2965</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">2966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Rule of $name should reference &#39;user&#39;&quot;,</td></tr>
<tr><td class="h">2967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in &#39;src&#39; and &#39;dst&#39;\n&quot;,</td></tr>
<tr><td class="h">2968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; because service has keyword &#39;foreach&#39;&quot;</td></tr>
<tr><td class="h">2969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">2970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2971</td><td><div class="c3">910</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2971">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2971">100</a></div></td><td></td><td></td><td></td><td><div>3536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rule = {</td></tr>
<tr><td class="h">2972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;service&nbsp;&nbsp;=&gt; $service,</td></tr>
<tr><td class="h">2973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action&nbsp;&nbsp;&nbsp;=&gt; $action,</td></tr>
<tr><td class="h">2974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $src,</td></tr>
<tr><td class="h">2975</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $dst,</td></tr>
<tr><td class="h">2976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $prt,</td></tr>
<tr><td class="h">2977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_user =&gt; $src_user ? $dst_user ? &#39;both&#39; : &#39;src&#39; : &#39;dst&#39;,</td></tr>
<tr><td class="h">2978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">2979</td><td><div class="c3">910</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2979">100</a></div></td><td></td><td></td><td></td><td><div>1410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{log} = $log if $log;</td></tr>
<tr><td class="h">2980</td><td><div class="c3">910</div><div class="c3">910</div></td><td></td><td></td><td></td><td></td><td><div>755</div><div>1818</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $service-&gt;{rules} }, $rule;</td></tr>
<tr><td class="h">2981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2982</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">2983</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected &#39;permit&#39; or &#39;deny&#39;&quot;);</td></tr>
<tr><td class="h">2984</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2986</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>1225</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $service;</td></tr>
<tr><td class="h">2987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2988</td><td colspan="7"></td></tr><tr><td class="h">2989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %pathrestrictions;</td></tr>
<tr><td class="h">2990</td><td colspan="7"></td></tr><tr><td class="h">2991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_pathrestriction {</td></tr>
<tr><td class="h">2992</td><td><div class="c3">64</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L2992">64</a></div></td><td><div class="c0">0</div></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">2993</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">2994</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $restriction = new(&#39;Pathrestriction&#39;, name =&gt; $name);</td></tr>
<tr><td class="h">2995</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L2995">50</a></div></td><td></td><td></td><td></td><td><div>538</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$restriction-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">2996</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>521</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($restriction);</td></tr>
<tr><td class="h">2997</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @elements = read_list \&amp;read_intersection;</td></tr>
<tr><td class="h">2998</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$restriction-&gt;{elements} = \@elements;</td></tr>
<tr><td class="h">2999</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $restriction;</td></tr>
<tr><td class="h">3000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3001</td><td colspan="7"></td></tr><tr><td class="h">3002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_attributed_object {</td></tr>
<tr><td class="h">3003</td><td><div class="c3">86</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3003">86</a></div></td><td><div class="c0">0</div></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $attr_descr) = @_;</td></tr>
<tr><td class="h">3004</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $object = { name =&gt; $name };</td></tr>
<tr><td class="h">3005</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">3006</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">3007</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($object);</td></tr>
<tr><td class="h">3008</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">3009</td><td><div class="c3">609</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3009">100</a></div></td><td></td><td></td><td></td><td><div>690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">3010</td><td><div class="c3">523</div></td><td></td><td></td><td></td><td></td><td><div>724</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attribute = read_identifier;</td></tr>
<tr><td class="h">3011</td><td><div class="c3">523</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3011">50</a></div></td><td></td><td></td><td></td><td><div>1164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val_descr = $attr_descr-&gt;{$attribute}</td></tr>
<tr><td class="h">3012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Unknown attribute &#39;$attribute&#39;&quot;);</td></tr>
<tr><td class="h">3013</td><td><div class="c3">523</div></td><td></td><td></td><td></td><td></td><td><div>620</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">3014</td><td><div class="c3">523</div></td><td></td><td></td><td></td><td></td><td><div>464</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val;</td></tr>
<tr><td class="h">3015</td><td><div class="c3">523</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3015">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3015">50</a></div></td><td></td><td></td><td></td><td><div>933</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $values = $val_descr-&gt;{values}) {</td></tr>
<tr><td class="h">3016</td><td><div class="c3">375</div></td><td></td><td></td><td></td><td></td><td><div>470</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$val = read_identifier;</td></tr>
<tr><td class="h">3017</td><td><div class="c3">375</div><div class="c3">2188</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3017">50</a></div></td><td></td><td></td><td></td><td><div>466</div><div>3027</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_ eq $val } @$values</td></tr>
<tr><td class="h">3018</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Invalid value&quot;);</td></tr>
<tr><td class="h">3019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3020</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $fun = $val_descr-&gt;{function}) {</td></tr>
<tr><td class="h">3021</td><td><div class="c3">148</div></td><td></td><td></td><td></td><td></td><td><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$val = &amp;$fun;</td></tr>
<tr><td class="h">3022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3024</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err();</td></tr>
<tr><td class="h">3025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3026</td><td><div class="c3">523</div></td><td></td><td></td><td></td><td></td><td><div>651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;;&#39;;</td></tr>
<tr><td class="h">3027</td><td><div class="c3">523</div></td><td></td><td></td><td></td><td></td><td><div>754</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_attribute($object, $attribute =&gt; $val);</td></tr>
<tr><td class="h">3028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3029</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $attribute (keys %$attr_descr) {</td></tr>
<tr><td class="h">3030</td><td><div class="c3">645</div></td><td></td><td></td><td></td><td></td><td><div>536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $description = $attr_descr-&gt;{$attribute};</td></tr>
<tr><td class="h">3031</td><td><div class="c3">645</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3031">100</a></div></td><td></td><td></td><td></td><td><div>870</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless (defined $object-&gt;{$attribute}) {</td></tr>
<tr><td class="h">3032</td><td><div class="c3">122</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3032">50</a></div></td><td></td><td></td><td></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $default = $description-&gt;{default}) {</td></tr>
<tr><td class="h">3033</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{$attribute} = $default;</td></tr>
<tr><td class="h">3034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3036</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_atline(&quot;Missing &#39;$attribute&#39; for $object-&gt;{name}&quot;);</td></tr>
<tr><td class="h">3037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3039</td><td colspan="7"></td></tr><tr><td class="h">3040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert from syntax to internal values, e.g. &#39;none&#39; =&gt; undef.</td></tr>
<tr><td class="h">3041</td><td><div class="c3">645</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3041">100</a></div></td><td></td><td></td><td></td><td><div>1006</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $map = $description-&gt;{map}) {</td></tr>
<tr><td class="h">3042</td><td><div class="c3">301</div></td><td></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = $object-&gt;{$attribute};</td></tr>
<tr><td class="h">3043</td><td><div class="c3">301</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3043">100</a></div></td><td></td><td></td><td></td><td><div>581</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (exists $map-&gt;{$value}) {</td></tr>
<tr><td class="h">3044</td><td><div class="c3">97</div></td><td></td><td></td><td></td><td></td><td><div>150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{$attribute} = $map-&gt;{$value};</td></tr>
<tr><td class="h">3045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3048</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>158</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $object;</td></tr>
<tr><td class="h">3049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3050</td><td colspan="7"></td></tr><tr><td class="h">3051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %isakmp_attributes = (</td></tr>
<tr><td class="h">3052</td><td colspan="7"></td></tr><tr><td class="h">3053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This one is ignored and is optional.</td></tr>
<tr><td class="h">3054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;identity =&gt; {</td></tr>
<tr><td class="h">3055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;=&gt; [qw( address fqdn )],</td></tr>
<tr><td class="h">3056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default =&gt; &#39;none&#39;,</td></tr>
<tr><td class="h">3057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { none =&gt; undef }</td></tr>
<tr><td class="h">3058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;nat_traversal =&gt; {</td></tr>
<tr><td class="h">3060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;=&gt; [qw( on additional off )],</td></tr>
<tr><td class="h">3061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default =&gt; &#39;off&#39;,</td></tr>
<tr><td class="h">3062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { off =&gt; undef }</td></tr>
<tr><td class="h">3063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;authentication =&gt; { values&nbsp;&nbsp;&nbsp;=&gt; [qw( preshare rsasig )], },</td></tr>
<tr><td class="h">3065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;encryption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { values&nbsp;&nbsp;&nbsp;=&gt; [qw( aes aes192 aes256 des 3des )], },</td></tr>
<tr><td class="h">3066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { values&nbsp;&nbsp;&nbsp;=&gt; [qw( md5 sha sha256 sha384 sha512 )], },</td></tr>
<tr><td class="h">3067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ike_version&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { values&nbsp;&nbsp;&nbsp;=&gt; [ 1, 2 ], default =&gt; 1, },</td></tr>
<tr><td class="h">3068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;lifetime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { function =&gt; \&amp;read_time_val, },</td></tr>
<tr><td class="h">3069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { values&nbsp;&nbsp;&nbsp;=&gt; [ 1, 2, 5, 14, 15, 16, 19, 20, 21, 24 ], },</td></tr>
<tr><td class="h">3070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;lifetime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { function =&gt; \&amp;read_time_val, },</td></tr>
<tr><td class="h">3071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;trust_point =&gt; {</td></tr>
<tr><td class="h">3072</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function =&gt; \&amp;read_identifier,</td></tr>
<tr><td class="h">3073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;&nbsp;=&gt; &#39;none&#39;,</td></tr>
<tr><td class="h">3074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { none =&gt; undef }</td></tr>
<tr><td class="h">3075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">3077</td><td colspan="7"></td></tr><tr><td class="h">3078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %isakmp;</td></tr>
<tr><td class="h">3079</td><td colspan="7"></td></tr><tr><td class="h">3080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_isakmp {</td></tr>
<tr><td class="h">3081</td><td><div class="c3">43</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3081">43</a></div></td><td><div class="c0">0</div></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">3082</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return read_attributed_object $name, \%isakmp_attributes;</td></tr>
<tr><td class="h">3083</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3084</td><td colspan="7"></td></tr><tr><td class="h">3085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %ipsec_attributes = (</td></tr>
<tr><td class="h">3086</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;key_exchange&nbsp;&nbsp;&nbsp;=&gt; { function =&gt; \&amp;read_typed_name, },</td></tr>
<tr><td class="h">3087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;esp_encryption =&gt; {</td></tr>
<tr><td class="h">3088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;=&gt; [qw( none aes aes192 aes256 des 3des )],</td></tr>
<tr><td class="h">3089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default =&gt; &#39;none&#39;,</td></tr>
<tr><td class="h">3090</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { none =&gt; undef }</td></tr>
<tr><td class="h">3091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;esp_authentication =&gt; {</td></tr>
<tr><td class="h">3093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;=&gt; [qw( none md5_hmac sha_hmac md5 sha sha256 sha384 sha512 )],</td></tr>
<tr><td class="h">3094</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default =&gt; &#39;none&#39;,</td></tr>
<tr><td class="h">3095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {</td></tr>
<tr><td class="h">3096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none =&gt; undef,</td></tr>
<tr><td class="h">3097</td><td colspan="7"></td></tr><tr><td class="h">3098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Compatibility for old version.</td></tr>
<tr><td class="h">3099</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5_hmac =&gt; &#39;md5&#39;,</td></tr>
<tr><td class="h">3100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sha_hmac =&gt; &#39;sha&#39;,</td></tr>
<tr><td class="h">3101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ah =&gt; {</td></tr>
<tr><td class="h">3104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;=&gt; [qw( none md5_hmac sha_hmac md5 sha sha256 sha384 sha512 )],</td></tr>
<tr><td class="h">3105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default =&gt; &#39;none&#39;,</td></tr>
<tr><td class="h">3106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { none =&gt; undef, md5_hmac =&gt; &#39;md5&#39;, sha_hmac =&gt; &#39;sha&#39;, }</td></tr>
<tr><td class="h">3107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;pfs_group =&gt; {</td></tr>
<tr><td class="h">3109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;=&gt; [qw( none 1 2 5 14 15 16 19 20 21 24 )],</td></tr>
<tr><td class="h">3110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default =&gt; &#39;none&#39;,</td></tr>
<tr><td class="h">3111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { none =&gt; undef }</td></tr>
<tr><td class="h">3112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">3113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;lifetime =&gt; { function =&gt; \&amp;read_time_val, },</td></tr>
<tr><td class="h">3114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">3115</td><td colspan="7"></td></tr><tr><td class="h">3116</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %ipsec;</td></tr>
<tr><td class="h">3117</td><td colspan="7"></td></tr><tr><td class="h">3118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_ipsec {</td></tr>
<tr><td class="h">3119</td><td><div class="c3">43</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3119">43</a></div></td><td><div class="c0">0</div></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">3120</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return read_attributed_object $name, \%ipsec_attributes;</td></tr>
<tr><td class="h">3121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3122</td><td colspan="7"></td></tr><tr><td class="h">3123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %crypto;</td></tr>
<tr><td class="h">3124</td><td colspan="7"></td></tr><tr><td class="h">3125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_crypto {</td></tr>
<tr><td class="h">3126</td><td><div class="c3">49</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3126">49</a></div></td><td><div class="c0">0</div></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name) = @_;</td></tr>
<tr><td class="h">3127</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">3128</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">3129</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto = { name =&gt; $name };</td></tr>
<tr><td class="h">3130</td><td><div class="c3">49</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3130">100</a></div></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$crypto-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">3131</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($crypto);</td></tr>
<tr><td class="h">3132</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">3133</td><td><div class="c3">104</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3133">100</a></div></td><td></td><td></td><td></td><td><div>126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">3134</td><td><div class="c3">55</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3134">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3134">50</a></div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (check_flag &#39;detailed_crypto_acl&#39;) {</td></tr>
<tr><td class="h">3135</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto-&gt;{detailed_crypto_acl} = 1;</td></tr>
<tr><td class="h">3136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $type = check_assign &#39;type&#39;, \&amp;read_typed_name) {</td></tr>
<tr><td class="h">3138</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3138">50</a></div></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto-&gt;{type}</td></tr>
<tr><td class="h">3139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Redefining &#39;type&#39; attribute&quot;);</td></tr>
<tr><td class="h">3140</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto-&gt;{type} = $type;</td></tr>
<tr><td class="h">3141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3143</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected valid attribute&quot;);</td></tr>
<tr><td class="h">3144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3146</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3146">50</a></div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$crypto-&gt;{type} or error_atline(&quot;Missing &#39;type&#39; for $name&quot;);</td></tr>
<tr><td class="h">3147</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $crypto;</td></tr>
<tr><td class="h">3148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3149</td><td colspan="7"></td></tr><tr><td class="h">3150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %owners;</td></tr>
<tr><td class="h">3151</td><td colspan="7"></td></tr><tr><td class="h">3152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_owner {</td></tr>
<tr><td class="h">3153</td><td><div class="c3">128</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3153">128</a></div></td><td><div class="c0">0</div></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">3154</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $owner = new(&#39;Owner&#39;, name =&gt; $name);</td></tr>
<tr><td class="h">3155</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;=&#39;;</td></tr>
<tr><td class="h">3156</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;skip &#39;\{&#39;;</td></tr>
<tr><td class="h">3157</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_description($owner);</td></tr>
<tr><td class="h">3158</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">3159</td><td><div class="c3">308</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3159">100</a></div></td><td></td><td></td><td></td><td><div>379</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if check &#39;\}&#39;;</td></tr>
<tr><td class="h">3160</td><td><div class="c3">180</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3160">50</a></div></td><td></td><td></td><td></td><td><div>319</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $alias = check_assign(&#39;alias&#39;, \&amp;read_string)) {</td></tr>
<tr><td class="h">3161</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3161">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{alias}</td></tr>
<tr><td class="h">3162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Redefining &#39;alias&#39; attribute&quot;);</td></tr>
<tr><td class="h">3163</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{alias} = $alias;</td></tr>
<tr><td class="h">3164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my @admins = check_assign_list(&#39;admins&#39;, \&amp;read_name)) {</td></tr>
<tr><td class="h">3166</td><td><div class="c3">118</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3166">50</a></div></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{admins}</td></tr>
<tr><td class="h">3167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Redefining &#39;admins&#39; attribute&quot;);</td></tr>
<tr><td class="h">3168</td><td><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>296</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{admins} = \@admins;</td></tr>
<tr><td class="h">3169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my @watchers = check_assign_list(&#39;watchers&#39;, \&amp;read_name)) {</td></tr>
<tr><td class="h">3171</td><td><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3171">50</a></div></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{watchers}</td></tr>
<tr><td class="h">3172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and error_atline(&quot;Redefining &#39;watchers&#39; attribute&quot;);</td></tr>
<tr><td class="h">3173</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{watchers} = \@watchers;</td></tr>
<tr><td class="h">3174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;extend_only&#39;) {</td></tr>
<tr><td class="h">3176</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{extend_only} = 1;</td></tr>
<tr><td class="h">3177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;extend_unbounded&#39;) {</td></tr>
<tr><td class="h">3179</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{extend_unbounded} = 1;</td></tr>
<tr><td class="h">3180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;extend&#39;) {</td></tr>
<tr><td class="h">3182</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{extend} = 1;</td></tr>
<tr><td class="h">3183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (check_flag &#39;show_all&#39;) {</td></tr>
<tr><td class="h">3185</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{show_all} = 1;</td></tr>
<tr><td class="h">3186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3188</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syntax_err(&quot;Expected valid attribute&quot;);</td></tr>
<tr><td class="h">3189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3191</td><td><div class="c3">128</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3191">100</a></div></td><td></td><td></td><td></td><td><div>281</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$owner-&gt;{admins}) {</td></tr>
<tr><td class="h">3192</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3192">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3192">67</a></div></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{extend_only} and $owner-&gt;{watchers}</td></tr>
<tr><td class="h">3193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or error_atline(&quot;Missing attribute &#39;admins&#39;&quot;);</td></tr>
<tr><td class="h">3194</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{admins} = [];</td></tr>
<tr><td class="h">3195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3196</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $owner;</td></tr>
<tr><td class="h">3197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3198</td><td colspan="7"></td></tr><tr><td class="h">3199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %global_type = (</td></tr>
<tr><td class="h">3200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_router,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%routers ],</td></tr>
<tr><td class="h">3201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_network,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%networks ],</td></tr>
<tr><td class="h">3202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;any&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_aggregate,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%aggregates ],</td></tr>
<tr><td class="h">3203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;area&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_area,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%areas ],</td></tr>
<tr><td class="h">3204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;owner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_owner,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%owners ],</td></tr>
<tr><td class="h">3205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_group,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%groups ],</td></tr>
<tr><td class="h">3206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;protocol&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_protocol,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%protocols ],</td></tr>
<tr><td class="h">3207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;protocolgroup&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_protocolgroup,&nbsp;&nbsp;&nbsp;\%protocolgroups ],</td></tr>
<tr><td class="h">3208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;service&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_service,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%services ],</td></tr>
<tr><td class="h">3209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;pathrestriction =&gt; [ \&amp;read_pathrestriction, \%pathrestrictions ],</td></tr>
<tr><td class="h">3210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;isakmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_isakmp,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%isakmp ],</td></tr>
<tr><td class="h">3211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ipsec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_ipsec,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%ipsec ],</td></tr>
<tr><td class="h">3212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;crypto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ \&amp;read_crypto,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%crypto ],</td></tr>
<tr><td class="h">3213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">3214</td><td colspan="7"></td></tr><tr><td class="h">3215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_netspoc {</td></tr>
<tr><td class="h">3216</td><td colspan="7"></td></tr><tr><td class="h">3217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check for global definitions.</td></tr>
<tr><td class="h">3218</td><td><div class="c3">6207</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3218">50</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3218">6207</a></div></td><td><div class="c0">0</div></td><td><div>7628</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pair = check_typed_name or syntax_err(&#39;&#39;);</td></tr>
<tr><td class="h">3219</td><td><div class="c3">6207</div></td><td></td><td></td><td></td><td></td><td><div>8462</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @$pair;</td></tr>
<tr><td class="h">3220</td><td><div class="c3">6207</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3220">50</a></div></td><td></td><td></td><td></td><td><div>12916</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $descr = $global_type{$type}</td></tr>
<tr><td class="h">3221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or syntax_err(&quot;Unknown global definition&quot;);</td></tr>
<tr><td class="h">3222</td><td><div class="c3">6207</div></td><td></td><td></td><td></td><td></td><td><div>5852</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($fun, $hash) = @$descr;</td></tr>
<tr><td class="h">3223</td><td><div class="c3">6207</div></td><td></td><td></td><td></td><td></td><td><div>15391</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = $fun-&gt;(&quot;$type:$name&quot;);</td></tr>
<tr><td class="h">3224</td><td><div class="c3">6207</div></td><td></td><td></td><td></td><td></td><td><div>9513</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{file} = $current_file;</td></tr>
<tr><td class="h">3225</td><td><div class="c3">6207</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3225">50</a></div></td><td></td><td></td><td></td><td><div>10937</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $hash-&gt;{$name}) {</td></tr>
<tr><td class="h">3226</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">3227</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Duplicate definition of $type:$name in&quot;,</td></tr>
<tr><td class="h">3228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $current_file and $other-&gt;{file}&quot;</td></tr>
<tr><td class="h">3229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">3230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3231</td><td colspan="7"></td></tr><tr><td class="h">3232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Result is not used in this module but can be useful</td></tr>
<tr><td class="h">3233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# when this function is called from outside.</td></tr>
<tr><td class="h">3234</td><td><div class="c3">6207</div></td><td></td><td></td><td></td><td></td><td><div>16690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $hash-&gt;{$name} = $result;</td></tr>
<tr><td class="h">3235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3236</td><td colspan="7"></td></tr><tr><td class="h">3237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Read input from file and process it by function which is given as argument.</td></tr>
<tr><td class="h">3238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_file {</td></tr>
<tr><td class="h">3239</td><td><div class="c3">759</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3239">759</a></div></td><td><div class="c0">0</div></td><td><div>932</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $current_file = shift;</td></tr>
<tr><td class="h">3240</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>693</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $read_syntax = shift;</td></tr>
<tr><td class="h">3241</td><td colspan="7"></td></tr><tr><td class="h">3242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Read file as one large line.</td></tr>
<tr><td class="h">3243</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>1916</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $/;</td></tr>
<tr><td class="h">3244</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>694</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $input;</td></tr>
<tr><td class="h">3245</td><td colspan="7"></td></tr><tr><td class="h">3246</td><td><div class="c3">759</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3246">50</a></div></td><td></td><td></td><td></td><td><div>1168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined $current_file) {</td></tr>
<tr><td class="h">3247</td><td><div class="c3">759</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3247">50</a></div></td><td></td><td></td><td></td><td><div>9031</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open(my $fh, &#39;&lt;&#39;, $current_file)</td></tr>
<tr><td class="h">3248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or fatal_err(&quot;Can&#39;t open $current_file: $!&quot;);</td></tr>
<tr><td class="h">3249</td><td colspan="7"></td></tr><tr><td class="h">3250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Fill buffer with content of whole file.</td></tr>
<tr><td class="h">3251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Content is implicitly freed when subroutine is left.</td></tr>
<tr><td class="h">3252</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>8660</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input = &lt;$fh&gt;;</td></tr>
<tr><td class="h">3253</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>3013</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">3254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3256</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$current_file = &#39;STDIN&#39;;</td></tr>
<tr><td class="h">3257</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &lt;&gt;;</td></tr>
<tr><td class="h">3258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3259</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>907</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $line = 1;</td></tr>
<tr><td class="h">3260</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>2872</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $length = length $input;</td></tr>
<tr><td class="h">3261</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>1222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (skip_space_and_comment, pos $input != $length) {</td></tr>
<tr><td class="h">3262</td><td><div class="c3">6207</div></td><td></td><td></td><td></td><td></td><td><div>6907</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;$read_syntax;</td></tr>
<tr><td class="h">3263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3264</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>3081</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3266</td><td colspan="7"></td></tr><tr><td class="h">3267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub read_file_or_dir {</td></tr>
<tr><td class="h">3268</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3268">736</a></div></td><td><div class="c0">0</div></td><td><div>905</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($path, $read_syntax) = @_;</td></tr>
<tr><td class="h">3269</td><td><div class="c3">736</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3269">100</a></div></td><td></td><td></td><td><div>2378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$read_syntax ||= \&amp;read_netspoc;</td></tr>
<tr><td class="h">3270</td><td colspan="7"></td></tr><tr><td class="h">3271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle toplevel file.</td></tr>
<tr><td class="h">3272</td><td><div class="c3">736</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3272">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3272">67</a></div></td><td></td><td></td><td><div>4460</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!(defined $path &amp;&amp; -d $path)) {</td></tr>
<tr><td class="h">3273</td><td><div class="c3">66</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_file($path, $read_syntax);</td></tr>
<tr><td class="h">3274</td><td><div class="c3">66</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3276</td><td colspan="7"></td></tr><tr><td class="h">3277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Recursively read files and directories.</td></tr>
<tr><td class="h">3278</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>572</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $read_nested_files;</td></tr>
<tr><td class="h">3279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $read_nested_files0 = sub {</td></tr>
<tr><td class="h">3280</td><td><div class="c3">699</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3280">699</a></div></td><td></td><td><div>699</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($path, $read_syntax) = @_;</td></tr>
<tr><td class="h">3281</td><td><div class="c3">699</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3281">100</a></div></td><td></td><td></td><td></td><td><div>2684</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (-d $path) {</td></tr>
<tr><td class="h">3282</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3282">50</a></div></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opendir(my $dh, $path) or fatal_err(&quot;Can&#39;t opendir $path: $!&quot;);</td></tr>
<tr><td class="h">3283</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my $file = Encode::decode($filename_encode, readdir $dh)) {</td></tr>
<tr><td class="h">3284</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3284">100</a></div></td><td></td><td></td><td></td><td><div>570</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ /^\./;</td></tr>
<tr><td class="h">3285</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3285">50</a></div></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ m/$config-&gt;{ignore_files}/o;</td></tr>
<tr><td class="h">3286</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path = &quot;$path/$file&quot;;</td></tr>
<tr><td class="h">3287</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$read_nested_files-&gt;($path, $read_syntax);</td></tr>
<tr><td class="h">3288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3289</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closedir $dh;</td></tr>
<tr><td class="h">3290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3291</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3292</td><td><div class="c3">693</div></td><td></td><td></td><td></td><td></td><td><div>986</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_file $path, $read_syntax;</td></tr>
<tr><td class="h">3293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3294</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>3622</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3295</td><td colspan="7"></td></tr><tr><td class="h">3296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Special handling for &quot;*.private&quot;.</td></tr>
<tr><td class="h">3297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$read_nested_files = sub {</td></tr>
<tr><td class="h">3298</td><td><div class="c3">699</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3298">699</a></div></td><td></td><td><div>851</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($path, $read_syntax) = @_;</td></tr>
<tr><td class="h">3299</td><td colspan="7"></td></tr><tr><td class="h">3300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle private directories and files.</td></tr>
<tr><td class="h">3301</td><td><div class="c3">699</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3301">100</a></div></td><td></td><td></td><td></td><td><div>1625</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($name) = ($path =~ m&#39;([^/]*)\.private$&#39;)) {</td></tr>
<tr><td class="h">3302</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3302">100</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($private) {</td></tr>
<tr><td class="h">3303</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Nested private context is not supported:\n $path&quot;);</td></tr>
<tr><td class="h">3304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3305</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $private = $name;</td></tr>
<tr><td class="h">3306</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$read_nested_files0-&gt;($path, $read_syntax);</td></tr>
<tr><td class="h">3307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3309</td><td><div class="c3">685</div></td><td></td><td></td><td></td><td></td><td><div>951</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$read_nested_files0-&gt;($path, $read_syntax);</td></tr>
<tr><td class="h">3310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3311</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>1619</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3312</td><td colspan="7"></td></tr><tr><td class="h">3313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle toplevel directory.</td></tr>
<tr><td class="h">3314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Special handling for &quot;config&quot; and &quot;raw&quot;.</td></tr>
<tr><td class="h">3315</td><td><div class="c3">670</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3315">50</a></div></td><td></td><td></td><td></td><td><div>13485</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;opendir(my $dh, $path) or fatal_err(&quot;Can&#39;t opendir $path: $!&quot;);</td></tr>
<tr><td class="h">3316</td><td><div class="c3">670</div><div class="c3">2031</div></td><td></td><td></td><td></td><td></td><td><div>4636</div><div>49756</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @files = map({ Encode::decode($filename_encode, $_) } readdir $dh);</td></tr>
<tr><td class="h">3317</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>18171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;closedir $dh;</td></tr>
<tr><td class="h">3318</td><td colspan="7"></td></tr><tr><td class="h">3319</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>947</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $file (@files) {</td></tr>
<tr><td class="h">3320</td><td colspan="7"></td></tr><tr><td class="h">3321</td><td><div class="c3">2031</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3321">100</a></div></td><td></td><td></td><td></td><td><div>4705</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ /^\./;</td></tr>
<tr><td class="h">3322</td><td><div class="c3">691</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3322">50</a></div></td><td></td><td></td><td></td><td><div>4258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ m/$config-&gt;{ignore_files}/o;</td></tr>
<tr><td class="h">3323</td><td colspan="7"></td></tr><tr><td class="h">3324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore special files/directories.</td></tr>
<tr><td class="h">3325</td><td><div class="c3">691</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3325">50</a></div></td><td></td><td></td><td></td><td><div>1514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ /^(config|raw)$/;</td></tr>
<tr><td class="h">3326</td><td colspan="7"></td></tr><tr><td class="h">3327</td><td><div class="c3">691</div></td><td></td><td></td><td></td><td></td><td><div>1465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path = &quot;$path/$file&quot;;</td></tr>
<tr><td class="h">3328</td><td><div class="c3">691</div></td><td></td><td></td><td></td><td></td><td><div>1044</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$read_nested_files-&gt;($path, $read_syntax);</td></tr>
<tr><td class="h">3329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3330</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>1729</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3332</td><td colspan="7"></td></tr><tr><td class="h">3333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub show_read_statistics {</td></tr>
<tr><td class="h">3334</td><td><div class="c3">670</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3334">670</a></div></td><td><div class="c0">0</div></td><td><div>838</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $n&nbsp;&nbsp;= keys %networks;</td></tr>
<tr><td class="h">3335</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>676</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $h&nbsp;&nbsp;= keys %hosts;</td></tr>
<tr><td class="h">3336</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>603</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $r&nbsp;&nbsp;= keys %routers;</td></tr>
<tr><td class="h">3337</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>608</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $g&nbsp;&nbsp;= keys %groups;</td></tr>
<tr><td class="h">3338</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>576</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $s&nbsp;&nbsp;= keys %protocols;</td></tr>
<tr><td class="h">3339</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>575</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $sg = keys %protocolgroups;</td></tr>
<tr><td class="h">3340</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>579</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $p&nbsp;&nbsp;= keys %services;</td></tr>
<tr><td class="h">3341</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>2309</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;info(&quot;Read $r routers, $n networks, $h hosts&quot;);</td></tr>
<tr><td class="h">3342</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>1994</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;info(&quot;Read $p services, $g groups, $s protocols, $sg protocol groups&quot;);</td></tr>
<tr><td class="h">3343</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>683</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3345</td><td colspan="7"></td></tr><tr><td class="h">3346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">## no critic (RequireArgUnpacking RequireFinalReturn)</td></tr>
<tr><td class="h">3347</td><td colspan="7"></td></tr><tr><td class="h">3348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Type checking functions</td></tr>
<tr><td class="h">3349</td><td><div class="c3">2688</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3349">2688</a></div></td><td><div class="c0">0</div></td><td><div>6606</div></td><td class="s">sub is_network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Network&#39;; }</td></tr>
<tr><td class="h">3350</td><td><div class="c3">12326</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3350">12326</a></div></td><td><div class="c0">0</div></td><td><div>30230</div></td><td class="s">sub is_router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Router&#39;; }</td></tr>
<tr><td class="h">3351</td><td><div class="c3">4082</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3351">4082</a></div></td><td><div class="c0">0</div></td><td><div>15373</div></td><td class="s">sub is_interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Interface&#39;; }</td></tr>
<tr><td class="h">3352</td><td><div class="c3">2679</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3352">2679</a></div></td><td><div class="c0">0</div></td><td><div>4750</div></td><td class="s">sub is_host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Host&#39;; }</td></tr>
<tr><td class="h">3353</td><td><div class="c3">190</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3353">190</a></div></td><td><div class="c0">0</div></td><td><div>7306</div></td><td class="s">sub is_subnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Subnet&#39;; }</td></tr>
<tr><td class="h">3354</td><td><div class="c3">264</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3354">264</a></div></td><td><div class="c0">0</div></td><td><div>534</div></td><td class="s">sub is_area&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Area&#39;; }</td></tr>
<tr><td class="h">3355</td><td><div class="c3">2988</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3355">2988</a></div></td><td><div class="c0">0</div></td><td><div>4991</div></td><td class="s">sub is_zone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Zone&#39;; }</td></tr>
<tr><td class="h">3356</td><td><div class="c3">3598</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3356">3598</a></div></td><td><div class="c0">0</div></td><td><div>10543</div></td><td class="s">sub is_group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Group&#39;; }</td></tr>
<tr><td class="h">3357</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3357">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">sub is_protocolgroup { ref($_[0]) eq &#39;Protocolgroup&#39;; }</td></tr>
<tr><td class="h">3358</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3358">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">sub is_objectgroup&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Objectgroup&#39;; }</td></tr>
<tr><td class="h">3359</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3359">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">sub is_chain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ ref($_[0]) eq &#39;Chain&#39;; }</td></tr>
<tr><td class="h">3360</td><td><div class="c3">4902</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3360">4902</a></div></td><td><div class="c0">0</div></td><td><div>11128</div></td><td class="s">sub is_autointerface { ref($_[0]) eq &#39;Autointerface&#39;; }</td></tr>
<tr><td class="h">3361</td><td colspan="7"></td></tr><tr><td class="h">3362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">## use critic</td></tr>
<tr><td class="h">3363</td><td colspan="7"></td></tr><tr><td class="h">3364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_rule {</td></tr>
<tr><td class="h">3365</td><td><div class="c3">152</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3365">152</a></div></td><td><div class="c0">0</div></td><td><div>135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule) = @_;</td></tr>
<tr><td class="h">3366</td><td><div class="c3">152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3366">100</a></div></td><td></td><td></td><td></td><td><div>262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig_rule = $rule-&gt;{orig_rule}) {</td></tr>
<tr><td class="h">3367</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return print_rule($orig_rule);</td></tr>
<tr><td class="h">3368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3369</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $extra = &#39;&#39;;</td></tr>
<tr><td class="h">3370</td><td><div class="c3">124</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3370">33</a></div></td><td></td><td></td><td><div>355</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $service = $rule-&gt;{rule} &amp;&amp; $rule-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">3371</td><td><div class="c3">124</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3371">50</a></div></td><td></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$extra .= &quot; $rule-&gt;{for_router}&quot; if $rule-&gt;{for_router};</td></tr>
<tr><td class="h">3372</td><td><div class="c3">124</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3372">50</a></div></td><td></td><td></td><td></td><td><div>186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$extra .= &quot; stateless&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $rule-&gt;{stateless};</td></tr>
<tr><td class="h">3373</td><td><div class="c3">124</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3373">50</a></div></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$extra .= &quot; stateless_icmp&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $rule-&gt;{stateless_icmp};</td></tr>
<tr><td class="h">3374</td><td><div class="c3">124</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3374">50</a></div></td><td></td><td></td><td></td><td><div>259</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$extra .= &quot; of $service-&gt;{name}&quot; if $service;</td></tr>
<tr><td class="h">3375</td><td><div class="c3">124</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3375">67</a></div></td><td></td><td></td><td><div>299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prt = $rule-&gt;{orig_prt} || $rule-&gt;{prt};</td></tr>
<tr><td class="h">3376</td><td><div class="c3">124</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3376">50</a></div></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $action = $rule-&gt;{deny} ? &#39;deny&#39; : &#39;permit&#39;;</td></tr>
<tr><td class="h">3377</td><td colspan="7"></td></tr><tr><td class="h">3378</td><td><div class="c3">124</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3378">50</a></div></td><td></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $chain = $rule-&gt;{chain}) {</td></tr>
<tr><td class="h">3379</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$action = $chain-&gt;{name};</td></tr>
<tr><td class="h">3380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return</td></tr>
<tr><td class="h">3382</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>753</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$action</td></tr>
<tr><td class="h">3383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; src=$rule-&gt;{src}-&gt;{name}; dst=$rule-&gt;{dst}-&gt;{name}; &quot;</td></tr>
<tr><td class="h">3384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot;prt=$prt-&gt;{name};$extra&quot;;</td></tr>
<tr><td class="h">3385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3386</td><td colspan="7"></td></tr><tr><td class="h">3387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">3388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Order protocols</td></tr>
<tr><td class="h">3389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">3390</td><td colspan="7"></td></tr><tr><td class="h">3391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hash for converting a reference of a protocol back to this protocol.</td></tr>
<tr><td class="h">3392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %ref2prt;</td></tr>
<tr><td class="h">3393</td><td colspan="7"></td></tr><tr><td class="h">3394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Look up a protocol object by its defining attributes.</td></tr>
<tr><td class="h">3395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %prt_hash;</td></tr>
<tr><td class="h">3396</td><td colspan="7"></td></tr><tr><td class="h">3397</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub prepare_prt_ordering {</td></tr>
<tr><td class="h">3398</td><td><div class="c3">10890</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3398">10890</a></div></td><td><div class="c0">0</div></td><td><div>8461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt) = @_;</td></tr>
<tr><td class="h">3399</td><td><div class="c3">10890</div></td><td></td><td></td><td></td><td></td><td><div>10438</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $prt-&gt;{proto};</td></tr>
<tr><td class="h">3400</td><td><div class="c3">10890</div></td><td></td><td></td><td></td><td></td><td><div>7589</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $main_prt;</td></tr>
<tr><td class="h">3401</td><td><div class="c3">10890</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3401">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3401">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3401">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3401">100</a></div></td><td></td><td></td><td><div>32592</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($proto eq &#39;tcp&#39; or $proto eq &#39;udp&#39;) {</td></tr>
<tr><td class="h">3402</td><td colspan="7"></td></tr><tr><td class="h">3403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert src and dst port ranges from arrays to real protocol objects.</td></tr>
<tr><td class="h">3404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is used in function expand_rules via expand_protocols:</td></tr>
<tr><td class="h">3405</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# An unexpanded rule has references to TCP and UDP protocols</td></tr>
<tr><td class="h">3406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with combined src and dst port ranges. An expanded rule has</td></tr>
<tr><td class="h">3407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# distinct references to src and dst protocols with a single</td></tr>
<tr><td class="h">3408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# port range.</td></tr>
<tr><td class="h">3409</td><td><div class="c3">5672</div></td><td></td><td></td><td></td><td></td><td><div>6018</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $where (&#39;src_range&#39;, &#39;dst_range&#39;) {</td></tr>
<tr><td class="h">3410</td><td colspan="7"></td></tr><tr><td class="h">3411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# An array with low and high port.</td></tr>
<tr><td class="h">3412</td><td><div class="c3">11344</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3412">100</a></div></td><td></td><td></td><td></td><td><div>19002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $range = $prt-&gt;{$where} or next;</td></tr>
<tr><td class="h">3413</td><td><div class="c3">7134</div></td><td></td><td></td><td></td><td></td><td><div>12698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = join &#39;:&#39;, @$range;</td></tr>
<tr><td class="h">3414</td><td><div class="c3">7134</div></td><td></td><td></td><td></td><td></td><td><div>7895</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $range_prt = $prt_hash{$proto}-&gt;{$key};</td></tr>
<tr><td class="h">3415</td><td><div class="c3">7134</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3415">100</a></div></td><td></td><td></td><td></td><td><div>9660</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $range_prt) {</td></tr>
<tr><td class="h">3416</td><td><div class="c3">4904</div></td><td></td><td></td><td></td><td></td><td><div>10165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$range_prt = {</td></tr>
<tr><td class="h">3417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;=&gt; $prt-&gt;{name},</td></tr>
<tr><td class="h">3418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto =&gt; $proto,</td></tr>
<tr><td class="h">3419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range =&gt; $range,</td></tr>
<tr><td class="h">3420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3421</td><td><div class="c3">4904</div></td><td></td><td></td><td></td><td></td><td><div>6555</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_hash{$proto}-&gt;{$key} = $range_prt;</td></tr>
<tr><td class="h">3422</td><td colspan="7"></td></tr><tr><td class="h">3423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set up ref2prt.</td></tr>
<tr><td class="h">3424</td><td><div class="c3">4904</div></td><td></td><td></td><td></td><td></td><td><div>7466</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2prt{$range_prt} = $range_prt;</td></tr>
<tr><td class="h">3425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3426</td><td><div class="c3">7134</div></td><td></td><td></td><td></td><td></td><td><div>12412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{$where} = $range_prt;</td></tr>
<tr><td class="h">3427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;icmp&#39;) {</td></tr>
<tr><td class="h">3430</td><td><div class="c3">816</div></td><td></td><td></td><td></td><td></td><td><div>794</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = $prt-&gt;{type};</td></tr>
<tr><td class="h">3431</td><td><div class="c3">816</div></td><td></td><td></td><td></td><td></td><td><div>756</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $code = $prt-&gt;{code};</td></tr>
<tr><td class="h">3432</td><td><div class="c3">816</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3432">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3432">100</a></div></td><td></td><td></td><td></td><td><div>1235</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key&nbsp;&nbsp;= defined $type ? (defined $code ? &quot;$type:$code&quot; : $type) : &#39;&#39;;</td></tr>
<tr><td class="h">3433</td><td><div class="c3">816</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3433">100</a></div></td><td></td><td></td><td></td><td><div>2863</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$main_prt = $prt_hash{$proto}-&gt;{$key}</td></tr>
<tr><td class="h">3434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $prt_hash{$proto}-&gt;{$key} = $prt;</td></tr>
<tr><td class="h">3435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;ip&#39;) {</td></tr>
<tr><td class="h">3437</td><td><div class="c3">774</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3437">100</a></div></td><td></td><td></td><td></td><td><div>1736</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$main_prt = $prt_hash{$proto}</td></tr>
<tr><td class="h">3438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $prt_hash{$proto} = $prt;</td></tr>
<tr><td class="h">3439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3441</td><td colspan="7"></td></tr><tr><td class="h">3442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Other protocol.</td></tr>
<tr><td class="h">3443</td><td><div class="c3">3628</div></td><td></td><td></td><td></td><td></td><td><div>3168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = $proto;</td></tr>
<tr><td class="h">3444</td><td><div class="c3">3628</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3444">100</a></div></td><td></td><td></td><td></td><td><div>7438</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$main_prt = $prt_hash{proto}-&gt;{$key}</td></tr>
<tr><td class="h">3445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $prt_hash{proto}-&gt;{$key} = $prt;</td></tr>
<tr><td class="h">3446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3447</td><td><div class="c3">10890</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3447">100</a></div></td><td></td><td></td><td></td><td><div>14971</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($main_prt) {</td></tr>
<tr><td class="h">3448</td><td colspan="7"></td></tr><tr><td class="h">3449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found duplicate protocol definition.&nbsp;&nbsp;Link $prt with $main_prt.</td></tr>
<tr><td class="h">3450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We link all duplicate protocols to the first protocol found.</td></tr>
<tr><td class="h">3451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This assures that we always reach the main protocol from any duplicate</td></tr>
<tr><td class="h">3452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# protocol in one step via -&gt;{main}. This is used later to</td></tr>
<tr><td class="h">3453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# substitute occurrences of $prt with $main_prt.</td></tr>
<tr><td class="h">3454</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{main} = $main_prt;</td></tr>
<tr><td class="h">3455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3456</td><td><div class="c3">10890</div></td><td></td><td></td><td></td><td></td><td><div>11831</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3458</td><td colspan="7"></td></tr><tr><td class="h">3459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub order_icmp {</td></tr>
<tr><td class="h">3460</td><td><div class="c3">724</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3460">724</a></div></td><td><div class="c0">0</div></td><td><div>671</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($hash, $up) = @_;</td></tr>
<tr><td class="h">3461</td><td colspan="7"></td></tr><tr><td class="h">3462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle &#39;icmp any&#39;.</td></tr>
<tr><td class="h">3463</td><td><div class="c3">724</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3463">50</a></div></td><td></td><td></td><td></td><td><div>1303</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $prt = $hash-&gt;{&#39;&#39;}) {</td></tr>
<tr><td class="h">3464</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>712</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{up} = $up;</td></tr>
<tr><td class="h">3465</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>684</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = $prt;</td></tr>
<tr><td class="h">3466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3467</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1294</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (values %$hash) {</td></tr>
<tr><td class="h">3468</td><td colspan="7"></td></tr><tr><td class="h">3469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# &#39;icmp any&#39; has been handled above.</td></tr>
<tr><td class="h">3470</td><td><div class="c3">800</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3470">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3470">100</a></div></td><td></td><td></td><td></td><td><div>1359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!defined $prt-&gt;{type}) {</td></tr>
<tr><td class="h">3471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (defined $prt-&gt;{code}) {</td></tr>
<tr><td class="h">3473</td><td><div class="c3">20</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3473">33</a></div></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{up} = ($hash-&gt;{ $prt-&gt;{type} } or $up);</td></tr>
<tr><td class="h">3474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3476</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{up} = $up;</td></tr>
<tr><td class="h">3477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3478</td><td colspan="7"></td></tr><tr><td class="h">3479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set up ref2prt.</td></tr>
<tr><td class="h">3480</td><td><div class="c3">800</div></td><td></td><td></td><td></td><td></td><td><div>2015</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2prt{$prt} = $prt;</td></tr>
<tr><td class="h">3481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3482</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>883</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3484</td><td colspan="7"></td></tr><tr><td class="h">3485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub order_proto {</td></tr>
<tr><td class="h">3486</td><td><div class="c3">724</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3486">724</a></div></td><td><div class="c0">0</div></td><td><div>684</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($hash, $up) = @_;</td></tr>
<tr><td class="h">3487</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1227</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (values %$hash) {</td></tr>
<tr><td class="h">3488</td><td><div class="c3">3620</div></td><td></td><td></td><td></td><td></td><td><div>3222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{up} = $up;</td></tr>
<tr><td class="h">3489</td><td colspan="7"></td></tr><tr><td class="h">3490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set up ref2prt.</td></tr>
<tr><td class="h">3491</td><td><div class="c3">3620</div></td><td></td><td></td><td></td><td></td><td><div>5412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2prt{$prt} = $prt;</td></tr>
<tr><td class="h">3492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3493</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>774</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3495</td><td colspan="7"></td></tr><tr><td class="h">3496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Set {up} relation from port range to the smallest port range which</td></tr>
<tr><td class="h">3497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># includes it.</td></tr>
<tr><td class="h">3498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If no including range is found, link it with next larger protocol.</td></tr>
<tr><td class="h">3499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Set attribute {has_neighbor} to range adjacent to upper port.</td></tr>
<tr><td class="h">3500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find overlapping ranges and split one of them to eliminate the overlap.</td></tr>
<tr><td class="h">3501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Set attribute {split} at original range, referencing pair of splitted ranges.</td></tr>
<tr><td class="h">3502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub order_ranges {</td></tr>
<tr><td class="h">3503</td><td><div class="c3">1448</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3503">1448</a></div></td><td><div class="c0">0</div></td><td><div>1401</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($range_href, $up) = @_;</td></tr>
<tr><td class="h">3504</td><td><div class="c3">6145</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3504">50</a></div></td><td></td><td></td><td></td><td><div>11935</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @sorted =</td></tr>
<tr><td class="h">3505</td><td colspan="7"></td></tr><tr><td class="h">3506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Sort by low port. If low ports are equal, sort reverse by high port.</td></tr>
<tr><td class="h">3507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# I.e. larger ranges coming first, if there are multiple ranges</td></tr>
<tr><td class="h">3508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with identical low port.</td></tr>
<tr><td class="h">3509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort {</td></tr>
<tr><td class="h">3510</td><td><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>3538</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;{range}-&gt;[0] &lt;=&gt; $b-&gt;{range}-&gt;[0]</td></tr>
<tr><td class="h">3511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $b-&gt;{range}-&gt;[1] &lt;=&gt; $a-&gt;{range}-&gt;[1]</td></tr>
<tr><td class="h">3512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} values %$range_href;</td></tr>
<tr><td class="h">3513</td><td colspan="7"></td></tr><tr><td class="h">3514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check current range [a1, a2] for sub-ranges, starting at position $i.</td></tr>
<tr><td class="h">3515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return position of range which isn&#39;t sub-range or undef</td></tr>
<tr><td class="h">3516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# if end of array is reached.</td></tr>
<tr><td class="h">3517</td><td><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>1114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $check_subrange;</td></tr>
<tr><td class="h">3518</td><td colspan="7"></td></tr><tr><td class="h">3519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$check_subrange = sub {</td></tr>
<tr><td class="h">3520</td><td><div class="c3">4908</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3520">4908</a></div></td><td></td><td><div>5996</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($a, $a1, $a2, $i) = @_;</td></tr>
<tr><td class="h">3521</td><td><div class="c3">4908</div></td><td></td><td></td><td></td><td></td><td><div>3680</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">3522</td><td><div class="c3">7242</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3522">100</a></div></td><td></td><td></td><td></td><td><div>10617</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $i == @sorted;</td></tr>
<tr><td class="h">3523</td><td><div class="c3">5794</div></td><td></td><td></td><td></td><td></td><td><div>4765</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $b = $sorted[$i];</td></tr>
<tr><td class="h">3524</td><td><div class="c3">5794</div><div class="c3">5794</div></td><td></td><td></td><td></td><td></td><td><div>4055</div><div>7351</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($b1, $b2) = @{ $b-&gt;{range} };</td></tr>
<tr><td class="h">3525</td><td colspan="7"></td></tr><tr><td class="h">3526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Neighbors</td></tr>
<tr><td class="h">3527</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aaaabbbb</td></tr>
<tr><td class="h">3528</td><td><div class="c3">5794</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3528">100</a></div></td><td></td><td></td><td></td><td><div>8183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a2 + 1 == $b1) {</td></tr>
<tr><td class="h">3529</td><td colspan="7"></td></tr><tr><td class="h">3530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark protocol as candidate for joining of port ranges during</td></tr>
<tr><td class="h">3531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# optimization.</td></tr>
<tr><td class="h">3532</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;{has_neighbor} = $b-&gt;{has_neighbor} = 1;</td></tr>
<tr><td class="h">3533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3534</td><td colspan="7"></td></tr><tr><td class="h">3535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Not related.</td></tr>
<tr><td class="h">3536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aaaa&nbsp;&nbsp;&nbsp;&nbsp;bbbbb</td></tr>
<tr><td class="h">3537</td><td><div class="c3">5794</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3537">100</a></div></td><td></td><td></td><td></td><td><div>8654</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $i if $a2 &lt; $b1;</td></tr>
<tr><td class="h">3538</td><td colspan="7"></td></tr><tr><td class="h">3539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $a includes $b.</td></tr>
<tr><td class="h">3540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aaaaaaa</td></tr>
<tr><td class="h">3541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;bbbbb</td></tr>
<tr><td class="h">3542</td><td><div class="c3">3466</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3542">100</a></div></td><td></td><td></td><td></td><td><div>4713</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a2 &gt;= $b2) {</td></tr>
<tr><td class="h">3543</td><td><div class="c3">3460</div></td><td></td><td></td><td></td><td></td><td><div>3121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b-&gt;{up} = $a;</td></tr>
<tr><td class="h">3544</td><td colspan="7"></td></tr><tr><td class="h">3545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$b-&gt;{name} [$b1-$b2] &lt; $a-&gt;{name} [$a1-$a2]&quot;);</td></tr>
<tr><td class="h">3546</td><td><div class="c3">3460</div></td><td></td><td></td><td></td><td></td><td><div>6342</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i = $check_subrange-&gt;($b, $b1, $b2, $i + 1);</td></tr>
<tr><td class="h">3547</td><td colspan="7"></td></tr><tr><td class="h">3548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Stop at end of array.</td></tr>
<tr><td class="h">3549</td><td><div class="c3">3460</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3549">100</a></div></td><td></td><td></td><td></td><td><div>5861</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i or return;</td></tr>
<tr><td class="h">3550</td><td><div class="c3">2328</div></td><td></td><td></td><td></td><td></td><td><div>1993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">3551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3552</td><td colspan="7"></td></tr><tr><td class="h">3553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $a and $b are overlapping.</td></tr>
<tr><td class="h">3554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aaaaa</td></tr>
<tr><td class="h">3555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;bbbbbb</td></tr>
<tr><td class="h">3556</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Split $b in two parts $x and $y with $x included by $b:</td></tr>
<tr><td class="h">3557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aaaaa</td></tr>
<tr><td class="h">3558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;xxxyyy</td></tr>
<tr><td class="h">3559</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $x1 = $b1;</td></tr>
<tr><td class="h">3560</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $x2 = $a2;</td></tr>
<tr><td class="h">3561</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $y1 = $a2 + 1;</td></tr>
<tr><td class="h">3562</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $y2 = $b2;</td></tr>
<tr><td class="h">3563</td><td colspan="7"></td></tr><tr><td class="h">3564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$b-&gt;{name} [$b1-$b2] split into [$x1-$x2] and [$y1-$y2]&quot;);</td></tr>
<tr><td class="h">3565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $find_or_insert_range = sub {</td></tr>
<tr><td class="h">3566</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($a1, $a2, $i, $orig, $prefix) = @_;</td></tr>
<tr><td class="h">3567</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">3568</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3568">100</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($i == @sorted) {</td></tr>
<tr><td class="h">3569</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">3570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3571</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $b = $sorted[$i];</td></tr>
<tr><td class="h">3572</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($b1, $b2) = @{ $b-&gt;{range} };</td></tr>
<tr><td class="h">3573</td><td colspan="7"></td></tr><tr><td class="h">3574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# New range starts at higher position and therefore must</td></tr>
<tr><td class="h">3575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# be inserted behind current range.</td></tr>
<tr><td class="h">3576</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3576">100</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a1 &gt; $b1) {</td></tr>
<tr><td class="h">3577</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i++;</td></tr>
<tr><td class="h">3578</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">3579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3580</td><td colspan="7"></td></tr><tr><td class="h">3581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# New and current range start a same position.</td></tr>
<tr><td class="h">3582</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3582">100</a></div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a1 == $b1) {</td></tr>
<tr><td class="h">3583</td><td colspan="7"></td></tr><tr><td class="h">3584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# New range is smaller and therefore must be inserted</td></tr>
<tr><td class="h">3585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# behind current range.</td></tr>
<tr><td class="h">3586</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3586">100</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a2 &lt; $b2) {</td></tr>
<tr><td class="h">3587</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i++;</td></tr>
<tr><td class="h">3588</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">3589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3590</td><td colspan="7"></td></tr><tr><td class="h">3591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found identical range, return this one.</td></tr>
<tr><td class="h">3592</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3592">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a2 == $b2) {</td></tr>
<tr><td class="h">3593</td><td colspan="7"></td></tr><tr><td class="h">3594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Splitted range is already defined: $b-&gt;{name}&quot;);</td></tr>
<tr><td class="h">3595</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $b;</td></tr>
<tr><td class="h">3596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3597</td><td colspan="7"></td></tr><tr><td class="h">3598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# New range is larger than current range and therefore</td></tr>
<tr><td class="h">3599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# must be inserted in front of current one.</td></tr>
<tr><td class="h">3600</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">3601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3602</td><td colspan="7"></td></tr><tr><td class="h">3603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# New range starts at lower position than current one.</td></tr>
<tr><td class="h">3604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It must be inserted in front of current range.</td></tr>
<tr><td class="h">3605</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">3606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3607</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_range = {</td></tr>
<tr><td class="h">3608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;=&gt; &quot;$prefix$orig-&gt;{name}&quot;,</td></tr>
<tr><td class="h">3609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto =&gt; $orig-&gt;{proto},</td></tr>
<tr><td class="h">3610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range =&gt; [ $a1, $a2 ],</td></tr>
<tr><td class="h">3611</td><td colspan="7"></td></tr><tr><td class="h">3612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark for range optimization.</td></tr>
<tr><td class="h">3613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_neighbor =&gt; 1</td></tr>
<tr><td class="h">3614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3615</td><td colspan="7"></td></tr><tr><td class="h">3616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Insert new range at position $i.</td></tr>
<tr><td class="h">3617</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice @sorted, $i, 0, $new_range;</td></tr>
<tr><td class="h">3618</td><td colspan="7"></td></tr><tr><td class="h">3619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set up ref2prt.</td></tr>
<tr><td class="h">3620</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2prt{$new_range} = $new_range;</td></tr>
<tr><td class="h">3621</td><td colspan="7"></td></tr><tr><td class="h">3622</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $new_range;</td></tr>
<tr><td class="h">3623</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3624</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $left&nbsp;&nbsp;= $find_or_insert_range-&gt;($x1, $x2, $i + 1, $b, &#39;lpart_&#39;);</td></tr>
<tr><td class="h">3625</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rigth = $find_or_insert_range-&gt;($y1, $y2, $i + 1, $b, &#39;rpart_&#39;);</td></tr>
<tr><td class="h">3626</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$b-&gt;{split} = [ $left, $rigth ];</td></tr>
<tr><td class="h">3627</td><td colspan="7"></td></tr><tr><td class="h">3628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Continue processing with next element.</td></tr>
<tr><td class="h">3629</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i++;</td></tr>
<tr><td class="h">3630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3631</td><td><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>4956</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3632</td><td colspan="7"></td></tr><tr><td class="h">3633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Array wont be empty because $prt_tcp and $prt_udp are defined internally.</td></tr>
<tr><td class="h">3634</td><td><div class="c3">1448</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3634">50</a></div></td><td></td><td></td><td></td><td><div>2497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@sorted or internal_err(&quot;Unexpected empty array&quot;);</td></tr>
<tr><td class="h">3635</td><td colspan="7"></td></tr><tr><td class="h">3636</td><td><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>1288</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $a = $sorted[0];</td></tr>
<tr><td class="h">3637</td><td><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>1517</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;{up} = $up;</td></tr>
<tr><td class="h">3638</td><td><div class="c3">1448</div><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>1157</div><div>2208</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($a1, $a2) = @{ $a-&gt;{range} };</td></tr>
<tr><td class="h">3639</td><td colspan="7"></td></tr><tr><td class="h">3640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ranges &quot;TCP any&quot; and &quot;UDP any&quot; 1..65535 are defined internally,</td></tr>
<tr><td class="h">3641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# they include all other ranges.</td></tr>
<tr><td class="h">3642</td><td><div class="c3">1448</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3642">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3642">33</a></div></td><td></td><td></td><td><div>4727</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$a1 == 1 and $a2 == 65535</td></tr>
<tr><td class="h">3643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Expected $a-&gt;{name} to have range 1..65535&quot;);</td></tr>
<tr><td class="h">3644</td><td colspan="7"></td></tr><tr><td class="h">3645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# There can&#39;t be any port which isn&#39;t included by ranges &quot;TCP any&quot;</td></tr>
<tr><td class="h">3646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# or &quot;UDP any&quot;.</td></tr>
<tr><td class="h">3647</td><td><div class="c3">1448</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3647">50</a></div></td><td></td><td></td><td></td><td><div>2020</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$check_subrange-&gt;($a, $a1, $a2, 1) and internal_err();</td></tr>
<tr><td class="h">3648</td><td><div class="c3">1448</div></td><td></td><td></td><td></td><td></td><td><div>1669</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3650</td><td colspan="7"></td></tr><tr><td class="h">3651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_splitted_protocol {</td></tr>
<tr><td class="h">3652</td><td><div class="c3">868</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3652">868</a></div></td><td><div class="c0">0</div></td><td><div>758</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt) = @_;</td></tr>
<tr><td class="h">3653</td><td colspan="7"></td></tr><tr><td class="h">3654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle unset src_range.</td></tr>
<tr><td class="h">3655</td><td><div class="c3">868</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3655">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3655">100</a></div></td><td></td><td></td><td></td><td><div>1718</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $prt) {</td></tr>
<tr><td class="h">3656</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $prt;</td></tr>
<tr><td class="h">3657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $split = $prt-&gt;{split}) {</td></tr>
<tr><td class="h">3659</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($prt1, $prt2) = @$split;</td></tr>
<tr><td class="h">3660</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (expand_splitted_protocol($prt1),</td></tr>
<tr><td class="h">3661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_splitted_protocol($prt2));</td></tr>
<tr><td class="h">3662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3664</td><td><div class="c3">820</div></td><td></td><td></td><td></td><td></td><td><div>1172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $prt;</td></tr>
<tr><td class="h">3665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3667</td><td colspan="7"></td></tr><tr><td class="h">3668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Protocol &#39;ip&#39; is needed later for implementing secondary rules and</td></tr>
<tr><td class="h">3669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># automatically generated deny rules.</td></tr>
<tr><td class="h">3670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_ip;</td></tr>
<tr><td class="h">3671</td><td colspan="7"></td></tr><tr><td class="h">3672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Protocol &#39;ICMP any&#39;, needed in optimization of chains for iptables.</td></tr>
<tr><td class="h">3673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_icmp;</td></tr>
<tr><td class="h">3674</td><td colspan="7"></td></tr><tr><td class="h">3675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Protocol &#39;TCP any&#39;.</td></tr>
<tr><td class="h">3676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_tcp;</td></tr>
<tr><td class="h">3677</td><td colspan="7"></td></tr><tr><td class="h">3678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Protocol &#39;UDP any&#39;.</td></tr>
<tr><td class="h">3679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_udp;</td></tr>
<tr><td class="h">3680</td><td colspan="7"></td></tr><tr><td class="h">3681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># DHCP server.</td></tr>
<tr><td class="h">3682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_bootps;</td></tr>
<tr><td class="h">3683</td><td colspan="7"></td></tr><tr><td class="h">3684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># IPSec: Internet key exchange.</td></tr>
<tr><td class="h">3685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Source and destination port (range) is set to 500.</td></tr>
<tr><td class="h">3686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_ike;</td></tr>
<tr><td class="h">3687</td><td colspan="7"></td></tr><tr><td class="h">3688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># IPSec: NAT traversal.</td></tr>
<tr><td class="h">3689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_natt;</td></tr>
<tr><td class="h">3690</td><td colspan="7"></td></tr><tr><td class="h">3691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># IPSec: encryption security payload.</td></tr>
<tr><td class="h">3692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_esp;</td></tr>
<tr><td class="h">3693</td><td colspan="7"></td></tr><tr><td class="h">3694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># IPSec: authentication header.</td></tr>
<tr><td class="h">3695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $prt_ah;</td></tr>
<tr><td class="h">3696</td><td colspan="7"></td></tr><tr><td class="h">3697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Port range &#39;TCP any&#39;; assigned in sub order_protocols below.</td></tr>
<tr><td class="h">3698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $range_tcp_any;</td></tr>
<tr><td class="h">3699</td><td colspan="7"></td></tr><tr><td class="h">3700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Port range &#39;tcp established&#39; is needed later for reverse rules</td></tr>
<tr><td class="h">3701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># and assigned below.</td></tr>
<tr><td class="h">3702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $range_tcp_established;</td></tr>
<tr><td class="h">3703</td><td colspan="7"></td></tr><tr><td class="h">3704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Order protocols. We need this to simplify optimization.</td></tr>
<tr><td class="h">3705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Additionally add internal predefined protocols.</td></tr>
<tr><td class="h">3706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub order_protocols {</td></tr>
<tr><td class="h">3707</td><td><div class="c3">724</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3707">724</a></div></td><td><div class="c0">0</div></td><td><div>1293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Arranging protocols&#39;);</td></tr>
<tr><td class="h">3708</td><td colspan="7"></td></tr><tr><td class="h">3709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Internal protocols need to be processed before user defined protocols,</td></tr>
<tr><td class="h">3710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# because we want to avoid handling of {main} for internal protocols.</td></tr>
<tr><td class="h">3711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $prt_tcp and $prt_udp need to be processed before all other TCP and UDP</td></tr>
<tr><td class="h">3712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# protocols, because otherwise the range 1..65535 would get a misleading</td></tr>
<tr><td class="h">3713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# name.</td></tr>
<tr><td class="h">3714</td><td><div class="c3">724</div><div class="c3">5068</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3714">100</a></div></td><td></td><td></td><td></td><td><div>1601</div><div>8541</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (</td></tr>
<tr><td class="h">3715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_ip,</td></tr>
<tr><td class="h">3716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_icmp,</td></tr>
<tr><td class="h">3717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_tcp, $prt_udp,</td></tr>
<tr><td class="h">3718</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_bootps,</td></tr>
<tr><td class="h">3719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_ike,</td></tr>
<tr><td class="h">3720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_natt,</td></tr>
<tr><td class="h">3721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_esp, $prt_ah,</td></tr>
<tr><td class="h">3722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ $_-&gt;{prt} ? ($_-&gt;{prt}) : () } values %routing_info,</td></tr>
<tr><td class="h">3723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %xxrp_info),</td></tr>
<tr><td class="h">3724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %protocols</td></tr>
<tr><td class="h">3725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">3726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">3727</td><td><div class="c3">10890</div></td><td></td><td></td><td></td><td></td><td><div>12316</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prepare_prt_ordering $prt;</td></tr>
<tr><td class="h">3728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3729</td><td colspan="7"></td></tr><tr><td class="h">3730</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1022</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$range_tcp_any&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $prt_tcp-&gt;{dst_range};</td></tr>
<tr><td class="h">3731</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>2650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$range_tcp_established = {</td></tr>
<tr><td class="h">3732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%$range_tcp_any,</td></tr>
<tr><td class="h">3733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;reversed:TCP_ANY&#39;,</td></tr>
<tr><td class="h">3734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;established =&gt; 1</td></tr>
<tr><td class="h">3735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">3736</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1489</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$range_tcp_established-&gt;{up} = $range_tcp_any;</td></tr>
<tr><td class="h">3737</td><td colspan="7"></td></tr><tr><td class="h">3738</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>632</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $up = $prt_ip;</td></tr>
<tr><td class="h">3739</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;order_ranges($prt_hash{tcp}, $up);</td></tr>
<tr><td class="h">3740</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>981</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;order_ranges($prt_hash{udp}, $up);</td></tr>
<tr><td class="h">3741</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;order_icmp($prt_hash{icmp}, $up);</td></tr>
<tr><td class="h">3742</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>1020</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;order_proto($prt_hash{proto}, $up);</td></tr>
<tr><td class="h">3743</td><td colspan="7"></td></tr><tr><td class="h">3744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Set up ref2prt.</td></tr>
<tr><td class="h">3745</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>961</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ref2prt{$prt_ip} = $prt_ip;</td></tr>
<tr><td class="h">3746</td><td><div class="c3">724</div></td><td></td><td></td><td></td><td></td><td><div>741</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3748</td><td colspan="7"></td></tr><tr><td class="h">3749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">3750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Link topology elements each with another</td></tr>
<tr><td class="h">3751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">3752</td><td colspan="7"></td></tr><tr><td class="h">3753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_group;</td></tr>
<tr><td class="h">3754</td><td colspan="7"></td></tr><tr><td class="h">3755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_to_owner {</td></tr>
<tr><td class="h">3756</td><td><div class="c3">6502</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3756">6502</a></div></td><td><div class="c0">0</div></td><td><div>5086</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $key) = @_;</td></tr>
<tr><td class="h">3757</td><td><div class="c3">6502</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3757">100</a></div></td><td></td><td></td><td><div>13474</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$key ||= &#39;owner&#39;;</td></tr>
<tr><td class="h">3758</td><td><div class="c3">6502</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3758">100</a></div></td><td></td><td></td><td></td><td><div>9384</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $value = $obj-&gt;{$key}) {</td></tr>
<tr><td class="h">3759</td><td><div class="c3">136</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3759">100</a></div></td><td></td><td></td><td></td><td><div>267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $owner = $owners{$value}) {</td></tr>
<tr><td class="h">3760</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $obj-&gt;{$key} = $owner;</td></tr>
<tr><td class="h">3761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">3763</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Can&#39;t resolve reference to &#39;$value&#39;&quot;,</td></tr>
<tr><td class="h">3764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in attribute &#39;$key&#39; of $obj-&gt;{name}&quot;</td></tr>
<tr><td class="h">3765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">3766</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $obj-&gt;{$key};</td></tr>
<tr><td class="h">3767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3768</td><td><div class="c3">6370</div></td><td></td><td></td><td></td><td></td><td><div>9550</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3770</td><td colspan="7"></td></tr><tr><td class="h">3771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_to_real_owner {</td></tr>
<tr><td class="h">3772</td><td><div class="c3">6370</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3772">6370</a></div></td><td><div class="c0">0</div></td><td><div>5146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $key) = @_;</td></tr>
<tr><td class="h">3773</td><td><div class="c3">6370</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3773">100</a></div></td><td></td><td></td><td></td><td><div>6557</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $owner = link_to_owner($obj, $key)) {</td></tr>
<tr><td class="h">3774</td><td><div class="c3">82</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3774">100</a></div></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner-&gt;{extend_only}) {</td></tr>
<tr><td class="h">3775</td><td colspan="7"></td></tr><tr><td class="h">3776</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">3777</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $owner-&gt;{extend_only};</td></tr>
<tr><td class="h">3778</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">3779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$owner-&gt;{name} with attribute &#39;extend_only&#39;&quot;,</td></tr>
<tr><td class="h">3780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must only be used at area,\n not at $obj-&gt;{name}&quot;</td></tr>
<tr><td class="h">3781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">3782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3784</td><td><div class="c3">6370</div></td><td></td><td></td><td></td><td></td><td><div>5928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3786</td><td colspan="7"></td></tr><tr><td class="h">3787</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Element of attribute &#39;watchers&#39; of owner A is allowed to reference</td></tr>
<tr><td class="h">3788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># some other owner B. In this case all admins and watchers of B are</td></tr>
<tr><td class="h">3789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># added to watchers of A.</td></tr>
<tr><td class="h">3790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_watchers {</td></tr>
<tr><td class="h">3791</td><td><div class="c3">138</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3791">138</a></div></td><td><div class="c0">0</div></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($owner) = @_;</td></tr>
<tr><td class="h">3792</td><td><div class="c3">138</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $names = $owner-&gt;{watchers};</td></tr>
<tr><td class="h">3793</td><td colspan="7"></td></tr><tr><td class="h">3794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No wathers given.</td></tr>
<tr><td class="h">3795</td><td><div class="c3">138</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3795">100</a></div></td><td></td><td></td><td></td><td><div>206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$names) {</td></tr>
<tr><td class="h">3796</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $owner-&gt;{admins};</td></tr>
<tr><td class="h">3797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3798</td><td colspan="7"></td></tr><tr><td class="h">3799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Owners, referenced in $names have already been resolved.</td></tr>
<tr><td class="h">3800</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3800">100</a></div></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($owner-&gt;{watching_owners}) {</td></tr>
<tr><td class="h">3801</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ @{ $owner-&gt;{admins} }, @$names ];</td></tr>
<tr><td class="h">3802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3803</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3803">100</a></div></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($names eq &#39;recursive&#39;) {</td></tr>
<tr><td class="h">3804</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Found recursive definition of watchers in $owner-&gt;{name}&quot;);</td></tr>
<tr><td class="h">3805</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $owner-&gt;{watchers} = [];</td></tr>
<tr><td class="h">3806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3807</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{watchers} = &#39;recursive&#39;;</td></tr>
<tr><td class="h">3808</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $watching_owners = [];</td></tr>
<tr><td class="h">3809</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @expanded;</td></tr>
<tr><td class="h">3810</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $name (@$names) {</td></tr>
<tr><td class="h">3811</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3811">100</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($o_name) = ($name =~ /^owner:(.*)$/)) {</td></tr>
<tr><td class="h">3812</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner_b = $owners{$o_name};</td></tr>
<tr><td class="h">3813</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3813">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$owner_b) {</td></tr>
<tr><td class="h">3814</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unknown owner:$o_name referenced in watcher of&quot;,</td></tr>
<tr><td class="h">3815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $owner-&gt;{name}&quot;);</td></tr>
<tr><td class="h">3816</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">3817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3818</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$watching_owners, $owner_b;</td></tr>
<tr><td class="h">3819</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @expanded,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ expand_watchers($owner_b) };</td></tr>
<tr><td class="h">3820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3822</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @expanded, $name;</td></tr>
<tr><td class="h">3823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3825</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{watchers} = \@expanded;</td></tr>
<tr><td class="h">3826</td><td colspan="7"></td></tr><tr><td class="h">3827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mark: no need to expand again and for cut-netspoc.</td></tr>
<tr><td class="h">3828</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{watching_owners} = $watching_owners;</td></tr>
<tr><td class="h">3829</td><td colspan="7"></td></tr><tr><td class="h">3830</td><td><div class="c3">28</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>23</div><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ @{ $owner-&gt;{admins} }, @expanded ];</td></tr>
<tr><td class="h">3831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3832</td><td colspan="7"></td></tr><tr><td class="h">3833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_owners {</td></tr>
<tr><td class="h">3834</td><td colspan="7"></td></tr><tr><td class="h">3835</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3835">736</a></div></td><td><div class="c0">0</div></td><td><div>616</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %alias2owner;</td></tr>
<tr><td class="h">3836</td><td colspan="7"></td></tr><tr><td class="h">3837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use sort to get deterministic error messages.</td></tr>
<tr><td class="h">3838</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1472</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $name (sort keys %owners) {</td></tr>
<tr><td class="h">3839</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner = $owners{$name};</td></tr>
<tr><td class="h">3840</td><td colspan="7"></td></tr><tr><td class="h">3841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for unique alias names.</td></tr>
<tr><td class="h">3842</td><td><div class="c3">128</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3842">67</a></div></td><td></td><td></td><td><div>407</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $alias = $owner-&gt;{alias} || $name;</td></tr>
<tr><td class="h">3843</td><td><div class="c3">128</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3843">100</a></div></td><td></td><td></td><td></td><td><div>218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $alias2owner{$alias}) {</td></tr>
<tr><td class="h">3844</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $descr1 = $owner-&gt;{name};</td></tr>
<tr><td class="h">3845</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3845">100</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{alias} and $descr1 .= &quot; with alias &#39;$owner-&gt;{alias}&#39;&quot;;</td></tr>
<tr><td class="h">3846</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $descr2 = $other-&gt;{name};</td></tr>
<tr><td class="h">3847</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3847">50</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other-&gt;{alias} and $descr2 .= &quot; with alias &#39;$other-&gt;{alias}&#39;&quot;;</td></tr>
<tr><td class="h">3848</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Name conflict between owners\n - $descr1\n - $descr2&quot;);</td></tr>
<tr><td class="h">3849</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3851</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$alias2owner{$alias} = $owner;</td></tr>
<tr><td class="h">3852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3853</td><td colspan="7"></td></tr><tr><td class="h">3854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check and expand referenced owners in watchers.</td></tr>
<tr><td class="h">3855</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_watchers($owner);</td></tr>
<tr><td class="h">3856</td><td colspan="7"></td></tr><tr><td class="h">3857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check email addresses in admins and watchers.</td></tr>
<tr><td class="h">3858</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw( admins watchers )) {</td></tr>
<tr><td class="h">3859</td><td><div class="c3">256</div><div class="c3">256</div></td><td></td><td></td><td></td><td></td><td><div>212</div><div>465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $email (@{ $owner-&gt;{$attr} }) {</td></tr>
<tr><td class="h">3860</td><td colspan="7"></td></tr><tr><td class="h">3861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check email syntax.</td></tr>
<tr><td class="h">3862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only 7 bit ASCII</td></tr>
<tr><td class="h">3863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Local part definition from wikipedia,</td></tr>
<tr><td class="h">3864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# without space and other quoted characters</td></tr>
<tr><td class="h">3865</td><td><div class="c3">148</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3865">50</a></div></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do {</td></tr>
<tr><td class="h">3866</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3866">144</a></div></td><td></td><td><div>860</div><div>166</div><div>761</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use bytes;</td></tr>
<tr><td class="h">3867</td><td><div class="c3">148</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3867">100</a></div></td><td></td><td></td><td></td><td><div>6925</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$email =~ m/^ [\w.!\#$%&amp;&#39;&#39;*+\/=?^_``{|}~-]+ \@ [\w.-]+ $/x</td></tr>
<tr><td class="h">3868</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $email eq &#39;guest&#39;;</td></tr>
<tr><td class="h">3869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">3871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Invalid email address (ASCII only)&quot;,</td></tr>
<tr><td class="h">3872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $attr of $owner-&gt;{name}: $email&quot;</td></tr>
<tr><td class="h">3873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">3874</td><td colspan="7"></td></tr><tr><td class="h">3875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Normalize email to lower case.</td></tr>
<tr><td class="h">3876</td><td><div class="c3">148</div></td><td></td><td></td><td></td><td></td><td><div>677</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$email = lc($email);</td></tr>
<tr><td class="h">3877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3879</td><td colspan="7"></td></tr><tr><td class="h">3880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for duplicate email addresses</td></tr>
<tr><td class="h">3881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# in admins, watchers and between admins and watchers.</td></tr>
<tr><td class="h">3882</td><td><div class="c3">128</div><div class="c3">128</div><div class="c3">128</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3882">100</a></div></td><td></td><td></td><td></td><td><div>134</div><div>151</div><div>231</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (find_duplicates(@{ $owner-&gt;{admins} }, @{ $owner-&gt;{watchers} })) {</td></tr>
<tr><td class="h">3883</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(admins watchers)) {</td></tr>
<tr><td class="h">3884</td><td><div class="c3">4</div><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3884">100</a></div></td><td></td><td></td><td></td><td><div>3</div><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @emails = find_duplicates(@{ $owner-&gt;{$attr} })) {</td></tr>
<tr><td class="h">3885</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{$attr} = [ unique(@{ $owner-&gt;{$attr} }) ];</td></tr>
<tr><td class="h">3886</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Duplicates in $attr of $owner-&gt;{name}: &quot;,</td></tr>
<tr><td class="h">3887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;, &#39;, @emails));</td></tr>
<tr><td class="h">3888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3890</td><td><div class="c3">2</div><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3890">50</a></div></td><td></td><td></td><td></td><td><div>3</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @duplicates =</td></tr>
<tr><td class="h">3891</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_duplicates(@{ $owner-&gt;{admins} }, @{ $owner-&gt;{watchers} }))</td></tr>
<tr><td class="h">3892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">3893</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Duplicates in admins/watchers of $owner-&gt;{name}: &quot;,</td></tr>
<tr><td class="h">3894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;, &#39;, @duplicates));</td></tr>
<tr><td class="h">3895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3898</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %networks) {</td></tr>
<tr><td class="h">3899</td><td><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>3393</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($network);</td></tr>
<tr><td class="h">3900</td><td><div class="c3">3042</div><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2251</div><div>4950</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">3901</td><td><div class="c3">433</div></td><td></td><td></td><td></td><td></td><td><div>500</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($host);</td></tr>
<tr><td class="h">3902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3903</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3904</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $aggregate (values %aggregates) {</td></tr>
<tr><td class="h">3905</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($aggregate);</td></tr>
<tr><td class="h">3906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3907</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (values %areas) {</td></tr>
<tr><td class="h">3908</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_owner($area);</td></tr>
<tr><td class="h">3909</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3909">100</a></div></td><td></td><td></td><td></td><td><div>318</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $router_attributes = $area-&gt;{router_attributes}) {</td></tr>
<tr><td class="h">3910</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($router_attributes);</td></tr>
<tr><td class="h">3911</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3913</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (values %routers, @router_fragments) {</td></tr>
<tr><td class="h">3914</td><td><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>2100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($router);</td></tr>
<tr><td class="h">3915</td><td><div class="c3">1925</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3915">100</a></div></td><td></td><td></td><td></td><td><div>3822</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{model}-&gt;{has_vip} or next;</td></tr>
<tr><td class="h">3916</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">3917</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($interface);</td></tr>
<tr><td class="h">3918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3920</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $service (values %services) {</td></tr>
<tr><td class="h">3921</td><td><div class="c3">818</div></td><td></td><td></td><td></td><td></td><td><div>992</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_to_real_owner($service, &#39;sub_owner&#39;);</td></tr>
<tr><td class="h">3922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3923</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>881</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3925</td><td colspan="7"></td></tr><tr><td class="h">3926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_policy_distribution_point {</td></tr>
<tr><td class="h">3927</td><td><div class="c3">1939</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3927">1939</a></div></td><td><div class="c0">0</div></td><td><div>1614</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">3928</td><td><div class="c3">1939</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3928">100</a></div></td><td></td><td></td><td></td><td><div>3398</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pair = $obj-&gt;{policy_distribution_point} or return;</td></tr>
<tr><td class="h">3929</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @$pair;</td></tr>
<tr><td class="h">3930</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3930">50</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type ne &#39;host&#39;) {</td></tr>
<tr><td class="h">3931</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Must only use &#39;host&#39; in &#39;policy_distribution_point&#39;&quot;,</td></tr>
<tr><td class="h">3932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">3933</td><td colspan="7"></td></tr><tr><td class="h">3934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors;</td></tr>
<tr><td class="h">3935</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $obj-&gt;{policy_distribution_point};</td></tr>
<tr><td class="h">3936</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3938</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $host = $hosts{$name};</td></tr>
<tr><td class="h">3939</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3939">50</a></div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$host) {</td></tr>
<tr><td class="h">3940</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring undefined host:$name&quot;,</td></tr>
<tr><td class="h">3941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in &#39;policy_distribution_point&#39; of $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">3942</td><td colspan="7"></td></tr><tr><td class="h">3943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors;</td></tr>
<tr><td class="h">3944</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $obj-&gt;{policy_distribution_point};</td></tr>
<tr><td class="h">3945</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3947</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{policy_distribution_point} = $host;</td></tr>
<tr><td class="h">3948</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3950</td><td colspan="7"></td></tr><tr><td class="h">3951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_general_permit {</td></tr>
<tr><td class="h">3952</td><td><div class="c3">1939</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3952">1939</a></div></td><td><div class="c0">0</div></td><td><div>1550</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">3953</td><td><div class="c3">1939</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3953">100</a></div></td><td></td><td></td><td></td><td><div>3822</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $list = $obj-&gt;{general_permit} or return;</td></tr>
<tr><td class="h">3954</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $context = $obj-&gt;{name};</td></tr>
<tr><td class="h">3955</td><td colspan="7"></td></tr><tr><td class="h">3956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort protocols and src_range/dst_range/orig_prt triples by name,</td></tr>
<tr><td class="h">3957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# so we can compare value lists of attribute general_permit for</td></tr>
<tr><td class="h">3958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# redundancy during inheritance.</td></tr>
<tr><td class="h">3959</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3959">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3959">100</a></div></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$list = $obj-&gt;{general_permit} = [</td></tr>
<tr><td class="h">3960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort {</td></tr>
<tr><td class="h">3961</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ref $a eq &#39;ARRAY&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $a-&gt;[2]-&gt;{name} : $a-&gt;{name})</td></tr>
<tr><td class="h">3962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp(ref $b eq &#39;ARRAY&#39; ? $b-&gt;[2]-&gt;{name} : $b-&gt;{name})</td></tr>
<tr><td class="h">3963</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} @{ split_protocols(expand_protocols($list, $context)) }</td></tr>
<tr><td class="h">3964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">3965</td><td colspan="7"></td></tr><tr><td class="h">3966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t allow port ranges. This wouldn&#39;t work, because</td></tr>
<tr><td class="h">3967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# gen_reverse_rules doesn&#39;t handle generally permitted protocols.</td></tr>
<tr><td class="h">3968</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (@$list) {</td></tr>
<tr><td class="h">3969</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $orig_prt;</td></tr>
<tr><td class="h">3970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range;</td></tr>
<tr><td class="h">3971</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $range;</td></tr>
<tr><td class="h">3972</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3972">100</a></div></td><td></td><td></td><td></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref $prt eq &#39;ARRAY&#39;) {</td></tr>
<tr><td class="h">3973</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($src_range, my $dst_range, $orig_prt) = @$prt;</td></tr>
<tr><td class="h">3974</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$range = $dst_range-&gt;{range};</td></tr>
<tr><td class="h">3975</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">3977</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3977">100</a></div></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$range = $prt-&gt;{range} or next;</td></tr>
<tr><td class="h">3978</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_prt = $prt;</td></tr>
<tr><td class="h">3979</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3980</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @reason;</td></tr>
<tr><td class="h">3981</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3981">50</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $flags = $orig_prt-&gt;{flags}) {</td></tr>
<tr><td class="h">3982</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @reason, &#39;modifiers&#39;;</td></tr>
<tr><td class="h">3983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3984</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3984">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L3984">50</a></div></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($src_range || $range &amp;&amp; $range ne $aref_tcp_any) {</td></tr>
<tr><td class="h">3985</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @reason, &#39;ports&#39;;</td></tr>
<tr><td class="h">3986</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3987</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3987">100</a></div></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@reason) {</td></tr>
<tr><td class="h">3988</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $reason = join &#39; or &#39;, @reason;</td></tr>
<tr><td class="h">3989</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Must not use &#39;$orig_prt-&gt;{name}&#39; with $reason&quot;,</td></tr>
<tr><td class="h">3990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in general_permit of $context&quot;);</td></tr>
<tr><td class="h">3991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">3993</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">3994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">3995</td><td colspan="7"></td></tr><tr><td class="h">3996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Link areas with referenced interfaces or network.</td></tr>
<tr><td class="h">3997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_areas {</td></tr>
<tr><td class="h">3998</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L3998">736</a></div></td><td><div class="c0">0</div></td><td><div>1155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (values %areas) {</td></tr>
<tr><td class="h">3999</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L3999">100</a></div></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($area-&gt;{anchor}) {</td></tr>
<tr><td class="h">4000</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @elements =</td></tr>
<tr><td class="h">4001</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ expand_group([ $area-&gt;{anchor} ], $area-&gt;{name}) };</td></tr>
<tr><td class="h">4002</td><td><div class="c3">34</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4002">50</a></div></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@elements == 1) {</td></tr>
<tr><td class="h">4003</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $elements[0];</td></tr>
<tr><td class="h">4004</td><td><div class="c3">34</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4004">50</a></div></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_network $obj) {</td></tr>
<tr><td class="h">4005</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{anchor} = $obj;</td></tr>
<tr><td class="h">4006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4008</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">4009</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected $obj-&gt;{name} in anchor of $area-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4010</td><td colspan="7"></td></tr><tr><td class="h">4011</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">4012</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $area-&gt;{anchor};</td></tr>
<tr><td class="h">4013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4014</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4016</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">4017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Expected exactly one element in anchor of $area-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4018</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $area-&gt;{anchor};</td></tr>
<tr><td class="h">4019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4020</td><td colspan="7"></td></tr><tr><td class="h">4021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4023</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(border inclusive_border)) {</td></tr>
<tr><td class="h">4024</td><td><div class="c3">196</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4024">100</a></div></td><td></td><td></td><td></td><td><div>400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$area-&gt;{$attr};</td></tr>
<tr><td class="h">4025</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>205</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{$attr} = expand_group($area-&gt;{$attr}, $area-&gt;{name});</td></tr>
<tr><td class="h">4026</td><td><div class="c3">104</div><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>159</div><div>153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@{ $area-&gt;{$attr} }) {</td></tr>
<tr><td class="h">4027</td><td><div class="c3">124</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4027">50</a></div></td><td></td><td></td><td></td><td><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_interface $obj) {</td></tr>
<tr><td class="h">4028</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $obj-&gt;{router};</td></tr>
<tr><td class="h">4029</td><td><div class="c3">124</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4029">50</a></div></td><td></td><td></td><td></td><td><div>310</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed}</td></tr>
<tr><td class="h">4030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Referencing unmanaged $obj-&gt;{name} &quot;,</td></tr>
<tr><td class="h">4031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;from $area-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4032</td><td colspan="7"></td></tr><tr><td class="h">4033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reverse swapped main and virtual interface.</td></tr>
<tr><td class="h">4034</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4034">100</a></div></td><td></td><td></td><td></td><td><div>345</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $main_interface = $obj-&gt;{main_interface}) {</td></tr>
<tr><td class="h">4035</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj = $main_interface;</td></tr>
<tr><td class="h">4036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4039</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">4040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected $obj-&gt;{name} in $attr of $area-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4041</td><td colspan="7"></td></tr><tr><td class="h">4042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">4043</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $area-&gt;{$attr};</td></tr>
<tr><td class="h">4044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4048</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4048">100</a></div></td><td></td><td></td><td></td><td><div>342</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $router_attributes = $area-&gt;{router_attributes}) {</td></tr>
<tr><td class="h">4049</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_policy_distribution_point($router_attributes);</td></tr>
<tr><td class="h">4050</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_general_permit($router_attributes);</td></tr>
<tr><td class="h">4051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4053</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4055</td><td colspan="7"></td></tr><tr><td class="h">4056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Link interfaces with networks in both directions.</td></tr>
<tr><td class="h">4057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_interfaces {</td></tr>
<tr><td class="h">4058</td><td><div class="c3">1925</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4058">1925</a></div></td><td><div class="c0">0</div></td><td><div>1612</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">4059</td><td><div class="c3">1925</div><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>1488</div><div>2654</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4060</td><td><div class="c3">4673</div></td><td></td><td></td><td></td><td></td><td><div>4961</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_name = $interface-&gt;{network};</td></tr>
<tr><td class="h">4061</td><td><div class="c3">4673</div></td><td></td><td></td><td></td><td></td><td><div>5247</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network&nbsp;&nbsp;= $networks{$net_name};</td></tr>
<tr><td class="h">4062</td><td colspan="7"></td></tr><tr><td class="h">4063</td><td><div class="c3">4673</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4063">50</a></div></td><td></td><td></td><td></td><td><div>6752</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($network) {</td></tr>
<tr><td class="h">4064</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &quot;Referencing undefined network:$net_name&quot;</td></tr>
<tr><td class="h">4065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; from $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4066</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4066">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{disabled}) {</td></tr>
<tr><td class="h">4067</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg($msg);</td></tr>
<tr><td class="h">4068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4070</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg($msg);</td></tr>
<tr><td class="h">4071</td><td colspan="7"></td></tr><tr><td class="h">4072</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">4073</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4075</td><td colspan="7"></td></tr><tr><td class="h">4076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors.</td></tr>
<tr><td class="h">4077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This case is handled in disable_behind.</td></tr>
<tr><td class="h">4078</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{network} = undef;</td></tr>
<tr><td class="h">4079</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">4080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4081</td><td colspan="7"></td></tr><tr><td class="h">4082</td><td><div class="c3">4673</div></td><td></td><td></td><td></td><td></td><td><div>4293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{network} = $network;</td></tr>
<tr><td class="h">4083</td><td colspan="7"></td></tr><tr><td class="h">4084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Private network must be connected to private interface</td></tr>
<tr><td class="h">4085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of same context.</td></tr>
<tr><td class="h">4086</td><td><div class="c3">4673</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4086">100</a></div></td><td></td><td></td><td></td><td><div>6908</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private1 = $network-&gt;{private}) {</td></tr>
<tr><td class="h">4087</td><td><div class="c3">9</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4087">100</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private2 = $interface-&gt;{private}) {</td></tr>
<tr><td class="h">4088</td><td><div class="c3">7</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4088">100</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private1 eq $private2</td></tr>
<tr><td class="h">4089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">4090</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$private2.private $interface-&gt;{name} must not&quot;,</td></tr>
<tr><td class="h">4091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; be connected to $private1.private&quot;,</td></tr>
<tr><td class="h">4092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $network-&gt;{name}&quot;</td></tr>
<tr><td class="h">4093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4094</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4096</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Public $interface-&gt;{name} must not be connected to&quot;,</td></tr>
<tr><td class="h">4097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $private1.private $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4099</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4100</td><td colspan="7"></td></tr><tr><td class="h">4101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Public network may connect to private interface.</td></tr>
<tr><td class="h">4102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The owner of a private context can prevent a public network from</td></tr>
<tr><td class="h">4103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# connecting to a private interface by simply connecting an own private</td></tr>
<tr><td class="h">4104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# network to the private interface.</td></tr>
<tr><td class="h">4105</td><td colspan="7"></td></tr><tr><td class="h">4106</td><td><div class="c3">4673</div><div class="c3">4673</div></td><td></td><td></td><td></td><td></td><td><div>3486</div><div>6528</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $network-&gt;{interfaces} }, $interface;</td></tr>
<tr><td class="h">4107</td><td><div class="c3">4673</div></td><td></td><td></td><td></td><td></td><td><div>6541</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_interface_ip($interface, $network);</td></tr>
<tr><td class="h">4108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4109</td><td><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>1991</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4111</td><td colspan="7"></td></tr><tr><td class="h">4112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_interface_ip {</td></tr>
<tr><td class="h">4113</td><td><div class="c3">4713</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4113">4713</a></div></td><td><div class="c0">0</div></td><td><div>3898</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $network) = @_;</td></tr>
<tr><td class="h">4114</td><td><div class="c3">4713</div></td><td></td><td></td><td></td><td></td><td><div>4393</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{ip};</td></tr>
<tr><td class="h">4115</td><td><div class="c3">4713</div></td><td></td><td></td><td></td><td></td><td><div>4092</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $network_ip = $network-&gt;{ip};</td></tr>
<tr><td class="h">4116</td><td><div class="c3">4713</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4116">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4116">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4116">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4116">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4116">100</a></div></td><td></td><td></td><td></td><td><div>15997</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($ip =~ /^(?:short|tunnel)$/) {</td></tr>
<tr><td class="h">4117</td><td colspan="7"></td></tr><tr><td class="h">4118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Nothing to check:</td></tr>
<tr><td class="h">4119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# short interface may be linked to arbitrary network,</td></tr>
<tr><td class="h">4120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# tunnel interfaces and networks have been generated internally.</td></tr>
<tr><td class="h">4121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($ip eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">4123</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4123">50</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network_ip eq &#39;unnumbered&#39;</td></tr>
<tr><td class="h">4124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Unnumbered $interface-&gt;{name} must not be linked &quot;,</td></tr>
<tr><td class="h">4125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;to $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($network_ip eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">4128</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">4129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$interface-&gt;{name} must not be linked &quot;,</td></tr>
<tr><td class="h">4130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;to unnumbered $network-&gt;{name}&quot;</td></tr>
<tr><td class="h">4131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($ip eq &#39;negotiated&#39;) {</td></tr>
<tr><td class="h">4134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($ip eq &#39;bridged&#39;) {</td></tr>
<tr><td class="h">4136</td><td colspan="7"></td></tr><tr><td class="h">4137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Nothing to be checked: attribute &#39;bridged&#39; is set automatically</td></tr>
<tr><td class="h">4138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# for an interface without IP and linked to bridged network.</td></tr>
<tr><td class="h">4139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4141</td><td colspan="7"></td></tr><tr><td class="h">4142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check compatibility of interface IP and network IP/mask.</td></tr>
<tr><td class="h">4143</td><td><div class="c3">4130</div></td><td></td><td></td><td></td><td></td><td><div>3611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = $network-&gt;{mask};</td></tr>
<tr><td class="h">4144</td><td><div class="c3">4130</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4144">50</a></div></td><td></td><td></td><td></td><td><div>6377</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not(match_ip($ip, $network_ip, $mask))) {</td></tr>
<tr><td class="h">4145</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$interface-&gt;{name}&#39;s IP doesn&#39;t match &quot;,</td></tr>
<tr><td class="h">4146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$network-&gt;{name}&#39;s IP/mask&quot;);</td></tr>
<tr><td class="h">4147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4148</td><td><div class="c3">4130</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4148">100</a></div></td><td></td><td></td><td></td><td><div>5531</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($mask == 0xffffffff) {</td></tr>
<tr><td class="h">4149</td><td><div class="c3">82</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4149">100</a></div></td><td></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $network-&gt;{loopback}) {</td></tr>
<tr><td class="h">4150</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">4151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$interface-&gt;{name} has address of its network.\n&quot;,</td></tr>
<tr><td class="h">4152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Remove definition of $network-&gt;{name} and\n&quot;,</td></tr>
<tr><td class="h">4153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; add attribute &#39;loopback&#39; at&quot;,</td></tr>
<tr><td class="h">4154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; interface definition.&quot;</td></tr>
<tr><td class="h">4155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4159</td><td><div class="c3">4048</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4159">50</a></div></td><td></td><td></td><td></td><td><div>5514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip == $network_ip) {</td></tr>
<tr><td class="h">4160</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$interface-&gt;{name} has address of its network&quot;);</td></tr>
<tr><td class="h">4161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4162</td><td><div class="c3">4048</div></td><td></td><td></td><td></td><td></td><td><div>5753</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $broadcast = $network_ip + complement_32bit $mask;</td></tr>
<tr><td class="h">4163</td><td><div class="c3">4048</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4163">50</a></div></td><td></td><td></td><td></td><td><div>6395</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip == $broadcast) {</td></tr>
<tr><td class="h">4164</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$interface-&gt;{name} has broadcast address&quot;);</td></tr>
<tr><td class="h">4165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4168</td><td><div class="c3">4713</div></td><td></td><td></td><td></td><td></td><td><div>7122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4170</td><td colspan="7"></td></tr><tr><td class="h">4171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Iterate over all interfaces of all routers.</td></tr>
<tr><td class="h">4172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Don&#39;t use values %interfaces because we want to traverse the interfaces</td></tr>
<tr><td class="h">4173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># in a deterministic order.</td></tr>
<tr><td class="h">4174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_routers {</td></tr>
<tr><td class="h">4175</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4175">736</a></div></td><td><div class="c0">0</div></td><td><div>2045</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (sort(by_name values %routers), @router_fragments) {</td></tr>
<tr><td class="h">4176</td><td><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>2310</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_interfaces($router);</td></tr>
<tr><td class="h">4177</td><td><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>2374</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_policy_distribution_point($router);</td></tr>
<tr><td class="h">4178</td><td><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>2206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_general_permit($router);</td></tr>
<tr><td class="h">4179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4180</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>752</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4182</td><td colspan="7"></td></tr><tr><td class="h">4183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_subnet {</td></tr>
<tr><td class="h">4184</td><td><div class="c3">3326</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4184">3326</a></div></td><td><div class="c0">0</div></td><td><div>2734</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($object, $parent) = @_;</td></tr>
<tr><td class="h">4185</td><td colspan="7"></td></tr><tr><td class="h">4186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $context = sub {</td></tr>
<tr><td class="h">4187</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4187">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4187">50</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4187">2</a></div></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!$parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $object-&gt;{name}</td></tr>
<tr><td class="h">4188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ref $parent ? &quot;$object-&gt;{name} of $parent-&gt;{name}&quot;</td></tr>
<tr><td class="h">4189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$parent $object-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4190</td><td><div class="c3">3326</div></td><td></td><td></td><td></td><td></td><td><div>7043</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">4191</td><td><div class="c3">3326</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4191">100</a></div></td><td></td><td></td><td></td><td><div>10860</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not $object-&gt;{subnet_of};</td></tr>
<tr><td class="h">4192</td><td><div class="c3">82</div><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>74</div><div>150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @{ $object-&gt;{subnet_of} };</td></tr>
<tr><td class="h">4193</td><td><div class="c3">82</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4193">50</a></div></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type ne &#39;network&#39;) {</td></tr>
<tr><td class="h">4194</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Attribute &#39;subnet_of&#39; of &quot;, $context-&gt;(), &quot;\n&quot;,</td></tr>
<tr><td class="h">4195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must not be linked to $type:$name&quot;;</td></tr>
<tr><td class="h">4196</td><td colspan="7"></td></tr><tr><td class="h">4197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors;</td></tr>
<tr><td class="h">4198</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $object-&gt;{subnet_of};</td></tr>
<tr><td class="h">4199</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4201</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $network = $networks{$name};</td></tr>
<tr><td class="h">4202</td><td><div class="c3">82</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4202">50</a></div></td><td></td><td></td><td></td><td><div>149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $network) {</td></tr>
<tr><td class="h">4203</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">4204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ignoring undefined network:$name&quot;,</td></tr>
<tr><td class="h">4205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from attribute &#39;subnet_of&#39;\n of &quot;,</td></tr>
<tr><td class="h">4206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$context-&gt;()</td></tr>
<tr><td class="h">4207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4208</td><td colspan="7"></td></tr><tr><td class="h">4209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors;</td></tr>
<tr><td class="h">4210</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $object-&gt;{subnet_of};</td></tr>
<tr><td class="h">4211</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4213</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{subnet_of} = $network;</td></tr>
<tr><td class="h">4214</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $network-&gt;{ip};</td></tr>
<tr><td class="h">4215</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mask&nbsp;&nbsp;&nbsp;= $network-&gt;{mask};</td></tr>
<tr><td class="h">4216</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $sub_ip = $object-&gt;{ip};</td></tr>
<tr><td class="h">4217</td><td colspan="7"></td></tr><tr><td class="h">4218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug($network-&gt;{name}) if not defined $ip;</td></tr>
<tr><td class="h">4219</td><td><div class="c3">82</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4219">50</a></div></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($ip eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">4220</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Unnumbered $network-&gt;{name} must not be referenced from&quot;,</td></tr>
<tr><td class="h">4221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; attribute &#39;subnet_of&#39;\n of &quot;, $context-&gt;();</td></tr>
<tr><td class="h">4222</td><td colspan="7"></td></tr><tr><td class="h">4223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent further errors;</td></tr>
<tr><td class="h">4224</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $object-&gt;{subnet_of};</td></tr>
<tr><td class="h">4225</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4227</td><td colspan="7"></td></tr><tr><td class="h">4228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $sub_mask needs not to be tested here,</td></tr>
<tr><td class="h">4229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# because it has already been checked for $object.</td></tr>
<tr><td class="h">4230</td><td><div class="c3">82</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4230">100</a></div></td><td></td><td></td><td></td><td><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not(match_ip($sub_ip, $ip, $mask))) {</td></tr>
<tr><td class="h">4231</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg $context-&gt;(), &quot; is subnet_of $network-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; but its IP doesn&#39;t match that&#39;s IP/mask&quot;;</td></tr>
<tr><td class="h">4233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4234</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4236</td><td colspan="7"></td></tr><tr><td class="h">4237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_subnets {</td></tr>
<tr><td class="h">4238</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4238">736</a></div></td><td><div class="c0">0</div></td><td><div>1130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %networks) {</td></tr>
<tr><td class="h">4239</td><td><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>3975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_subnet($network, undef);</td></tr>
<tr><td class="h">4240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4241</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (values %networks, values %aggregates, values %areas) {</td></tr>
<tr><td class="h">4242</td><td><div class="c3">3280</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4242">100</a></div></td><td></td><td></td><td></td><td><div>5417</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $obj-&gt;{nat} or next;</td></tr>
<tr><td class="h">4243</td><td><div class="c3">226</div><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>181</div><div>356</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat (values %{ $obj-&gt;{nat} }) {</td></tr>
<tr><td class="h">4244</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>602</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_subnet($nat, $obj);</td></tr>
<tr><td class="h">4245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4247</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>735</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4249</td><td colspan="7"></td></tr><tr><td class="h">4250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our @pathrestrictions;</td></tr>
<tr><td class="h">4251</td><td colspan="7"></td></tr><tr><td class="h">4252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_pathrestriction {</td></tr>
<tr><td class="h">4253</td><td><div class="c3">56</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4253">56</a></div></td><td><div class="c0">0</div></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $elements) = @_;</td></tr>
<tr><td class="h">4254</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $restrict = new(&#39;Pathrestriction&#39;, name =&gt; $name, elements =&gt; $elements);</td></tr>
<tr><td class="h">4255</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$elements) {</td></tr>
<tr><td class="h">4256</td><td colspan="7"></td></tr><tr><td class="h">4257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;pathrestriction $name at $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4258</td><td><div class="c3">118</div><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>90</div><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $interface-&gt;{path_restrict} }, $restrict;</td></tr>
<tr><td class="h">4259</td><td><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">4260</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4260">100</a></div></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed} or $router-&gt;{semi_managed} = 1;</td></tr>
<tr><td class="h">4261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4262</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @pathrestrictions, $restrict;</td></tr>
<tr><td class="h">4263</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4265</td><td colspan="7"></td></tr><tr><td class="h">4266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_pathrestrictions {</td></tr>
<tr><td class="h">4267</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4267">736</a></div></td><td><div class="c0">0</div></td><td><div>1126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (values %pathrestrictions) {</td></tr>
<tr><td class="h">4268</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{elements} = expand_group $restrict-&gt;{elements},</td></tr>
<tr><td class="h">4269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{name};</td></tr>
<tr><td class="h">4270</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $changed;</td></tr>
<tr><td class="h">4271</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private = my $no_private = $restrict-&gt;{private};</td></tr>
<tr><td class="h">4272</td><td><div class="c3">64</div><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>57</div><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@{ $restrict-&gt;{elements} }) {</td></tr>
<tr><td class="h">4273</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4273">50</a></div></td><td></td><td></td><td></td><td><div>166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not is_interface($obj)) {</td></tr>
<tr><td class="h">4274</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$restrict-&gt;{name} must not reference $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4275</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= undef;</td></tr>
<tr><td class="h">4276</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$changed = 1;</td></tr>
<tr><td class="h">4277</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">4278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4279</td><td colspan="7"></td></tr><tr><td class="h">4280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add pathrestriction to interface.</td></tr>
<tr><td class="h">4281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Multiple restrictions may be applied to a single</td></tr>
<tr><td class="h">4282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interface.</td></tr>
<tr><td class="h">4283</td><td><div class="c3">132</div><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>115</div><div>192</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $obj-&gt;{path_restrict} }, $restrict;</td></tr>
<tr><td class="h">4284</td><td colspan="7"></td></tr><tr><td class="h">4285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Unmanaged router with pathrestriction is handled specially.</td></tr>
<tr><td class="h">4286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It is separating zones, but gets no code.</td></tr>
<tr><td class="h">4287</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $obj-&gt;{router};</td></tr>
<tr><td class="h">4288</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4288">100</a></div></td><td></td><td></td><td></td><td><div>205</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed} or $router-&gt;{semi_managed} = 1;</td></tr>
<tr><td class="h">4289</td><td colspan="7"></td></tr><tr><td class="h">4290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Pathrestrictions must not be applied to secondary interfaces</td></tr>
<tr><td class="h">4291</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4291">50</a></div></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{main_interface}</td></tr>
<tr><td class="h">4292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg &quot;secondary $obj-&gt;{name} must not be used&quot;,</td></tr>
<tr><td class="h">4293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in pathrestriction&quot;;</td></tr>
<tr><td class="h">4294</td><td colspan="7"></td></tr><tr><td class="h">4295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Private pathrestriction must reference at least one interface</td></tr>
<tr><td class="h">4296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of its own context.</td></tr>
<tr><td class="h">4297</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4297">50</a></div></td><td></td><td></td><td></td><td><div>166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($private) {</td></tr>
<tr><td class="h">4298</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4298">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $obj_p = $obj-&gt;{private}) {</td></tr>
<tr><td class="h">4299</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4299">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private eq $obj_p and $no_private = 0;</td></tr>
<tr><td class="h">4300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4302</td><td colspan="7"></td></tr><tr><td class="h">4303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Public pathrestriction must not reference private interface.</td></tr>
<tr><td class="h">4304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4305</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4305">50</a></div></td><td></td><td></td><td></td><td><div>277</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $obj_p = $obj-&gt;{private}) {</td></tr>
<tr><td class="h">4306</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Public $restrict-&gt;{name} must not reference&quot;,</td></tr>
<tr><td class="h">4307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $obj_p.private $obj-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4311</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4311">50</a></div></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_private) {</td></tr>
<tr><td class="h">4312</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;$private.private $restrict-&gt;{name} must reference&quot;,</td></tr>
<tr><td class="h">4313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at least one interface out of $private.private&quot;;</td></tr>
<tr><td class="h">4314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4315</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4315">50</a></div></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($changed) {</td></tr>
<tr><td class="h">4316</td><td><div class="c0">0</div><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{elements} = [ grep { $_ } @{ $restrict-&gt;{elements} } ];</td></tr>
<tr><td class="h">4317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4318</td><td><div class="c3">64</div><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>55</div><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $count = @{ $restrict-&gt;{elements} };</td></tr>
<tr><td class="h">4319</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4319">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4319">50</a></div></td><td></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($count == 1) {</td></tr>
<tr><td class="h">4320</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">4321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ignoring $restrict-&gt;{name} with only&quot;,</td></tr>
<tr><td class="h">4322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $restrict-&gt;{elements}-&gt;[0]-&gt;{name}&quot;</td></tr>
<tr><td class="h">4323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4324</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{elements} = [];</td></tr>
<tr><td class="h">4325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($count == 0) {</td></tr>
<tr><td class="h">4327</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring $restrict-&gt;{name} without elements&quot;);</td></tr>
<tr><td class="h">4328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4329</td><td colspan="7"></td></tr><tr><td class="h">4330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add pathrestriction to tunnel interfaces,</td></tr>
<tr><td class="h">4331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# which belong to real interface.</td></tr>
<tr><td class="h">4332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t count them as extra elements.</td></tr>
<tr><td class="h">4333</td><td><div class="c3">64</div><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>53</div><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $restrict-&gt;{elements} }) {</td></tr>
<tr><td class="h">4334</td><td><div class="c3">132</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4334">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4334">33</a></div></td><td></td><td></td><td><div>503</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not($interface-&gt;{spoke} or $interface-&gt;{hub});</td></tr>
<tr><td class="h">4335</td><td colspan="7"></td></tr><tr><td class="h">4336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t add for no_check interface because traffic would</td></tr>
<tr><td class="h">4337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pass the pathrestriction two times.</td></tr>
<tr><td class="h">4338</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4338">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{no_check};</td></tr>
<tr><td class="h">4339</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">4340</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4341</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_intf = $intf-&gt;{real_interface};</td></tr>
<tr><td class="h">4342</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4342">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $real_intf;</td></tr>
<tr><td class="h">4343</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4343">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $real_intf eq $interface;</td></tr>
<tr><td class="h">4344</td><td colspan="7"></td></tr><tr><td class="h">4345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Adding $restrict-&gt;{name} to $intf-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4346</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $restrict-&gt;{elements} },&nbsp;&nbsp;$intf;</td></tr>
<tr><td class="h">4347</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $intf-&gt;{path_restrict} }, $restrict;</td></tr>
<tr><td class="h">4348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4351</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>688</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4353</td><td colspan="7"></td></tr><tr><td class="h">4354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect groups of virtual interfaces</td></tr>
<tr><td class="h">4355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - be connected to the same network and</td></tr>
<tr><td class="h">4356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - having the same IP address.</td></tr>
<tr><td class="h">4357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Link all virtual interfaces to the group of member interfaces.</td></tr>
<tr><td class="h">4358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check consistency:</td></tr>
<tr><td class="h">4359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - Member interfaces must use identical protocol and identical ID.</td></tr>
<tr><td class="h">4360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - The same ID must not be used by some other group</td></tr>
<tr><td class="h">4361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;- connected to the same network</td></tr>
<tr><td class="h">4362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;- emploing the same redundancy type</td></tr>
<tr><td class="h">4363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_virtual_interfaces {</td></tr>
<tr><td class="h">4364</td><td colspan="7"></td></tr><tr><td class="h">4365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect array of virtual interfaces with same IP at same network.</td></tr>
<tr><td class="h">4366</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4366">736</a></div></td><td><div class="c0">0</div></td><td><div>688</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %net2ip2virtual;</td></tr>
<tr><td class="h">4367</td><td colspan="7"></td></tr><tr><td class="h">4368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Hash table to look up first virtual interface of a group</td></tr>
<tr><td class="h">4369</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# inside the same network and using the same ID and type.</td></tr>
<tr><td class="h">4370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %net2id2type2virtual;</td></tr>
<tr><td class="h">4371</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>904</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $virtual1 (@virtual_interfaces) {</td></tr>
<tr><td class="h">4372</td><td><div class="c3">144</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4372">50</a></div></td><td></td><td></td><td></td><td><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $virtual1-&gt;{disabled};</td></tr>
<tr><td class="h">4373</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip&nbsp;&nbsp;&nbsp;&nbsp;= $virtual1-&gt;{ip};</td></tr>
<tr><td class="h">4374</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net&nbsp;&nbsp;&nbsp;= $virtual1-&gt;{network};</td></tr>
<tr><td class="h">4375</td><td><div class="c3">144</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4375">100</a></div></td><td></td><td></td><td><div>353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type1 = $virtual1-&gt;{redundancy_type} || &#39;&#39;;</td></tr>
<tr><td class="h">4376</td><td><div class="c3">144</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4376">50</a></div></td><td></td><td></td><td><div>341</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id1&nbsp;&nbsp;&nbsp;= $virtual1-&gt;{redundancy_id} || &#39;&#39;;</td></tr>
<tr><td class="h">4377</td><td><div class="c3">144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4377">100</a></div></td><td></td><td></td><td></td><td><div>330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $interfaces = $net2ip2virtual{$net}-&gt;{$ip}) {</td></tr>
<tr><td class="h">4378</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $virtual2 = $interfaces-&gt;[0];</td></tr>
<tr><td class="h">4379</td><td><div class="c3">74</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4379">100</a></div></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type2 = $virtual2-&gt;{redundancy_type} || &#39;&#39;;</td></tr>
<tr><td class="h">4380</td><td><div class="c3">74</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4380">50</a></div></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type1 ne $type2) {</td></tr>
<tr><td class="h">4381</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Virtual IP: $virtual1-&gt;{name} and $virtual2-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; use different redundancy protocols&quot;;</td></tr>
<tr><td class="h">4383</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">4384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4385</td><td><div class="c3">74</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4385">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4385">50</a></div></td><td></td><td></td><td><div>227</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $id1 eq ($virtual2-&gt;{redundancy_id} || &#39;&#39;)) {</td></tr>
<tr><td class="h">4386</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Virtual IP: $virtual1-&gt;{name} and $virtual2-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; use different ID&quot;;</td></tr>
<tr><td class="h">4388</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">4389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4390</td><td colspan="7"></td></tr><tr><td class="h">4391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This changes value of %net2ip2virtual and all attributes</td></tr>
<tr><td class="h">4392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# {redundancy_interfaces} where this array is referenced.</td></tr>
<tr><td class="h">4393</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$interfaces, $virtual1;</td></tr>
<tr><td class="h">4394</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$virtual1-&gt;{redundancy_interfaces} = $interfaces;</td></tr>
<tr><td class="h">4395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4397</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2ip2virtual{$net}-&gt;{$ip} = $virtual1-&gt;{redundancy_interfaces} =</td></tr>
<tr><td class="h">4398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[$virtual1];</td></tr>
<tr><td class="h">4399</td><td colspan="7"></td></tr><tr><td class="h">4400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for identical ID used at unrelated virtual interfaces</td></tr>
<tr><td class="h">4401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# inside the same network.</td></tr>
<tr><td class="h">4402</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4402">50</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($id1) {</td></tr>
<tr><td class="h">4403</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4403">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $virtual2 = $net2id2type2virtual{$net}-&gt;{$id1}-&gt;{$type1})</td></tr>
<tr><td class="h">4404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">4405</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Virtual IP:&quot;,</td></tr>
<tr><td class="h">4406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Unrelated $virtual1-&gt;{name} and $virtual2-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; use identical ID&quot;;</td></tr>
<tr><td class="h">4408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4410</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2id2type2virtual{$net}-&gt;{$id1}-&gt;{$type1} = $virtual1;</td></tr>
<tr><td class="h">4411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4415</td><td colspan="7"></td></tr><tr><td class="h">4416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A virtual interface is used as hop for static routing.</td></tr>
<tr><td class="h">4417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Therefore a network behind this interface must be reachable</td></tr>
<tr><td class="h">4418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# via all virtual interfaces of the group.</td></tr>
<tr><td class="h">4419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This can only be guaranteed, if pathrestrictions are identical</td></tr>
<tr><td class="h">4420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# at all interfaces.</td></tr>
<tr><td class="h">4421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Exception in routing code:</td></tr>
<tr><td class="h">4422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If the group has ony two interfaces, the one or other physical</td></tr>
<tr><td class="h">4423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# interface can be used as hop.</td></tr>
<tr><td class="h">4424</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>641</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">4425</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $href (values %net2ip2virtual) {</td></tr>
<tr><td class="h">4426</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interfaces (values %$href) {</td></tr>
<tr><td class="h">4427</td><td><div class="c3">70</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4427">100</a></div></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if @$interfaces &lt;= 2;</td></tr>
<tr><td class="h">4428</td><td><div class="c3">8</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>11</div><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @virt_routers = map { $_-&gt;{router} } @$interfaces;</td></tr>
<tr><td class="h">4429</td><td><div class="c3">8</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>11</div><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %routers_hash = map { $_ =&gt; $_ } @virt_routers;</td></tr>
<tr><td class="h">4430</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@virt_routers) {</td></tr>
<tr><td class="h">4431</td><td><div class="c3">28</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>20</div><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4432</td><td><div class="c3">110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4432">100</a></div></td><td></td><td></td><td></td><td><div>192</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">4433</td><td><div class="c3">66</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4433">100</a></div></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $restricts = $interface-&gt;{path_restrict} or next;</td></tr>
<tr><td class="h">4434</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$restricts) {</td></tr>
<tr><td class="h">4435</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4435">100</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$restrict};</td></tr>
<tr><td class="h">4436</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @restrict_routers =</td></tr>
<tr><td class="h">4437</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $routers_hash{$_} }</td></tr>
<tr><td class="h">4438</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{router} } @{ $restrict-&gt;{elements} });</td></tr>
<tr><td class="h">4439</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4439">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if @restrict_routers == @virt_routers;</td></tr>
<tr><td class="h">4440</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$restrict} = 1;</td></tr>
<tr><td class="h">4441</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @info;</td></tr>
<tr><td class="h">4442</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@virt_routers) {</td></tr>
<tr><td class="h">4443</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $info = $router-&gt;{name};</td></tr>
<tr><td class="h">4444</td><td><div class="c3">6</div><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4444">100</a></div></td><td></td><td></td><td></td><td><div>6</div><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_ eq $router } @restrict_routers) {</td></tr>
<tr><td class="h">4445</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info .= &quot; has $restrict-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4447</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @info, $info;</td></tr>
<tr><td class="h">4448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">4450</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must apply pathrestriction equally to&quot;,</td></tr>
<tr><td class="h">4451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; group of routers with virtual IP:\n&quot;,</td></tr>
<tr><td class="h">4452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - &quot;,</td></tr>
<tr><td class="h">4453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&quot;\n - &quot;, @info)</td></tr>
<tr><td class="h">4454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4460</td><td colspan="7"></td></tr><tr><td class="h">4461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Automatically add pathrestriction to interfaces belonging to</td></tr>
<tr><td class="h">4462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $net2ip2virtual, if at least one interface is managed.</td></tr>
<tr><td class="h">4463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Pathrestriction would be useless if all devices are unmanaged.</td></tr>
<tr><td class="h">4464</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $href (values %net2ip2virtual) {</td></tr>
<tr><td class="h">4465</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interfaces (values %$href) {</td></tr>
<tr><td class="h">4466</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$interfaces) {</td></tr>
<tr><td class="h">4467</td><td><div class="c3">84</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">4468</td><td><div class="c3">84</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4468">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4468">67</a></div></td><td></td><td></td><td><div>242</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed} || $router-&gt;{routing_only}) {</td></tr>
<tr><td class="h">4469</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name = &quot;auto-virtual-&quot; . print_ip $interface-&gt;{ip};</td></tr>
<tr><td class="h">4470</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_pathrestriction($name, $interfaces);</td></tr>
<tr><td class="h">4471</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">4472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4476</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4478</td><td colspan="7"></td></tr><tr><td class="h">4479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">4480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Check, whether input Interfaces belong to same redundancy group.</td></tr>
<tr><td class="h">4481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : Array keeping all interfaces of a network.</td></tr>
<tr><td class="h">4482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;&nbsp;: True, if all interfacss belong to same redundancy group,</td></tr>
<tr><td class="h">4483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false otherwise.</td></tr>
<tr><td class="h">4484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub is_redundany_group {</td></tr>
<tr><td class="h">4485</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4485">10</a></div></td><td><div class="c0">0</div></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interfaces) = @_;</td></tr>
<tr><td class="h">4486</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4486">100</a></div></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $group = $interfaces-&gt;[0]-&gt;{redundancy_interfaces} or return;</td></tr>
<tr><td class="h">4487</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4487">50</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $count =</td></tr>
<tr><td class="h">4488</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $_-&gt;{redundancy_interfaces} || &#39;&#39; eq $group } @$interfaces);</td></tr>
<tr><td class="h">4489</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $count == @$interfaces;</td></tr>
<tr><td class="h">4490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4491</td><td colspan="7"></td></tr><tr><td class="h">4492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_ip_addresses {</td></tr>
<tr><td class="h">4493</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4493">736</a></div></td><td><div class="c0">0</div></td><td><div>1086</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %networks) {</td></tr>
<tr><td class="h">4494</td><td><div class="c3">3042</div><div class="c3">22</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4494">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4494">50</a></div></td><td></td><td></td><td><div>6293</div><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{ip} eq &#39;unnumbered&#39;</td></tr>
<tr><td class="h">4495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $network-&gt;{interfaces}</td></tr>
<tr><td class="h">4496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and @{ $network-&gt;{interfaces} } &gt; 2)</td></tr>
<tr><td class="h">4497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">4498</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &quot;Unnumbered $network-&gt;{name} is connected to&quot;</td></tr>
<tr><td class="h">4499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; more than two interfaces:&quot;;</td></tr>
<tr><td class="h">4500</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4501</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= &quot;\n $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4503</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg($msg);</td></tr>
<tr><td class="h">4504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4505</td><td colspan="7"></td></tr><tr><td class="h">4506</td><td><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2302</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %ip2obj;</td></tr>
<tr><td class="h">4507</td><td colspan="7"></td></tr><tr><td class="h">4508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 1. Check for duplicate interface addresses.</td></tr>
<tr><td class="h">4509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 2. Short interfaces must not be used, if a managed interface</td></tr>
<tr><td class="h">4510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;with static routing exists in the same network.</td></tr>
<tr><td class="h">4511</td><td><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2225</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($short_intf, $route_intf);</td></tr>
<tr><td class="h">4512</td><td><div class="c3">3042</div><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2259</div><div>3722</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4513</td><td><div class="c3">4766</div></td><td></td><td></td><td></td><td></td><td><div>4456</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $interface-&gt;{ip};</td></tr>
<tr><td class="h">4514</td><td><div class="c3">4766</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4514">100</a></div></td><td></td><td></td><td></td><td><div>5548</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip eq &#39;short&#39;) {</td></tr>
<tr><td class="h">4515</td><td colspan="7"></td></tr><tr><td class="h">4516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore short interface from splitted crypto router.</td></tr>
<tr><td class="h">4517</td><td><div class="c3">466</div><div class="c3">466</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4517">100</a></div></td><td></td><td></td><td></td><td><div>377</div><div>896</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (1 &lt; @{ $interface-&gt;{router}-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4518</td><td><div class="c3">436</div></td><td></td><td></td><td></td><td></td><td><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$short_intf = $interface;</td></tr>
<tr><td class="h">4519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4522</td><td><div class="c3">4300</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4522">100</a></div></td><td></td><td></td><td></td><td><div>8027</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($ip =~ /^(?:unnumbered|negotiated|tunnel|bridged)$/) {</td></tr>
<tr><td class="h">4523</td><td><div class="c3">4130</div></td><td></td><td></td><td></td><td></td><td><div>3495</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">4524</td><td><div class="c3">4130</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4524">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4524">100</a></div></td><td></td><td></td><td><div>14879</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($router-&gt;{managed} || $router-&gt;{routing_only})</td></tr>
<tr><td class="h">4525</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; !$interface-&gt;{routing})</td></tr>
<tr><td class="h">4526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">4527</td><td><div class="c3">2420</div></td><td></td><td></td><td></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$route_intf = $interface;</td></tr>
<tr><td class="h">4528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4529</td><td><div class="c3">4130</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4529">100</a></div></td><td></td><td></td><td></td><td><div>5378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $old_intf = $ip2obj{$ip}) {</td></tr>
<tr><td class="h">4530</td><td><div class="c3">78</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4530">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4530">67</a></div></td><td></td><td></td><td><div>280</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($old_intf-&gt;{redundant}</td></tr>
<tr><td class="h">4531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $interface-&gt;{redundant})</td></tr>
<tr><td class="h">4532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">4533</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Duplicate IP address for&quot;,</td></tr>
<tr><td class="h">4534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $old_intf-&gt;{name} and $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4538</td><td><div class="c3">4052</div></td><td></td><td></td><td></td><td></td><td><div>5720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ip2obj{$ip} = $interface;</td></tr>
<tr><td class="h">4539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4542</td><td><div class="c3">4766</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4542">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4542">100</a></div></td><td></td><td></td><td><div>10726</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($short_intf and $route_intf) {</td></tr>
<tr><td class="h">4543</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;$short_intf-&gt;{name} must be defined in more detail,&quot;,</td></tr>
<tr><td class="h">4544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; since there is\n&quot;,</td></tr>
<tr><td class="h">4545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; a managed $route_intf-&gt;{name} with static routing enabled.&quot;;</td></tr>
<tr><td class="h">4546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4548</td><td><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %range2obj;</td></tr>
<tr><td class="h">4549</td><td><div class="c3">3042</div><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2255</div><div>4041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">4550</td><td><div class="c3">433</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4550">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4550">50</a></div></td><td></td><td></td><td></td><td><div>790</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = $host-&gt;{ip}) {</td></tr>
<tr><td class="h">4551</td><td><div class="c3">391</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4551">100</a></div></td><td></td><td></td><td></td><td><div>657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other_device = $ip2obj{$ip}) {</td></tr>
<tr><td class="h">4552</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Duplicate IP address for $other_device-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; and $host-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4556</td><td><div class="c3">383</div></td><td></td><td></td><td></td><td></td><td><div>692</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ip2obj{$ip} = $host;</td></tr>
<tr><td class="h">4557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $range = $host-&gt;{range}) {</td></tr>
<tr><td class="h">4560</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($from, $to) = @$range;</td></tr>
<tr><td class="h">4561</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4561">100</a></div></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other_device = $range2obj{$from}-&gt;{$to}) {</td></tr>
<tr><td class="h">4562</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Duplicate IP range for $other_device-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; and $host-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4566</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>518</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$range2obj{$from}-&gt;{$to} = $host;</td></tr>
<tr><td class="h">4567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4570</td><td><div class="c3">3042</div><div class="c3">3042</div></td><td></td><td></td><td></td><td></td><td><div>2926</div><div>5688</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">4571</td><td><div class="c3">433</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4571">100</a></div></td><td></td><td></td><td></td><td><div>1273</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $range = $host-&gt;{range}) {</td></tr>
<tr><td class="h">4572</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (my $ip = $range-&gt;[0] ; $ip &lt;= $range-&gt;[1] ; $ip++) {</td></tr>
<tr><td class="h">4573</td><td><div class="c3">1548</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4573">100</a></div></td><td></td><td></td><td></td><td><div>3313</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other_device = $ip2obj{$ip}) {</td></tr>
<tr><td class="h">4574</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4574">100</a></div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_host($other_device)</td></tr>
<tr><td class="h">4575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">4576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Duplicate IP address for&quot;,</td></tr>
<tr><td class="h">4577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $other_device-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; and $host-&gt;{name}&quot;</td></tr>
<tr><td class="h">4579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4585</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>778</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4587</td><td colspan="7"></td></tr><tr><td class="h">4588</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_ipsec;</td></tr>
<tr><td class="h">4589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_crypto;</td></tr>
<tr><td class="h">4590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_tunnels;</td></tr>
<tr><td class="h">4591</td><td colspan="7"></td></tr><tr><td class="h">4592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_topology {</td></tr>
<tr><td class="h">4593</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4593">736</a></div></td><td><div class="c0">0</div></td><td><div>1482</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Linking topology&#39;);</td></tr>
<tr><td class="h">4594</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>984</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_routers;</td></tr>
<tr><td class="h">4595</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1062</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_ipsec;</td></tr>
<tr><td class="h">4596</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>983</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_crypto;</td></tr>
<tr><td class="h">4597</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1057</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_tunnels;</td></tr>
<tr><td class="h">4598</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_pathrestrictions;</td></tr>
<tr><td class="h">4599</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_virtual_interfaces;</td></tr>
<tr><td class="h">4600</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>963</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_areas;</td></tr>
<tr><td class="h">4601</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_subnets;</td></tr>
<tr><td class="h">4602</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1018</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_owners;</td></tr>
<tr><td class="h">4603</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_ip_addresses();</td></tr>
<tr><td class="h">4604</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>653</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4606</td><td colspan="7"></td></tr><tr><td class="h">4607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">4608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark all parts of the topology located behind disabled interfaces.</td></tr>
<tr><td class="h">4609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># &quot;Behind&quot; is defined like this:</td></tr>
<tr><td class="h">4610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Look from a router to its interfaces;</td></tr>
<tr><td class="h">4611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># if an interface is marked as disabled,</td></tr>
<tr><td class="h">4612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># recursively mark the whole part of the topology located behind</td></tr>
<tr><td class="h">4613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># this interface as disabled.</td></tr>
<tr><td class="h">4614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Be cautious with loops:</td></tr>
<tr><td class="h">4615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark all interfaces at loop entry as disabled,</td></tr>
<tr><td class="h">4616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># otherwise the whole topology will get disabled.</td></tr>
<tr><td class="h">4617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">4618</td><td colspan="7"></td></tr><tr><td class="h">4619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub disable_behind;</td></tr>
<tr><td class="h">4620</td><td colspan="7"></td></tr><tr><td class="h">4621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub disable_behind {</td></tr>
<tr><td class="h">4622</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4622">6</a></div></td><td><div class="c0">0</div></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($in_interface) = @_;</td></tr>
<tr><td class="h">4623</td><td colspan="7"></td></tr><tr><td class="h">4624</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;debug(&quot;disable_behind $in_interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4625</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$in_interface-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4626</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $network = $in_interface-&gt;{network};</td></tr>
<tr><td class="h">4627</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4627">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4627">67</a></div></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $network or $network-&gt;{disabled}) {</td></tr>
<tr><td class="h">4628</td><td colspan="7"></td></tr><tr><td class="h">4629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Stop disabling at $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4630</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4632</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4633</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">4634</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4636</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4637</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4637">100</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_interface;</td></tr>
<tr><td class="h">4638</td><td colspan="7"></td></tr><tr><td class="h">4639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This stops at other entry of a loop as well.</td></tr>
<tr><td class="h">4640</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4640">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{disabled}) {</td></tr>
<tr><td class="h">4641</td><td colspan="7"></td></tr><tr><td class="h">4642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Stop disabling at $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">4643</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">4644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4645</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4646</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">4647</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4648</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4649</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4649">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $interface;</td></tr>
<tr><td class="h">4650</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_behind $out_interface ;</td></tr>
<tr><td class="h">4651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4652</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4653</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4655</td><td colspan="7"></td></tr><tr><td class="h">4656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Lists of network objects which are left over after disabling.</td></tr>
<tr><td class="h">4657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#my @managed_routers;&nbsp;&nbsp;&nbsp;# defined above</td></tr>
<tr><td class="h">4658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @routing_only_routers;</td></tr>
<tr><td class="h">4659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @managed_crypto_hubs;</td></tr>
<tr><td class="h">4660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @routers;</td></tr>
<tr><td class="h">4661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @networks;</td></tr>
<tr><td class="h">4662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @zones;</td></tr>
<tr><td class="h">4663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @areas;</td></tr>
<tr><td class="h">4664</td><td colspan="7"></td></tr><tr><td class="h">4665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Group bridged networks by prefix of name.</td></tr>
<tr><td class="h">4666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Each group</td></tr>
<tr><td class="h">4667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - must have the same IP address and mask,</td></tr>
<tr><td class="h">4668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - must have at least two members,</td></tr>
<tr><td class="h">4669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - must be adjacent</td></tr>
<tr><td class="h">4670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - linked by bridged interfaces</td></tr>
<tr><td class="h">4671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - IP addresses of hosts must be disjoint (ToDo).</td></tr>
<tr><td class="h">4672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Each router having a bridged interface</td></tr>
<tr><td class="h">4673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># must connect at least two bridged networks of the same group.</td></tr>
<tr><td class="h">4674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_bridged_networks {</td></tr>
<tr><td class="h">4675</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4675">736</a></div></td><td><div class="c0">0</div></td><td><div>616</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %prefix2net;</td></tr>
<tr><td class="h">4676</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">4677</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4677">100</a></div></td><td></td><td></td><td></td><td><div>5385</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = $network-&gt;{bridged} or next;</td></tr>
<tr><td class="h">4678</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prefix2net{$prefix}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">4679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4680</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1390</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $prefix (keys %prefix2net) {</td></tr>
<tr><td class="h">4681</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4681">50</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $network = $networks{$prefix}) {</td></tr>
<tr><td class="h">4682</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4682">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{disabled}</td></tr>
<tr><td class="h">4683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Must not define $network-&gt;{name} together with&quot;,</td></tr>
<tr><td class="h">4684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; bridged networks of same name&quot;);</td></tr>
<tr><td class="h">4685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4687</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $href (values %prefix2net) {</td></tr>
<tr><td class="h">4688</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @group = values %$href;</td></tr>
<tr><td class="h">4689</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net1&nbsp;&nbsp;= pop(@group);</td></tr>
<tr><td class="h">4690</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4690">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@group or warn_msg(&quot;Bridged $net1-&gt;{name} must not be used solitary&quot;);</td></tr>
<tr><td class="h">4691</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">4692</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @next = ($net1);</td></tr>
<tr><td class="h">4693</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip1, $mask1) = @{$net1}{qw(ip mask)};</td></tr>
<tr><td class="h">4694</td><td colspan="7"></td></tr><tr><td class="h">4695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark all networks connected directly or indirectly with $net1</td></tr>
<tr><td class="h">4696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# by a bridge as &#39;connected&#39; in $href.</td></tr>
<tr><td class="h">4697</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my $network = pop(@next)) {</td></tr>
<tr><td class="h">4698</td><td><div class="c3">32</div><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>30</div><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$network}{qw(ip mask)};</td></tr>
<tr><td class="h">4699</td><td><div class="c3">32</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4699">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4699">33</a></div></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ip == $ip1 and $mask == $mask1</td></tr>
<tr><td class="h">4700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;$net1-&gt;{name} and $network-&gt;{name} must have&quot;,</td></tr>
<tr><td class="h">4701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; identical ip/mask&quot;);</td></tr>
<tr><td class="h">4702</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$href-&gt;{$network} = &#39;connected&#39;;</td></tr>
<tr><td class="h">4703</td><td><div class="c3">32</div><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>26</div><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $in_intf (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4704</td><td><div class="c3">54</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4704">100</a></div></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_intf-&gt;{ip} ne &#39;bridged&#39;;</td></tr>
<tr><td class="h">4705</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_intf-&gt;{router};</td></tr>
<tr><td class="h">4706</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4706">100</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$router};</td></tr>
<tr><td class="h">4707</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $count = 1;</td></tr>
<tr><td class="h">4708</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$router} = $router;</td></tr>
<tr><td class="h">4709</td><td><div class="c3">16</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4709">50</a></div></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $layer3_intf = $in_intf-&gt;{layer3_interface}) {</td></tr>
<tr><td class="h">4710</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4710">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_ip($layer3_intf-&gt;{ip}, $ip, $mask)</td></tr>
<tr><td class="h">4711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;$layer3_intf-&gt;{name}&#39;s IP doesn&#39;t match&quot;,</td></tr>
<tr><td class="h">4712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; IP/mask of bridged networks&quot;);</td></tr>
<tr><td class="h">4713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4714</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4715</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4715">100</a></div></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $in_intf;</td></tr>
<tr><td class="h">4716</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4716">100</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf-&gt;{ip} ne &#39;bridged&#39;;</td></tr>
<tr><td class="h">4717</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_net = $out_intf-&gt;{network};</td></tr>
<tr><td class="h">4718</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4718">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $href-&gt;{$next_net};</td></tr>
<tr><td class="h">4719</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@next, $out_intf-&gt;{network});</td></tr>
<tr><td class="h">4720</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count++;</td></tr>
<tr><td class="h">4721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4722</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4722">50</a></div></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count &gt; 1</td></tr>
<tr><td class="h">4723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;$router-&gt;{name} can&#39;t bridge a single network&quot;);</td></tr>
<tr><td class="h">4724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4726</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@group) {</td></tr>
<tr><td class="h">4727</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4727">50</a></div></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$href-&gt;{$network} eq &#39;connected&#39;</td></tr>
<tr><td class="h">4728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">4729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$network-&gt;{name} and $net1-&gt;{name}&quot;,</td></tr>
<tr><td class="h">4730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must be connected by bridge&quot;</td></tr>
<tr><td class="h">4731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4734</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>962</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4736</td><td colspan="7"></td></tr><tr><td class="h">4737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_disabled {</td></tr>
<tr><td class="h">4738</td><td><div class="c3">736</div><div class="c3">4667</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4738">736</a></div></td><td><div class="c0">0</div></td><td><div>1363</div><div>4895</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @disabled_interfaces = grep { $_-&gt;{disabled} } values %interfaces;</td></tr>
<tr><td class="h">4739</td><td colspan="7"></td></tr><tr><td class="h">4740</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>935</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@disabled_interfaces) {</td></tr>
<tr><td class="h">4741</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4741">50</a></div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{router}-&gt;{disabled};</td></tr>
<tr><td class="h">4742</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_behind($interface);</td></tr>
<tr><td class="h">4743</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4743">50</a></div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{router}-&gt;{disabled}) {</td></tr>
<tr><td class="h">4744</td><td colspan="7"></td></tr><tr><td class="h">4745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We reached an initial element of @disabled_interfaces,</td></tr>
<tr><td class="h">4746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# which seems to be part of a loop.</td></tr>
<tr><td class="h">4747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is dangerous, since the whole topology</td></tr>
<tr><td class="h">4748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# may be disabled by accident.</td></tr>
<tr><td class="h">4749</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;$interface-&gt;{name} must not be disabled,\n&quot;,</td></tr>
<tr><td class="h">4750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; since it is part of a loop&quot;;</td></tr>
<tr><td class="h">4751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4753</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>864</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@disabled_interfaces) {</td></tr>
<tr><td class="h">4754</td><td colspan="7"></td></tr><tr><td class="h">4755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Delete disabled interfaces from routers.</td></tr>
<tr><td class="h">4756</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">4757</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_delete($router-&gt;{interfaces}, $interface);</td></tr>
<tr><td class="h">4758</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4758">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4758">33</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed} || $router-&gt;{routing_only}) {</td></tr>
<tr><td class="h">4759</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_delete($interface-&gt;{hardware}-&gt;{interfaces}, $interface);</td></tr>
<tr><td class="h">4760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4762</td><td colspan="7"></td></tr><tr><td class="h">4763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Disable area, where all interfaces or anchor are disabled.</td></tr>
<tr><td class="h">4764</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1779</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (sort by_name values %areas) {</td></tr>
<tr><td class="h">4765</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>119</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ok;</td></tr>
<tr><td class="h">4766</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4766">100</a></div></td><td></td><td></td><td></td><td><div>240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $anchor = $area-&gt;{anchor}) {</td></tr>
<tr><td class="h">4767</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok = !$anchor-&gt;{disabled};</td></tr>
<tr><td class="h">4768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4770</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(border inclusive_border)) {</td></tr>
<tr><td class="h">4771</td><td><div class="c3">196</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4771">100</a></div></td><td></td><td></td><td></td><td><div>418</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $borders = $area-&gt;{$attr} or next;</td></tr>
<tr><td class="h">4772</td><td><div class="c3">104</div><div class="c3">124</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4772">50</a></div></td><td></td><td></td><td></td><td><div>122</div><div>347</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my @active_borders = grep { !$_-&gt;{disabled} } @$borders) {</td></tr>
<tr><td class="h">4773</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{$attr} = \@active_borders;</td></tr>
<tr><td class="h">4774</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok = 1;</td></tr>
<tr><td class="h">4775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4776</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4778</td><td><div class="c3">132</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4778">50</a></div></td><td></td><td></td><td></td><td><div>217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ok) {</td></tr>
<tr><td class="h">4779</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>343</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @areas, $area;</td></tr>
<tr><td class="h">4780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4782</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4785</td><td colspan="7"></td></tr><tr><td class="h">4786</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1599</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (sort(by_name values %routers), @router_fragments) {</td></tr>
<tr><td class="h">4787</td><td><div class="c3">1925</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4787">50</a></div></td><td></td><td></td><td></td><td><div>2885</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{disabled};</td></tr>
<tr><td class="h">4788</td><td><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>1667</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @routers, $router;</td></tr>
<tr><td class="h">4789</td><td><div class="c3">1925</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4789">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4789">100</a></div></td><td></td><td></td><td></td><td><div>3107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed}) {</td></tr>
<tr><td class="h">4790</td><td><div class="c3">1450</div></td><td></td><td></td><td></td><td></td><td><div>1690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @managed_routers, $router;</td></tr>
<tr><td class="h">4791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($router-&gt;{routing_only}) {</td></tr>
<tr><td class="h">4793</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @routing_only_routers, $router;</td></tr>
<tr><td class="h">4794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4796</td><td colspan="7"></td></tr><tr><td class="h">4797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect vrf instances belonging to one device.</td></tr>
<tr><td class="h">4798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This includes different managed hosts with identical server_name.</td></tr>
<tr><td class="h">4799</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>726</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %name2vrf;</td></tr>
<tr><td class="h">4800</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">4801</td><td><div class="c3">1505</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4801">100</a></div></td><td></td><td></td><td></td><td><div>2238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{orig_router};</td></tr>
<tr><td class="h">4802</td><td><div class="c3">1463</div></td><td></td><td></td><td></td><td></td><td><div>1451</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $device_name = $router-&gt;{device_name};</td></tr>
<tr><td class="h">4803</td><td><div class="c3">1463</div><div class="c3">1463</div></td><td></td><td></td><td></td><td></td><td><div>1075</div><div>2918</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $name2vrf{$device_name} }, $router;</td></tr>
<tr><td class="h">4804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4805</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $aref (values %name2vrf) {</td></tr>
<tr><td class="h">4806</td><td><div class="c3">1453</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4806">100</a></div></td><td></td><td></td><td></td><td><div>2599</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if @$aref == 1;</td></tr>
<tr><td class="h">4807</td><td><div class="c3">20</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4807">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4807">67</a></div></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal(</td></tr>
<tr><td class="h">4808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map {</td></tr>
<tr><td class="h">4809</td><td><div class="c3">10</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4809">50</a></div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_-&gt;{managed} || $_-&gt;{routing_only}</td></tr>
<tr><td class="h">4810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $_-&gt;{model}-&gt;{name}</td></tr>
<tr><td class="h">4811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ()</td></tr>
<tr><td class="h">4812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} @$aref</td></tr>
<tr><td class="h">4813</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">4814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">4815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;All VRF instances of router:$aref-&gt;[0]-&gt;{device_name}&quot;,</td></tr>
<tr><td class="h">4816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must have identical model&quot;</td></tr>
<tr><td class="h">4817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4818</td><td colspan="7"></td></tr><tr><td class="h">4819</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %hardware;</td></tr>
<tr><td class="h">4820</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@$aref) {</td></tr>
<tr><td class="h">4821</td><td><div class="c3">20</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>17</div><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">4822</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name = $hardware-&gt;{name};</td></tr>
<tr><td class="h">4823</td><td><div class="c3">36</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4823">50</a></div></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $hardware{$name}) {</td></tr>
<tr><td class="h">4824</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">4825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Duplicate hardware &#39;$name&#39; at&quot;,</td></tr>
<tr><td class="h">4826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $other-&gt;{name} and $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">4827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4830</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware{$name} = $router;</td></tr>
<tr><td class="h">4831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4834</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $shared_hash = {};</td></tr>
<tr><td class="h">4835</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@$aref) {</td></tr>
<tr><td class="h">4836</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{vrf_members}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $aref;</td></tr>
<tr><td class="h">4837</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{vrf_shared_data} = $shared_hash;</td></tr>
<tr><td class="h">4838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4840</td><td colspan="7"></td></tr><tr><td class="h">4841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect networks into @networks.</td></tr>
<tr><td class="h">4842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# We need a deterministic order.</td></tr>
<tr><td class="h">4843</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t sort by name because code shouldn&#39;t change if a network is renamed.</td></tr>
<tr><td class="h">4844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Derive order from order of routers and interfaces.</td></tr>
<tr><td class="h">4845</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>797</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">4846</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>799</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@routers) {</td></tr>
<tr><td class="h">4847</td><td><div class="c3">1925</div><div class="c3">1925</div></td><td></td><td></td><td></td><td></td><td><div>1479</div><div>2354</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">4848</td><td><div class="c3">4720</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4848">50</a></div></td><td></td><td></td><td></td><td><div>6390</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{disabled};</td></tr>
<tr><td class="h">4849</td><td><div class="c3">4720</div></td><td></td><td></td><td></td><td></td><td><div>3891</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">4850</td><td><div class="c3">4720</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4850">100</a></div></td><td></td><td></td><td></td><td><div>12534</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$network}++ or push @networks, $network;</td></tr>
<tr><td class="h">4851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4853</td><td colspan="7"></td></tr><tr><td class="h">4854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find networks not connected to any router.</td></tr>
<tr><td class="h">4855</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %networks) {</td></tr>
<tr><td class="h">4856</td><td><div class="c3">3042</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4856">100</a></div></td><td></td><td></td><td></td><td><div>4152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{disabled};</td></tr>
<tr><td class="h">4857</td><td><div class="c3">3038</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4857">100</a></div></td><td></td><td></td><td></td><td><div>6057</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$seen{$network}) {</td></tr>
<tr><td class="h">4858</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4858">100</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (keys %networks &gt; 1) {</td></tr>
<tr><td class="h">4859</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$network-&gt;{name} isn&#39;t connected to any router&quot;);</td></tr>
<tr><td class="h">4860</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">4861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4863</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @networks, $network;</td></tr>
<tr><td class="h">4864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4867</td><td colspan="7"></td></tr><tr><td class="h">4868</td><td><div class="c3">736</div><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>1096</div><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@virtual_interfaces = grep { not $_-&gt;{disabled} } @virtual_interfaces;</td></tr>
<tr><td class="h">4869</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1007</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_bridged_networks();</td></tr>
<tr><td class="h">4870</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1763</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">4871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4872</td><td colspan="7"></td></tr><tr><td class="h">4873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">4874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Convert hosts to subnets.</td></tr>
<tr><td class="h">4875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find adjacent subnets.</td></tr>
<tr><td class="h">4876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark subnet relation of subnets.</td></tr>
<tr><td class="h">4877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">4878</td><td colspan="7"></td></tr><tr><td class="h">4879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 255.255.255.255, 127.255.255.255, ..., 0.0.0.3, 0.0.0.1, 0.0.0.0</td></tr>
<tr><td class="h">4880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @inverse_masks = map { complement_32bit prefix2mask $_ } (0 .. 32);</td></tr>
<tr><td class="h">4881</td><td colspan="7"></td></tr><tr><td class="h">4882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Convert an IP range to a set of covering IP/mask pairs.</td></tr>
<tr><td class="h">4883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub split_ip_range {</td></tr>
<tr><td class="h">4884</td><td><div class="c3">42</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4884">42</a></div></td><td><div class="c0">0</div></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($low, $high) = @_;</td></tr>
<tr><td class="h">4885</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">4886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;IP:</td></tr>
<tr><td class="h">4887</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ($low &lt;= $high) {</td></tr>
<tr><td class="h">4888</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $mask (@inverse_masks) {</td></tr>
<tr><td class="h">4889</td><td><div class="c3">2400</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4889">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4889">100</a></div></td><td></td><td></td><td><div>3990</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($low &amp; $mask) == 0 &amp;&amp; ($low + $mask) &lt;= $high) {</td></tr>
<tr><td class="h">4890</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, [ $low, complement_32bit $mask ];</td></tr>
<tr><td class="h">4891</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$low = $low + $mask + 1;</td></tr>
<tr><td class="h">4892</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next IP;</td></tr>
<tr><td class="h">4893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4896</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @result;</td></tr>
<tr><td class="h">4897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">4898</td><td colspan="7"></td></tr><tr><td class="h">4899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub convert_hosts {</td></tr>
<tr><td class="h">4900</td><td><div class="c3">704</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L4900">704</a></div></td><td><div class="c0">0</div></td><td><div>1258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Converting hosts to subnets&#39;);</td></tr>
<tr><td class="h">4901</td><td><div class="c3">704</div></td><td></td><td></td><td></td><td></td><td><div>816</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">4902</td><td><div class="c3">3184</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4902">100</a></div></td><td></td><td></td><td></td><td><div>6795</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{ip} =~ /^(?:unnumbered|tunnel)$/;</td></tr>
<tr><td class="h">4903</td><td><div class="c3">3115</div></td><td></td><td></td><td></td><td></td><td><div>2268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @inv_prefix_aref;</td></tr>
<tr><td class="h">4904</td><td colspan="7"></td></tr><tr><td class="h">4905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Converts hosts and ranges to subnets.</td></tr>
<tr><td class="h">4906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Eliminate duplicate subnets.</td></tr>
<tr><td class="h">4907</td><td><div class="c3">3115</div><div class="c3">3115</div></td><td></td><td></td><td></td><td></td><td><div>2348</div><div>4228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">4908</td><td><div class="c3">419</div></td><td></td><td></td><td></td><td></td><td><div>870</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $nat, $id, $private, $owner) =</td></tr>
<tr><td class="h">4909</td><td><div class="c3">419</div></td><td></td><td></td><td></td><td></td><td><div>425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$host}{qw(name nat id private owner)};</td></tr>
<tr><td class="h">4910</td><td><div class="c3">419</div></td><td></td><td></td><td></td><td></td><td><div>508</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @ip_mask;</td></tr>
<tr><td class="h">4911</td><td><div class="c3">419</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4911">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4911">50</a></div></td><td></td><td></td><td></td><td><div>890</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = $host-&gt;{ip}) {</td></tr>
<tr><td class="h">4912</td><td><div class="c3">377</div></td><td></td><td></td><td></td><td></td><td><div>594</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ip_mask = [ $ip, 0xffffffff ];</td></tr>
<tr><td class="h">4913</td><td><div class="c3">377</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4913">100</a></div></td><td></td><td></td><td></td><td><div>649</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($id) {</td></tr>
<tr><td class="h">4914</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4914">100</a></div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($user, $dom) = ($id =~ /^(.*?)(\@.*)$/)) {</td></tr>
<tr><td class="h">4915</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4915">100</a></div></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user</td></tr>
<tr><td class="h">4916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">4917</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ID of $name must not start&quot;,</td></tr>
<tr><td class="h">4918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; with character &#39;\@&#39;&quot;</td></tr>
<tr><td class="h">4919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4922</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;ID of $name must contain character &#39;\@&#39;&quot;);</td></tr>
<tr><td class="h">4923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($host-&gt;{range}) {</td></tr>
<tr><td class="h">4927</td><td><div class="c3">42</div><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>40</div><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip1, $ip2) = @{ $host-&gt;{range} };</td></tr>
<tr><td class="h">4928</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ip_mask = split_ip_range $ip1, $ip2;</td></tr>
<tr><td class="h">4929</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4929">100</a></div></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($id) {</td></tr>
<tr><td class="h">4930</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4930">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4930">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4930">100</a></div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@ip_mask &gt; 1) {</td></tr>
<tr><td class="h">4931</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Range of $name with ID must expand to&quot;,</td></tr>
<tr><td class="h">4932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; exactly one subnet&quot;);</td></tr>
<tr><td class="h">4933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($ip_mask[0]-&gt;[1] == 0xffffffff) {</td></tr>
<tr><td class="h">4935</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$name with ID must not have single IP&quot;);</td></tr>
<tr><td class="h">4936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($id =~ /^.+\@/) {</td></tr>
<tr><td class="h">4938</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;ID of $name must start with character &#39;\@&#39;&quot;,</td></tr>
<tr><td class="h">4939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; or have no &#39;\@&#39; at all&quot;);</td></tr>
<tr><td class="h">4940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4944</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected host type&quot;);</td></tr>
<tr><td class="h">4945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4946</td><td><div class="c3">419</div></td><td></td><td></td><td></td><td></td><td><div>468</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ip_mask (@ip_mask) {</td></tr>
<tr><td class="h">4947</td><td><div class="c3">455</div></td><td></td><td></td><td></td><td></td><td><div>499</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @$ip_mask;</td></tr>
<tr><td class="h">4948</td><td><div class="c3">455</div></td><td></td><td></td><td></td><td></td><td><div>1161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $inv_prefix = 32 - mask2prefix $mask;</td></tr>
<tr><td class="h">4949</td><td><div class="c3">455</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4949">100</a></div></td><td></td><td></td><td></td><td><div>1013</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other_subnet = $inv_prefix_aref[$inv_prefix]-&gt;{$ip}) {</td></tr>
<tr><td class="h">4950</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat2 = $other_subnet-&gt;{nat};</td></tr>
<tr><td class="h">4951</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_error;</td></tr>
<tr><td class="h">4952</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4952">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4952">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4952">33</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4952">25</a></div></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat xor $nat2) {</td></tr>
<tr><td class="h">4953</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_error = 1;</td></tr>
<tr><td class="h">4954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4955</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nat and $nat2) {</td></tr>
<tr><td class="h">4956</td><td colspan="7"></td></tr><tr><td class="h">4957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Number of entries is equal.</td></tr>
<tr><td class="h">4958</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4958">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (keys %$nat == keys %$nat2) {</td></tr>
<tr><td class="h">4959</td><td colspan="7"></td></tr><tr><td class="h">4960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Entries are equal.</td></tr>
<tr><td class="h">4961</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $name (keys %$nat) {</td></tr>
<tr><td class="h">4962</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4962">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4962">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($nat2-&gt;{$name}</td></tr>
<tr><td class="h">4963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $nat-&gt;{$name} eq $nat2-&gt;{$name})</td></tr>
<tr><td class="h">4964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">4965</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_error = 1;</td></tr>
<tr><td class="h">4966</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">4967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4971</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_error = 1;</td></tr>
<tr><td class="h">4972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_error</td></tr>
<tr><td class="h">4975</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4975">50</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg &quot;Inconsistent NAT definition for&quot;,</td></tr>
<tr><td class="h">4976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $other_subnet-&gt;{name} and $host-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4977</td><td colspan="7"></td></tr><tr><td class="h">4978</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner2 = $other_subnet-&gt;{owner};</td></tr>
<tr><td class="h">4979</td><td><div class="c3">8</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4979">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4979">33</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L4979">12</a></div></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($owner xor $owner2)</td></tr>
<tr><td class="h">4980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $owner &amp;&amp; $owner2 &amp;&amp; $owner ne $owner2)</td></tr>
<tr><td class="h">4981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">4982</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Inconsistent owner definition for&quot;,</td></tr>
<tr><td class="h">4983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $other_subnet-&gt;{name} and $host-&gt;{name}&quot;;</td></tr>
<tr><td class="h">4984</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4985</td><td><div class="c3">8</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>7</div><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $host-&gt;{subnets} }, $other_subnet;</td></tr>
<tr><td class="h">4986</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">4987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">4988</td><td><div class="c3">447</div></td><td></td><td></td><td></td><td></td><td><div>668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnet = new(</td></tr>
<tr><td class="h">4989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Subnet&#39;,</td></tr>
<tr><td class="h">4990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $name,</td></tr>
<tr><td class="h">4991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network =&gt; $network,</td></tr>
<tr><td class="h">4992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $ip,</td></tr>
<tr><td class="h">4993</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $mask,</td></tr>
<tr><td class="h">4994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">4995</td><td><div class="c3">447</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4995">100</a></div></td><td></td><td></td><td></td><td><div>731</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{nat}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $nat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $nat;</td></tr>
<tr><td class="h">4996</td><td><div class="c3">447</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4996">50</a></div></td><td></td><td></td><td></td><td><div>665</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">4997</td><td><div class="c3">447</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4997">100</a></div></td><td></td><td></td><td></td><td><div>618</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{owner}&nbsp;&nbsp;&nbsp;= $owner&nbsp;&nbsp;&nbsp;if $owner;</td></tr>
<tr><td class="h">4998</td><td><div class="c3">447</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L4998">100</a></div></td><td></td><td></td><td></td><td><div>635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($id) {</td></tr>
<tr><td class="h">4999</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{id} = $id;</td></tr>
<tr><td class="h">5000</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{radius_attributes} =</td></tr>
<tr><td class="h">5001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host-&gt;{radius_attributes};</td></tr>
<tr><td class="h">5002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5003</td><td><div class="c3">447</div></td><td></td><td></td><td></td><td></td><td><div>642</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inv_prefix_aref[$inv_prefix]-&gt;{$ip} = $subnet;</td></tr>
<tr><td class="h">5004</td><td><div class="c3">447</div><div class="c3">447</div></td><td></td><td></td><td></td><td></td><td><div>351</div><div>683</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $host-&gt;{subnets} },&nbsp;&nbsp;&nbsp;&nbsp;$subnet;</td></tr>
<tr><td class="h">5005</td><td><div class="c3">447</div><div class="c3">447</div></td><td></td><td></td><td></td><td></td><td><div>370</div><div>1415</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $network-&gt;{subnets} }, $subnet;</td></tr>
<tr><td class="h">5006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5008</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5009</td><td colspan="7"></td></tr><tr><td class="h">5010</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find adjacent subnets which build a larger subnet.</td></tr>
<tr><td class="h">5011</td><td><div class="c3">3115</div></td><td></td><td></td><td></td><td></td><td><div>5370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network_inv_prefix = 32 - mask2prefix $network-&gt;{mask};</td></tr>
<tr><td class="h">5012</td><td><div class="c3">3115</div></td><td></td><td></td><td></td><td></td><td><div>5456</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (my $i = 0 ; $i &lt; @inv_prefix_aref ; $i++) {</td></tr>
<tr><td class="h">5013</td><td><div class="c3">425</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5013">100</a></div></td><td></td><td></td><td></td><td><div>1518</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip2subnet = $inv_prefix_aref[$i]) {</td></tr>
<tr><td class="h">5014</td><td><div class="c3">373</div></td><td></td><td></td><td></td><td></td><td><div>461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next&nbsp;&nbsp;&nbsp;= 2**$i;</td></tr>
<tr><td class="h">5015</td><td><div class="c3">373</div></td><td></td><td></td><td></td><td></td><td><div>495</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $modulo = 2 * $next;</td></tr>
<tr><td class="h">5016</td><td><div class="c3">373</div></td><td></td><td></td><td></td><td></td><td><div>719</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ip (keys %$ip2subnet) {</td></tr>
<tr><td class="h">5017</td><td><div class="c3">481</div></td><td></td><td></td><td></td><td></td><td><div>491</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnet = $ip2subnet-&gt;{$ip};</td></tr>
<tr><td class="h">5018</td><td colspan="7"></td></tr><tr><td class="h">5019</td><td><div class="c3">481</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5019">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5019">100</a></div><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5019">100</a></div></td><td></td><td></td><td><div>2702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">5020</td><td colspan="7"></td></tr><tr><td class="h">5021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t combine subnets with NAT</td></tr>
<tr><td class="h">5022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ToDo: This would be possible if all NAT addresses</td></tr>
<tr><td class="h">5023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;match too.</td></tr>
<tr><td class="h">5024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# But, attention for PIX firewalls:</td></tr>
<tr><td class="h">5025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# static commands for networks / subnets block</td></tr>
<tr><td class="h">5026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# network and broadcast address.</td></tr>
<tr><td class="h">5027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not $subnet-&gt;{nat}</td></tr>
<tr><td class="h">5028</td><td colspan="7"></td></tr><tr><td class="h">5029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t combine subnets having radius-ID.</td></tr>
<tr><td class="h">5030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $subnet-&gt;{id}</td></tr>
<tr><td class="h">5031</td><td colspan="7"></td></tr><tr><td class="h">5032</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only take the left part of two adjacent subnets.</td></tr>
<tr><td class="h">5033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $ip % $modulo == 0</td></tr>
<tr><td class="h">5034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">5035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5036</td><td><div class="c3">248</div></td><td></td><td></td><td></td><td></td><td><div>251</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_ip = $ip + $next;</td></tr>
<tr><td class="h">5037</td><td colspan="7"></td></tr><tr><td class="h">5038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find the right part.</td></tr>
<tr><td class="h">5039</td><td><div class="c3">248</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5039">100</a></div></td><td></td><td></td><td></td><td><div>542</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $neighbor = $ip2subnet-&gt;{$next_ip}) {</td></tr>
<tr><td class="h">5040</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{neighbor} = $neighbor;</td></tr>
<tr><td class="h">5041</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up_inv_prefix = $i + 1;</td></tr>
<tr><td class="h">5042</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up;</td></tr>
<tr><td class="h">5043</td><td><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5043">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5043">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5043">67</a></div></td><td></td><td></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($up_inv_prefix &gt;= $network_inv_prefix) {</td></tr>
<tr><td class="h">5044</td><td colspan="7"></td></tr><tr><td class="h">5045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Larger subnet is whole network.</td></tr>
<tr><td class="h">5046</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = $network;</td></tr>
<tr><td class="h">5047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $up_inv_prefix &lt; @inv_prefix_aref</td></tr>
<tr><td class="h">5049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $up =</td></tr>
<tr><td class="h">5050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inv_prefix_aref[$up_inv_prefix]-&gt;{$ip})</td></tr>
<tr><td class="h">5051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5054</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>193</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $name = $subnet-&gt;{name}) =~</td></tr>
<tr><td class="h">5055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s/^.*:/auto_subnet:/;</td></tr>
<tr><td class="h">5056</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = prefix2mask(32 - $up_inv_prefix);</td></tr>
<tr><td class="h">5057</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = new(</td></tr>
<tr><td class="h">5058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Subnet&#39;,</td></tr>
<tr><td class="h">5059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $name,</td></tr>
<tr><td class="h">5060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network =&gt; $network,</td></tr>
<tr><td class="h">5061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $ip,</td></tr>
<tr><td class="h">5062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $mask</td></tr>
<tr><td class="h">5063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">5064</td><td><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5064">50</a></div></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private = $subnet-&gt;{private}) {</td></tr>
<tr><td class="h">5065</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5065">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up-&gt;{private} = $private if $private;</td></tr>
<tr><td class="h">5066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5067</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inv_prefix_aref[$up_inv_prefix]-&gt;{$ip} = $up;</td></tr>
<tr><td class="h">5068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5069</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{up}&nbsp;&nbsp;&nbsp;= $up;</td></tr>
<tr><td class="h">5070</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$neighbor-&gt;{up} = $up;</td></tr>
<tr><td class="h">5071</td><td><div class="c3">34</div><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>34</div><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $network-&gt;{subnets} }, $up;</td></tr>
<tr><td class="h">5072</td><td colspan="7"></td></tr><tr><td class="h">5073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t search for enclosing subnet below.</td></tr>
<tr><td class="h">5074</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">5075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5077</td><td colspan="7"></td></tr><tr><td class="h">5078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For neighbors, {up} has been set already.</td></tr>
<tr><td class="h">5079</td><td><div class="c3">447</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5079">100</a></div></td><td></td><td></td><td></td><td><div>724</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $subnet-&gt;{up};</td></tr>
<tr><td class="h">5080</td><td colspan="7"></td></tr><tr><td class="h">5081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Search for enclosing subnet.</td></tr>
<tr><td class="h">5082</td><td><div class="c3">430</div></td><td></td><td></td><td></td><td></td><td><div>857</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (my $j = $i + 1 ; $j &lt; @inv_prefix_aref ; $j++) {</td></tr>
<tr><td class="h">5083</td><td><div class="c3">111</div></td><td></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = prefix2mask(32 - $j);</td></tr>
<tr><td class="h">5084</td><td><div class="c3">111</div></td><td></td><td></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ip = $ip &amp; $mask;&nbsp;&nbsp;&nbsp;&nbsp;# Perl bug #108480</td></tr>
<tr><td class="h">5085</td><td><div class="c3">111</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5085">100</a></div></td><td></td><td></td><td></td><td><div>295</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $up = $inv_prefix_aref[$j]-&gt;{$ip}) {</td></tr>
<tr><td class="h">5086</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{up} = $up;</td></tr>
<tr><td class="h">5087</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">5088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5090</td><td colspan="7"></td></tr><tr><td class="h">5091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use network, if no enclosing subnet found.</td></tr>
<tr><td class="h">5092</td><td><div class="c3">430</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5092">67</a></div></td><td></td><td></td><td><div>2007</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{up} ||= $network;</td></tr>
<tr><td class="h">5093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5094</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5096</td><td colspan="7"></td></tr><tr><td class="h">5097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Attribute {up} has been set for all subnets now.</td></tr>
<tr><td class="h">5098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do the same for unmanaged interfaces.</td></tr>
<tr><td class="h">5099</td><td><div class="c3">3115</div><div class="c3">3115</div></td><td></td><td></td><td></td><td></td><td><div>2457</div><div>4054</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">5100</td><td><div class="c3">4488</div></td><td></td><td></td><td></td><td></td><td><div>3904</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">5101</td><td><div class="c3">4488</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5101">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5101">100</a></div></td><td></td><td></td><td><div>12345</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{managed} or $router-&gt;{routing_only};</td></tr>
<tr><td class="h">5102</td><td><div class="c3">1336</div></td><td></td><td></td><td></td><td></td><td><div>2457</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{up} = $network;</td></tr>
<tr><td class="h">5103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5105</td><td><div class="c3">704</div></td><td></td><td></td><td></td><td></td><td><div>787</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">5106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5107</td><td colspan="7"></td></tr><tr><td class="h">5108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find adjacent subnets and substitute them by their enclosing subnet.</td></tr>
<tr><td class="h">5109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub combine_subnets {</td></tr>
<tr><td class="h">5110</td><td><div class="c3">1772</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5110">1772</a></div></td><td><div class="c0">0</div></td><td><div>1576</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($subnets) = @_;</td></tr>
<tr><td class="h">5111</td><td><div class="c3">1772</div><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>2099</div><div>575</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hash = map { $_ =&gt; $_ } @$subnets;</td></tr>
<tr><td class="h">5112</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>1376</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @extra;</td></tr>
<tr><td class="h">5113</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>1367</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">5114</td><td><div class="c3">1780</div></td><td></td><td></td><td></td><td></td><td><div>2037</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $subnet (@$subnets) {</td></tr>
<tr><td class="h">5115</td><td><div class="c3">324</div></td><td></td><td></td><td></td><td></td><td><div>238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $neighbor;</td></tr>
<tr><td class="h">5116</td><td><div class="c3">324</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5116">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5116">100</a></div></td><td></td><td></td><td><div>862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($neighbor = $subnet-&gt;{neighbor} and $hash{$neighbor}) {</td></tr>
<tr><td class="h">5117</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up = $subnet-&gt;{up};</td></tr>
<tr><td class="h">5118</td><td><div class="c3">10</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5118">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($hash{$up}) {</td></tr>
<tr><td class="h">5119</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hash{$up} = $up;</td></tr>
<tr><td class="h">5120</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @extra, $up;</td></tr>
<tr><td class="h">5121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5122</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $hash{$subnet};</td></tr>
<tr><td class="h">5123</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $hash{$neighbor};</td></tr>
<tr><td class="h">5124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5126</td><td><div class="c3">1780</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5126">100</a></div></td><td></td><td></td><td></td><td><div>2211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@extra) {</td></tr>
<tr><td class="h">5127</td><td colspan="7"></td></tr><tr><td class="h">5128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Try again to combine subnets with extra subnets.</td></tr>
<tr><td class="h">5129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This version isn&#39;t optimized.</td></tr>
<tr><td class="h">5130</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$subnets, @extra;</td></tr>
<tr><td class="h">5131</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@extra = ();</td></tr>
<tr><td class="h">5132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5134</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>1603</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">5135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5137</td><td colspan="7"></td></tr><tr><td class="h">5138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort networks by size of mask,</td></tr>
<tr><td class="h">5139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# i.e. large subnets coming first and</td></tr>
<tr><td class="h">5140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# for equal mask by IP address.</td></tr>
<tr><td class="h">5141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# We need this to make the output deterministic.</td></tr>
<tr><td class="h">5142</td><td><div class="c3">1772</div><div class="c3">50</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5142">50</a></div></td><td></td><td></td><td></td><td><div>3681</div><div>201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ sort { $a-&gt;{mask} &lt;=&gt; $b-&gt;{mask} || $a-&gt;{ip} &lt;=&gt; $b-&gt;{ip} }</td></tr>
<tr><td class="h">5143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %hash ];</td></tr>
<tr><td class="h">5144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5145</td><td colspan="7"></td></tr><tr><td class="h">5146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">5147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Expand rules</td></tr>
<tr><td class="h">5148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">5149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Simplify rules to expanded rules where each rule has exactly one</td></tr>
<tr><td class="h">5150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># src, dst and prt</td></tr>
<tr><td class="h">5151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">5152</td><td colspan="7"></td></tr><tr><td class="h">5153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %name2object = (</td></tr>
<tr><td class="h">5154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; \%hosts,</td></tr>
<tr><td class="h">5155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;network&nbsp;&nbsp;&nbsp;=&gt; \%networks,</td></tr>
<tr><td class="h">5156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;interface =&gt; \%interfaces,</td></tr>
<tr><td class="h">5157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;any&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; \%aggregates,</td></tr>
<tr><td class="h">5158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; \%groups,</td></tr>
<tr><td class="h">5159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;area&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; \%areas,</td></tr>
<tr><td class="h">5160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">5161</td><td colspan="7"></td></tr><tr><td class="h">5162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_intf {</td></tr>
<tr><td class="h">5163</td><td><div class="c3">200</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5163">200</a></div></td><td><div class="c0">0</div></td><td><div>6099</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">5164</td><td><div class="c3">200</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5164">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5164">100</a></div></td><td></td><td></td><td></td><td><div>455</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig_router = $router-&gt;{orig_router}) {</td></tr>
<tr><td class="h">5165</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @{ $orig_router-&gt;{orig_interfaces} };</td></tr>
<tr><td class="h">5166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $orig_interfaces = $router-&gt;{orig_interfaces}) {</td></tr>
<tr><td class="h">5168</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @$orig_interfaces;</td></tr>
<tr><td class="h">5169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5171</td><td><div class="c3">170</div><div class="c3">170</div></td><td></td><td></td><td></td><td></td><td><div>142</div><div>372</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @{ $router-&gt;{interfaces} };</td></tr>
<tr><td class="h">5172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5174</td><td colspan="7"></td></tr><tr><td class="h">5175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %auto_interfaces;</td></tr>
<tr><td class="h">5176</td><td colspan="7"></td></tr><tr><td class="h">5177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_auto_intf {</td></tr>
<tr><td class="h">5178</td><td><div class="c3">98</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5178">98</a></div></td><td><div class="c0">0</div></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($object, $managed) = @_;</td></tr>
<tr><td class="h">5179</td><td><div class="c3">98</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5179">50</a></div></td><td></td><td></td><td><div>251</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$managed ||= 0;</td></tr>
<tr><td class="h">5180</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = $auto_interfaces{$object}-&gt;{$managed};</td></tr>
<tr><td class="h">5181</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5181">100</a></div></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $result) {</td></tr>
<tr><td class="h">5182</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name;</td></tr>
<tr><td class="h">5183</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5183">100</a></div></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_router $object) {</td></tr>
<tr><td class="h">5184</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($name = $object-&gt;{name}) =~ s/^router://;</td></tr>
<tr><td class="h">5185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5187</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name = &quot;[$object-&gt;{name}]&quot;;</td></tr>
<tr><td class="h">5188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5189</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name&nbsp;&nbsp;&nbsp;= &quot;interface:$name.[auto]&quot;;</td></tr>
<tr><td class="h">5190</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = new(</td></tr>
<tr><td class="h">5191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Autointerface&#39;,</td></tr>
<tr><td class="h">5192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $name,</td></tr>
<tr><td class="h">5193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;&nbsp;=&gt; $object,</td></tr>
<tr><td class="h">5194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;managed =&gt; $managed</td></tr>
<tr><td class="h">5195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">5196</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5196">50</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{disabled} = 1 if $object-&gt;{disabled};</td></tr>
<tr><td class="h">5197</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$auto_interfaces{$object}-&gt;{$managed} = $result;</td></tr>
<tr><td class="h">5198</td><td colspan="7"></td></tr><tr><td class="h">5199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug($result-&gt;{name});</td></tr>
<tr><td class="h">5200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5201</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">5202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5203</td><td colspan="7"></td></tr><tr><td class="h">5204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check intersection of interface and auto-interface.</td></tr>
<tr><td class="h">5205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Prevent expressions like &quot;interface:r.x &amp;! interface:r.[auto]&quot;,</td></tr>
<tr><td class="h">5206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># because we don&#39;t know the exact value of the auto-interface.</td></tr>
<tr><td class="h">5207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># The auto-interface could be &quot;r.x&quot; but not for sure.</td></tr>
<tr><td class="h">5208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $info is hash with attributes</td></tr>
<tr><td class="h">5209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - i =&gt; { $router =&gt; $interface, ... }</td></tr>
<tr><td class="h">5210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - r =&gt; { $router =&gt; $autointerface, ... }</td></tr>
<tr><td class="h">5211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - n =&gt; { $router =&gt; { $network =&gt; autointerface, ... }, ... }</td></tr>
<tr><td class="h">5212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">5213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># interface:router.network conflicts with interface:router.[auto]</td></tr>
<tr><td class="h">5214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># interface:router.network conflicts with interface:[network].[auto]</td></tr>
<tr><td class="h">5215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># interface:router:[auto] conflicts with interface:[network].[auto]</td></tr>
<tr><td class="h">5216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;if router is connected to network.</td></tr>
<tr><td class="h">5217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_auto_intf {</td></tr>
<tr><td class="h">5218</td><td><div class="c3">56</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5218">56</a></div></td><td><div class="c0">0</div></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($info, $elements, $context) = @_;</td></tr>
<tr><td class="h">5219</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $add_info = {};</td></tr>
<tr><td class="h">5220</td><td colspan="7"></td></tr><tr><td class="h">5221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check current elements with interfaces of previous elements.</td></tr>
<tr><td class="h">5222</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$elements) {</td></tr>
<tr><td class="h">5223</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">5224</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other;</td></tr>
<tr><td class="h">5225</td><td><div class="c3">74</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5225">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5225">100</a></div></td><td></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">5226</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router&nbsp;&nbsp;= $obj-&gt;{router};</td></tr>
<tr><td class="h">5227</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $obj-&gt;{network};</td></tr>
<tr><td class="h">5228</td><td><div class="c3">20</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5228">100</a></div></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other = $info-&gt;{r}-&gt;{$router} || $info-&gt;{n}-&gt;{$router}-&gt;{$network};</td></tr>
<tr><td class="h">5229</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_info-&gt;{i}-&gt;{$router} = $obj;</td></tr>
<tr><td class="h">5230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Autointerface&#39;) {</td></tr>
<tr><td class="h">5232</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $auto = $obj-&gt;{object};</td></tr>
<tr><td class="h">5233</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5233">100</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_router($auto)) {</td></tr>
<tr><td class="h">5234</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $auto;</td></tr>
<tr><td class="h">5235</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other = $info-&gt;{i}-&gt;{$router};</td></tr>
<tr><td class="h">5236</td><td><div class="c3">12</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5236">50</a></div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$other) {</td></tr>
<tr><td class="h">5237</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $info-&gt;{n}-&gt;{$router};</td></tr>
<tr><td class="h">5238</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other = (values %$href)[0];</td></tr>
<tr><td class="h">5239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5240</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_info-&gt;{r}-&gt;{$router} = $obj;</td></tr>
<tr><td class="h">5241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5243</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $auto;</td></tr>
<tr><td class="h">5244</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">5245</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">5246</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other = $info-&gt;{r}-&gt;{$router};</td></tr>
<tr><td class="h">5247</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5247">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5247">33</a></div></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$other &amp;&amp; ($other = $info-&gt;{i}-&gt;{$router})) {</td></tr>
<tr><td class="h">5248</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5248">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$other-&gt;{network} eq $network) {</td></tr>
<tr><td class="h">5249</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other = undef;</td></tr>
<tr><td class="h">5250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5252</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_info-&gt;{n}-&gt;{$router}-&gt;{$network} = $obj;</td></tr>
<tr><td class="h">5253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5256</td><td><div class="c3">74</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5256">100</a></div></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($other) {</td></tr>
<tr><td class="h">5257</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Must not use $other-&gt;{name} and $obj-&gt;{name} together\n&quot;,</td></tr>
<tr><td class="h">5258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in intersection of $context&quot;);</td></tr>
<tr><td class="h">5259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5261</td><td colspan="7"></td></tr><tr><td class="h">5262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Extend info with values of current elements.</td></tr>
<tr><td class="h">5263</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$add_info) {</td></tr>
<tr><td class="h">5264</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $add_info-&gt;{$key};</td></tr>
<tr><td class="h">5265</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rkey (%$href) {</td></tr>
<tr><td class="h">5266</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val = $href-&gt;{$rkey};</td></tr>
<tr><td class="h">5267</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5267">100</a></div></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref $val) {</td></tr>
<tr><td class="h">5268</td><td><div class="c3">48</div><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>101</div><div>189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $info-&gt;{$key}-&gt;{$rkey} }{ keys %$val } = values %$val;</td></tr>
<tr><td class="h">5269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5271</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info-&gt;{$key}-&gt;{$rkey} = $val;</td></tr>
<tr><td class="h">5272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5275</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">5276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5277</td><td colspan="7"></td></tr><tr><td class="h">5278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Get a reference to an array of network object descriptions and</td></tr>
<tr><td class="h">5279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># return a reference to an array of network objects.</td></tr>
<tr><td class="h">5280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_group1;</td></tr>
<tr><td class="h">5281</td><td colspan="7"></td></tr><tr><td class="h">5282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_group1 {</td></tr>
<tr><td class="h">5283</td><td><div class="c3">4964</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5283">4964</a></div></td><td><div class="c0">0</div></td><td><div>4635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aref, $context, $clean_autogrp) = @_;</td></tr>
<tr><td class="h">5284</td><td><div class="c3">4964</div></td><td></td><td></td><td></td><td></td><td><div>3655</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @objects;</td></tr>
<tr><td class="h">5285</td><td><div class="c3">4964</div></td><td></td><td></td><td></td><td></td><td><div>5099</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $parts (@$aref) {</td></tr>
<tr><td class="h">5286</td><td colspan="7"></td></tr><tr><td class="h">5287</td><td><div class="c3">5518</div></td><td></td><td></td><td></td><td></td><td><div>6415</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name, $ext) = @$parts;</td></tr>
<tr><td class="h">5288</td><td><div class="c3">5518</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5288">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5288">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5288">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5288">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5288">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5288">50</a></div></td><td></td><td></td><td></td><td><div>19961</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;&amp;&#39;) {</td></tr>
<tr><td class="h">5289</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @non_compl;</td></tr>
<tr><td class="h">5290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @compl;</td></tr>
<tr><td class="h">5291</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %autointf_info;</td></tr>
<tr><td class="h">5292</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element (@$name) {</td></tr>
<tr><td class="h">5293</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5293">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $element1 = $element-&gt;[0] eq &#39;!&#39; ? $element-&gt;[1] : $element;</td></tr>
<tr><td class="h">5294</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @elements =</td></tr>
<tr><td class="h">5295</td><td><div class="c3">74</div><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>116</div><div>201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{is_used} = 1; $_; } @{</td></tr>
<tr><td class="h">5296</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_group1(</td></tr>
<tr><td class="h">5297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[$element1], &quot;intersection of $context&quot;,</td></tr>
<tr><td class="h">5298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clean_autogrp</td></tr>
<tr><td class="h">5299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">5300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">5301</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_auto_intf(\%autointf_info, \@elements, $context);</td></tr>
<tr><td class="h">5302</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5302">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($element-&gt;[0] eq &#39;!&#39;) {</td></tr>
<tr><td class="h">5303</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @compl, @elements;</td></tr>
<tr><td class="h">5304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5306</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @non_compl, \@elements;</td></tr>
<tr><td class="h">5307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5309</td><td><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5309">50</a></div></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@non_compl &gt;= 1</td></tr>
<tr><td class="h">5310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Intersection needs at least one element&quot;,</td></tr>
<tr><td class="h">5311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; which is not complement in $context&quot;;</td></tr>
<tr><td class="h">5312</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $result;</td></tr>
<tr><td class="h">5313</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $first_set = shift @non_compl;</td></tr>
<tr><td class="h">5314</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element (@$first_set) {</td></tr>
<tr><td class="h">5315</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{$element} = $element;</td></tr>
<tr><td class="h">5316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5317</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $set (@non_compl) {</td></tr>
<tr><td class="h">5318</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intersection;</td></tr>
<tr><td class="h">5319</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element (@$set) {</td></tr>
<tr><td class="h">5320</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5320">100</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($result-&gt;{$element}) {</td></tr>
<tr><td class="h">5321</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intersection-&gt;{$element} = $element;</td></tr>
<tr><td class="h">5322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5324</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $intersection;</td></tr>
<tr><td class="h">5325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5326</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element (@compl) {</td></tr>
<tr><td class="h">5327</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5327">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $element-&gt;{disabled};</td></tr>
<tr><td class="h">5328</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5328">100</a></div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $result-&gt;{$element}</td></tr>
<tr><td class="h">5329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;Useless delete of $element-&gt;{name} in $context&quot;);</td></tr>
<tr><td class="h">5330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5331</td><td colspan="7"></td></tr><tr><td class="h">5332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Put result into same order as the elements of first non</td></tr>
<tr><td class="h">5333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# complemented set. This set contains all elements of resulting set,</td></tr>
<tr><td class="h">5334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because we are doing intersection here.</td></tr>
<tr><td class="h">5335</td><td><div class="c3">28</div><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>38</div><div>189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, grep { $result-&gt;{$_} } @$first_set;</td></tr>
<tr><td class="h">5336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;!&#39;) {</td></tr>
<tr><td class="h">5338</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Complement (!) is only supported as part of intersection&quot;,</td></tr>
<tr><td class="h">5339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $context&quot;);</td></tr>
<tr><td class="h">5340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;user&#39;) {</td></tr>
<tr><td class="h">5342</td><td colspan="7"></td></tr><tr><td class="h">5343</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Either a single object or an array of objects.</td></tr>
<tr><td class="h">5344</td><td><div class="c3">912</div></td><td></td><td></td><td></td><td></td><td><div>895</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $elements = $name-&gt;{elements};</td></tr>
<tr><td class="h">5345</td><td><div class="c3">912</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5345">100</a></div></td><td></td><td></td><td></td><td><div>2446</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, ref($elements) eq &#39;ARRAY&#39; ? @$elements : $elements;</td></tr>
<tr><td class="h">5346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5347</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;interface&#39;) {</td></tr>
<tr><td class="h">5348</td><td><div class="c3">580</div></td><td></td><td></td><td></td><td></td><td><div>444</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @check;</td></tr>
<tr><td class="h">5349</td><td><div class="c3">580</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5349">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5349">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5349">50</a></div></td><td></td><td></td><td></td><td><div>1869</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref $name) {</td></tr>
<tr><td class="h">5350</td><td><div class="c3">36</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5350">50</a></div></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ref $ext</td></tr>
<tr><td class="h">5351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Must not use interface:[..].$ext in $context&quot;);</td></tr>
<tr><td class="h">5352</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($selector, $managed) = @$ext;</td></tr>
<tr><td class="h">5353</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sub_objects = expand_group1 $name,</td></tr>
<tr><td class="h">5354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;interface:[..].[$selector] of $context&quot;;</td></tr>
<tr><td class="h">5355</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$sub_objects) {</td></tr>
<tr><td class="h">5356</td><td><div class="c3">36</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5356">50</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $object-&gt;{disabled};</td></tr>
<tr><td class="h">5357</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">5358</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $object;</td></tr>
<tr><td class="h">5359</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5359">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5359">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5359">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5359">0</a></div></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">5360</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5360">50</a></div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($selector eq &#39;all&#39;) {</td></tr>
<tr><td class="h">5361</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5361">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5361">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">5362</td><td colspan="7"></td></tr><tr><td class="h">5363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We can&#39;t simply take</td></tr>
<tr><td class="h">5364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aggregate -&gt; networks -&gt; interfaces,</td></tr>
<tr><td class="h">5365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because subnets may be missing.</td></tr>
<tr><td class="h">5366</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5366">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{mask} == 0</td></tr>
<tr><td class="h">5367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Must not use&quot;,</td></tr>
<tr><td class="h">5368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; interface:[..].[all]\n&quot;,</td></tr>
<tr><td class="h">5369</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; with $object-&gt;{name} having ip/mask\n&quot;,</td></tr>
<tr><td class="h">5370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $context&quot;;</td></tr>
<tr><td class="h">5371</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check, @{ $object-&gt;{zone}-&gt;{interfaces} };</td></tr>
<tr><td class="h">5372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($managed) {</td></tr>
<tr><td class="h">5374</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5374">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check,</td></tr>
<tr><td class="h">5375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep(</td></tr>
<tr><td class="h">5376</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_-&gt;{router}-&gt;{managed}</td></tr>
<tr><td class="h">5377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $_-&gt;{router}-&gt;{routing_only} }</td></tr>
<tr><td class="h">5378</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $object-&gt;{interfaces} });</td></tr>
<tr><td class="h">5379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5381</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check, @{ $object-&gt;{interfaces} };</td></tr>
<tr><td class="h">5382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5385</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5385">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">5386</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Must not use&quot;,</td></tr>
<tr><td class="h">5387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; interface:[any:..].[auto]&quot;,</td></tr>
<tr><td class="h">5388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $context&quot;;</td></tr>
<tr><td class="h">5389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5391</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, get_auto_intf $object, $managed;</td></tr>
<tr><td class="h">5392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">5396</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $object-&gt;{router};</td></tr>
<tr><td class="h">5397</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5397">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5397">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5397">0</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5397">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed</td></tr>
<tr><td class="h">5398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; !($router-&gt;{managed} || $router-&gt;{routing_only}))</td></tr>
<tr><td class="h">5399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5400</td><td colspan="7"></td></tr><tr><td class="h">5401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do nothing.</td></tr>
<tr><td class="h">5402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($selector eq &#39;all&#39;) {</td></tr>
<tr><td class="h">5404</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check, get_intf($router);</td></tr>
<tr><td class="h">5405</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5407</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, get_auto_intf $router;</td></tr>
<tr><td class="h">5408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Area&#39;) {</td></tr>
<tr><td class="h">5411</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @routers;</td></tr>
<tr><td class="h">5412</td><td colspan="7"></td></tr><tr><td class="h">5413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent duplicates and border routers.</td></tr>
<tr><td class="h">5414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">5415</td><td colspan="7"></td></tr><tr><td class="h">5416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t add routers at border of this area.</td></tr>
<tr><td class="h">5417</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $object-&gt;{border} }) {</td></tr>
<tr><td class="h">5418</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{ $interface-&gt;{router} } = 1;</td></tr>
<tr><td class="h">5419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5420</td><td colspan="7"></td></tr><tr><td class="h">5421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add routers at border of security zones inside</td></tr>
<tr><td class="h">5422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# current area.</td></tr>
<tr><td class="h">5423</td><td><div class="c3">12</div><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>13</div><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (</td></tr>
<tr><td class="h">5424</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{router} }</td></tr>
<tr><td class="h">5425</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { get_intf($_) } @{ $object-&gt;{zones} }</td></tr>
<tr><td class="h">5426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">5427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5428</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5428">100</a></div></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $seen{$router}) {</td></tr>
<tr><td class="h">5429</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @routers, $router;</td></tr>
<tr><td class="h">5430</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$router} = 1;</td></tr>
<tr><td class="h">5431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5433</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5433">100</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed) {</td></tr>
<tr><td class="h">5434</td><td colspan="7"></td></tr><tr><td class="h">5435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove semi managed routers.</td></tr>
<tr><td class="h">5436</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5436">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@routers =</td></tr>
<tr><td class="h">5437</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $_-&gt;{managed} || $_-&gt;{routing_only} }</td></tr>
<tr><td class="h">5438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@routers);</td></tr>
<tr><td class="h">5439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5441</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @routers, map {</td></tr>
<tr><td class="h">5442</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $r = $_-&gt;{unmanaged_routers};</td></tr>
<tr><td class="h">5443</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5443">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$r ? @$r : ()</td></tr>
<tr><td class="h">5444</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} @{ $object-&gt;{zones} };</td></tr>
<tr><td class="h">5445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5446</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5446">100</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($selector eq &#39;all&#39;) {</td></tr>
<tr><td class="h">5447</td><td><div class="c3">4</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check, map { get_intf($_) } @routers;</td></tr>
<tr><td class="h">5448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5450</td><td><div class="c3">8</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>8</div><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, map { get_auto_intf($_) } @routers;</td></tr>
<tr><td class="h">5451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Autointerface&#39;) {</td></tr>
<tr><td class="h">5454</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $object-&gt;{object};</td></tr>
<tr><td class="h">5455</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5455">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_router $obj) {</td></tr>
<tr><td class="h">5456</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5456">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5456">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5456">0</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5456">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed</td></tr>
<tr><td class="h">5457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; !($obj-&gt;{managed} || $obj-&gt;{routing_only}))</td></tr>
<tr><td class="h">5458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5459</td><td colspan="7"></td></tr><tr><td class="h">5460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This router has no managed interfaces.</td></tr>
<tr><td class="h">5461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($selector eq &#39;all&#39;) {</td></tr>
<tr><td class="h">5463</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check, get_intf($obj);</td></tr>
<tr><td class="h">5464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5466</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, get_auto_intf $obj;</td></tr>
<tr><td class="h">5467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5470</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Can&#39;t use $object-&gt;{name} inside&quot;,</td></tr>
<tr><td class="h">5471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; interface:[..].[$selector] of $context&quot;;</td></tr>
<tr><td class="h">5472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5475</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">5476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected type &#39;$type&#39; in interface:[..] of $context&quot;;</td></tr>
<tr><td class="h">5477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5480</td><td colspan="7"></td></tr><tr><td class="h">5481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interface:name.[xxx]</td></tr>
<tr><td class="h">5482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (ref $ext) {</td></tr>
<tr><td class="h">5483</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($selector, $managed) = @$ext;</td></tr>
<tr><td class="h">5484</td><td><div class="c3">86</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5484">50</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $router = $routers{$name}) {</td></tr>
<tr><td class="h">5485</td><td colspan="7"></td></tr><tr><td class="h">5486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Syntactically impossible.</td></tr>
<tr><td class="h">5487</td><td><div class="c3">86</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5487">50</a></div></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$managed and internal_err();</td></tr>
<tr><td class="h">5488</td><td><div class="c3">86</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5488">100</a></div></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($selector eq &#39;all&#39;) {</td></tr>
<tr><td class="h">5489</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check, get_intf($router);</td></tr>
<tr><td class="h">5490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5492</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, get_auto_intf $router;</td></tr>
<tr><td class="h">5493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5496</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">5497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Can&#39;t resolve $type:$name.[$selector] in $context&quot;);</td></tr>
<tr><td class="h">5498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5500</td><td colspan="7"></td></tr><tr><td class="h">5501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interface:name.name</td></tr>
<tr><td class="h">5502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $interface = $interfaces{&quot;$name.$ext&quot;}) {</td></tr>
<tr><td class="h">5503</td><td><div class="c3">458</div></td><td></td><td></td><td></td><td></td><td><div>526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, $interface;</td></tr>
<tr><td class="h">5504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5506</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Can&#39;t resolve $type:$name.$ext in $context&quot;);</td></tr>
<tr><td class="h">5507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5508</td><td colspan="7"></td></tr><tr><td class="h">5509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Silently remove unnumbered, bridged and tunnel interfaces</td></tr>
<tr><td class="h">5510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# from automatic groups.</td></tr>
<tr><td class="h">5511</td><td><div class="c3">136</div></td><td></td><td></td><td></td><td></td><td><div>231</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects,</td></tr>
<tr><td class="h">5512</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{ip} ne &#39;tunnel&#39; }</td></tr>
<tr><td class="h">5513</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clean_autogrp</td></tr>
<tr><td class="h">5514</td><td><div class="c3">580</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5514">100</a></div></td><td></td><td></td><td></td><td><div>1333</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? grep { $_-&gt;{ip} !~ /^(?:unnumbered|bridged)$/ } @check</td></tr>
<tr><td class="h">5515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: @check;</td></tr>
<tr><td class="h">5516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (ref $name) {</td></tr>
<tr><td class="h">5518</td><td><div class="c3">430</div></td><td></td><td></td><td></td><td></td><td><div>468</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sub_objects = [</td></tr>
<tr><td class="h">5519</td><td><div class="c3">430</div><div class="c3">430</div></td><td></td><td></td><td></td><td></td><td><div>741</div><div>791</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{is_used} = 1; $_; }</td></tr>
<tr><td class="h">5520</td><td><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>1737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { not($_-&gt;{disabled}) }</td></tr>
<tr><td class="h">5521</td><td><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>350</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ expand_group1($name, &quot;$type:[..] of $context&quot;) }</td></tr>
<tr><td class="h">5522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">5523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $get_aggregates = sub {</td></tr>
<tr><td class="h">5524</td><td><div class="c3">364</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5524">364</a></div></td><td></td><td><div>382</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($object, $ip, $mask) = @_;</td></tr>
<tr><td class="h">5525</td><td><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @objects;</td></tr>
<tr><td class="h">5526</td><td><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>407</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $object;</td></tr>
<tr><td class="h">5527</td><td><div class="c3">364</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5527">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5527">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5527">100</a></div></td><td></td><td></td><td><div>1221</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Area&#39;) {</td></tr>
<tr><td class="h">5528</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects,</td></tr>
<tr><td class="h">5529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unique(</td></tr>
<tr><td class="h">5530</td><td><div class="c3">40</div><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>40</div><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ get_any($_, $ip, $mask) } @{ $object-&gt;{zones} }));</td></tr>
<tr><td class="h">5531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Network&#39; &amp;&amp; $object-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">5533</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, get_any($object-&gt;{zone}, $ip, $mask);</td></tr>
<tr><td class="h">5534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5536</td><td><div class="c3">320</div></td><td></td><td></td><td></td><td></td><td><div>781</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">5537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5538</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return \@objects;</td></tr>
<tr><td class="h">5539</td><td><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>1401</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">5540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $get_networks = sub {</td></tr>
<tr><td class="h">5541</td><td><div class="c3">406</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5541">406</a></div></td><td></td><td><div>384</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($object) = @_;</td></tr>
<tr><td class="h">5542</td><td><div class="c3">406</div></td><td></td><td></td><td></td><td></td><td><div>310</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @objects;</td></tr>
<tr><td class="h">5543</td><td><div class="c3">406</div></td><td></td><td></td><td></td><td></td><td><div>406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $object;</td></tr>
<tr><td class="h">5544</td><td><div class="c3">406</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5544">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5544">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5544">50</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5544">100</a></div></td><td></td><td></td><td><div>1454</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Host&#39; or $type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">5545</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, $object-&gt;{network};</td></tr>
<tr><td class="h">5546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">5548</td><td><div class="c3">344</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5548">100</a></div></td><td></td><td></td><td></td><td><div>438</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$object-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">5549</td><td><div class="c3">314</div></td><td></td><td></td><td></td><td></td><td><div>369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, $object;</td></tr>
<tr><td class="h">5550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5551</td><td colspan="7"></td></tr><tr><td class="h">5552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take aggregate directly. Don&#39;t use next &quot;elsif&quot;</td></tr>
<tr><td class="h">5553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# clause below, where it would be changed to non</td></tr>
<tr><td class="h">5554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# matching aggregate with IP 0/0.</td></tr>
<tr><td class="h">5555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5556</td><td><div class="c3">30</div><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>24</div><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, @{ $object-&gt;{networks} };</td></tr>
<tr><td class="h">5557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $aggregates = $get_aggregates-&gt;($object, 0, 0)) {</td></tr>
<tr><td class="h">5560</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">5561</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@objects,</td></tr>
<tr><td class="h">5562</td><td colspan="7"></td></tr><tr><td class="h">5563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check type, because $get_aggregates</td></tr>
<tr><td class="h">5564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# eventually returns non aggregate network if</td></tr>
<tr><td class="h">5565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# one matches 0/0.</td></tr>
<tr><td class="h">5566</td><td><div class="c3">20</div><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5566">100</a></div></td><td></td><td></td><td></td><td><div>31</div><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ $_-&gt;{is_aggregate} ? @{ $_-&gt;{networks} } : $_ }</td></tr>
<tr><td class="h">5567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$aggregates)</td></tr>
<tr><td class="h">5568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">5569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5571</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">5572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5573</td><td><div class="c3">406</div></td><td></td><td></td><td></td><td></td><td><div>806</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return \@objects;</td></tr>
<tr><td class="h">5574</td><td><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>925</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">5575</td><td><div class="c3">400</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5575">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5575">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5575">50</a></div></td><td></td><td></td><td></td><td><div>999</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;host&#39;) {</td></tr>
<tr><td class="h">5576</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $ext;</td></tr>
<tr><td class="h">5577</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @hosts;</td></tr>
<tr><td class="h">5578</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$sub_objects) {</td></tr>
<tr><td class="h">5579</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $object;</td></tr>
<tr><td class="h">5580</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5580">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5580">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5580">50</a></div></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Host&#39;) {</td></tr>
<tr><td class="h">5581</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hosts, $object;</td></tr>
<tr><td class="h">5582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">5584</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5584">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{is_managed_host}) {</td></tr>
<tr><td class="h">5585</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hosts, $object;</td></tr>
<tr><td class="h">5586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5587</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5588</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">5589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected interface in host:[..] of $context&quot;;</td></tr>
<tr><td class="h">5590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $networks = $get_networks-&gt;($object)) {</td></tr>
<tr><td class="h">5593</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$networks) {</td></tr>
<tr><td class="h">5594</td><td><div class="c3">24</div><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>18</div><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hosts, @{ $network-&gt;{hosts} };</td></tr>
<tr><td class="h">5595</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5595">100</a></div></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed_hosts = $network-&gt;{managed_hosts}) {</td></tr>
<tr><td class="h">5596</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hosts, @$managed_hosts;</td></tr>
<tr><td class="h">5597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5601</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">5602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected type &#39;$type&#39; in host:[..] of $context&quot;;</td></tr>
<tr><td class="h">5603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5605</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5605">100</a></div></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed) {</td></tr>
<tr><td class="h">5606</td><td><div class="c3">8</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>9</div><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@hosts = grep { $_-&gt;{is_managed_host} } @hosts;</td></tr>
<tr><td class="h">5607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5608</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>192</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, @hosts;</td></tr>
<tr><td class="h">5609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;network&#39;) {</td></tr>
<tr><td class="h">5611</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5611">50</a></div></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext and internal_err;</td></tr>
<tr><td class="h">5612</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @list;</td></tr>
<tr><td class="h">5613</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$sub_objects) {</td></tr>
<tr><td class="h">5614</td><td><div class="c3">62</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5614">50</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $networks = $get_networks-&gt;($object)) {</td></tr>
<tr><td class="h">5615</td><td colspan="7"></td></tr><tr><td class="h">5616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Silently remove from automatic groups:</td></tr>
<tr><td class="h">5617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - crosslink network</td></tr>
<tr><td class="h">5618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - loopback network of managed device</td></tr>
<tr><td class="h">5619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Change loopback network of unmanaged device</td></tr>
<tr><td class="h">5620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to loopback interface.</td></tr>
<tr><td class="h">5621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @list, $clean_autogrp</td></tr>
<tr><td class="h">5622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? map {</td></tr>
<tr><td class="h">5623</td><td><div class="c3">94</div><div class="c3">94</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5623">100</a></div></td><td></td><td></td><td></td><td><div>126</div><div>161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($_-&gt;{loopback}) {</td></tr>
<tr><td class="h">5624</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $interfaces = $_-&gt;{interfaces};</td></tr>
<tr><td class="h">5625</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interfaces-&gt;[0];</td></tr>
<tr><td class="h">5626</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5626">50</a></div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($intf-&gt;{router}-&gt;{managed}) {</td></tr>
<tr><td class="h">5627</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();</td></tr>
<tr><td class="h">5628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5630</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5630">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$interfaces &gt; 1) {</td></tr>
<tr><td class="h">5631</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">5632</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not use $_-&gt;{name},&quot;,</td></tr>
<tr><td class="h">5633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; use interfaces instead&quot;</td></tr>
<tr><td class="h">5634</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">5635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5636</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intf;</td></tr>
<tr><td class="h">5637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5640</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_;</td></tr>
<tr><td class="h">5641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5643</td><td><div class="c3">62</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5643">50</a></div></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { not($_-&gt;{crosslink}) } @$networks</td></tr>
<tr><td class="h">5644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: @$networks;</td></tr>
<tr><td class="h">5645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5647</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $object;</td></tr>
<tr><td class="h">5648</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unexpected type &#39;$type&#39; in network:[..] of&quot;,</td></tr>
<tr><td class="h">5649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $context&quot;);</td></tr>
<tr><td class="h">5650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5652</td><td colspan="7"></td></tr><tr><td class="h">5653</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore duplicate networks resulting from different</td></tr>
<tr><td class="h">5654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interfaces connected to the same network.</td></tr>
<tr><td class="h">5655</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, unique(@list);</td></tr>
<tr><td class="h">5656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;any&#39;) {</td></tr>
<tr><td class="h">5658</td><td><div class="c3">330</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5658">100</a></div></td><td></td><td></td><td></td><td><div>543</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = $ext ? @$ext : (0, 0);</td></tr>
<tr><td class="h">5659</td><td><div class="c3">330</div></td><td></td><td></td><td></td><td></td><td><div>263</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @list;</td></tr>
<tr><td class="h">5660</td><td><div class="c3">330</div></td><td></td><td></td><td></td><td></td><td><div>383</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$sub_objects) {</td></tr>
<tr><td class="h">5661</td><td><div class="c3">344</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5661">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5661">50</a></div></td><td></td><td></td><td></td><td><div>474</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $aggregates = $get_aggregates-&gt;($object, $ip, $mask))</td></tr>
<tr><td class="h">5662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5663</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @list, @$aggregates;</td></tr>
<tr><td class="h">5664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $networks = $get_networks-&gt;($object)) {</td></tr>
<tr><td class="h">5666</td><td><div class="c3">320</div></td><td></td><td></td><td></td><td></td><td><div>504</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @list,</td></tr>
<tr><td class="h">5667</td><td><div class="c3">320</div></td><td></td><td></td><td></td><td></td><td><div>346</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ get_any($_-&gt;{zone}, $ip, $mask) } @$networks);</td></tr>
<tr><td class="h">5668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5670</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $object;</td></tr>
<tr><td class="h">5671</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">5672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected type &#39;$type&#39; in any:[..]&quot;,</td></tr>
<tr><td class="h">5673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $context&quot;;</td></tr>
<tr><td class="h">5674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5676</td><td colspan="7"></td></tr><tr><td class="h">5677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore duplicate aggregates resulting from different</td></tr>
<tr><td class="h">5678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interfaces connected to the same aggregate.</td></tr>
<tr><td class="h">5679</td><td><div class="c3">330</div></td><td></td><td></td><td></td><td></td><td><div>487</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, unique(@list);</td></tr>
<tr><td class="h">5680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5682</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unexpected $type:[..] in $context&quot;);</td></tr>
<tr><td class="h">5683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5685</td><td colspan="7"></td></tr><tr><td class="h">5686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# An object named simply &#39;type:name&#39;.</td></tr>
<tr><td class="h">5687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $object = $name2object{$type}-&gt;{$name}) {</td></tr>
<tr><td class="h">5688</td><td colspan="7"></td></tr><tr><td class="h">5689</td><td><div class="c3">3598</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5689">50</a></div></td><td></td><td></td><td></td><td><div>5013</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ext</td></tr>
<tr><td class="h">5690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Unexpected &#39;.$ext&#39; after $type:$name in $context&quot;);</td></tr>
<tr><td class="h">5691</td><td colspan="7"></td></tr><tr><td class="h">5692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Split a group into its members.</td></tr>
<tr><td class="h">5693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# There may be two different versions depending of $clean_autogrp.</td></tr>
<tr><td class="h">5694</td><td><div class="c3">3598</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5694">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5694">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5694">67</a></div></td><td></td><td></td><td><div>4243</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_group $object) {</td></tr>
<tr><td class="h">5695</td><td colspan="7"></td></tr><tr><td class="h">5696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Two different expanded values, depending on $clean_autogrp.</td></tr>
<tr><td class="h">5697</td><td><div class="c3">26</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5697">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ext = $clean_autogrp ? &#39;clean&#39; : &#39;noclean&#39;;</td></tr>
<tr><td class="h">5698</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attr_name = &quot;expanded_$ext&quot;;</td></tr>
<tr><td class="h">5699</td><td colspan="7"></td></tr><tr><td class="h">5700</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $elements = $object-&gt;{$attr_name};</td></tr>
<tr><td class="h">5701</td><td colspan="7"></td></tr><tr><td class="h">5702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for recursive definition.</td></tr>
<tr><td class="h">5703</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5703">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5703">100</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{recursive}) {</td></tr>
<tr><td class="h">5704</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Found recursion in definition of $context&quot;);</td></tr>
<tr><td class="h">5705</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{$attr_name} = $elements = [];</td></tr>
<tr><td class="h">5706</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $object-&gt;{recursive};</td></tr>
<tr><td class="h">5707</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5708</td><td colspan="7"></td></tr><tr><td class="h">5709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Group has not been converted from names to references.</td></tr>
<tr><td class="h">5710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (not $elements) {</td></tr>
<tr><td class="h">5711</td><td colspan="7"></td></tr><tr><td class="h">5712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add marker for detection of recursive group definition.</td></tr>
<tr><td class="h">5713</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{recursive} = 1;</td></tr>
<tr><td class="h">5714</td><td colspan="7"></td></tr><tr><td class="h">5715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark group as used.</td></tr>
<tr><td class="h">5716</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">5717</td><td colspan="7"></td></tr><tr><td class="h">5718</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>281</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$elements =</td></tr>
<tr><td class="h">5719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_group1($object-&gt;{elements}, &quot;$type:$name&quot;,</td></tr>
<tr><td class="h">5720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clean_autogrp);</td></tr>
<tr><td class="h">5721</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $object-&gt;{recursive};</td></tr>
<tr><td class="h">5722</td><td colspan="7"></td></tr><tr><td class="h">5723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Private group must not reference private element of other</td></tr>
<tr><td class="h">5724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# context.</td></tr>
<tr><td class="h">5725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Public group must not reference private element.</td></tr>
<tr><td class="h">5726</td><td><div class="c3">18</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5726">50</a></div></td><td></td><td></td><td><div>463</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private1 = $object-&gt;{private} || &#39;public&#39;;</td></tr>
<tr><td class="h">5727</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element (@$elements) {</td></tr>
<tr><td class="h">5728</td><td><div class="c3">48</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5728">50</a></div></td><td></td><td></td><td></td><td><div>503</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private2 = $element-&gt;{private}) {</td></tr>
<tr><td class="h">5729</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5729">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private1 eq $private2</td></tr>
<tr><td class="h">5730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">5731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$private1 $object-&gt;{name} must not&quot;,</td></tr>
<tr><td class="h">5732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; reference $private2 $element-&gt;{name}&quot;</td></tr>
<tr><td class="h">5733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">5734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5736</td><td colspan="7"></td></tr><tr><td class="h">5737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Detect and remove duplicate values in group.</td></tr>
<tr><td class="h">5738</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %unique;</td></tr>
<tr><td class="h">5739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @duplicate;</td></tr>
<tr><td class="h">5740</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$elements) {</td></tr>
<tr><td class="h">5741</td><td><div class="c3">48</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5741">50</a></div></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($unique{$obj}++) {</td></tr>
<tr><td class="h">5742</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @duplicate, $obj;</td></tr>
<tr><td class="h">5743</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj = undef;</td></tr>
<tr><td class="h">5744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5746</td><td><div class="c3">18</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5746">50</a></div></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@duplicate) {</td></tr>
<tr><td class="h">5747</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$elements = [ grep { defined $_ } @$elements ];</td></tr>
<tr><td class="h">5748</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &quot;Duplicate elements in $type:$name:\n &quot;</td></tr>
<tr><td class="h">5749</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. join(&quot;\n &quot;, map { $_-&gt;{name} } @duplicate);</td></tr>
<tr><td class="h">5750</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg($msg);</td></tr>
<tr><td class="h">5751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5752</td><td colspan="7"></td></tr><tr><td class="h">5753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Cache result for further references to the same group</td></tr>
<tr><td class="h">5754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# in same $clean_autogrp context.</td></tr>
<tr><td class="h">5755</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;{$attr_name} = $elements;</td></tr>
<tr><td class="h">5756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5757</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, @$elements;</td></tr>
<tr><td class="h">5758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5759</td><td colspan="7"></td></tr><tr><td class="h">5760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Substitute aggregate by aggregate set of zone cluster.</td></tr>
<tr><td class="h">5761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($object-&gt;{is_aggregate} &amp;&amp; $object-&gt;{zone}-&gt;{zone_cluster}) {</td></tr>
<tr><td class="h">5762</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$object}{qw(ip mask)};</td></tr>
<tr><td class="h">5763</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@objects,</td></tr>
<tr><td class="h">5764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get_cluster_aggregates($object-&gt;{zone}, $ip, $mask));</td></tr>
<tr><td class="h">5765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5766</td><td colspan="7"></td></tr><tr><td class="h">5767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5768</td><td><div class="c3">3572</div></td><td></td><td></td><td></td><td></td><td><div>7227</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, $object;</td></tr>
<tr><td class="h">5769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5770</td><td colspan="7"></td></tr><tr><td class="h">5771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5773</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Can&#39;t resolve $type:$name in $context&quot;);</td></tr>
<tr><td class="h">5774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5776</td><td><div class="c3">4964</div></td><td></td><td></td><td></td><td></td><td><div>7135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@objects;</td></tr>
<tr><td class="h">5777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5778</td><td colspan="7"></td></tr><tr><td class="h">5779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Remove and warn about duplicate values in group.</td></tr>
<tr><td class="h">5780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub remove_duplicates {</td></tr>
<tr><td class="h">5781</td><td><div class="c3">4464</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5781">4464</a></div></td><td><div class="c0">0</div></td><td><div>4013</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aref, $context) = @_;</td></tr>
<tr><td class="h">5782</td><td><div class="c3">4464</div></td><td></td><td></td><td></td><td></td><td><div>3262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">5783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @duplicate;</td></tr>
<tr><td class="h">5784</td><td><div class="c3">4464</div></td><td></td><td></td><td></td><td></td><td><div>4716</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$aref) {</td></tr>
<tr><td class="h">5785</td><td><div class="c3">5512</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5785">100</a></div></td><td></td><td></td><td></td><td><div>15360</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($seen{$obj}++) {</td></tr>
<tr><td class="h">5786</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @duplicate, $obj;</td></tr>
<tr><td class="h">5787</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj = undef;</td></tr>
<tr><td class="h">5788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5790</td><td><div class="c3">4464</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5790">100</a></div></td><td></td><td></td><td></td><td><div>6911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@duplicate) {</td></tr>
<tr><td class="h">5791</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &quot;Duplicate elements in $context:\n &quot;</td></tr>
<tr><td class="h">5792</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. join(&quot;\n &quot;, map { $_-&gt;{name} } @duplicate);</td></tr>
<tr><td class="h">5793</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg($msg);</td></tr>
<tr><td class="h">5794</td><td><div class="c3">2</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aref = [ grep { defined $_ } @$aref ];</td></tr>
<tr><td class="h">5795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5796</td><td><div class="c3">4464</div></td><td></td><td></td><td></td><td></td><td><div>6356</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $aref;</td></tr>
<tr><td class="h">5797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5798</td><td colspan="7"></td></tr><tr><td class="h">5799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_group {</td></tr>
<tr><td class="h">5800</td><td><div class="c3">4454</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5800">4454</a></div></td><td><div class="c0">0</div></td><td><div>5874</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obref, $context) = @_;</td></tr>
<tr><td class="h">5801</td><td><div class="c3">4454</div></td><td></td><td></td><td></td><td></td><td><div>5299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $aref = expand_group1 $obref, $context, &#39;clean_autogrp&#39;;</td></tr>
<tr><td class="h">5802</td><td><div class="c3">4454</div></td><td></td><td></td><td></td><td></td><td><div>5476</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aref = remove_duplicates($aref, $context);</td></tr>
<tr><td class="h">5803</td><td colspan="7"></td></tr><tr><td class="h">5804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore disabled objects.</td></tr>
<tr><td class="h">5805</td><td><div class="c3">4454</div></td><td></td><td></td><td></td><td></td><td><div>3383</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $changed;</td></tr>
<tr><td class="h">5806</td><td><div class="c3">4454</div></td><td></td><td></td><td></td><td></td><td><div>4440</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$aref) {</td></tr>
<tr><td class="h">5807</td><td><div class="c3">5490</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5807">100</a></div></td><td></td><td></td><td></td><td><div>10722</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{disabled}) {</td></tr>
<tr><td class="h">5808</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object&nbsp;&nbsp;= undef;</td></tr>
<tr><td class="h">5809</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$changed = 1;</td></tr>
<tr><td class="h">5810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5812</td><td><div class="c3">4454</div><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5812">100</a></div></td><td></td><td></td><td></td><td><div>6251</div><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aref = [ grep { defined $_ } @$aref ] if $changed;</td></tr>
<tr><td class="h">5813</td><td><div class="c3">4454</div></td><td></td><td></td><td></td><td></td><td><div>6509</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $aref;</td></tr>
<tr><td class="h">5814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5815</td><td colspan="7"></td></tr><tr><td class="h">5816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %subnet_warning_seen;</td></tr>
<tr><td class="h">5817</td><td colspan="7"></td></tr><tr><td class="h">5818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_group_in_rule {</td></tr>
<tr><td class="h">5819</td><td><div class="c3">1784</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5819">1784</a></div></td><td><div class="c0">0</div></td><td><div>1824</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obref, $context, $convert_hosts) = @_;</td></tr>
<tr><td class="h">5820</td><td><div class="c3">1784</div></td><td></td><td></td><td></td><td></td><td><div>2088</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $aref = expand_group($obref, $context);</td></tr>
<tr><td class="h">5821</td><td colspan="7"></td></tr><tr><td class="h">5822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore unusable objects.</td></tr>
<tr><td class="h">5823</td><td><div class="c3">1784</div></td><td></td><td></td><td></td><td></td><td><div>1387</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $changed;</td></tr>
<tr><td class="h">5824</td><td><div class="c3">1784</div></td><td></td><td></td><td></td><td></td><td><div>2139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$aref) {</td></tr>
<tr><td class="h">5825</td><td><div class="c3">2136</div></td><td></td><td></td><td></td><td></td><td><div>1524</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ignore;</td></tr>
<tr><td class="h">5826</td><td><div class="c3">2136</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5826">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5826">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5826">50</a></div></td><td></td><td></td><td></td><td><div>2548</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_network $object) {</td></tr>
<tr><td class="h">5827</td><td><div class="c3">1688</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5827">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5827">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5827">100</a></div></td><td></td><td></td><td></td><td><div>4953</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{ip} eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">5828</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ignore = &quot;unnumbered $object-&gt;{name}&quot;;</td></tr>
<tr><td class="h">5829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5830</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($object-&gt;{crosslink}) {</td></tr>
<tr><td class="h">5831</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ignore = &quot;crosslink $object-&gt;{name}&quot;;</td></tr>
<tr><td class="h">5832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($object-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">5834</td><td><div class="c3">222</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5834">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5834">100</a></div></td><td></td><td></td><td></td><td><div>512</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{is_tunnel}) {</td></tr>
<tr><td class="h">5835</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ignore = &quot;$object-&gt;{name} with tunnel&quot;;</td></tr>
<tr><td class="h">5836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($object-&gt;{has_id_hosts}) {</td></tr>
<tr><td class="h">5838</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ignore = &quot;$object-&gt;{name} with software clients&quot;;</td></tr>
<tr><td class="h">5839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_interface $object) {</td></tr>
<tr><td class="h">5843</td><td><div class="c3">184</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5843">50</a></div></td><td></td><td></td><td></td><td><div>516</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($object-&gt;{ip} =~ /^(short|unnumbered)$/) {</td></tr>
<tr><td class="h">5844</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ignore = &quot;$object-&gt;{ip} $object-&gt;{name}&quot;;</td></tr>
<tr><td class="h">5845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_area $object) {</td></tr>
<tr><td class="h">5848</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ignore = $object-&gt;{name};</td></tr>
<tr><td class="h">5849</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5850</td><td><div class="c3">2136</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5850">100</a></div></td><td></td><td></td><td></td><td><div>4292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ignore) {</td></tr>
<tr><td class="h">5851</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object&nbsp;&nbsp;= undef;</td></tr>
<tr><td class="h">5852</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$changed = 1;</td></tr>
<tr><td class="h">5853</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring $ignore in $context&quot;);</td></tr>
<tr><td class="h">5854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5856</td><td><div class="c3">1784</div><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5856">100</a></div></td><td></td><td></td><td></td><td><div>2548</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aref = [ grep { defined $_ } @$aref ] if $changed;</td></tr>
<tr><td class="h">5857</td><td colspan="7"></td></tr><tr><td class="h">5858</td><td><div class="c3">1784</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5858">100</a></div></td><td></td><td></td><td></td><td><div>2189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($convert_hosts) {</td></tr>
<tr><td class="h">5859</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>1390</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @subnets;</td></tr>
<tr><td class="h">5860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %subnet2host;</td></tr>
<tr><td class="h">5861</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @other;</td></tr>
<tr><td class="h">5862</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>1856</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$aref) {</td></tr>
<tr><td class="h">5863</td><td colspan="7"></td></tr><tr><td class="h">5864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;group:$obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">5865</td><td><div class="c3">2108</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5865">100</a></div></td><td></td><td></td><td></td><td><div>2354</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_host $obj) {</td></tr>
<tr><td class="h">5866</td><td><div class="c3">222</div><div class="c3">222</div></td><td></td><td></td><td></td><td></td><td><div>195</div><div>299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $subnet (@{ $obj-&gt;{subnets} }) {</td></tr>
<tr><td class="h">5867</td><td colspan="7"></td></tr><tr><td class="h">5868</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle special case, where network and subnet</td></tr>
<tr><td class="h">5869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# have identical address.</td></tr>
<tr><td class="h">5870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# E.g. range = 10.1.1.0-10.1.1.255.</td></tr>
<tr><td class="h">5871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert subnet to network, because</td></tr>
<tr><td class="h">5872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - different objects with identical IP</td></tr>
<tr><td class="h">5873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;can&#39;t be checked and optimized properly,</td></tr>
<tr><td class="h">5874</td><td><div class="c3">234</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5874">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5874">50</a></div></td><td></td><td></td><td></td><td><div>669</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($subnet-&gt;{mask} == $subnet-&gt;{network}-&gt;{mask}) {</td></tr>
<tr><td class="h">5875</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $subnet-&gt;{network};</td></tr>
<tr><td class="h">5876</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5876">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L5876">33</a></div></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;not $network-&gt;{has_id_hosts}</td></tr>
<tr><td class="h">5877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $subnet_warning_seen{$subnet}++)</td></tr>
<tr><td class="h">5878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">5879</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">5880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Use $network-&gt;{name} instead of&quot;,</td></tr>
<tr><td class="h">5881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $subnet-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">5882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; because both have identical address&quot;</td></tr>
<tr><td class="h">5883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">5884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5885</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @other, $network;</td></tr>
<tr><td class="h">5886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $host = $subnet2host{$subnet}) {</td></tr>
<tr><td class="h">5888</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;$obj-&gt;{name} and $host-&gt;{name}&quot;,</td></tr>
<tr><td class="h">5889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; overlap in $context&quot;);</td></tr>
<tr><td class="h">5890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5892</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>342</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet2host{$subnet} = $obj;</td></tr>
<tr><td class="h">5893</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>807</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @subnets, $subnet;</td></tr>
<tr><td class="h">5894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5898</td><td><div class="c3">1886</div></td><td></td><td></td><td></td><td></td><td><div>3015</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @other, $obj;</td></tr>
<tr><td class="h">5899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5901</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>2311</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @other, ($convert_hosts eq &#39;no_combine&#39;)</td></tr>
<tr><td class="h">5902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? @subnets</td></tr>
<tr><td class="h">5903</td><td><div class="c3">1772</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5903">50</a></div></td><td></td><td></td><td></td><td><div>2505</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: @{ combine_subnets \@subnets };</td></tr>
<tr><td class="h">5904</td><td><div class="c3">1772</div></td><td></td><td></td><td></td><td></td><td><div>3409</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return \@other;</td></tr>
<tr><td class="h">5905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5907</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $aref;</td></tr>
<tr><td class="h">5908</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5909</td><td colspan="7"></td></tr><tr><td class="h">5910</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5911</td><td colspan="7"></td></tr><tr><td class="h">5912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_unused_groups {</td></tr>
<tr><td class="h">5913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $check = sub {</td></tr>
<tr><td class="h">5914</td><td><div class="c3">972</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5914">972</a></div></td><td></td><td><div>957</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($hash, $print_type) = @_;</td></tr>
<tr><td class="h">5915</td><td><div class="c3">972</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5915">50</a></div></td><td></td><td></td><td></td><td><div>1500</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $print = $print_type eq &#39;warn&#39; ? \&amp;warn_msg : \&amp;err_msg;</td></tr>
<tr><td class="h">5916</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>2547</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $name (sort keys %$hash) {</td></tr>
<tr><td class="h">5917</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = $hash-&gt;{$name};</td></tr>
<tr><td class="h">5918</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5918">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $value-&gt;{is_used};</td></tr>
<tr><td class="h">5919</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;(&quot;unused $value-&gt;{name}&quot;);</td></tr>
<tr><td class="h">5920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5921</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5921">486</a></div></td><td><div class="c0">0</div></td><td><div>1421</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">5922</td><td><div class="c3">486</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5922">50</a></div></td><td></td><td></td><td></td><td><div>1030</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $conf = $config-&gt;{check_unused_groups}) {</td></tr>
<tr><td class="h">5923</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hash (\%groups, \%protocolgroups) {</td></tr>
<tr><td class="h">5924</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check-&gt;($hash, $conf);</td></tr>
<tr><td class="h">5925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5927</td><td><div class="c3">486</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5927">50</a></div></td><td></td><td></td><td></td><td><div>990</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $conf = $config-&gt;{check_unused_protocols}) {</td></tr>
<tr><td class="h">5928</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hash (\%protocols) {</td></tr>
<tr><td class="h">5929</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check-&gt;($hash, $conf);</td></tr>
<tr><td class="h">5930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5932</td><td colspan="7"></td></tr><tr><td class="h">5933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Not used any longer; free memory.</td></tr>
<tr><td class="h">5934</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>606</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%groups = ();</td></tr>
<tr><td class="h">5935</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1610</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">5936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">5937</td><td colspan="7"></td></tr><tr><td class="h">5938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Result:</td></tr>
<tr><td class="h">5939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Reference to array with elements</td></tr>
<tr><td class="h">5940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - non TCP/UDP protocol</td></tr>
<tr><td class="h">5941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - dst_range of (splitted) TCP/UDP protocol</td></tr>
<tr><td class="h">5942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - [ src_range, dst_range, orig_prt ]</td></tr>
<tr><td class="h">5943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of (splitted) protocol having src_range or main_prt.</td></tr>
<tr><td class="h">5944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_protocols {</td></tr>
<tr><td class="h">5945</td><td><div class="c3">956</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L5945">956</a></div></td><td><div class="c0">0</div></td><td><div>1442</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aref, $context) = @_;</td></tr>
<tr><td class="h">5946</td><td><div class="c3">956</div></td><td></td><td></td><td></td><td></td><td><div>745</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @protocols;</td></tr>
<tr><td class="h">5947</td><td><div class="c3">956</div></td><td></td><td></td><td></td><td></td><td><div>1408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@$aref) {</td></tr>
<tr><td class="h">5948</td><td colspan="7"></td></tr><tr><td class="h">5949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle anonymous protocol.</td></tr>
<tr><td class="h">5950</td><td><div class="c3">1024</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5950">100</a></div></td><td></td><td></td><td></td><td><div>1847</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref($pair) eq &#39;HASH&#39;) {</td></tr>
<tr><td class="h">5951</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1024</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @protocols, $pair;</td></tr>
<tr><td class="h">5952</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1431</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">5953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5954</td><td colspan="7"></td></tr><tr><td class="h">5955</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @$pair;</td></tr>
<tr><td class="h">5956</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5956">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5956">50</a></div></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;protocol&#39;) {</td></tr>
<tr><td class="h">5957</td><td><div class="c3">50</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5957">50</a></div></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $prt = $protocols{$name}) {</td></tr>
<tr><td class="h">5958</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @protocols, $prt;</td></tr>
<tr><td class="h">5959</td><td colspan="7"></td></tr><tr><td class="h">5960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Currently needed by external program &#39;cut-netspoc&#39;.</td></tr>
<tr><td class="h">5961</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">5962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5964</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Can&#39;t resolve reference to $type:$name in $context&quot;);</td></tr>
<tr><td class="h">5965</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">5966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;protocolgroup&#39;) {</td></tr>
<tr><td class="h">5969</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5969">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $prtgroup = $protocolgroups{$name}) {</td></tr>
<tr><td class="h">5970</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $elements = $prtgroup-&gt;{elements};</td></tr>
<tr><td class="h">5971</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5971">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L5971">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($elements eq &#39;recursive&#39;) {</td></tr>
<tr><td class="h">5972</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Found recursion in definition of $context&quot;);</td></tr>
<tr><td class="h">5973</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prtgroup-&gt;{elements} = $elements = [];</td></tr>
<tr><td class="h">5974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5975</td><td colspan="7"></td></tr><tr><td class="h">5976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check if it has already been converted</td></tr>
<tr><td class="h">5977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# from names to references.</td></tr>
<tr><td class="h">5978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (not $prtgroup-&gt;{is_used}) {</td></tr>
<tr><td class="h">5979</td><td colspan="7"></td></tr><tr><td class="h">5980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Detect recursive definitions.</td></tr>
<tr><td class="h">5981</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prtgroup-&gt;{elements} = &#39;recursive&#39;;</td></tr>
<tr><td class="h">5982</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prtgroup-&gt;{is_used}&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">5983</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$elements = expand_protocols($elements, &quot;$type:$name&quot;);</td></tr>
<tr><td class="h">5984</td><td colspan="7"></td></tr><tr><td class="h">5985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Cache result for further references to the same group.</td></tr>
<tr><td class="h">5986</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prtgroup-&gt;{elements} = $elements;</td></tr>
<tr><td class="h">5987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5988</td><td colspan="7"></td></tr><tr><td class="h">5989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Split only once.</td></tr>
<tr><td class="h">5990</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @protocols, @$elements;</td></tr>
<tr><td class="h">5991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5993</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Can&#39;t resolve reference to $type:$name in $context&quot;);</td></tr>
<tr><td class="h">5994</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">5995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">5997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">5998</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unknown type of $type:$name in $context&quot;);</td></tr>
<tr><td class="h">5999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6001</td><td><div class="c3">956</div></td><td></td><td></td><td></td><td></td><td><div>1867</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@protocols;</td></tr>
<tr><td class="h">6002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6003</td><td colspan="7"></td></tr><tr><td class="h">6004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Expand splitted protocols.</td></tr>
<tr><td class="h">6005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub split_protocols {</td></tr>
<tr><td class="h">6006</td><td><div class="c3">928</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6006">928</a></div></td><td><div class="c0">0</div></td><td><div>852</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($protocols, $context) = @_;</td></tr>
<tr><td class="h">6007</td><td><div class="c3">928</div></td><td></td><td></td><td></td><td></td><td><div>721</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @splitted_protocols;</td></tr>
<tr><td class="h">6008</td><td><div class="c3">928</div></td><td></td><td></td><td></td><td></td><td><div>1014</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (@$protocols) {</td></tr>
<tr><td class="h">6009</td><td><div class="c3">996</div></td><td></td><td></td><td></td><td></td><td><div>1020</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $prt-&gt;{proto};</td></tr>
<tr><td class="h">6010</td><td><div class="c3">996</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6010">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6010">100</a></div></td><td></td><td></td><td><div>2297</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not($proto eq &#39;tcp&#39; or $proto eq &#39;udp&#39;)) {</td></tr>
<tr><td class="h">6011</td><td><div class="c3">192</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @splitted_protocols, $prt;</td></tr>
<tr><td class="h">6012</td><td><div class="c3">192</div></td><td></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">6013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6014</td><td colspan="7"></td></tr><tr><td class="h">6015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect splitted src_range / dst_range pairs.</td></tr>
<tr><td class="h">6016</td><td><div class="c3">804</div></td><td></td><td></td><td></td><td></td><td><div>715</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_range = $prt-&gt;{dst_range};</td></tr>
<tr><td class="h">6017</td><td><div class="c3">804</div></td><td></td><td></td><td></td><td></td><td><div>708</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range = $prt-&gt;{src_range};</td></tr>
<tr><td class="h">6018</td><td colspan="7"></td></tr><tr><td class="h">6019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember original protocol as third value</td></tr>
<tr><td class="h">6020</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - if src_range is given or</td></tr>
<tr><td class="h">6021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - if original protocol has flags or</td></tr>
<tr><td class="h">6022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - if $dst_range is shared between different protocols.</td></tr>
<tr><td class="h">6023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Cache list of triples at original protocol for re-use.</td></tr>
<tr><td class="h">6024</td><td><div class="c3">804</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6024">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6024">100</a></div></td><td></td><td></td><td><div>3926</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($src_range or $prt-&gt;{flags} or $dst_range-&gt;{name} ne $prt-&gt;{name}) {</td></tr>
<tr><td class="h">6025</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref_list = $prt-&gt;{src_dst_range_list};</td></tr>
<tr><td class="h">6026</td><td><div class="c3">60</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6026">100</a></div></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $aref_list) {</td></tr>
<tr><td class="h">6027</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src_split (expand_splitted_protocol $src_range) {</td></tr>
<tr><td class="h">6028</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst_split (expand_splitted_protocol $dst_range) {</td></tr>
<tr><td class="h">6029</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$aref_list, [ $src_split, $dst_split, $prt ];</td></tr>
<tr><td class="h">6030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6032</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{src_dst_range_list} = $aref_list;</td></tr>
<tr><td class="h">6033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6034</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @splitted_protocols, @$aref_list;</td></tr>
<tr><td class="h">6035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6037</td><td><div class="c3">744</div></td><td></td><td></td><td></td><td></td><td><div>993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst_split (expand_splitted_protocol $dst_range) {</td></tr>
<tr><td class="h">6038</td><td><div class="c3">750</div></td><td></td><td></td><td></td><td></td><td><div>1941</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @splitted_protocols, $dst_split;</td></tr>
<tr><td class="h">6039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6042</td><td><div class="c3">928</div></td><td></td><td></td><td></td><td></td><td><div>1276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@splitted_protocols;</td></tr>
<tr><td class="h">6043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6044</td><td colspan="7"></td></tr><tr><td class="h">6045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub path_auto_interfaces;</td></tr>
<tr><td class="h">6046</td><td colspan="7"></td></tr><tr><td class="h">6047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hash with attributes deny, permit for storing expanded rules with</td></tr>
<tr><td class="h">6048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># different action.</td></tr>
<tr><td class="h">6049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %expanded_rules;</td></tr>
<tr><td class="h">6050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our %grouped_rules;</td></tr>
<tr><td class="h">6051</td><td colspan="7"></td></tr><tr><td class="h">6052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hash for ordering all rules.</td></tr>
<tr><td class="h">6053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Put attributes with small value set first, to get a more</td></tr>
<tr><td class="h">6054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># memory efficient tree with few branches at root.</td></tr>
<tr><td class="h">6055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $rule_tree{$stateless}-&gt;{$deny}-&gt;{$src_range}-&gt;{$src}-&gt;{$dst}-&gt;{$prt}</td></tr>
<tr><td class="h">6056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;= $rule;</td></tr>
<tr><td class="h">6057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %rule_tree;</td></tr>
<tr><td class="h">6058</td><td colspan="7"></td></tr><tr><td class="h">6059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect deleted rules for further inspection.</td></tr>
<tr><td class="h">6060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @deleted_rules;</td></tr>
<tr><td class="h">6061</td><td colspan="7"></td></tr><tr><td class="h">6062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Add rules to %rule_tree for efficient look up.</td></tr>
<tr><td class="h">6063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_rules {</td></tr>
<tr><td class="h">6064</td><td><div class="c3">1438</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6064">1438</a></div></td><td><div class="c0">0</div></td><td><div>1265</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rules_ref, $rule_tree) = @_;</td></tr>
<tr><td class="h">6065</td><td><div class="c3">1438</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6065">50</a></div></td><td></td><td></td><td><div>3529</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$rule_tree ||= \%rule_tree;</td></tr>
<tr><td class="h">6066</td><td colspan="7"></td></tr><tr><td class="h">6067</td><td><div class="c3">1438</div></td><td></td><td></td><td></td><td></td><td><div>1727</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$rules_ref) {</td></tr>
<tr><td class="h">6068</td><td><div class="c3">1480</div></td><td></td><td></td><td></td><td></td><td><div>2424</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($stateless, $deny, $src, $dst, $src_range, $prt) =</td></tr>
<tr><td class="h">6069</td><td><div class="c3">1480</div></td><td></td><td></td><td></td><td></td><td><div>1267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$rule}{qw(stateless deny src dst src_range prt)};</td></tr>
<tr><td class="h">6070</td><td><div class="c3">1480</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6070">100</a></div></td><td></td><td></td><td><div>3414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$stateless ||= &#39;&#39;;</td></tr>
<tr><td class="h">6071</td><td><div class="c3">1480</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6071">100</a></div></td><td></td><td></td><td><div>3168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||= &#39;&#39;;</td></tr>
<tr><td class="h">6072</td><td><div class="c3">1480</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6072">67</a></div></td><td></td><td></td><td><div>3065</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_range ||= $prt_ip;</td></tr>
<tr><td class="h">6073</td><td><div class="c3">1480</div></td><td></td><td></td><td></td><td></td><td><div>4635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $old_rule =</td></tr>
<tr><td class="h">6074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule_tree-&gt;{$stateless}-&gt;{$deny}-&gt;{$src_range}-&gt;{$src}-&gt;{$dst}</td></tr>
<tr><td class="h">6075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$prt};</td></tr>
<tr><td class="h">6076</td><td><div class="c3">1480</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6076">100</a></div></td><td></td><td></td><td></td><td><div>2114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($old_rule) {</td></tr>
<tr><td class="h">6077</td><td colspan="7"></td></tr><tr><td class="h">6078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found identical rule.</td></tr>
<tr><td class="h">6079</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{deleted} = $old_rule;</td></tr>
<tr><td class="h">6080</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @deleted_rules, $rule;</td></tr>
<tr><td class="h">6081</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">6082</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6083</td><td colspan="7"></td></tr><tr><td class="h">6084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Add:&quot;, print_rule $rule);</td></tr>
<tr><td class="h">6085</td><td><div class="c3">1478</div></td><td></td><td></td><td></td><td></td><td><div>5050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule_tree-&gt;{$stateless}-&gt;{$deny}-&gt;{$src_range}-&gt;{$src}-&gt;{$dst}-&gt;{$prt}</td></tr>
<tr><td class="h">6086</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule;</td></tr>
<tr><td class="h">6087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6088</td><td><div class="c3">1438</div></td><td></td><td></td><td></td><td></td><td><div>2073</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6090</td><td colspan="7"></td></tr><tr><td class="h">6091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %obj2zone;</td></tr>
<tr><td class="h">6092</td><td colspan="7"></td></tr><tr><td class="h">6093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_zone {</td></tr>
<tr><td class="h">6094</td><td><div class="c3">1840</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6094">1840</a></div></td><td><div class="c0">0</div></td><td><div>1585</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">6095</td><td><div class="c3">1840</div></td><td></td><td></td><td></td><td></td><td><div>1803</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">6096</td><td><div class="c3">1840</div></td><td></td><td></td><td></td><td></td><td><div>1312</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result;</td></tr>
<tr><td class="h">6097</td><td colspan="7"></td></tr><tr><td class="h">6098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A router or network with [auto] interface.</td></tr>
<tr><td class="h">6099</td><td><div class="c3">1840</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6099">100</a></div></td><td></td><td></td><td></td><td><div>2747</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Autointerface&#39;) {</td></tr>
<tr><td class="h">6100</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj&nbsp;&nbsp;= $obj-&gt;{object};</td></tr>
<tr><td class="h">6101</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type = ref $obj;</td></tr>
<tr><td class="h">6102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6103</td><td colspan="7"></td></tr><tr><td class="h">6104</td><td><div class="c3">1840</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6104">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6104">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6104">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6104">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6104">0</a></div></td><td></td><td></td><td></td><td><div>2638</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">6105</td><td><div class="c3">1428</div></td><td></td><td></td><td></td><td></td><td><div>1438</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{zone};</td></tr>
<tr><td class="h">6106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39;) {</td></tr>
<tr><td class="h">6108</td><td><div class="c3">198</div></td><td></td><td></td><td></td><td></td><td><div>247</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">6109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">6111</td><td><div class="c3">182</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6111">100</a></div></td><td></td><td></td><td></td><td><div>295</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{router}-&gt;{managed}) {</td></tr>
<tr><td class="h">6112</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{router};</td></tr>
<tr><td class="h">6113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6115</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">6116</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6118</td><td colspan="7"></td></tr><tr><td class="h">6119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Only used when called from expand_rules.</td></tr>
<tr><td class="h">6120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Router&#39;) {</td></tr>
<tr><td class="h">6121</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6121">100</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{managed}) {</td></tr>
<tr><td class="h">6122</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj;</td></tr>
<tr><td class="h">6123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6125</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{interfaces}-&gt;[0]-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">6126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Host&#39;) {</td></tr>
<tr><td class="h">6129</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">6130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6132</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">6133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6134</td><td><div class="c3">1840</div></td><td></td><td></td><td></td><td></td><td><div>5371</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ($obj2zone{$obj} = $result);</td></tr>
<tr><td class="h">6135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6136</td><td colspan="7"></td></tr><tr><td class="h">6137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub path_walk;</td></tr>
<tr><td class="h">6138</td><td colspan="7"></td></tr><tr><td class="h">6139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_special {</td></tr>
<tr><td class="h">6140</td><td><div class="c3">2632</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6140">2632</a></div></td><td><div class="c0">0</div></td><td><div>3562</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst, $flags, $context) = @_;</td></tr>
<tr><td class="h">6141</td><td><div class="c3">2632</div></td><td></td><td></td><td></td><td></td><td><div>1975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">6142</td><td><div class="c3">2632</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6142">100</a></div></td><td></td><td></td><td></td><td><div>2878</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (is_autointerface $src) {</td></tr>
<tr><td class="h">6143</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (path_auto_interfaces $src, $dst) {</td></tr>
<tr><td class="h">6144</td><td><div class="c3">68</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6144">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6144">50</a></div></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} eq &#39;short&#39;) {</td></tr>
<tr><td class="h">6145</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;&#39;$interface-&gt;{ip}&#39; $interface-&gt;{name}&quot;,</td></tr>
<tr><td class="h">6146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; (from .[auto])\n&quot;, &quot; must not be used in rule of $context&quot;;</td></tr>
<tr><td class="h">6147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($interface-&gt;{ip} eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">6149</td><td colspan="7"></td></tr><tr><td class="h">6150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore unnumbered interfaces.</td></tr>
<tr><td class="h">6151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6153</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $interface;</td></tr>
<tr><td class="h">6154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6158</td><td><div class="c3">2590</div></td><td></td><td></td><td></td><td></td><td><div>2703</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = ($src);</td></tr>
<tr><td class="h">6159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6160</td><td><div class="c3">2632</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6160">100</a></div></td><td></td><td></td><td></td><td><div>4818</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($flags-&gt;{net}) {</td></tr>
<tr><td class="h">6161</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @networks;</td></tr>
<tr><td class="h">6162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @other;</td></tr>
<tr><td class="h">6163</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@result) {</td></tr>
<tr><td class="h">6164</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">6165</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network;</td></tr>
<tr><td class="h">6166</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6166">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6166">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6166">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6166">67</a></div></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">6167</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network = $obj;</td></tr>
<tr><td class="h">6168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39; or $type eq &#39;Host&#39;) {</td></tr>
<tr><td class="h">6170</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6170">50</a></div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{id}) {</td></tr>
<tr><td class="h">6171</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @other, $obj;</td></tr>
<tr><td class="h">6172</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">6173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6175</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network = $obj-&gt;{network};</td></tr>
<tr><td class="h">6176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">6179</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6179">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6179">33</a></div></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{router}-&gt;{managed} || $obj-&gt;{loopback}) {</td></tr>
<tr><td class="h">6180</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @other, $obj;</td></tr>
<tr><td class="h">6181</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">6182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6184</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network = $obj-&gt;{network};</td></tr>
<tr><td class="h">6185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6188</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">6189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6190</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6190">50</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @networks, $network if $network-&gt;{ip} ne &#39;unnumbered&#39;;</td></tr>
<tr><td class="h">6191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6192</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = (@other, unique(@networks));</td></tr>
<tr><td class="h">6193</td><td colspan="7"></td></tr><tr><td class="h">6194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;special: &quot;, join(&#39;, &#39;, map { $_-&gt;{name} } @result);</td></tr>
<tr><td class="h">6195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6196</td><td><div class="c3">2632</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6196">50</a></div></td><td></td><td></td><td></td><td><div>3999</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($flags-&gt;{any}) {</td></tr>
<tr><td class="h">6197</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %zones;</td></tr>
<tr><td class="h">6198</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@result) {</td></tr>
<tr><td class="h">6199</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">6200</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone;</td></tr>
<tr><td class="h">6201</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6201">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6201">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6201">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">6202</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone = $obj-&gt;{zone};</td></tr>
<tr><td class="h">6203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39; or $type eq &#39;Interface&#39; or $type eq &#39;Host&#39;)</td></tr>
<tr><td class="h">6205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">6206</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone = $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">6207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6209</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">6210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6211</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zones{$zone} = $zone;</td></tr>
<tr><td class="h">6212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6213</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = map { get_any($_, 0, 0) } values %zones;</td></tr>
<tr><td class="h">6214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6215</td><td><div class="c3">2632</div></td><td></td><td></td><td></td><td></td><td><div>5090</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @result;</td></tr>
<tr><td class="h">6216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6217</td><td colspan="7"></td></tr><tr><td class="h">6218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Add managed hosts of networks and aggregates.</td></tr>
<tr><td class="h">6219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_managed_hosts {</td></tr>
<tr><td class="h">6220</td><td><div class="c3">886</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6220">886</a></div></td><td><div class="c0">0</div></td><td><div>869</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aref, $context) = @_;</td></tr>
<tr><td class="h">6221</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @extra;</td></tr>
<tr><td class="h">6222</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>1005</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $object (@$aref) {</td></tr>
<tr><td class="h">6223</td><td><div class="c3">1042</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6223">100</a></div></td><td></td><td></td><td></td><td><div>2445</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed_hosts = $object-&gt;{managed_hosts} or next;</td></tr>
<tr><td class="h">6224</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @extra, @$managed_hosts;</td></tr>
<tr><td class="h">6225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6226</td><td><div class="c3">886</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6226">100</a></div></td><td></td><td></td><td></td><td><div>1461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@extra) {</td></tr>
<tr><td class="h">6227</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$aref, @extra;</td></tr>
<tr><td class="h">6228</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aref = remove_duplicates($aref, $context);</td></tr>
<tr><td class="h">6229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6230</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>994</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $aref;</td></tr>
<tr><td class="h">6231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6232</td><td colspan="7"></td></tr><tr><td class="h">6233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This handles a rule between objects inside a single security zone or</td></tr>
<tr><td class="h">6234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># between interfaces of a single managed router.</td></tr>
<tr><td class="h">6235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Show warning or error message if rule is between</td></tr>
<tr><td class="h">6236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - different interfaces or</td></tr>
<tr><td class="h">6237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - different networks or</td></tr>
<tr><td class="h">6238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - subnets/hosts of different networks.</td></tr>
<tr><td class="h">6239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Rules between identical objects are silently ignored.</td></tr>
<tr><td class="h">6240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># But a message is shown if a service only has rules between identical objects.</td></tr>
<tr><td class="h">6241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub collect_unenforceable {</td></tr>
<tr><td class="h">6242</td><td><div class="c3">46</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6242">46</a></div></td><td><div class="c0">0</div></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst, $zone, $service) = @_;</td></tr>
<tr><td class="h">6243</td><td colspan="7"></td></tr><tr><td class="h">6244</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6244">100</a></div></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($zone-&gt;{has_unenforceable}) {</td></tr>
<tr><td class="h">6245</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{seen_unenforceable}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">6246</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{silent_unenforceable} = 1;</td></tr>
<tr><td class="h">6247</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6249</td><td colspan="7"></td></tr><tr><td class="h">6250</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $context = $service-&gt;{name};</td></tr>
<tr><td class="h">6251</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{silent_unenforceable} = 1;</td></tr>
<tr><td class="h">6252</td><td colspan="7"></td></tr><tr><td class="h">6253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A rule between identical objects is a common case</td></tr>
<tr><td class="h">6254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# which results from rules with &quot;src=user;dst=user;&quot;.</td></tr>
<tr><td class="h">6255</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6255">100</a></div></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $src eq $dst;</td></tr>
<tr><td class="h">6256</td><td colspan="7"></td></tr><tr><td class="h">6257</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6257">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6257">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6257">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6257">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6257">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6257">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6257">67</a></div><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6257">100</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6257">33</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6257">33</a></div></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (is_router $zone) {</td></tr>
<tr><td class="h">6258</td><td colspan="7"></td></tr><tr><td class="h">6259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Auto interface is assumed to be identical</td></tr>
<tr><td class="h">6260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to each other interface of a single router.</td></tr>
<tr><td class="h">6261</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6261">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6261">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if is_autointerface($src) or is_autointerface($dst);</td></tr>
<tr><td class="h">6262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_subnet $src and is_subnet($dst)) {</td></tr>
<tr><td class="h">6264</td><td colspan="7"></td></tr><tr><td class="h">6265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For rules with different subnets of a single network we don&#39;t</td></tr>
<tr><td class="h">6266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# know if the subnets have been split from a single range.</td></tr>
<tr><td class="h">6267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# E.g. range 1-4 becomes four subnets 1,2-3,4</td></tr>
<tr><td class="h">6268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For most splits the resulting subnets would be adjacent.</td></tr>
<tr><td class="h">6269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Hence we check for adjacency.</td></tr>
<tr><td class="h">6270</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6270">50</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($src-&gt;{network} eq $dst-&gt;{network}) {</td></tr>
<tr><td class="h">6271</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6271">50</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($a, $b) = $src-&gt;{ip} &gt; $dst-&gt;{ip} ? ($dst, $src) : ($src, $dst);</td></tr>
<tr><td class="h">6272</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6272">50</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($a-&gt;{ip} + complement_32bit($a-&gt;{mask}) + 1 == $b-&gt;{ip}) {</td></tr>
<tr><td class="h">6273</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($src-&gt;{is_aggregate} &amp;&amp; $dst-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">6278</td><td colspan="7"></td></tr><tr><td class="h">6279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Both are aggregates,</td></tr>
<tr><td class="h">6280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - belonging to same zone cluster and</td></tr>
<tr><td class="h">6281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - having identical ip and mask</td></tr>
<tr><td class="h">6282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</td></tr>
<tr><td class="h">6283</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6283">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6283">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( zone_eq($src-&gt;{zone}, $dst-&gt;{zone})</td></tr>
<tr><td class="h">6284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $src-&gt;{ip} == $dst-&gt;{ip}</td></tr>
<tr><td class="h">6285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $src-&gt;{mask} == $dst-&gt;{mask});</td></tr>
<tr><td class="h">6286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($src-&gt;{is_aggregate} &amp;&amp; $src-&gt;{mask} == 0) {</td></tr>
<tr><td class="h">6288</td><td colspan="7"></td></tr><tr><td class="h">6289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is a common case, which results from rules like</td></tr>
<tr><td class="h">6290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# group:some_networks -&gt; any:[group:some_networks]</td></tr>
<tr><td class="h">6291</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6291">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if zone_eq($src-&gt;{zone}, get_zone($dst));</td></tr>
<tr><td class="h">6292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($dst-&gt;{is_aggregate} &amp;&amp; $dst-&gt;{mask} == 0) {</td></tr>
<tr><td class="h">6294</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6294">50</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if zone_eq($dst-&gt;{zone}, get_zone($src));</td></tr>
<tr><td class="h">6295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($dst-&gt;{managed_hosts}) {</td></tr>
<tr><td class="h">6297</td><td colspan="7"></td></tr><tr><td class="h">6298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Network or aggregate was only used for its managed_hosts</td></tr>
<tr><td class="h">6299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to be added automatically in expand_group.</td></tr>
<tr><td class="h">6300</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6302</td><td><div class="c3">10</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6302">50</a></div></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{seen_unenforceable}-&gt;{$src}-&gt;{$dst} ||= [ $src, $dst ];</td></tr>
<tr><td class="h">6303</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6305</td><td colspan="7"></td></tr><tr><td class="h">6306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub show_unenforceable {</td></tr>
<tr><td class="h">6307</td><td><div class="c3">792</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6307">792</a></div></td><td><div class="c0">0</div></td><td><div>754</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($service) = @_;</td></tr>
<tr><td class="h">6308</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>824</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $context = $service-&gt;{name};</td></tr>
<tr><td class="h">6309</td><td colspan="7"></td></tr><tr><td class="h">6310</td><td><div class="c3">792</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6310">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6310">100</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6310">67</a></div></td><td></td><td></td><td><div>1522</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($service-&gt;{has_unenforceable}</td></tr>
<tr><td class="h">6311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; (!$service-&gt;{seen_unenforceable} || !$service-&gt;{seen_enforceable}))</td></tr>
<tr><td class="h">6312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">6313</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Useless attribute &#39;has_unenforceable&#39; at $context&quot;);</td></tr>
<tr><td class="h">6314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6315</td><td><div class="c3">792</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6315">50</a></div></td><td></td><td></td><td></td><td><div>1727</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$config-&gt;{check_unenforceable};</td></tr>
<tr><td class="h">6316</td><td><div class="c3">792</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6316">50</a></div></td><td></td><td></td><td></td><td><div>1201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $service-&gt;{disabled};</td></tr>
<tr><td class="h">6317</td><td colspan="7"></td></tr><tr><td class="h">6318</td><td><div class="c3">792</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6318">50</a></div></td><td></td><td></td><td></td><td><div>1432</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print = $config-&gt;{check_unenforceable} eq &#39;warn&#39; ? \&amp;warn_msg : \&amp;err_msg;</td></tr>
<tr><td class="h">6319</td><td colspan="7"></td></tr><tr><td class="h">6320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Warning about fully unenforceable service can&#39;t be disabled with</td></tr>
<tr><td class="h">6321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# attribute has_unenforceable.</td></tr>
<tr><td class="h">6322</td><td><div class="c3">792</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6322">100</a></div></td><td></td><td></td><td></td><td><div>1655</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!delete $service-&gt;{seen_enforceable}) {</td></tr>
<tr><td class="h">6323</td><td colspan="7"></td></tr><tr><td class="h">6324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t warn on empty service without any expanded rules.</td></tr>
<tr><td class="h">6325</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6325">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6325">67</a></div></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($service-&gt;{seen_unenforceable} || $service-&gt;{silent_unenforceable})</td></tr>
<tr><td class="h">6326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">6327</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;(&quot;$context is fully unenforceable&quot;);</td></tr>
<tr><td class="h">6328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6329</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6331</td><td><div class="c3">782</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6331">100</a></div></td><td></td><td></td><td></td><td><div>1229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $service-&gt;{has_unenforceable};</td></tr>
<tr><td class="h">6332</td><td colspan="7"></td></tr><tr><td class="h">6333</td><td><div class="c3">780</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6333">100</a></div></td><td></td><td></td><td></td><td><div>1337</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = delete $service-&gt;{seen_unenforceable}) {</td></tr>
<tr><td class="h">6334</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &quot;$context has unenforceable rules:&quot;;</td></tr>
<tr><td class="h">6335</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hash (values %$hash) {</td></tr>
<tr><td class="h">6336</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $aref (values %$hash) {</td></tr>
<tr><td class="h">6337</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst) = @$aref;</td></tr>
<tr><td class="h">6338</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= &quot;\n src=$src-&gt;{name}; dst=$dst-&gt;{name}&quot;;</td></tr>
<tr><td class="h">6339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6341</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;($msg);</td></tr>
<tr><td class="h">6342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6343</td><td><div class="c3">780</div></td><td></td><td></td><td></td><td></td><td><div>743</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;delete $service-&gt;{silent_unenforceable};</td></tr>
<tr><td class="h">6344</td><td><div class="c3">780</div></td><td></td><td></td><td></td><td></td><td><div>920</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6346</td><td colspan="7"></td></tr><tr><td class="h">6347</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warn_useless_unenforceable {</td></tr>
<tr><td class="h">6348</td><td><div class="c3">692</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6348">692</a></div></td><td><div class="c0">0</div></td><td><div>763</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">6349</td><td><div class="c3">2038</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6349">100</a></div></td><td></td><td></td><td></td><td><div>3501</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{has_unenforceable} or next;</td></tr>
<tr><td class="h">6350</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6350">100</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{seen_unenforceable} and next;</td></tr>
<tr><td class="h">6351</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $agg00 = $zone-&gt;{ipmask2aggregate}-&gt;{&#39;0/0&#39;};</td></tr>
<tr><td class="h">6352</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6352">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name = $agg00 ? $agg00-&gt;{name} : $zone-&gt;{name};</td></tr>
<tr><td class="h">6353</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Useless attribute &#39;has_unenforceable&#39; at $name&quot;);</td></tr>
<tr><td class="h">6354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6355</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>658</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6357</td><td colspan="7"></td></tr><tr><td class="h">6358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub show_deleted_rules1 {</td></tr>
<tr><td class="h">6359</td><td><div class="c3">692</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6359">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6359">692</a></div></td><td><div class="c0">0</div></td><td><div>1132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not @deleted_rules;</td></tr>
<tr><td class="h">6360</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %sname2oname2deleted;</td></tr>
<tr><td class="h">6361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;RULE:</td></tr>
<tr><td class="h">6362</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@deleted_rules) {</td></tr>
<tr><td class="h">6363</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other = $rule-&gt;{deleted};</td></tr>
<tr><td class="h">6364</td><td colspan="7"></td></tr><tr><td class="h">6365</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6365">33</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt1 = $rule-&gt;{orig_prt}&nbsp;&nbsp;|| $rule-&gt;{prt};</td></tr>
<tr><td class="h">6366</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6366">33</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt2 = $other-&gt;{orig_prt} || $other-&gt;{prt};</td></tr>
<tr><td class="h">6367</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6367">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6367">33</a></div></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $prt1-&gt;{flags}-&gt;{overlaps} &amp;&amp; $prt2-&gt;{flags}-&gt;{overlaps};</td></tr>
<tr><td class="h">6368</td><td colspan="7"></td></tr><tr><td class="h">6369</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $service&nbsp;&nbsp;= $rule-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">6370</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $oservice = $other-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">6371</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6371">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $overlaps = $service-&gt;{overlaps}) {</td></tr>
<tr><td class="h">6372</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $overlap (@$overlaps) {</td></tr>
<tr><td class="h">6373</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6373">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($oservice eq $overlap) {</td></tr>
<tr><td class="h">6374</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{overlaps_used}-&gt;{$overlap} = $overlap;</td></tr>
<tr><td class="h">6375</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next RULE;</td></tr>
<tr><td class="h">6376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6379</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6379">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $overlaps = $oservice-&gt;{overlaps}) {</td></tr>
<tr><td class="h">6380</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $overlap (@$overlaps) {</td></tr>
<tr><td class="h">6381</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6381">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($service eq $overlap) {</td></tr>
<tr><td class="h">6382</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oservice-&gt;{overlaps_used}-&gt;{$overlap} = $overlap;</td></tr>
<tr><td class="h">6383</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next RULE;</td></tr>
<tr><td class="h">6384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6387</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sname = $service-&gt;{name};</td></tr>
<tr><td class="h">6388</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $oname = $oservice-&gt;{name};</td></tr>
<tr><td class="h">6389</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pfile = $service-&gt;{file};</td></tr>
<tr><td class="h">6390</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ofile = $oservice-&gt;{file};</td></tr>
<tr><td class="h">6391</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pfile =~ s/.*?([^\/]+)$/$1/;</td></tr>
<tr><td class="h">6392</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ofile =~ s/.*?([^\/]+)$/$1/;</td></tr>
<tr><td class="h">6393</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $sname2oname2deleted{$sname}-&gt;{$oname} }, $rule);</td></tr>
<tr><td class="h">6394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6395</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6395">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $action = $config-&gt;{check_duplicate_rules}) {</td></tr>
<tr><td class="h">6396</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6396">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $print = $action eq &#39;warn&#39; ? \&amp;warn_msg : \&amp;err_msg;</td></tr>
<tr><td class="h">6397</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $sname (sort keys %sname2oname2deleted) {</td></tr>
<tr><td class="h">6398</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $sname2oname2deleted{$sname};</td></tr>
<tr><td class="h">6399</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $oname (sort keys %$hash) {</td></tr>
<tr><td class="h">6400</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref = $hash-&gt;{$oname};</td></tr>
<tr><td class="h">6401</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg&nbsp;&nbsp;= &quot;Duplicate rules in $sname and $oname:\n&nbsp;&nbsp;&quot;;</td></tr>
<tr><td class="h">6402</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= join(&quot;\n&nbsp;&nbsp;&quot;, map { print_rule $_ } @$aref);</td></tr>
<tr><td class="h">6403</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;($msg);</td></tr>
<tr><td class="h">6404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6405</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6407</td><td colspan="7"></td></tr><tr><td class="h">6408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Variable will be reused during sub optimize.</td></tr>
<tr><td class="h">6409</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@deleted_rules = ();</td></tr>
<tr><td class="h">6410</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6412</td><td colspan="7"></td></tr><tr><td class="h">6413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub collect_redundant_rules {</td></tr>
<tr><td class="h">6414</td><td><div class="c3">46</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6414">46</a></div></td><td><div class="c0">0</div></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $other) = @_;</td></tr>
<tr><td class="h">6415</td><td colspan="7"></td></tr><tr><td class="h">6416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore automatically generated rules from crypto or from reverse rules.</td></tr>
<tr><td class="h">6417</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6417">50</a></div></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$rule-&gt;{rule};</td></tr>
<tr><td class="h">6418</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6418">50</a></div></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$other-&gt;{rule};</td></tr>
<tr><td class="h">6419</td><td colspan="7"></td></tr><tr><td class="h">6420</td><td><div class="c3">46</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6420">67</a></div></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prt1 = $rule-&gt;{orig_prt}&nbsp;&nbsp;|| $rule-&gt;{prt};</td></tr>
<tr><td class="h">6421</td><td><div class="c3">46</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6421">67</a></div></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prt2 = $other-&gt;{orig_prt} || $other-&gt;{prt};</td></tr>
<tr><td class="h">6422</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6422">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6422">33</a></div></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $prt1-&gt;{flags}-&gt;{overlaps} &amp;&amp; $prt2-&gt;{flags}-&gt;{overlaps};</td></tr>
<tr><td class="h">6423</td><td colspan="7"></td></tr><tr><td class="h">6424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Automatically generated reverse rule for stateless router</td></tr>
<tr><td class="h">6425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# is still needed, even for stateful routers for static routes.</td></tr>
<tr><td class="h">6426</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src = $rule-&gt;{src};</td></tr>
<tr><td class="h">6427</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6427">50</a></div></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (is_interface($src)) {</td></tr>
<tr><td class="h">6428</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $src-&gt;{router};</td></tr>
<tr><td class="h">6429</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6429">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6429">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed} || $router-&gt;{routing_only}) {</td></tr>
<tr><td class="h">6430</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6433</td><td colspan="7"></td></tr><tr><td class="h">6434</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $service&nbsp;&nbsp;= $rule-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">6435</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $oservice = $other-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">6436</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6436">50</a></div></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$oservice) {</td></tr>
<tr><td class="h">6437</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;d:&quot;, print_rule $rule;</td></tr>
<tr><td class="h">6438</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;o:&quot;, print_rule $other;</td></tr>
<tr><td class="h">6439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6440</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6440">100</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $overlaps = $service-&gt;{overlaps}) {</td></tr>
<tr><td class="h">6441</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $overlap (@$overlaps) {</td></tr>
<tr><td class="h">6442</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6442">100</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($oservice eq $overlap) {</td></tr>
<tr><td class="h">6443</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{overlaps_used}-&gt;{$overlap} = $overlap;</td></tr>
<tr><td class="h">6444</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6448</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @deleted_rules, [ $rule, $other ];</td></tr>
<tr><td class="h">6449</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6451</td><td colspan="7"></td></tr><tr><td class="h">6452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub show_deleted_rules2 {</td></tr>
<tr><td class="h">6453</td><td><div class="c3">486</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6453">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6453">486</a></div></td><td><div class="c0">0</div></td><td><div>811</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not @deleted_rules;</td></tr>
<tr><td class="h">6454</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %sname2oname2deleted;</td></tr>
<tr><td class="h">6455</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@deleted_rules) {</td></tr>
<tr><td class="h">6456</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $other) = @$pair;</td></tr>
<tr><td class="h">6457</td><td colspan="7"></td></tr><tr><td class="h">6458</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $service&nbsp;&nbsp;= $rule-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">6459</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $oservice = $other-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">6460</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sname&nbsp;&nbsp;&nbsp;&nbsp;= $service-&gt;{name};</td></tr>
<tr><td class="h">6461</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $oname&nbsp;&nbsp;&nbsp;&nbsp;= $oservice-&gt;{name};</td></tr>
<tr><td class="h">6462</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pfile&nbsp;&nbsp;&nbsp;&nbsp;= $service-&gt;{file};</td></tr>
<tr><td class="h">6463</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ofile&nbsp;&nbsp;&nbsp;&nbsp;= $oservice-&gt;{file};</td></tr>
<tr><td class="h">6464</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>395</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pfile =~ s/.*?([^\/]+)$/$1/;</td></tr>
<tr><td class="h">6465</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>331</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ofile =~ s/.*?([^\/]+)$/$1/;</td></tr>
<tr><td class="h">6466</td><td><div class="c3">40</div><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>37</div><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $sname2oname2deleted{$sname}-&gt;{$oname} }, [ $rule, $other ]);</td></tr>
<tr><td class="h">6467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6468</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6468">100</a></div></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $action = $config-&gt;{check_redundant_rules}) {</td></tr>
<tr><td class="h">6469</td><td><div class="c3">22</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6469">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $print = $action eq &#39;warn&#39; ? \&amp;warn_msg : \&amp;err_msg;</td></tr>
<tr><td class="h">6470</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $sname (sort keys %sname2oname2deleted) {</td></tr>
<tr><td class="h">6471</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $sname2oname2deleted{$sname};</td></tr>
<tr><td class="h">6472</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $oname (sort keys %$hash) {</td></tr>
<tr><td class="h">6473</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref = $hash-&gt;{$oname};</td></tr>
<tr><td class="h">6474</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg&nbsp;&nbsp;= &quot;Redundant rules in $sname compared to $oname:\n&nbsp;&nbsp;&quot;;</td></tr>
<tr><td class="h">6475</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= join(</td></tr>
<tr><td class="h">6476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n&nbsp;&nbsp;&quot;,</td></tr>
<tr><td class="h">6477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map {</td></tr>
<tr><td class="h">6478</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($r, $o) = @$_;</td></tr>
<tr><td class="h">6479</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_rule($r) . &quot;\n&lt; &quot; . print_rule($o);</td></tr>
<tr><td class="h">6480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} @$aref</td></tr>
<tr><td class="h">6481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">6482</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;($msg);</td></tr>
<tr><td class="h">6483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6486</td><td colspan="7"></td></tr><tr><td class="h">6487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Free memory.</td></tr>
<tr><td class="h">6488</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@deleted_rules = ();</td></tr>
<tr><td class="h">6489</td><td colspan="7"></td></tr><tr><td class="h">6490</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>384</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6492</td><td colspan="7"></td></tr><tr><td class="h">6493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warn_unused_overlaps {</td></tr>
<tr><td class="h">6494</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6494">486</a></div></td><td><div class="c0">0</div></td><td><div>1153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %services) {</td></tr>
<tr><td class="h">6495</td><td><div class="c3">720</div></td><td></td><td></td><td></td><td></td><td><div>856</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $service = $services{$key};</td></tr>
<tr><td class="h">6496</td><td><div class="c3">720</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6496">50</a></div></td><td></td><td></td><td></td><td><div>1100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $service-&gt;{disabled};</td></tr>
<tr><td class="h">6497</td><td><div class="c3">720</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6497">100</a></div></td><td></td><td></td><td></td><td><div>1497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $overlaps = $service-&gt;{overlaps}) {</td></tr>
<tr><td class="h">6498</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $used = delete $service-&gt;{overlaps_used};</td></tr>
<tr><td class="h">6499</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $overlap (@$overlaps) {</td></tr>
<tr><td class="h">6500</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6500">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $overlap-&gt;{disabled};</td></tr>
<tr><td class="h">6501</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6501">50</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$used-&gt;{$overlap}</td></tr>
<tr><td class="h">6502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;Useless &#39;overlaps = $overlap-&gt;{name}&#39;&quot;,</td></tr>
<tr><td class="h">6503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $service-&gt;{name}&quot;);</td></tr>
<tr><td class="h">6504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6507</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6509</td><td colspan="7"></td></tr><tr><td class="h">6510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># All log tags defined at some routers.</td></tr>
<tr><td class="h">6511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %known_log;</td></tr>
<tr><td class="h">6512</td><td colspan="7"></td></tr><tr><td class="h">6513</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub collect_log {</td></tr>
<tr><td class="h">6514</td><td><div class="c3">692</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6514">692</a></div></td><td><div class="c0">0</div></td><td><div>806</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers) {</td></tr>
<tr><td class="h">6515</td><td><div class="c3">1422</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6515">100</a></div></td><td></td><td></td><td></td><td><div>2685</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $log = $router-&gt;{log} or next;</td></tr>
<tr><td class="h">6516</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tag (keys %$log) {</td></tr>
<tr><td class="h">6517</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$known_log{$tag} = 1;</td></tr>
<tr><td class="h">6518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6520</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>656</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6522</td><td colspan="7"></td></tr><tr><td class="h">6523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_log {</td></tr>
<tr><td class="h">6524</td><td><div class="c3">36</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6524">36</a></div></td><td><div class="c0">0</div></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($log, $context) = @_;</td></tr>
<tr><td class="h">6525</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $tag (@$log) {</td></tr>
<tr><td class="h">6526</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6526">100</a></div></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$known_log{$tag} and next;</td></tr>
<tr><td class="h">6527</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Referencing unknown &#39;$tag&#39; in log of $context&quot;);</td></tr>
<tr><td class="h">6528</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_delete($log, $tag);</td></tr>
<tr><td class="h">6529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6530</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6532</td><td colspan="7"></td></tr><tr><td class="h">6533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Normalize lists of log tags at different rules in such a way,</td></tr>
<tr><td class="h">6534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># that equal sets of tags are represented by &#39;eq&#39; array references.</td></tr>
<tr><td class="h">6535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %key2log;</td></tr>
<tr><td class="h">6536</td><td colspan="7"></td></tr><tr><td class="h">6537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub normalize_log {</td></tr>
<tr><td class="h">6538</td><td><div class="c3">34</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6538">34</a></div></td><td><div class="c0">0</div></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($log) = @_;</td></tr>
<tr><td class="h">6539</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @tags = sort @$log;</td></tr>
<tr><td class="h">6540</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $key = join(&#39;,&#39;, @tags);</td></tr>
<tr><td class="h">6541</td><td><div class="c3">34</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6541">100</a></div></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $key2log{$key} ||= \@tags;</td></tr>
<tr><td class="h">6542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6543</td><td colspan="7"></td></tr><tr><td class="h">6544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters:</td></tr>
<tr><td class="h">6545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - The service.</td></tr>
<tr><td class="h">6546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - Reference to array for storing resulting expanded rules.</td></tr>
<tr><td class="h">6547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - Flag which will be passed on to expand_group.</td></tr>
<tr><td class="h">6548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_rules {</td></tr>
<tr><td class="h">6549</td><td><div class="c3">792</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6549">792</a></div></td><td><div class="c0">0</div></td><td><div>769</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($service, $convert_hosts) = @_;</td></tr>
<tr><td class="h">6550</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>786</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $rules_ref = $service-&gt;{rules};</td></tr>
<tr><td class="h">6551</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>749</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $service-&gt;{user};</td></tr>
<tr><td class="h">6552</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>732</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $context&nbsp;&nbsp;&nbsp;= $service-&gt;{name};</td></tr>
<tr><td class="h">6553</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>677</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $disabled&nbsp;&nbsp;= $service-&gt;{disabled};</td></tr>
<tr><td class="h">6554</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>670</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $private&nbsp;&nbsp;&nbsp;= $service-&gt;{private};</td></tr>
<tr><td class="h">6555</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>725</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $foreach&nbsp;&nbsp;&nbsp;= $service-&gt;{foreach};</td></tr>
<tr><td class="h">6556</td><td colspan="7"></td></tr><tr><td class="h">6557</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>847</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $unexpanded (@$rules_ref) {</td></tr>
<tr><td class="h">6558</td><td><div class="c3">884</div></td><td></td><td></td><td></td><td></td><td><div>1077</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $unexpanded-&gt;{action} eq &#39;deny&#39;;</td></tr>
<tr><td class="h">6559</td><td><div class="c3">884</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6559">100</a></div></td><td></td><td></td><td></td><td><div>1240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $store_type = $deny ? &#39;deny&#39; : &#39;permit&#39;;</td></tr>
<tr><td class="h">6560</td><td><div class="c3">884</div></td><td></td><td></td><td></td><td></td><td><div>786</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $unexpanded-&gt;{log};</td></tr>
<tr><td class="h">6561</td><td><div class="c3">884</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6561">100</a></div></td><td></td><td></td><td></td><td><div>1298</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($log) {</td></tr>
<tr><td class="h">6562</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_log($log, $context);</td></tr>
<tr><td class="h">6563</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6563">100</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$log) {</td></tr>
<tr><td class="h">6564</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log = normalize_log($log);</td></tr>
<tr><td class="h">6565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6567</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log = undef;</td></tr>
<tr><td class="h">6568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6570</td><td><div class="c3">884</div></td><td></td><td></td><td></td><td></td><td><div>1827</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt_list =</td></tr>
<tr><td class="h">6571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split_protocols(</td></tr>
<tr><td class="h">6572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_protocols($unexpanded-&gt;{prt}, &quot;rule in $context&quot;));</td></tr>
<tr><td class="h">6573</td><td><div class="c3">884</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6573">100</a></div></td><td></td><td></td><td></td><td><div>1614</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element ($foreach ? @$user : $user) {</td></tr>
<tr><td class="h">6574</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>919</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_object-&gt;{elements} = $element;</td></tr>
<tr><td class="h">6575</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>1933</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src =</td></tr>
<tr><td class="h">6576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_group_in_rule($unexpanded-&gt;{src},</td></tr>
<tr><td class="h">6577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;src of rule in $context&quot;,</td></tr>
<tr><td class="h">6578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$convert_hosts);</td></tr>
<tr><td class="h">6579</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>1346</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_context = &quot;dst of rule in $context&quot;;</td></tr>
<tr><td class="h">6580</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>1308</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst = expand_group_in_rule($unexpanded-&gt;{dst}, $dst_context,</td></tr>
<tr><td class="h">6581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$convert_hosts);</td></tr>
<tr><td class="h">6582</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>1264</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst = add_managed_hosts($dst, $dst_context);</td></tr>
<tr><td class="h">6583</td><td><div class="c3">886</div></td><td></td><td></td><td></td><td></td><td><div>945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (@$prt_list) {</td></tr>
<tr><td class="h">6584</td><td colspan="7"></td></tr><tr><td class="h">6585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent modification of original array.</td></tr>
<tr><td class="h">6586</td><td><div class="c3">946</div></td><td></td><td></td><td></td><td></td><td><div>787</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt = $prt;</td></tr>
<tr><td class="h">6587</td><td colspan="7"></td></tr><tr><td class="h">6588</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If $prt is duplicate of an identical protocol,</td></tr>
<tr><td class="h">6589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# use the main protocol, but remember the original</td></tr>
<tr><td class="h">6590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# one for debugging / comments.</td></tr>
<tr><td class="h">6591</td><td><div class="c3">946</div></td><td></td><td></td><td></td><td></td><td><div>776</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $orig_prt;</td></tr>
<tr><td class="h">6592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range;</td></tr>
<tr><td class="h">6593</td><td><div class="c3">946</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6593">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6593">100</a></div></td><td></td><td></td><td></td><td><div>2274</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref $prt eq &#39;ARRAY&#39;) {</td></tr>
<tr><td class="h">6594</td><td><div class="c3">50</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($src_range, $prt, $orig_prt) = @$prt;</td></tr>
<tr><td class="h">6595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $main_prt = $prt-&gt;{main}) {</td></tr>
<tr><td class="h">6597</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_prt = $prt;</td></tr>
<tr><td class="h">6598</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $main_prt;</td></tr>
<tr><td class="h">6599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6600</td><td colspan="7"></td></tr><tr><td class="h">6601</td><td><div class="c3">946</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6601">100</a></div></td><td></td><td></td><td></td><td><div>1328</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $flags = $orig_prt ? $orig_prt-&gt;{flags} : $prt-&gt;{flags};</td></tr>
<tr><td class="h">6602</td><td><div class="c3">946</div></td><td></td><td></td><td></td><td></td><td><div>928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $stateless = $flags-&gt;{stateless};</td></tr>
<tr><td class="h">6603</td><td><div class="c3">946</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6603">100</a></div></td><td></td><td></td><td></td><td><div>1424</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst) =</td></tr>
<tr><td class="h">6604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$flags-&gt;{reversed} ? ($dst, $src) : ($src, $dst);</td></tr>
<tr><td class="h">6605</td><td colspan="7"></td></tr><tr><td class="h">6606</td><td><div class="c3">946</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src (@$src) {</td></tr>
<tr><td class="h">6607</td><td><div class="c3">1148</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6607">67</a></div></td><td></td><td></td><td><div>2916</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_zone = $obj2zone{$src} || get_zone $src;</td></tr>
<tr><td class="h">6608</td><td><div class="c3">1148</div></td><td></td><td></td><td></td><td></td><td><div>1115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_zone_cluster = $src_zone-&gt;{zone_cluster};</td></tr>
<tr><td class="h">6609</td><td><div class="c3">1148</div></td><td></td><td></td><td></td><td></td><td><div>1228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst (@$dst) {</td></tr>
<tr><td class="h">6610</td><td><div class="c3">1362</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6610">67</a></div></td><td></td><td></td><td><div>3359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_zone = $obj2zone{$dst} || get_zone $dst;</td></tr>
<tr><td class="h">6611</td><td><div class="c3">1362</div></td><td></td><td></td><td></td><td></td><td><div>1261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_zone_cluster = $dst_zone-&gt;{zone_cluster};</td></tr>
<tr><td class="h">6612</td><td><div class="c3">1362</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6612">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6612">60</a></div></td><td></td><td></td><td><div>4252</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$src_zone eq $dst_zone</td></tr>
<tr><td class="h">6613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $src_zone_cluster</td></tr>
<tr><td class="h">6614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $dst_zone_cluster</td></tr>
<tr><td class="h">6615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $src_zone_cluster eq $dst_zone_cluster)</td></tr>
<tr><td class="h">6616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">6617</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collect_unenforceable($src, $dst, $src_zone,</td></tr>
<tr><td class="h">6618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service);</td></tr>
<tr><td class="h">6619</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">6620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6621</td><td colspan="7"></td></tr><tr><td class="h">6622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# At least one rule is enforceable.</td></tr>
<tr><td class="h">6623</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is used to decide, if a service is fully</td></tr>
<tr><td class="h">6624</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# unenforceable.</td></tr>
<tr><td class="h">6625</td><td><div class="c3">1316</div></td><td></td><td></td><td></td><td></td><td><div>1457</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{seen_enforceable} = 1;</td></tr>
<tr><td class="h">6626</td><td colspan="7"></td></tr><tr><td class="h">6627</td><td><div class="c3">1316</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6627">50</a></div></td><td></td><td></td><td></td><td><div>2756</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @src =</td></tr>
<tr><td class="h">6628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_special($src, $dst, $flags-&gt;{src}, $context)</td></tr>
<tr><td class="h">6629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent multiple error messages.</td></tr>
<tr><td class="h">6630</td><td><div class="c3">1316</div></td><td></td><td></td><td></td><td></td><td><div>2816</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @dst =</td></tr>
<tr><td class="h">6631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_special($dst, $src, $flags-&gt;{dst}, $context);</td></tr>
<tr><td class="h">6632</td><td><div class="c3">1316</div></td><td></td><td></td><td></td><td></td><td><div>1709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src (@src) {</td></tr>
<tr><td class="h">6633</td><td><div class="c3">1316</div></td><td></td><td></td><td></td><td></td><td><div>1283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst (@dst) {</td></tr>
<tr><td class="h">6634</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6634">50</a></div></td><td></td><td></td><td></td><td><div>1615</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($private) {</td></tr>
<tr><td class="h">6635</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_p = $src-&gt;{private};</td></tr>
<tr><td class="h">6636</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_p = $dst-&gt;{private};</td></tr>
<tr><td class="h">6637</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6637">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6637">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_p and $src_p eq $private</td></tr>
<tr><td class="h">6638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $dst_p and $dst_p eq $private</td></tr>
<tr><td class="h">6639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg</td></tr>
<tr><td class="h">6640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Rule of $private.private $context&quot;,</td></tr>
<tr><td class="h">6641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must reference at least one object&quot;,</td></tr>
<tr><td class="h">6642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; out of $private.private&quot;;</td></tr>
<tr><td class="h">6643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6645</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6645">50</a></div></td><td></td><td></td><td></td><td><div>2080</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src-&gt;{private}</td></tr>
<tr><td class="h">6646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg</td></tr>
<tr><td class="h">6647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Rule of public $context must not&quot;,</td></tr>
<tr><td class="h">6648</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; reference $src-&gt;{name} of&quot;,</td></tr>
<tr><td class="h">6649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $src-&gt;{private}.private&quot;;</td></tr>
<tr><td class="h">6650</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6650">50</a></div></td><td></td><td></td><td></td><td><div>1987</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst-&gt;{private}</td></tr>
<tr><td class="h">6651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg</td></tr>
<tr><td class="h">6652</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Rule of public $context must not&quot;,</td></tr>
<tr><td class="h">6653</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; reference $dst-&gt;{name} of&quot;,</td></tr>
<tr><td class="h">6654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $dst-&gt;{private}.private&quot;;</td></tr>
<tr><td class="h">6655</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6656</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6656">50</a></div></td><td></td><td></td><td></td><td><div>1781</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $disabled;</td></tr>
<tr><td class="h">6657</td><td colspan="7"></td></tr><tr><td class="h">6658</td><td><div class="c3">1342</div></td><td></td><td></td><td></td><td></td><td><div>2795</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rule = {</td></tr>
<tr><td class="h">6659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;&nbsp;=&gt; $src,</td></tr>
<tr><td class="h">6660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst&nbsp;&nbsp;=&gt; $dst,</td></tr>
<tr><td class="h">6661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;=&gt; $prt,</td></tr>
<tr><td class="h">6662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule =&gt; $unexpanded</td></tr>
<tr><td class="h">6663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">6664</td><td><div class="c3">1342</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6664">100</a></div></td><td></td><td></td><td></td><td><div>1835</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{stateless} = 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $stateless;</td></tr>
<tr><td class="h">6665</td><td><div class="c3">1342</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6665">100</a></div></td><td></td><td></td><td></td><td><div>1849</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{deny}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $deny;</td></tr>
<tr><td class="h">6666</td><td><div class="c3">1342</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6666">100</a></div></td><td></td><td></td><td></td><td><div>1720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{src_range} = $src_range if $src_range;</td></tr>
<tr><td class="h">6667</td><td><div class="c3">1342</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6667">100</a></div></td><td></td><td></td><td></td><td><div>1745</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{log}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $log;</td></tr>
<tr><td class="h">6668</td><td><div class="c3">1342</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6668">100</a></div></td><td></td><td></td><td></td><td><div>2218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{orig_prt}&nbsp;&nbsp;= $orig_prt&nbsp;&nbsp;if $orig_prt;</td></tr>
<tr><td class="h">6669</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6669">50</a></div></td><td></td><td></td><td></td><td><div>1940</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{oneway} = 1 if $flags-&gt;{oneway};</td></tr>
<tr><td class="h">6670</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6670">50</a></div></td><td></td><td></td><td></td><td><div>2174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{no_check_supernet_rules} = 1</td></tr>
<tr><td class="h">6671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $flags-&gt;{no_check_supernet_rules};</td></tr>
<tr><td class="h">6672</td><td><div class="c3">1342</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6672">50</a></div></td><td></td><td></td><td></td><td><div>1815</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{stateless_icmp} = 1</td></tr>
<tr><td class="h">6673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $flags-&gt;{stateless_icmp};</td></tr>
<tr><td class="h">6674</td><td colspan="7"></td></tr><tr><td class="h">6675</td><td><div class="c3">1342</div><div class="c3">1342</div></td><td></td><td></td><td></td><td></td><td><div>1000</div><div>8414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $expanded_rules{$store_type} }, $rule);</td></tr>
<tr><td class="h">6676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6683</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>1170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;show_unenforceable($service);</td></tr>
<tr><td class="h">6684</td><td colspan="7"></td></tr><tr><td class="h">6685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Result is returned indirectly using parameter $result.</td></tr>
<tr><td class="h">6686</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>1459</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6688</td><td colspan="7"></td></tr><tr><td class="h">6689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_rulecount {</td></tr>
<tr><td class="h">6690</td><td><div class="c3">1870</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6690">1870</a></div></td><td><div class="c0">0</div></td><td><div>1571</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $count = 0;</td></tr>
<tr><td class="h">6691</td><td><div class="c3">1870</div></td><td></td><td></td><td></td><td></td><td><div>1937</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $type (&#39;deny&#39;, &#39;permit&#39;) {</td></tr>
<tr><td class="h">6692</td><td><div class="c3">3740</div><div class="c3">4050</div><div class="c3">3740</div></td><td></td><td></td><td></td><td></td><td><div>2836</div><div>6311</div><div>5795</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count += grep { not $_-&gt;{deleted} } @{ $expanded_rules{$type} };</td></tr>
<tr><td class="h">6693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6694</td><td><div class="c3">1870</div></td><td></td><td></td><td></td><td></td><td><div>4522</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;info(&quot;Expanded rule count: $count&quot;);</td></tr>
<tr><td class="h">6695</td><td><div class="c3">1870</div></td><td></td><td></td><td></td><td></td><td><div>1764</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6697</td><td colspan="7"></td></tr><tr><td class="h">6698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_services {</td></tr>
<tr><td class="h">6699</td><td><div class="c3">692</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6699">692</a></div></td><td><div class="c0">0</div></td><td><div>697</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($convert_hosts) = @_;</td></tr>
<tr><td class="h">6700</td><td><div class="c3">692</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6700">50</a></div></td><td></td><td></td><td></td><td><div>2220</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;convert_hosts if $convert_hosts;</td></tr>
<tr><td class="h">6701</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>1090</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Expanding services&#39;);</td></tr>
<tr><td class="h">6702</td><td colspan="7"></td></tr><tr><td class="h">6703</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>988</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;collect_log();</td></tr>
<tr><td class="h">6704</td><td colspan="7"></td></tr><tr><td class="h">6705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort by service name to make output deterministic.</td></tr>
<tr><td class="h">6706</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>1536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %services) {</td></tr>
<tr><td class="h">6707</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>1016</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $service = $services{$key};</td></tr>
<tr><td class="h">6708</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>832</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;&nbsp;= $service-&gt;{name};</td></tr>
<tr><td class="h">6709</td><td colspan="7"></td></tr><tr><td class="h">6710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Substitute service name by service object.</td></tr>
<tr><td class="h">6711</td><td><div class="c3">792</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6711">100</a></div></td><td></td><td></td><td></td><td><div>1270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $overlaps = $service-&gt;{overlaps}) {</td></tr>
<tr><td class="h">6712</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @pobjects;</td></tr>
<tr><td class="h">6713</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@$overlaps) {</td></tr>
<tr><td class="h">6714</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $oname) = @$pair;</td></tr>
<tr><td class="h">6715</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6715">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6715">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$type eq &#39;service&#39;) {</td></tr>
<tr><td class="h">6716</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Unexpected type &#39;$type&#39; in attribute &#39;overlaps&#39;&quot;,</td></tr>
<tr><td class="h">6717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $name&quot;;</td></tr>
<tr><td class="h">6718</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $other = $services{$oname}) {</td></tr>
<tr><td class="h">6720</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@pobjects, $other);</td></tr>
<tr><td class="h">6721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6723</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Unknown $type:$oname in attribute &#39;overlaps&#39;&quot;,</td></tr>
<tr><td class="h">6724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $name&quot;);</td></tr>
<tr><td class="h">6725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6727</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{overlaps} = \@pobjects;</td></tr>
<tr><td class="h">6728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6729</td><td colspan="7"></td></tr><tr><td class="h">6730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Attribute &quot;visible&quot; is known to have value &quot;*&quot; or &quot;name*&quot;.</td></tr>
<tr><td class="h">6731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It must match prefix of some owner name.</td></tr>
<tr><td class="h">6732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Change value to regex to simplify tests: # name* -&gt; /^name.*$/</td></tr>
<tr><td class="h">6733</td><td><div class="c3">792</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6733">50</a></div></td><td></td><td></td><td></td><td><div>1259</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $visible = $service-&gt;{visible}) {</td></tr>
<tr><td class="h">6734</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6734">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($prefix) = ($visible =~ /^ (\S*) [*] $/x)) {</td></tr>
<tr><td class="h">6735</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6735">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($prefix) {</td></tr>
<tr><td class="h">6736</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6736">0</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not grep { /^$prefix/ } keys %owners) {</td></tr>
<tr><td class="h">6737</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Attribute &#39;visible&#39; of $name doesn&#39;t match&quot;,</td></tr>
<tr><td class="h">6738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; any owner&quot;);</td></tr>
<tr><td class="h">6739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6741</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{visible} = qr/^$prefix.*$/;</td></tr>
<tr><td class="h">6742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6744</td><td colspan="7"></td></tr><tr><td class="h">6745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t convert hosts in user objects here.</td></tr>
<tr><td class="h">6746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This will be done when expanding &#39;user&#39; inside a rule.</td></tr>
<tr><td class="h">6747</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>1717</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{user} = expand_group($service-&gt;{user}, &quot;user of $name&quot;);</td></tr>
<tr><td class="h">6748</td><td><div class="c3">792</div></td><td></td><td></td><td></td><td></td><td><div>1661</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_rules($service, $convert_hosts);</td></tr>
<tr><td class="h">6749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6750</td><td colspan="7"></td></tr><tr><td class="h">6751</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>1045</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;warn_useless_unenforceable();</td></tr>
<tr><td class="h">6752</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>869</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_rulecount();</td></tr>
<tr><td class="h">6753</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>1050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Preparing optimization&#39;);</td></tr>
<tr><td class="h">6754</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>782</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $type (qw(deny permit)) {</td></tr>
<tr><td class="h">6755</td><td><div class="c3">1384</div></td><td></td><td></td><td></td><td></td><td><div>1928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_rules($expanded_rules{$type});</td></tr>
<tr><td class="h">6756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6757</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>922</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_rulecount();</td></tr>
<tr><td class="h">6758</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>897</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;show_deleted_rules1();</td></tr>
<tr><td class="h">6759</td><td><div class="c3">692</div></td><td></td><td></td><td></td><td></td><td><div>650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6761</td><td colspan="7"></td></tr><tr><td class="h">6762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># For each device, find the IP address which is used</td></tr>
<tr><td class="h">6763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># to manage the device from a central policy distribution point.</td></tr>
<tr><td class="h">6764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This address is added as a comment line to each generated code file.</td></tr>
<tr><td class="h">6765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This is to be used later when approving the generated code file.</td></tr>
<tr><td class="h">6766</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_policy_distribution_ip {</td></tr>
<tr><td class="h">6767</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6767">486</a></div></td><td><div class="c0">0</div></td><td><div>810</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Setting policy distribution IP&#39;);</td></tr>
<tr><td class="h">6768</td><td colspan="7"></td></tr><tr><td class="h">6769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find all TCP ranges which include port 22 and 23.</td></tr>
<tr><td class="h">6770</td><td><div class="c3">938</div></td><td></td><td></td><td></td><td></td><td><div>2470</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @admin_tcp_keys = grep({</td></tr>
<tr><td class="h">6771</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>994</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($p1, $p2) = split(&#39;:&#39;, $_);</td></tr>
<tr><td class="h">6772</td><td><div class="c3">938</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6772">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6772">100</a></div><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6772">100</a></div></td><td></td><td></td><td><div>4465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$p1 &lt;= 22 &amp;&amp; 22 &lt;= $p2 || $p1 &lt;= 23 &amp;&amp; 23 &lt;= $p2;</td></tr>
<tr><td class="h">6773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6774</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>401</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys %{ $prt_hash{tcp} });</td></tr>
<tr><td class="h">6775</td><td><div class="c3">486</div><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>598</div><div>863</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @prt_list = (@{ $prt_hash{tcp} }{@admin_tcp_keys}, $prt_hash{ip});</td></tr>
<tr><td class="h">6776</td><td colspan="7"></td></tr><tr><td class="h">6777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mapping from policy distribution host to subnets, networks and</td></tr>
<tr><td class="h">6778</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# aggregates that include this host.</td></tr>
<tr><td class="h">6779</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %host2pdp_src;</td></tr>
<tr><td class="h">6780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $get_pdp_src = sub {</td></tr>
<tr><td class="h">6781</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6781">18</a></div></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($host) = @_;</td></tr>
<tr><td class="h">6782</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pdp_src;</td></tr>
<tr><td class="h">6783</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6783">100</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($pdp_src = $host2pdp_src{$host}) {</td></tr>
<tr><td class="h">6784</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $pdp_src;</td></tr>
<tr><td class="h">6785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6786</td><td><div class="c3">16</div><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>15</div><div>29</div><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pdp (map { $_ } @{ $host-&gt;{subnets} }) {</td></tr>
<tr><td class="h">6787</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($pdp) {</td></tr>
<tr><td class="h">6788</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$pdp_src, $pdp;</td></tr>
<tr><td class="h">6789</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pdp = $pdp-&gt;{up};</td></tr>
<tr><td class="h">6790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6792</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $host2pdp_src{$host} = $pdp_src;</td></tr>
<tr><td class="h">6793</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1324</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">6794</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>685</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">6795</td><td><div class="c3">1192</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6795">100</a></div></td><td></td><td></td><td></td><td><div>2334</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pdp = $router-&gt;{policy_distribution_point} or next;</td></tr>
<tr><td class="h">6796</td><td><div class="c3">18</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6796">50</a></div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{orig_router};</td></tr>
<tr><td class="h">6797</td><td colspan="7"></td></tr><tr><td class="h">6798</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %found_interfaces;</td></tr>
<tr><td class="h">6799</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $pdp-&gt;{network}-&gt;{nat_domain}-&gt;{no_nat_set};</td></tr>
<tr><td class="h">6800</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pdp_src&nbsp;&nbsp;&nbsp;&nbsp;= $get_pdp_src-&gt;($pdp);</td></tr>
<tr><td class="h">6801</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $stateless&nbsp;&nbsp;= &#39;&#39;;</td></tr>
<tr><td class="h">6802</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &#39;&#39;;</td></tr>
<tr><td class="h">6803</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range&nbsp;&nbsp;= $prt_ip;</td></tr>
<tr><td class="h">6804</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src (@$pdp_src) {</td></tr>
<tr><td class="h">6805</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6805">100</a></div></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sub_rule_tree =</td></tr>
<tr><td class="h">6806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule_tree{$stateless}-&gt;{$deny}-&gt;{$src_range}-&gt;{$src}</td></tr>
<tr><td class="h">6807</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">6808</td><td colspan="7"></td></tr><tr><td class="h">6809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find interfaces where some rule permits management traffic.</td></tr>
<tr><td class="h">6810</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">6811</td><td colspan="7"></td></tr><tr><td class="h">6812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Loadbalancer VIP can&#39;t be used to access device.</td></tr>
<tr><td class="h">6813</td><td><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6813">50</a></div></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{vip};</td></tr>
<tr><td class="h">6814</td><td colspan="7"></td></tr><tr><td class="h">6815</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (@prt_list) {</td></tr>
<tr><td class="h">6816</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6816">100</a></div></td><td></td><td></td><td></td><td><div>259</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sub_rule_tree-&gt;{$interface}-&gt;{$prt} or next;</td></tr>
<tr><td class="h">6817</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$found_interfaces{$interface} = $interface;</td></tr>
<tr><td class="h">6818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6819</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6821</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">6822</td><td colspan="7"></td></tr><tr><td class="h">6823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ready, if exactly one management interface was found.</td></tr>
<tr><td class="h">6824</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6824">100</a></div></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (keys %found_interfaces == 1) {</td></tr>
<tr><td class="h">6825</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = values %found_interfaces;</td></tr>
<tr><td class="h">6826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6828</td><td colspan="7"></td></tr><tr><td class="h">6829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$router-&gt;{name}: &quot;, scalar keys %found_interfaces);</td></tr>
<tr><td class="h">6830</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @front = path_auto_interfaces($router, $pdp);</td></tr>
<tr><td class="h">6831</td><td colspan="7"></td></tr><tr><td class="h">6832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If multiple management interfaces were found, take that which is</td></tr>
<tr><td class="h">6833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# directed to policy_distribution_point.</td></tr>
<tr><td class="h">6834</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $front (@front) {</td></tr>
<tr><td class="h">6835</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6835">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($found_interfaces{$front}) {</td></tr>
<tr><td class="h">6836</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $front;</td></tr>
<tr><td class="h">6837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6839</td><td colspan="7"></td></tr><tr><td class="h">6840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take all management interfaces.</td></tr>
<tr><td class="h">6841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Preserve original order of router interfaces.</td></tr>
<tr><td class="h">6842</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6842">100</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!@result) {</td></tr>
<tr><td class="h">6843</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result =</td></tr>
<tr><td class="h">6844</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $found_interfaces{$_} } @{ $router-&gt;{interfaces} };</td></tr>
<tr><td class="h">6845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6846</td><td colspan="7"></td></tr><tr><td class="h">6847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t set {admin_ip} if no address is found.</td></tr>
<tr><td class="h">6848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Warning is printed below.</td></tr>
<tr><td class="h">6849</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6849">100</a></div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not @result;</td></tr>
<tr><td class="h">6850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6851</td><td colspan="7"></td></tr><tr><td class="h">6852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prefer loopback interface if available.</td></tr>
<tr><td class="h">6853</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{admin_ip} = [</td></tr>
<tr><td class="h">6854</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6854">50</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6854">50</a></div></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { print_ip((address($_, $no_nat_set))-&gt;[0]) }</td></tr>
<tr><td class="h">6855</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort { ($b-&gt;{loopback} || &#39;&#39;) cmp($a-&gt;{loopback} || &#39;&#39;) } @result</td></tr>
<tr><td class="h">6856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">6857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6858</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>470</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">6859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @unreachable;</td></tr>
<tr><td class="h">6860</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>556</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">6861</td><td><div class="c3">1192</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6861">100</a></div></td><td></td><td></td><td></td><td><div>1930</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$router};</td></tr>
<tr><td class="h">6862</td><td><div class="c3">1190</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6862">100</a></div></td><td></td><td></td><td></td><td><div>2118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$router-&gt;{policy_distribution_point};</td></tr>
<tr><td class="h">6863</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6863">50</a></div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{orig_router};</td></tr>
<tr><td class="h">6864</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6864">100</a></div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $vrf_members = $router-&gt;{vrf_members}) {</td></tr>
<tr><td class="h">6865</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $member (@$vrf_members) {</td></tr>
<tr><td class="h">6866</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6866">50</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$member-&gt;{admin_ip}) {</td></tr>
<tr><td class="h">6867</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@unreachable,</td></tr>
<tr><td class="h">6868</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;some VRF of router:$router-&gt;{device_name}&quot;);</td></tr>
<tr><td class="h">6869</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">6870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6872</td><td colspan="7"></td></tr><tr><td class="h">6873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print VRF instance with known admin_ip first.</td></tr>
<tr><td class="h">6874</td><td><div class="c3">2</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6874">0</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{vrf_members} = [</td></tr>
<tr><td class="h">6875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort {</td></tr>
<tr><td class="h">6876</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!$a-&gt;{admin_ip} &lt;=&gt; !$b-&gt;{admin_ip}</td></tr>
<tr><td class="h">6877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $a-&gt;{name} cmp $b-&gt;{name}</td></tr>
<tr><td class="h">6878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} @$vrf_members</td></tr>
<tr><td class="h">6879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">6880</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$_} = 1 for @$vrf_members;</td></tr>
<tr><td class="h">6881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6883</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6883">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{admin_ip}</td></tr>
<tr><td class="h">6884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or push @unreachable, $router-&gt;{name};</td></tr>
<tr><td class="h">6885</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$router} = 1;</td></tr>
<tr><td class="h">6886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6888</td><td><div class="c3">486</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6888">100</a></div></td><td></td><td></td><td></td><td><div>844</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@unreachable) {</td></tr>
<tr><td class="h">6889</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6889">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@unreachable &gt; 4) {</td></tr>
<tr><td class="h">6890</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice(@unreachable, 3, @unreachable - 3, &#39;...&#39;);</td></tr>
<tr><td class="h">6891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6892</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $list = join(&quot;\n - &quot;, @unreachable);</td></tr>
<tr><td class="h">6893</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">6894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Missing rules to reach devices from policy_distribution_point:\n&quot;,</td></tr>
<tr><td class="h">6895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - &quot;,</td></tr>
<tr><td class="h">6896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$list</td></tr>
<tr><td class="h">6897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">6898</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6899</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1997</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">6900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">6901</td><td colspan="7"></td></tr><tr><td class="h">6902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">6903</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Distribute owner, identify service owner</td></tr>
<tr><td class="h">6904</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">6905</td><td colspan="7"></td></tr><tr><td class="h">6906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub propagate_owners {</td></tr>
<tr><td class="h">6907</td><td><div class="c3">682</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6907">682</a></div></td><td><div class="c0">0</div></td><td><div>567</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %zone_got_net_owners;</td></tr>
<tr><td class="h">6908</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %clusters;</td></tr>
<tr><td class="h">6909</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;ZONE:</td></tr>
<tr><td class="h">6910</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>748</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">6911</td><td><div class="c3">2028</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6911">100</a></div></td><td></td><td></td><td></td><td><div>3007</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cluster = $zone-&gt;{zone_cluster}) {</td></tr>
<tr><td class="h">6912</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$clusters{$cluster} = $cluster;</td></tr>
<tr><td class="h">6913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6914</td><td colspan="7"></td></tr><tr><td class="h">6915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If an explicit owner was set, it has been set for</td></tr>
<tr><td class="h">6916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the whole cluster in link_aggregates.</td></tr>
<tr><td class="h">6917</td><td><div class="c3">2028</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6917">100</a></div></td><td></td><td></td><td></td><td><div>2760</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone-&gt;{owner};</td></tr>
<tr><td class="h">6918</td><td colspan="7"></td></tr><tr><td class="h">6919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Inversed inheritance: If a zone has no direct owner and if</td></tr>
<tr><td class="h">6920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# all contained real toplevel networks have the same owner,</td></tr>
<tr><td class="h">6921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# then set owner of this zone to the one owner.</td></tr>
<tr><td class="h">6922</td><td><div class="c3">2010</div></td><td></td><td></td><td></td><td></td><td><div>1414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner;</td></tr>
<tr><td class="h">6923</td><td><div class="c3">2010</div><div class="c3">2010</div></td><td></td><td></td><td></td><td></td><td><div>1510</div><div>2339</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} }) {</td></tr>
<tr><td class="h">6924</td><td><div class="c3">1991</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6924">50</a></div></td><td></td><td></td><td></td><td><div>2971</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{ip} eq &#39;tunnel&#39;;</td></tr>
<tr><td class="h">6925</td><td><div class="c3">1991</div></td><td></td><td></td><td></td><td></td><td><div>1647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_owner = $network-&gt;{owner};</td></tr>
<tr><td class="h">6926</td><td><div class="c3">1991</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6926">100</a></div></td><td></td><td></td><td></td><td><div>3855</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next ZONE if not $net_owner;</td></tr>
<tr><td class="h">6927</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6927">100</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner) {</td></tr>
<tr><td class="h">6928</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6928">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next ZONE if $net_owner ne $owner;</td></tr>
<tr><td class="h">6929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">6931</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner = $net_owner;</td></tr>
<tr><td class="h">6932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6934</td><td><div class="c3">37</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6934">100</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner) {</td></tr>
<tr><td class="h">6935</td><td colspan="7"></td></tr><tr><td class="h">6936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Inversed inherit: $zone-&gt;{name} $owner-&gt;{name}&quot;);</td></tr>
<tr><td class="h">6937</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{owner} = $owner;</td></tr>
<tr><td class="h">6938</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone_got_net_owners{$zone} = 1;</td></tr>
<tr><td class="h">6939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6941</td><td colspan="7"></td></tr><tr><td class="h">6942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check for consistent implicit owners of zone clusters.</td></tr>
<tr><td class="h">6943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Implicit owner from networks is only valid, if the same owner</td></tr>
<tr><td class="h">6944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# is found for all zones of cluster.</td></tr>
<tr><td class="h">6945</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $cluster (values %clusters) {</td></tr>
<tr><td class="h">6946</td><td><div class="c3">41</div><div class="c3">98</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6946">50</a></div></td><td></td><td></td><td></td><td><div>54</div><div>224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @implicit_owner_zones = grep { $zone_got_net_owners{$_} } @$cluster</td></tr>
<tr><td class="h">6947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">6948</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6948">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L6948">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">6949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!(</td></tr>
<tr><td class="h">6950</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@implicit_owner_zones == @$cluster</td></tr>
<tr><td class="h">6951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; equal(map { $_-&gt;{owner} } @implicit_owner_zones)</td></tr>
<tr><td class="h">6952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">6953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">6954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">6955</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_-&gt;{owner} = undef for @implicit_owner_zones;</td></tr>
<tr><td class="h">6956</td><td colspan="7"></td></tr><tr><td class="h">6957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Reset owner&quot;);</td></tr>
<tr><td class="h">6958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug($_-&gt;{name}) for @implicit_owner_zones;</td></tr>
<tr><td class="h">6959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6961</td><td colspan="7"></td></tr><tr><td class="h">6962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A zone can be part of multiple areas.</td></tr>
<tr><td class="h">6963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find the smallest enclosing area.</td></tr>
<tr><td class="h">6964</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>609</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %zone2area;</td></tr>
<tr><td class="h">6965</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>715</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">6966</td><td><div class="c3">2028</div><div class="c3">2028</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6966">100</a></div></td><td></td><td></td><td></td><td><div>1446</div><div>5653</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @areas = values %{ $zone-&gt;{areas} } or next;</td></tr>
<tr><td class="h">6967</td><td><div class="c3">164</div><div class="c3">63</div><div class="c3">63</div><div class="c3">63</div></td><td></td><td></td><td></td><td></td><td><div>197</div><div>48</div><div>65</div><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@areas = sort { @{ $a-&gt;{zones} } &lt;=&gt; @{ $b-&gt;{zones} } } @areas;</td></tr>
<tr><td class="h">6968</td><td><div class="c3">164</div></td><td></td><td></td><td></td><td></td><td><div>348</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone2area{$zone} = $areas[0];</td></tr>
<tr><td class="h">6969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6970</td><td colspan="7"></td></tr><tr><td class="h">6971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Build tree from inheritance relation:</td></tr>
<tr><td class="h">6972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# area -&gt; [area|zone, ..]</td></tr>
<tr><td class="h">6973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# zone&nbsp;&nbsp;-&gt; [network, ..]</td></tr>
<tr><td class="h">6974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# network -&gt; [network, ..]</td></tr>
<tr><td class="h">6975</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# network -&gt; [host|interface, ..]</td></tr>
<tr><td class="h">6976</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>653</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %tree;</td></tr>
<tr><td class="h">6977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %is_child;</td></tr>
<tr><td class="h">6978</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %ref2obj;</td></tr>
<tr><td class="h">6979</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $add_node = sub {</td></tr>
<tr><td class="h">6980</td><td><div class="c3">4670</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L6980">4670</a></div></td><td></td><td><div>4042</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($super, $sub) = @_;</td></tr>
<tr><td class="h">6981</td><td><div class="c3">4670</div><div class="c3">4670</div></td><td></td><td></td><td></td><td></td><td><div>3322</div><div>8690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $tree{$super} }, $sub;</td></tr>
<tr><td class="h">6982</td><td><div class="c3">4670</div></td><td></td><td></td><td></td><td></td><td><div>6777</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_child{$sub}&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">6983</td><td><div class="c3">4670</div></td><td></td><td></td><td></td><td></td><td><div>5975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2obj{$sub}&nbsp;&nbsp;&nbsp;= $sub;</td></tr>
<tr><td class="h">6984</td><td><div class="c3">4670</div></td><td></td><td></td><td></td><td></td><td><div>7915</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2obj{$super} = $super;</td></tr>
<tr><td class="h">6985</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>2518</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">6986</td><td colspan="7"></td></tr><tr><td class="h">6987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find subset relation between areas.</td></tr>
<tr><td class="h">6988</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>894</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (@areas) {</td></tr>
<tr><td class="h">6989</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6989">100</a></div></td><td></td><td></td><td></td><td><div>283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $super = $area-&gt;{subset_of}) {</td></tr>
<tr><td class="h">6990</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_node-&gt;($super, $area);</td></tr>
<tr><td class="h">6991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">6993</td><td colspan="7"></td></tr><tr><td class="h">6994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find direct subset relation between areas and zones.</td></tr>
<tr><td class="h">6995</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>784</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (@areas) {</td></tr>
<tr><td class="h">6996</td><td><div class="c3">118</div><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>100</div><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@{ $area-&gt;{zones} }) {</td></tr>
<tr><td class="h">6997</td><td><div class="c3">220</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L6997">100</a></div></td><td></td><td></td><td></td><td><div>519</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($zone2area{$zone} eq $area) {</td></tr>
<tr><td class="h">6998</td><td><div class="c3">164</div></td><td></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_node-&gt;($area, $zone);</td></tr>
<tr><td class="h">6999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7002</td><td colspan="7"></td></tr><tr><td class="h">7003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find subset relation between networks and hosts/interfaces.</td></tr>
<tr><td class="h">7004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $add_hosts = sub {</td></tr>
<tr><td class="h">7005</td><td><div class="c3">2813</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7005">2813</a></div></td><td></td><td><div>2197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network) = @_;</td></tr>
<tr><td class="h">7006</td><td><div class="c3">2813</div><div class="c3">2813</div></td><td></td><td></td><td></td><td></td><td><div>2440</div><div>3875</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">7007</td><td><div class="c3">329</div></td><td></td><td></td><td></td><td></td><td><div>393</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_node-&gt;($network, $host);</td></tr>
<tr><td class="h">7008</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7009</td><td><div class="c3">2813</div><div class="c3">2813</div></td><td></td><td></td><td></td><td></td><td><div>2287</div><div>3546</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7010</td><td><div class="c3">4390</div></td><td></td><td></td><td></td><td></td><td><div>3778</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">7011</td><td><div class="c3">4390</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7011">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7011">100</a></div></td><td></td><td></td><td><div>11130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!($router-&gt;{managed} || $router-&gt;{routing_only})) {</td></tr>
<tr><td class="h">7012</td><td><div class="c3">1332</div></td><td></td><td></td><td></td><td></td><td><div>1480</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_node-&gt;($network, $interface);</td></tr>
<tr><td class="h">7013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7014</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7015</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1763</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">7016</td><td colspan="7"></td></tr><tr><td class="h">7017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find subset relation between networks and networks.</td></tr>
<tr><td class="h">7018</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>593</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $add_subnets;</td></tr>
<tr><td class="h">7019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$add_subnets = sub {</td></tr>
<tr><td class="h">7020</td><td><div class="c3">2813</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7020">2813</a></div></td><td></td><td><div>2284</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network) = @_;</td></tr>
<tr><td class="h">7021</td><td><div class="c3">2813</div></td><td></td><td></td><td></td><td></td><td><div>2935</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_hosts-&gt;($network);</td></tr>
<tr><td class="h">7022</td><td><div class="c3">2813</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7022">100</a></div></td><td></td><td></td><td></td><td><div>7231</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnets = $network-&gt;{networks} or return;</td></tr>
<tr><td class="h">7023</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $subnet (@$subnets) {</td></tr>
<tr><td class="h">7024</td><td><div class="c3">112</div></td><td></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_node-&gt;($network, $subnet);</td></tr>
<tr><td class="h">7025</td><td><div class="c3">112</div></td><td></td><td></td><td></td><td></td><td><div>235</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_subnets-&gt;($subnet);</td></tr>
<tr><td class="h">7026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7027</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1531</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">7028</td><td colspan="7"></td></tr><tr><td class="h">7029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find subset relation between zones and networks.</td></tr>
<tr><td class="h">7030</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>758</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">7031</td><td><div class="c3">2028</div><div class="c3">2028</div></td><td></td><td></td><td></td><td></td><td><div>1546</div><div>2439</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} }) {</td></tr>
<tr><td class="h">7032</td><td><div class="c3">2701</div></td><td></td><td></td><td></td><td></td><td><div>3130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_node-&gt;($zone, $network);</td></tr>
<tr><td class="h">7033</td><td><div class="c3">2701</div></td><td></td><td></td><td></td><td></td><td><div>2994</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_subnets-&gt;($network);</td></tr>
<tr><td class="h">7034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7036</td><td colspan="7"></td></tr><tr><td class="h">7037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find root nodes.</td></tr>
<tr><td class="h">7038</td><td><div class="c3">1926</div></td><td></td><td></td><td></td><td></td><td><div>3129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @root_nodes =</td></tr>
<tr><td class="h">7039</td><td><div class="c3">682</div><div class="c3">3504</div></td><td></td><td></td><td></td><td></td><td><div>1636</div><div>4651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort by_name map { $ref2obj{$_} } grep { not $is_child{$_} } keys %tree;</td></tr>
<tr><td class="h">7040</td><td colspan="7"></td></tr><tr><td class="h">7041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# owner is extended by e_owner at node.</td></tr>
<tr><td class="h">7042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# owner-&gt;[[node, e_owner, .. ], .. ]</td></tr>
<tr><td class="h">7043</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>858</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %extended;</td></tr>
<tr><td class="h">7044</td><td colspan="7"></td></tr><tr><td class="h">7045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# upper_owner: owner object without attribute extend_only or undef</td></tr>
<tr><td class="h">7046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# extend: a list of owners with attribute extend</td></tr>
<tr><td class="h">7047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# extend_only: a list of owners with attribute extend_only</td></tr>
<tr><td class="h">7048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $inherit;</td></tr>
<tr><td class="h">7049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$inherit = sub {</td></tr>
<tr><td class="h">7050</td><td><div class="c3">6596</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7050">6596</a></div></td><td></td><td><div>6304</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($node, $upper_owner, $upper_node, $extend, $extend_only) = @_;</td></tr>
<tr><td class="h">7051</td><td><div class="c3">6596</div></td><td></td><td></td><td></td><td></td><td><div>5700</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner = $node-&gt;{owner};</td></tr>
<tr><td class="h">7052</td><td><div class="c3">6596</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7052">100</a></div></td><td></td><td></td><td></td><td><div>7194</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$owner) {</td></tr>
<tr><td class="h">7053</td><td><div class="c3">6464</div></td><td></td><td></td><td></td><td></td><td><div>6953</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$node-&gt;{owner} = $upper_owner;</td></tr>
<tr><td class="h">7054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7056</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">7057</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7057">100</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($upper_owner) {</td></tr>
<tr><td class="h">7058</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7058">100</a></div></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner eq $upper_owner) {</td></tr>
<tr><td class="h">7059</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7059">100</a></div></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$zone_got_net_owners{$upper_node}) {</td></tr>
<tr><td class="h">7060</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">7061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Useless $owner-&gt;{name} at $node-&gt;{name},\n&quot;,</td></tr>
<tr><td class="h">7062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; it was already inherited from&quot;,</td></tr>
<tr><td class="h">7063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $upper_node-&gt;{name}&quot;</td></tr>
<tr><td class="h">7064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7068</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7068">100</a></div></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($upper_owner-&gt;{extend}) {</td></tr>
<tr><td class="h">7069</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$extend = [ $upper_owner, @$extend ];</td></tr>
<tr><td class="h">7070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7072</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7073</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @extend_list = ($node);</td></tr>
<tr><td class="h">7074</td><td><div class="c3">132</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7074">50</a></div></td><td></td><td></td><td></td><td><div>225</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @extend_list, @$extend&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $extend;</td></tr>
<tr><td class="h">7075</td><td><div class="c3">132</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7075">50</a></div></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @extend_list, @$extend_only if $extend_only;</td></tr>
<tr><td class="h">7076</td><td><div class="c3">132</div><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>100</div><div>274</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $extended{$owner} }, \@extend_list;</td></tr>
<tr><td class="h">7077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7078</td><td><div class="c3">6596</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7078">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7078">67</a></div></td><td></td><td></td><td><div>10611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$owner || !$owner-&gt;{extend_only}) {</td></tr>
<tr><td class="h">7079</td><td><div class="c3">6584</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7079">100</a></div></td><td></td><td></td><td></td><td><div>9524</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $upper_extend = $extend_only-&gt;[0]) {</td></tr>
<tr><td class="h">7080</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$node-&gt;{extended_owner} = $upper_extend;</td></tr>
<tr><td class="h">7081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7082</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7083</td><td colspan="7"></td></tr><tr><td class="h">7084</td><td><div class="c3">6596</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7084">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7084">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7084">100</a></div></td><td></td><td></td><td><div>14292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner &amp;&amp; $owner-&gt;{extend_only}) {</td></tr>
<tr><td class="h">7085</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$extend_only = [ $owner, @$extend_only ];</td></tr>
<tr><td class="h">7086</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upper_owner = undef;</td></tr>
<tr><td class="h">7087</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upper_node&nbsp;&nbsp;= undef;</td></tr>
<tr><td class="h">7088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($owner) {</td></tr>
<tr><td class="h">7090</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upper_owner = $owner;</td></tr>
<tr><td class="h">7091</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upper_node&nbsp;&nbsp;= $node;</td></tr>
<tr><td class="h">7092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7093</td><td><div class="c3">6596</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7093">100</a></div></td><td></td><td></td><td></td><td><div>17811</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $childs = $tree{$node} or return;</td></tr>
<tr><td class="h">7094</td><td><div class="c3">3504</div></td><td></td><td></td><td></td><td></td><td><div>3553</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $child (@$childs) {</td></tr>
<tr><td class="h">7095</td><td><div class="c3">4670</div></td><td></td><td></td><td></td><td></td><td><div>7832</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inherit-&gt;($child, $upper_owner, $upper_node, $extend,</td></tr>
<tr><td class="h">7096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$extend_only);</td></tr>
<tr><td class="h">7097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7098</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>2709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">7099</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>846</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $node (@root_nodes) {</td></tr>
<tr><td class="h">7100</td><td><div class="c3">1926</div></td><td></td><td></td><td></td><td></td><td><div>2908</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inherit-&gt;($node, undef, undef, [], []);</td></tr>
<tr><td class="h">7101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7102</td><td colspan="7"></td></tr><tr><td class="h">7103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect extended owners and check for inconsistent extensions.</td></tr>
<tr><td class="h">7104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check owner with attribute {show_all}.</td></tr>
<tr><td class="h">7105</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1715</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $owner (sort by_name values %owners) {</td></tr>
<tr><td class="h">7106</td><td><div class="c3">96</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7106">100</a></div></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref = $extended{$owner} || [];</td></tr>
<tr><td class="h">7107</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $node1;</td></tr>
<tr><td class="h">7108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ext1;</td></tr>
<tr><td class="h">7109</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $combined;</td></tr>
<tr><td class="h">7110</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $node_ext (@$aref) {</td></tr>
<tr><td class="h">7111</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $node = shift @$node_ext;</td></tr>
<tr><td class="h">7112</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7112">100</a></div></td><td></td><td></td><td></td><td><div>235</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone_got_net_owners{$node};</td></tr>
<tr><td class="h">7113</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ext = $node_ext;</td></tr>
<tr><td class="h">7114</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7114">100</a></div></td><td></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($node1) {</td></tr>
<tr><td class="h">7115</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $owner_list ($ext1, $ext) {</td></tr>
<tr><td class="h">7116</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7116">100</a></div></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($other, $owner_node, $other_node) =</td></tr>
<tr><td class="h">7117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner_list eq $ext</td></tr>
<tr><td class="h">7118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? ($ext1, $node, $node1)</td></tr>
<tr><td class="h">7119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ($ext, $node1, $node);</td></tr>
<tr><td class="h">7120</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $e_owner (@$owner_list) {</td></tr>
<tr><td class="h">7121</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7121">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $e_owner-&gt;{extend_unbounded};</td></tr>
<tr><td class="h">7122</td><td><div class="c3">10</div><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7122">50</a></div></td><td></td><td></td><td></td><td><div>11</div><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if grep { $e_owner eq $_ } @$other;</td></tr>
<tr><td class="h">7123</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">7124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$owner-&gt;{name}&quot;,</td></tr>
<tr><td class="h">7125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; is extended by $e_owner-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">7126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - only at $owner_node-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">7127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - but not at $other_node-&gt;{name}&quot;</td></tr>
<tr><td class="h">7128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7131</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$combined = [ @$ext, @$combined ];</td></tr>
<tr><td class="h">7132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7134</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$combined = $ext;</td></tr>
<tr><td class="h">7135</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($node1, $ext1) = ($node, $ext);</td></tr>
<tr><td class="h">7136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7138</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7138">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7138">100</a></div></td><td></td><td></td><td><div>323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($combined &amp;&amp; @$combined) {</td></tr>
<tr><td class="h">7139</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{extended_by} = [ unique @$combined ];</td></tr>
<tr><td class="h">7140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7141</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7141">100</a></div></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner-&gt;{show_all}) {</td></tr>
<tr><td class="h">7142</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @invalid;</td></tr>
<tr><td class="h">7143</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $node (@root_nodes) {</td></tr>
<tr><td class="h">7144</td><td><div class="c3">6</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7144">100</a></div></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $node_owner = $node-&gt;{owner} || &#39;&#39;;</td></tr>
<tr><td class="h">7145</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7145">100</a></div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($node_owner ne $owner) {</td></tr>
<tr><td class="h">7146</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @invalid, $node;</td></tr>
<tr><td class="h">7147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7149</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7149">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@invalid) {</td></tr>
<tr><td class="h">7150</td><td><div class="c3">2</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $missing = join(&quot;\n - &quot;, map { $_-&gt;{name} } @invalid);</td></tr>
<tr><td class="h">7151</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$owner-&gt;{name} has attribute &#39;show_all&#39;,&quot;,</td></tr>
<tr><td class="h">7153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; but doesn&#39;t own whole topology.\n&quot;,</td></tr>
<tr><td class="h">7154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Missing:\n&quot;,</td></tr>
<tr><td class="h">7155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $missing&quot;</td></tr>
<tr><td class="h">7156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7160</td><td colspan="7"></td></tr><tr><td class="h">7161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle {router_attributes}-&gt;{owner} separately.</td></tr>
<tr><td class="h">7162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Areas can be nested. Proceed from small to larger ones.</td></tr>
<tr><td class="h">7163</td><td><div class="c3">682</div><div class="c3">56</div><div class="c3">56</div><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>1156</div><div>54</div><div>64</div><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (sort { @{ $a-&gt;{zones} } &lt;=&gt; @{ $b-&gt;{zones} } } @areas) {</td></tr>
<tr><td class="h">7164</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7164">100</a></div></td><td></td><td></td><td></td><td><div>265</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attributes = $area-&gt;{router_attributes} or next;</td></tr>
<tr><td class="h">7165</td><td><div class="c3">14</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7165">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $attributes-&gt;{owner}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">7166</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">7167</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@{ $area-&gt;{managed_routers} }) {</td></tr>
<tr><td class="h">7168</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7168">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $r_owner = $router-&gt;{owner}) {</td></tr>
<tr><td class="h">7169</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7169">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($r_owner eq $owner) {</td></tr>
<tr><td class="h">7170</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">7171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Useless $r_owner-&gt;{name} at $router-&gt;{name},\n&quot;,</td></tr>
<tr><td class="h">7172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; it was already inherited from $attributes-&gt;{name}&quot;</td></tr>
<tr><td class="h">7173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7177</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{owner} = $owner;</td></tr>
<tr><td class="h">7178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7181</td><td colspan="7"></td></tr><tr><td class="h">7182</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>885</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">7183</td><td><div class="c3">1427</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7183">100</a></div></td><td></td><td></td><td></td><td><div>2633</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner = $router-&gt;{owner} or next;</td></tr>
<tr><td class="h">7184</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">7185</td><td colspan="7"></td></tr><tr><td class="h">7186</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (get_intf($router)) {</td></tr>
<tr><td class="h">7187</td><td colspan="7"></td></tr><tr><td class="h">7188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Loadbalancer interface with {vip} can have dedicated owner.</td></tr>
<tr><td class="h">7189</td><td><div class="c3">6</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7189">67</a></div></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{owner} ||= $owner;</td></tr>
<tr><td class="h">7190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7192</td><td colspan="7"></td></tr><tr><td class="h">7193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Propagate owner of loopback interface to loopback network</td></tr>
<tr><td class="h">7194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# and loopback zone.</td></tr>
<tr><td class="h">7195</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>798</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@routers) {</td></tr>
<tr><td class="h">7196</td><td><div class="c3">1809</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7196">100</a></div></td><td></td><td></td><td><div>3342</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $router-&gt;{managed} || $router-&gt;{routing_only};</td></tr>
<tr><td class="h">7197</td><td><div class="c3">1809</div><div class="c3">1809</div></td><td></td><td></td><td></td><td></td><td><div>1351</div><div>2139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7198</td><td><div class="c3">4484</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7198">100</a></div></td><td></td><td></td><td></td><td><div>7952</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{loopback} or next;</td></tr>
<tr><td class="h">7199</td><td><div class="c3">78</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7199">100</a></div></td><td></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner = $interface-&gt;{owner} or next;</td></tr>
<tr><td class="h">7200</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">7201</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{owner} = $owner;</td></tr>
<tr><td class="h">7202</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7202">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{zone}-&gt;{owner} = $owner if $managed;</td></tr>
<tr><td class="h">7203</td><td colspan="7"></td></tr><tr><td class="h">7204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark dedicated owner of {vip} interface, which is also a</td></tr>
<tr><td class="h">7205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# loopback interface.</td></tr>
<tr><td class="h">7206</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">7207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7209</td><td colspan="7"></td></tr><tr><td class="h">7210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Inherit owner from enclosing network or zone to aggregate.</td></tr>
<tr><td class="h">7211</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>755</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">7212</td><td><div class="c3">2028</div><div class="c3">2028</div></td><td></td><td></td><td></td><td></td><td><div>1465</div><div>3811</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $aggregate (values %{ $zone-&gt;{ipmask2aggregate} }) {</td></tr>
<tr><td class="h">7213</td><td><div class="c3">100</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7213">50</a></div></td><td></td><td></td><td></td><td><div>186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $aggregate-&gt;{owner};</td></tr>
<tr><td class="h">7214</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up = $aggregate;</td></tr>
<tr><td class="h">7215</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($up = $up-&gt;{up}) {</td></tr>
<tr><td class="h">7216</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7216">100</a></div></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if !$up-&gt;{is_aggregate};</td></tr>
<tr><td class="h">7217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7218</td><td><div class="c3">100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7218">100</a></div></td><td></td><td></td><td></td><td><div>252</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{owner} = ($up ? $up : $zone)-&gt;{owner};</td></tr>
<tr><td class="h">7219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7221</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1652</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7222</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7223</td><td colspan="7"></td></tr><tr><td class="h">7224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_auto_intf {</td></tr>
<tr><td class="h">7225</td><td><div class="c3">1564</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7225">1564</a></div></td><td><div class="c0">0</div></td><td><div>1347</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src_aref, $dst_aref) = @_;</td></tr>
<tr><td class="h">7226</td><td><div class="c3">1564</div></td><td></td><td></td><td></td><td></td><td><div>2627</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for (my $i = 0 ; $i &lt; @$src_aref ; $i++) {</td></tr>
<tr><td class="h">7227</td><td><div class="c3">1974</div></td><td></td><td></td><td></td><td></td><td><div>1641</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src = $src_aref-&gt;[$i];</td></tr>
<tr><td class="h">7228</td><td><div class="c3">1974</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7228">100</a></div></td><td></td><td></td><td></td><td><div>2133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not is_autointerface($src);</td></tr>
<tr><td class="h">7229</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @new;</td></tr>
<tr><td class="h">7230</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst (@$dst_aref) {</td></tr>
<tr><td class="h">7231</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @new, path_auto_interfaces($src, $dst);</td></tr>
<tr><td class="h">7232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7233</td><td colspan="7"></td></tr><tr><td class="h">7234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Substitute auto interface by real interface(s).</td></tr>
<tr><td class="h">7235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Possible duplicate elements in @new are removed later.</td></tr>
<tr><td class="h">7236</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>138</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice(@$src_aref, $i, 1, @new);</td></tr>
<tr><td class="h">7237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7238</td><td><div class="c3">1564</div></td><td></td><td></td><td></td><td></td><td><div>1539</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7240</td><td colspan="7"></td></tr><tr><td class="h">7241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %unknown2services;</td></tr>
<tr><td class="h">7242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %unknown2unknown;</td></tr>
<tr><td class="h">7243</td><td colspan="7"></td></tr><tr><td class="h">7244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub show_unknown_owners {</td></tr>
<tr><td class="h">7245</td><td><div class="c3">682</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7245">682</a></div></td><td><div class="c0">0</div></td><td><div>1098</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $polices (values %unknown2services) {</td></tr>
<tr><td class="h">7246</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$polices = join(&#39;,&#39;, sort @$polices);</td></tr>
<tr><td class="h">7247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7248</td><td><div class="c3">682</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7248">50</a></div></td><td></td><td></td><td></td><td><div>1674</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print =</td></tr>
<tr><td class="h">7249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config-&gt;{check_service_unknown_owner} eq &#39;warn&#39;</td></tr>
<tr><td class="h">7250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? \&amp;warn_msg</td></tr>
<tr><td class="h">7251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \&amp;err_msg;</td></tr>
<tr><td class="h">7252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;UNKNOWN:</td></tr>
<tr><td class="h">7253</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (values %unknown2unknown) {</td></tr>
<tr><td class="h">7254</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up = $obj;</td></tr>
<tr><td class="h">7255</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($up = $up-&gt;{up}) {</td></tr>
<tr><td class="h">7256</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7256">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7256">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$unknown2services{$up}</td></tr>
<tr><td class="h">7257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $unknown2services{$obj} eq $unknown2services{$up})</td></tr>
<tr><td class="h">7258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">7259</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next UNKNOWN;</td></tr>
<tr><td class="h">7260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7262</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;(&quot;Unknown owner for $obj-&gt;{name} in $unknown2services{$obj}&quot;);</td></tr>
<tr><td class="h">7263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7264</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1070</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%unknown2services = %unknown2unknown = ();</td></tr>
<tr><td class="h">7265</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>671</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7267</td><td colspan="7"></td></tr><tr><td class="h">7268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_service_owner {</td></tr>
<tr><td class="h">7269</td><td><div class="c3">682</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7269">682</a></div></td><td><div class="c0">0</div></td><td><div>1186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Checking service owner&#39;);</td></tr>
<tr><td class="h">7270</td><td colspan="7"></td></tr><tr><td class="h">7271</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>905</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;propagate_owners();</td></tr>
<tr><td class="h">7272</td><td colspan="7"></td></tr><tr><td class="h">7273</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1478</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %services) {</td></tr>
<tr><td class="h">7274</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>1065</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $service = $services{$key};</td></tr>
<tr><td class="h">7275</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sname&nbsp;&nbsp;&nbsp;= $service-&gt;{name};</td></tr>
<tr><td class="h">7276</td><td colspan="7"></td></tr><tr><td class="h">7277</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>1806</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $users = expand_group($service-&gt;{user}, &quot;user of $sname&quot;);</td></tr>
<tr><td class="h">7278</td><td colspan="7"></td></tr><tr><td class="h">7279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Non &#39;user&#39; objects.</td></tr>
<tr><td class="h">7280</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>697</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @objects;</td></tr>
<tr><td class="h">7281</td><td colspan="7"></td></tr><tr><td class="h">7282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check, if service contains a coupling rule with only &quot;user&quot; elements.</td></tr>
<tr><td class="h">7283</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>666</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $is_coupling = 0;</td></tr>
<tr><td class="h">7284</td><td colspan="7"></td></tr><tr><td class="h">7285</td><td><div class="c3">782</div><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>639</div><div>1066</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $service-&gt;{rules} }) {</td></tr>
<tr><td class="h">7286</td><td><div class="c3">868</div></td><td></td><td></td><td></td><td></td><td><div>1175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_user = $rule-&gt;{has_user};</td></tr>
<tr><td class="h">7287</td><td><div class="c3">868</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7287">100</a></div></td><td></td><td></td><td></td><td><div>1353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($has_user eq &#39;both&#39;) {</td></tr>
<tr><td class="h">7288</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_coupling = 1;</td></tr>
<tr><td class="h">7289</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">7290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7291</td><td><div class="c3">842</div></td><td></td><td></td><td></td><td></td><td><div>841</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $what (qw(src dst)) {</td></tr>
<tr><td class="h">7292</td><td><div class="c3">1684</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7292">100</a></div></td><td></td><td></td><td></td><td><div>2708</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $what eq $has_user;</td></tr>
<tr><td class="h">7293</td><td><div class="c3">842</div></td><td></td><td></td><td></td><td></td><td><div>1864</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@objects,</td></tr>
<tr><td class="h">7294</td><td><div class="c3">842</div></td><td></td><td></td><td></td><td></td><td><div>647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ expand_group($rule-&gt;{$what}, &quot;$what of $sname&quot;) });</td></tr>
<tr><td class="h">7295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7297</td><td colspan="7"></td></tr><tr><td class="h">7298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Expand auto interface of objects in rules to set of real interfaces.</td></tr>
<tr><td class="h">7299</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>1270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_auto_intf(\@objects, $users);</td></tr>
<tr><td class="h">7300</td><td colspan="7"></td></tr><tr><td class="h">7301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Expand auto interfaces in users with counterpart in</td></tr>
<tr><td class="h">7302</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - users and objects</td></tr>
<tr><td class="h">7303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - only users</td></tr>
<tr><td class="h">7304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - only objects.</td></tr>
<tr><td class="h">7305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add elements of expanded users to objects.</td></tr>
<tr><td class="h">7306</td><td><div class="c3">782</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7306">100</a></div></td><td></td><td></td><td></td><td><div>1065</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($is_coupling) {</td></tr>
<tr><td class="h">7307</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7307">50</a></div></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@objects) {</td></tr>
<tr><td class="h">7308</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_auto_intf($users, [ @objects, @$users ]);</td></tr>
<tr><td class="h">7309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7311</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_auto_intf($users, $users);</td></tr>
<tr><td class="h">7312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7313</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, @$users;</td></tr>
<tr><td class="h">7314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7316</td><td><div class="c3">756</div></td><td></td><td></td><td></td><td></td><td><div>954</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_auto_intf($users, \@objects);</td></tr>
<tr><td class="h">7317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7318</td><td colspan="7"></td></tr><tr><td class="h">7319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect service owners and unknown owners;</td></tr>
<tr><td class="h">7320</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>646</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $service_owners;</td></tr>
<tr><td class="h">7321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $unknown_owners;</td></tr>
<tr><td class="h">7322</td><td colspan="7"></td></tr><tr><td class="h">7323</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>1036</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (unique @objects) {</td></tr>
<tr><td class="h">7324</td><td><div class="c3">894</div></td><td></td><td></td><td></td><td></td><td><div>922</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $owner = $obj-&gt;{owner};</td></tr>
<tr><td class="h">7325</td><td><div class="c3">894</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7325">100</a></div></td><td></td><td></td><td></td><td><div>1485</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($owner) {</td></tr>
<tr><td class="h">7326</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service_owners-&gt;{$owner} = $owner;</td></tr>
<tr><td class="h">7327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7329</td><td><div class="c3">864</div></td><td></td><td></td><td></td><td></td><td><div>1942</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$unknown_owners-&gt;{$obj} = $obj;</td></tr>
<tr><td class="h">7330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7332</td><td colspan="7"></td></tr><tr><td class="h">7333</td><td><div class="c3">782</div></td><td></td><td></td><td></td><td></td><td><div>1575</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$service-&gt;{owners} = [ values %$service_owners ];</td></tr>
<tr><td class="h">7334</td><td colspan="7"></td></tr><tr><td class="h">7335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for redundant service owner.</td></tr>
<tr><td class="h">7336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Allow dedicated service owner, if we have multiple owners</td></tr>
<tr><td class="h">7337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# from @objects.</td></tr>
<tr><td class="h">7338</td><td><div class="c3">782</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7338">100</a></div></td><td></td><td></td><td></td><td><div>1795</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $sub_owner = $service-&gt;{sub_owner}) {</td></tr>
<tr><td class="h">7339</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sub_owner-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">7340</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7340">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7340">33</a></div></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(keys %$service_owners == 1 &amp;&amp; $service_owners-&gt;{$sub_owner})</td></tr>
<tr><td class="h">7341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and warn_msg(&quot;Useless $sub_owner-&gt;{name} at $service-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7343</td><td colspan="7"></td></tr><tr><td class="h">7344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for multiple owners.</td></tr>
<tr><td class="h">7345</td><td><div class="c3">782</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7345">100</a></div></td><td></td><td></td><td></td><td><div>1157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $multi_count =</td></tr>
<tr><td class="h">7346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_coupling</td></tr>
<tr><td class="h">7347</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? 1</td></tr>
<tr><td class="h">7348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: values %$service_owners;</td></tr>
<tr><td class="h">7349</td><td><div class="c3">782</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7349">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7349">75</a></div></td><td></td><td></td><td><div>2650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($multi_count &gt; 1 xor $service-&gt;{multi_owner}) {</td></tr>
<tr><td class="h">7350</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7350">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($service-&gt;{multi_owner}) {</td></tr>
<tr><td class="h">7351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Useless use of attribute &#39;multi_owner&#39; at $sname&quot;);</td></tr>
<tr><td class="h">7352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $print =</td></tr>
<tr><td class="h">7355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config-&gt;{check_service_multi_owner}</td></tr>
<tr><td class="h">7356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $config-&gt;{check_service_multi_owner} eq &#39;warn&#39;</td></tr>
<tr><td class="h">7357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? \&amp;warn_msg</td></tr>
<tr><td class="h">7358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \&amp;err_msg</td></tr>
<tr><td class="h">7359</td><td><div class="c3">2</div><div class="c0">0</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7359">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7359">50</a></div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7359">0</a></div></td><td></td><td><div>8</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: sub { };</td></tr>
<tr><td class="h">7360</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @names =</td></tr>
<tr><td class="h">7361</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(map { ($_-&gt;{name} =~ /^owner:(.*)/)[0] }</td></tr>
<tr><td class="h">7362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %$service_owners);</td></tr>
<tr><td class="h">7363</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;(&quot;$sname has multiple owners:\n &quot; . join(&#39;, &#39;, @names));</td></tr>
<tr><td class="h">7364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7366</td><td colspan="7"></td></tr><tr><td class="h">7367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for unknown owners.</td></tr>
<tr><td class="h">7368</td><td><div class="c3">782</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7368">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7368">33</a></div></td><td></td><td></td><td><div>4009</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($unknown_owners and keys %$unknown_owners)</td></tr>
<tr><td class="h">7369</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor $service-&gt;{unknown_owner})</td></tr>
<tr><td class="h">7370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">7371</td><td><div class="c3">760</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7371">50</a></div></td><td></td><td></td><td></td><td><div>944</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($service-&gt;{unknown_owner}) {</td></tr>
<tr><td class="h">7372</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Useless use of attribute &#39;unknown_owner&#39; at $sname&quot;);</td></tr>
<tr><td class="h">7373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7375</td><td><div class="c3">760</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7375">50</a></div></td><td></td><td></td><td></td><td><div>2927</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($config-&gt;{check_service_unknown_owner}) {</td></tr>
<tr><td class="h">7376</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (values %$unknown_owners) {</td></tr>
<tr><td class="h">7377</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$unknown2unknown{$obj} = $obj;</td></tr>
<tr><td class="h">7378</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $unknown2services{$obj} }, $sname;</td></tr>
<tr><td class="h">7379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7384</td><td colspan="7"></td></tr><tr><td class="h">7385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Show unused owners.</td></tr>
<tr><td class="h">7386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remove attribute {is_used}, which isn&#39;t needed any longer.</td></tr>
<tr><td class="h">7387</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1231</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $owner (values %owners) {</td></tr>
<tr><td class="h">7388</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7388">100</a></div></td><td></td><td></td><td></td><td><div>223</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $owner-&gt;{is_used} or warn_msg(&quot;Unused $owner-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7390</td><td colspan="7"></td></tr><tr><td class="h">7391</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;show_unknown_owners();</td></tr>
<tr><td class="h">7392</td><td><div class="c3">682</div></td><td></td><td></td><td></td><td></td><td><div>574</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7394</td><td colspan="7"></td></tr><tr><td class="h">7395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">7396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Distribute NAT bindings</td></tr>
<tr><td class="h">7397</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">7398</td><td colspan="7"></td></tr><tr><td class="h">7399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># NAT Set: a set of NAT tags which are effective at some location.</td></tr>
<tr><td class="h">7400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># NAT Domain: a maximal area of the topology (a set of connected networks)</td></tr>
<tr><td class="h">7401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># where the NAT set is identical at each network.</td></tr>
<tr><td class="h">7402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_natdomain;</td></tr>
<tr><td class="h">7403</td><td colspan="7"></td></tr><tr><td class="h">7404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_natdomain {</td></tr>
<tr><td class="h">7405</td><td><div class="c3">3518</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7405">3518</a></div></td><td><div class="c0">0</div></td><td><div>3160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($network, $domain, $in_interface) = @_;</td></tr>
<tr><td class="h">7406</td><td colspan="7"></td></tr><tr><td class="h">7407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Found a loop inside a NAT domain.</td></tr>
<tr><td class="h">7408</td><td><div class="c3">3518</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7408">100</a></div></td><td></td><td></td><td></td><td><div>5775</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $network-&gt;{nat_domain};</td></tr>
<tr><td class="h">7409</td><td colspan="7"></td></tr><tr><td class="h">7410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $check_nat_err = sub {</td></tr>
<tr><td class="h">7411</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7411">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $nat_tags1, $nat_tags2) = @_;</td></tr>
<tr><td class="h">7412</td><td><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>7400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">7413</td><td colspan="7"></td></tr><tr><td class="h">7414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$domain-&gt;{name}: $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7415</td><td><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>4663</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{nat_domain} = $domain;</td></tr>
<tr><td class="h">7416</td><td><div class="c3">3036</div><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>2289</div><div>3740</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $domain-&gt;{networks} }, $network;</td></tr>
<tr><td class="h">7417</td><td><div class="c3">3036</div><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>2405</div><div>3752</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7418</td><td colspan="7"></td></tr><tr><td class="h">7419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore interface where we reached this network.</td></tr>
<tr><td class="h">7420</td><td><div class="c3">4760</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7420">100</a></div></td><td></td><td></td><td></td><td><div>10289</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_interface;</td></tr>
<tr><td class="h">7421</td><td><div class="c3">2687</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7421">100</a></div></td><td></td><td></td><td></td><td><div>3946</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">7422</td><td colspan="7"></td></tr><tr><td class="h">7423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;IN $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7424</td><td><div class="c3">2531</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7424">67</a></div></td><td></td><td></td><td><div>6135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_tags = $interface-&gt;{bind_nat} || $bind_nat0;</td></tr>
<tr><td class="h">7425</td><td><div class="c3">2531</div></td><td></td><td></td><td></td><td></td><td><div>2314</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">7426</td><td colspan="7"></td></tr><tr><td class="h">7427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found loop.</td></tr>
<tr><td class="h">7428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If one router is connected to the same NAT domain</td></tr>
<tr><td class="h">7429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# by different interfaces, all interfaces must have</td></tr>
<tr><td class="h">7430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the same NAT binding.</td></tr>
<tr><td class="h">7431</td><td><div class="c3">2531</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7431">100</a></div></td><td></td><td></td><td></td><td><div>3881</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $entry_nat_tags = $router-&gt;{active_path}) {</td></tr>
<tr><td class="h">7432</td><td><div class="c3">244</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7432">100</a></div></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if aref_eq($nat_tags, $entry_nat_tags);</td></tr>
<tr><td class="h">7433</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7433">50</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $names1 = join(&#39;,&#39;, @$nat_tags)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| &#39;(none)&#39;;</td></tr>
<tr><td class="h">7434</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7434">50</a></div></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $names2 = join(&#39;,&#39;, @$entry_nat_tags) || &#39;(none)&#39;;</td></tr>
<tr><td class="h">7435</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7435">50</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{nat_err_seen}-&gt;{&quot;$names1 $names2&quot;}++;</td></tr>
<tr><td class="h">7436</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Inconsistent NAT in loop at $router-&gt;{name}:\n&quot;,</td></tr>
<tr><td class="h">7437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; nat:$names1 vs. nat:$names2&quot;);</td></tr>
<tr><td class="h">7438</td><td colspan="7"></td></tr><tr><td class="h">7439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;LOOP $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7440</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">7441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7442</td><td colspan="7"></td></tr><tr><td class="h">7443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# &#39;local&#39; declaration restores previous value on block exit.</td></tr>
<tr><td class="h">7444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember NAT tags at loop entry.</td></tr>
<tr><td class="h">7445</td><td><div class="c3">2287</div></td><td></td><td></td><td></td><td></td><td><div>2938</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $router-&gt;{active_path} = $nat_tags;</td></tr>
<tr><td class="h">7446</td><td colspan="7"></td></tr><tr><td class="h">7447</td><td><div class="c3">2287</div><div class="c3">2287</div></td><td></td><td></td><td></td><td></td><td><div>1732</div><div>2808</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7448</td><td colspan="7"></td></tr><tr><td class="h">7449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t process interface where we reached this router.</td></tr>
<tr><td class="h">7450</td><td><div class="c3">5626</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7450">100</a></div></td><td></td><td></td><td></td><td><div>11709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $interface;</td></tr>
<tr><td class="h">7451</td><td><div class="c3">3339</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7451">100</a></div></td><td></td><td></td><td></td><td><div>5144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">7452</td><td colspan="7"></td></tr><tr><td class="h">7453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;OUT $out_interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Current NAT domain continues behind $out_interface.</td></tr>
<tr><td class="h">7455</td><td><div class="c3">3117</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7455">67</a></div></td><td></td><td></td><td><div>7172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_nat_tags = $out_interface-&gt;{bind_nat} || $bind_nat0;</td></tr>
<tr><td class="h">7456</td><td><div class="c3">3117</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7456">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7456">100</a></div></td><td></td><td></td><td></td><td><div>3796</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (aref_eq($out_nat_tags, $nat_tags)) {</td></tr>
<tr><td class="h">7457</td><td colspan="7"></td></tr><tr><td class="h">7458</td><td><div class="c3">2555</div></td><td></td><td></td><td></td><td></td><td><div>2362</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_net = $out_interface-&gt;{network};</td></tr>
<tr><td class="h">7459</td><td><div class="c3">2555</div></td><td></td><td></td><td></td><td></td><td><div>3706</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_natdomain($next_net, $domain, $out_interface);</td></tr>
<tr><td class="h">7460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7461</td><td colspan="7"></td></tr><tr><td class="h">7462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# New NAT domain starts at some interface of current router.</td></tr>
<tr><td class="h">7463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember NAT tag of current domain.</td></tr>
<tr><td class="h">7464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (not $router-&gt;{nat_tags}-&gt;{$domain}) {</td></tr>
<tr><td class="h">7465</td><td><div class="c3">428</div></td><td></td><td></td><td></td><td></td><td><div>729</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{nat_tags}-&gt;{$domain} = $nat_tags;</td></tr>
<tr><td class="h">7466</td><td><div class="c3">428</div><div class="c3">428</div></td><td></td><td></td><td></td><td></td><td><div>326</div><div>537</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $domain-&gt;{routers} },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router;</td></tr>
<tr><td class="h">7467</td><td><div class="c3">428</div><div class="c3">428</div></td><td></td><td></td><td></td><td></td><td><div>339</div><div>1088</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{nat_domains} }, $domain;</td></tr>
<tr><td class="h">7468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7471</td><td><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>8406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7473</td><td colspan="7"></td></tr><tr><td class="h">7474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @natdomains;</td></tr>
<tr><td class="h">7475</td><td colspan="7"></td></tr><tr><td class="h">7476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Distribute NAT tags from NAT domain to NAT domain.</td></tr>
<tr><td class="h">7477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns</td></tr>
<tr><td class="h">7478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - undef on success</td></tr>
<tr><td class="h">7479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - aref of routers, if invalid path was found in loop.</td></tr>
<tr><td class="h">7480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub distribute_nat1 {</td></tr>
<tr><td class="h">7481</td><td><div class="c3">248</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7481">248</a></div></td><td><div class="c0">0</div></td><td><div>268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($domain, $nat_tag, $nat_tags2multi, $in_router) = @_;</td></tr>
<tr><td class="h">7482</td><td colspan="7"></td></tr><tr><td class="h">7483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;nat:$nat_tag at $domain-&gt;{name} from $in_router-&gt;{name}&quot;;</td></tr>
<tr><td class="h">7484</td><td><div class="c3">248</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7484">100</a></div></td><td></td><td></td><td></td><td><div>381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($domain-&gt;{active_path}) {</td></tr>
<tr><td class="h">7485</td><td colspan="7"></td></tr><tr><td class="h">7486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$domain-&gt;{name} loop&quot;);</td></tr>
<tr><td class="h">7487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found a loop</td></tr>
<tr><td class="h">7488</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7490</td><td colspan="7"></td></tr><tr><td class="h">7491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Tag is already there.</td></tr>
<tr><td class="h">7492</td><td><div class="c3">246</div></td><td></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nat_set = $domain-&gt;{nat_set};</td></tr>
<tr><td class="h">7493</td><td><div class="c3">246</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7493">100</a></div></td><td></td><td></td><td></td><td><div>425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $nat_set-&gt;{$nat_tag};</td></tr>
<tr><td class="h">7494</td><td colspan="7"></td></tr><tr><td class="h">7495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Must not enter one NAT domain at different routers with</td></tr>
<tr><td class="h">7496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# different elements of grouped NAT tags.</td></tr>
<tr><td class="h">7497</td><td><div class="c3">218</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7497">100</a></div></td><td></td><td></td><td></td><td><div>393</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $aref = $nat_tags2multi-&gt;{$nat_tag}) {</td></tr>
<tr><td class="h">7498</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $multi_href (@$aref) {</td></tr>
<tr><td class="h">7499</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag2 (sort keys %$multi_href) {</td></tr>
<tr><td class="h">7500</td><td><div class="c3">230</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7500">100</a></div></td><td></td><td></td><td></td><td><div>475</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_set-&gt;{$nat_tag2}) {</td></tr>
<tr><td class="h">7501</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Grouped NAT tags &#39;$nat_tag2&#39; and &#39;$nat_tag&#39;&quot;,</td></tr>
<tr><td class="h">7503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must not both be active inside $domain-&gt;{name}&quot;</td></tr>
<tr><td class="h">7504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7509</td><td colspan="7"></td></tr><tr><td class="h">7510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Add tag.</td></tr>
<tr><td class="h">7511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use a hash to prevent duplicate entries.</td></tr>
<tr><td class="h">7512</td><td><div class="c3">218</div></td><td></td><td></td><td></td><td></td><td><div>305</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$nat_set-&gt;{$nat_tag} = 1;</td></tr>
<tr><td class="h">7513</td><td colspan="7"></td></tr><tr><td class="h">7514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Network which has translation with tag $nat_tag must not be located</td></tr>
<tr><td class="h">7515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# in area where this tag is effective.</td></tr>
<tr><td class="h">7516</td><td><div class="c3">218</div><div class="c3">218</div></td><td></td><td></td><td></td><td></td><td><div>184</div><div>297</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $domain-&gt;{networks} }) {</td></tr>
<tr><td class="h">7517</td><td><div class="c3">286</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7517">100</a></div></td><td></td><td></td><td></td><td><div>635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">7518</td><td><div class="c3">10</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7518">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat-&gt;{$nat_tag} or next;</td></tr>
<tr><td class="h">7519</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$network-&gt;{name} is translated by $nat_tag,\n&quot;,</td></tr>
<tr><td class="h">7521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; but is located inside the translation domain of $nat_tag.\n&quot;,</td></tr>
<tr><td class="h">7522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Probably $nat_tag was bound to wrong interface&quot;,</td></tr>
<tr><td class="h">7523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $in_router-&gt;{name}.&quot;</td></tr>
<tr><td class="h">7524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7525</td><td colspan="7"></td></tr><tr><td class="h">7526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Show error message only once.</td></tr>
<tr><td class="h">7527</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">7528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7529</td><td colspan="7"></td></tr><tr><td class="h">7530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Activate loop detection.</td></tr>
<tr><td class="h">7531</td><td><div class="c3">218</div></td><td></td><td></td><td></td><td></td><td><div>303</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $in_router-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">7532</td><td><div class="c3">218</div></td><td></td><td></td><td></td><td></td><td><div>246</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $domain-&gt;{active_path}&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">7533</td><td colspan="7"></td></tr><tr><td class="h">7534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Distribute NAT tag to adjacent NAT domains.</td></tr>
<tr><td class="h">7535</td><td><div class="c3">218</div><div class="c3">218</div></td><td></td><td></td><td></td><td></td><td><div>184</div><div>272</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@{ $domain-&gt;{routers} }) {</td></tr>
<tr><td class="h">7536</td><td><div class="c3">282</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7536">100</a></div></td><td></td><td></td><td></td><td><div>663</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router eq $in_router;</td></tr>
<tr><td class="h">7537</td><td><div class="c3">66</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_nat_tags = $router-&gt;{nat_tags}-&gt;{$domain};</td></tr>
<tr><td class="h">7538</td><td colspan="7"></td></tr><tr><td class="h">7539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found another interface with same NAT binding.</td></tr>
<tr><td class="h">7540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This stops effect of current NAT tag.</td></tr>
<tr><td class="h">7541</td><td><div class="c3">66</div><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7541">100</a></div></td><td></td><td></td><td></td><td><div>97</div><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if grep { $_ eq $nat_tag } @$in_nat_tags;</td></tr>
<tr><td class="h">7542</td><td colspan="7"></td></tr><tr><td class="h">7543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Traverse loop twice to prevent inherited errors.</td></tr>
<tr><td class="h">7544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for recursive and duplicate NAT.</td></tr>
<tr><td class="h">7545</td><td><div class="c3">46</div><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>39</div><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_domain (@{ $router-&gt;{nat_domains} }) {</td></tr>
<tr><td class="h">7546</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7546">100</a></div></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_domain eq $domain;</td></tr>
<tr><td class="h">7547</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_nat_tags = $router-&gt;{nat_tags}-&gt;{$out_domain};</td></tr>
<tr><td class="h">7548</td><td colspan="7"></td></tr><tr><td class="h">7549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Must not apply one NAT tag multiple times in a row.</td></tr>
<tr><td class="h">7550</td><td><div class="c3">58</div><div class="c3">50</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7550">100</a></div></td><td></td><td></td><td></td><td><div>65</div><div>145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_ eq $nat_tag } @$out_nat_tags) {</td></tr>
<tr><td class="h">7551</td><td colspan="7"></td></tr><tr><td class="h">7552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for recursive NAT in loop.</td></tr>
<tr><td class="h">7553</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7553">100</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{active_path}) {</td></tr>
<tr><td class="h">7554</td><td colspan="7"></td></tr><tr><td class="h">7555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Abort traversal and start collecting path.</td></tr>
<tr><td class="h">7556</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [$router];</td></tr>
<tr><td class="h">7557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7559</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;nat:$nat_tag is applied twice between&quot;,</td></tr>
<tr><td class="h">7560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $in_router-&gt;{name} and $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">7561</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7562</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7564</td><td colspan="7"></td></tr><tr><td class="h">7565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOMAIN:</td></tr>
<tr><td class="h">7566</td><td><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>41</div><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_domain (@{ $router-&gt;{nat_domains} }) {</td></tr>
<tr><td class="h">7567</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7567">100</a></div></td><td></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_domain eq $domain;</td></tr>
<tr><td class="h">7568</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_nat_tags = $router-&gt;{nat_tags}-&gt;{$out_domain};</td></tr>
<tr><td class="h">7569</td><td colspan="7"></td></tr><tr><td class="h">7570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Effect of current NAT tag stops if another element of</td></tr>
<tr><td class="h">7571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# grouped NAT tags becomes active.</td></tr>
<tr><td class="h">7572</td><td><div class="c3">54</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7572">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $aref = $nat_tags2multi-&gt;{$nat_tag}) {</td></tr>
<tr><td class="h">7573</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $href (@$aref) {</td></tr>
<tr><td class="h">7574</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag2 (@$out_nat_tags) {</td></tr>
<tr><td class="h">7575</td><td><div class="c3">40</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7575">50</a></div></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_tag2 eq $nat_tag;</td></tr>
<tr><td class="h">7576</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7576">100</a></div></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$href-&gt;{$nat_tag2};</td></tr>
<tr><td class="h">7577</td><td colspan="7"></td></tr><tr><td class="h">7578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;- $nat_tag2&quot;;</td></tr>
<tr><td class="h">7579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent transition from dynamic to</td></tr>
<tr><td class="h">7580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# static NAT.</td></tr>
<tr><td class="h">7581</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_info&nbsp;&nbsp;= $href-&gt;{$nat_tag};</td></tr>
<tr><td class="h">7582</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_info = $href-&gt;{$nat_tag2};</td></tr>
<tr><td class="h">7583</td><td colspan="7"></td></tr><tr><td class="h">7584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use $next_info-&gt;{name} and not $nat_info-&gt;{name}</td></tr>
<tr><td class="h">7585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because $nat_info may show wrong network,</td></tr>
<tr><td class="h">7586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because we combined different hidden networks into</td></tr>
<tr><td class="h">7587</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $nat_tags2multi.</td></tr>
<tr><td class="h">7588</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7588">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7588">50</a></div></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_info-&gt;{hidden}) {</td></tr>
<tr><td class="h">7589</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not change hidden nat:$nat_tag&quot;,</td></tr>
<tr><td class="h">7591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; using nat:$nat_tag2\n&quot;,</td></tr>
<tr><td class="h">7592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for $next_info-&gt;{name}&quot;,</td></tr>
<tr><td class="h">7593</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">7594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nat_info-&gt;{dynamic}) {</td></tr>
<tr><td class="h">7597</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7597">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!($next_info-&gt;{dynamic})) {</td></tr>
<tr><td class="h">7598</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not change dynamic nat:$nat_tag&quot;,</td></tr>
<tr><td class="h">7600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to static using nat:$nat_tag2\n&quot;,</td></tr>
<tr><td class="h">7601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for $nat_info-&gt;{name}&quot;,</td></tr>
<tr><td class="h">7602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">7603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7606</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next DOMAIN;</td></tr>
<tr><td class="h">7607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7610</td><td colspan="7"></td></tr><tr><td class="h">7611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Caller $domain-&gt;{name}&quot;;</td></tr>
<tr><td class="h">7612</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7612">100</a></div></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">7613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err_path = distribute_nat1(</td></tr>
<tr><td class="h">7614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_domain, $nat_tag, $nat_tags2multi, $router</td></tr>
<tr><td class="h">7615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">7616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">7617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">7618</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$err_path, $router;</td></tr>
<tr><td class="h">7619</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $err_path;</td></tr>
<tr><td class="h">7620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7623</td><td><div class="c3">214</div></td><td></td><td></td><td></td><td></td><td><div>581</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7624</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7625</td><td colspan="7"></td></tr><tr><td class="h">7626</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub distribute_nat {</td></tr>
<tr><td class="h">7627</td><td><div class="c3">226</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7627">226</a></div></td><td><div class="c0">0</div></td><td><div>284</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($domain, $nat_tag, $nat_tags2multi, $in_router) = @_;</td></tr>
<tr><td class="h">7628</td><td><div class="c3">226</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7628">100</a></div></td><td></td><td></td><td></td><td><div>309</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $err_path =</td></tr>
<tr><td class="h">7629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribute_nat1($domain, $nat_tag, $nat_tags2multi, $in_router))</td></tr>
<tr><td class="h">7630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">7631</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$err_path, $in_router;</td></tr>
<tr><td class="h">7632</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;nat:$nat_tag is applied recursively in loop at this path:\n&quot;,</td></tr>
<tr><td class="h">7633</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - &quot;, join(&quot;\n - &quot;, map { $_-&gt;{name} } reverse @$err_path));</td></tr>
<tr><td class="h">7634</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7635</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>221</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7637</td><td colspan="7"></td></tr><tr><td class="h">7638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub distribute_nat_info {</td></tr>
<tr><td class="h">7639</td><td><div class="c3">726</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7639">726</a></div></td><td><div class="c0">0</div></td><td><div>1364</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Distributing NAT&#39;);</td></tr>
<tr><td class="h">7640</td><td colspan="7"></td></tr><tr><td class="h">7641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mapping from nat_tag to boolean. Is false if all NAT mappings map</td></tr>
<tr><td class="h">7642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# to hidden.</td></tr>
<tr><td class="h">7643</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %has_non_hidden;</td></tr>
<tr><td class="h">7644</td><td colspan="7"></td></tr><tr><td class="h">7645</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>839</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">7646</td><td><div class="c3">3144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7646">100</a></div></td><td></td><td></td><td></td><td><div>5262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">7647</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>364</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$href) {</td></tr>
<tr><td class="h">7648</td><td><div class="c3">268</div></td><td></td><td></td><td></td><td></td><td><div>285</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $href-&gt;{$nat_tag};</td></tr>
<tr><td class="h">7649</td><td><div class="c3">268</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7649">100</a></div></td><td></td><td></td><td></td><td><div>472</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$nat_network-&gt;{hidden}) {</td></tr>
<tr><td class="h">7650</td><td><div class="c3">190</div></td><td></td><td></td><td></td><td></td><td><div>431</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_non_hidden{$nat_tag} = 1;</td></tr>
<tr><td class="h">7651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7652</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7653</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7654</td><td colspan="7"></td></tr><tr><td class="h">7655</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A hash with all defined NAT tags.</td></tr>
<tr><td class="h">7656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# It is used to check,</td></tr>
<tr><td class="h">7657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - if all NAT definitions are bound and</td></tr>
<tr><td class="h">7658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - if all bound NAT tags are defined somewhere.</td></tr>
<tr><td class="h">7659</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>865</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %nat_definitions;</td></tr>
<tr><td class="h">7660</td><td colspan="7"></td></tr><tr><td class="h">7661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check consistency of grouped NAT tags at one network.</td></tr>
<tr><td class="h">7662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If NAT tags are grouped at one network,</td></tr>
<tr><td class="h">7663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the same NAT tags must be used as group at all other networks.</td></tr>
<tr><td class="h">7664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Suppose tags A and B are used grouped.</td></tr>
<tr><td class="h">7665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# An occurence of bind_nat = A activates NAT:A.</td></tr>
<tr><td class="h">7666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# An successive bind_nat = B actives NAT:B, but implicitly disables NAT:A.</td></tr>
<tr><td class="h">7667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Hence A is disabled for all networks and therefore</td></tr>
<tr><td class="h">7668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# this restriction is needed.</td></tr>
<tr><td class="h">7669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Exception:</td></tr>
<tr><td class="h">7670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# NAT tags with &quot;hidden&quot; can be added to some valid set of grouped tags,</td></tr>
<tr><td class="h">7671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# because we don&#39;t allow transition from hidden tag back to some other</td></tr>
<tr><td class="h">7672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# (hidden) tag.</td></tr>
<tr><td class="h">7673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">7674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A hash with all defined NAT tags as keys and aref of hrefs as value.</td></tr>
<tr><td class="h">7675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# The href has those NAT tags as keys which are used together at one</td></tr>
<tr><td class="h">7676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# network.</td></tr>
<tr><td class="h">7677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This is used to check,</td></tr>
<tr><td class="h">7678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# that NAT tags are equally used grouped or solitary.</td></tr>
<tr><td class="h">7679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %nat_tags2multi;</td></tr>
<tr><td class="h">7680</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %all_hidden;</td></tr>
<tr><td class="h">7681</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>768</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">7682</td><td><div class="c3">3144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7682">100</a></div></td><td></td><td></td><td></td><td><div>5118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">7683</td><td colspan="7"></td></tr><tr><td class="h">7684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug $network-&gt;{name}, &quot; nat=&quot;, join(&#39;,&#39;, sort keys %$href);</td></tr>
<tr><td class="h">7685</td><td colspan="7"></td></tr><tr><td class="h">7686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print error message only once per network.</td></tr>
<tr><td class="h">7687</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err_shown;</td></tr>
<tr><td class="h">7688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $show_err = sub {</td></tr>
<tr><td class="h">7689</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7689">10</a></div></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($href1, $href2) = @_;</td></tr>
<tr><td class="h">7690</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7690">100</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $err_shown;</td></tr>
<tr><td class="h">7691</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tags1 = join(&#39;,&#39;, sort keys %$href1);</td></tr>
<tr><td class="h">7692</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name1 = $network-&gt;{name};</td></tr>
<tr><td class="h">7693</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tags2 = join(&#39;,&#39;, sort keys %$href2);</td></tr>
<tr><td class="h">7694</td><td colspan="7"></td></tr><tr><td class="h">7695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Values are NAT entries with name of network.</td></tr>
<tr><td class="h">7696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take first value deterministically.</td></tr>
<tr><td class="h">7697</td><td><div class="c3">6</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>10</div><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($name2) = sort map { $_-&gt;{name} } values %$href2;</td></tr>
<tr><td class="h">7698</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg</td></tr>
<tr><td class="h">7699</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;If multiple NAT tags are used at one network,\n&quot;,</td></tr>
<tr><td class="h">7700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; these NAT tags must be used&quot;,</td></tr>
<tr><td class="h">7701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; equally grouped at other networks:\n&quot;,</td></tr>
<tr><td class="h">7702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $name1: $tags1\n&quot;,</td></tr>
<tr><td class="h">7703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $name2: $tags2&quot;;</td></tr>
<tr><td class="h">7704</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$err_shown = 1;</td></tr>
<tr><td class="h">7705</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7706</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>779</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">7707</td><td colspan="7"></td></tr><tr><td class="h">7708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAT_TAG:</td></tr>
<tr><td class="h">7709</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>507</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$href) {</td></tr>
<tr><td class="h">7710</td><td><div class="c3">268</div></td><td></td><td></td><td></td><td></td><td><div>329</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_definitions{$nat_tag} = 1;</td></tr>
<tr><td class="h">7711</td><td><div class="c3">268</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7711">100</a></div></td><td></td><td></td><td></td><td><div>502</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $aref = $nat_tags2multi{$nat_tag}) {</td></tr>
<tr><td class="h">7712</td><td colspan="7"></td></tr><tr><td class="h">7713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If elements have a common non hidden tag,</td></tr>
<tr><td class="h">7714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# then only a single href is allowed.</td></tr>
<tr><td class="h">7715</td><td><div class="c3">62</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7715">100</a></div></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($has_non_hidden{$nat_tag}) {</td></tr>
<tr><td class="h">7716</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href2 = $aref-&gt;[0];</td></tr>
<tr><td class="h">7717</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7717">100</a></div></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys_eq($href, $href2) or $show_err-&gt;($href, $href2);</td></tr>
<tr><td class="h">7718</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NAT_TAG;</td></tr>
<tr><td class="h">7719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7720</td><td colspan="7"></td></tr><tr><td class="h">7721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Array of hrefs has common hidden NAT tag.</td></tr>
<tr><td class="h">7722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">7723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore new href if it is identical to some previous one.</td></tr>
<tr><td class="h">7724</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $href2 (@$aref) {</td></tr>
<tr><td class="h">7725</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7725">100</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys_eq($href, $href2) and next NAT_TAG;</td></tr>
<tr><td class="h">7726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7727</td><td colspan="7"></td></tr><tr><td class="h">7728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Some element is non hidden, check detailed.</td></tr>
<tr><td class="h">7729</td><td><div class="c3">22</div><div class="c3">112</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7729">100</a></div></td><td></td><td></td><td></td><td><div>39</div><div>157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $has_non_hidden{$_} } %$href) {</td></tr>
<tr><td class="h">7730</td><td colspan="7"></td></tr><tr><td class="h">7731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check new href for consistency with previous hrefs.</td></tr>
<tr><td class="h">7732</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag2 (sort keys %$href) {</td></tr>
<tr><td class="h">7733</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7733">100</a></div></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_tag2 eq $nat_tag;</td></tr>
<tr><td class="h">7734</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $href2 (@$aref) {</td></tr>
<tr><td class="h">7735</td><td colspan="7"></td></tr><tr><td class="h">7736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t check previous href with all hidden tags.</td></tr>
<tr><td class="h">7737</td><td><div class="c3">50</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7737">100</a></div></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $all_hidden{$href2};</td></tr>
<tr><td class="h">7738</td><td colspan="7"></td></tr><tr><td class="h">7739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Non hidden tag must not occur in other href.</td></tr>
<tr><td class="h">7740</td><td><div class="c3">38</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7740">100</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($has_non_hidden{$nat_tag2}) {</td></tr>
<tr><td class="h">7741</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7741">100</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($href2-&gt;{$nat_tag2}) {</td></tr>
<tr><td class="h">7742</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$show_err-&gt;($href, $href2);</td></tr>
<tr><td class="h">7743</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NAT_TAG;</td></tr>
<tr><td class="h">7744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7746</td><td colspan="7"></td></tr><tr><td class="h">7747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Hidden tag must occur in all other hrefs.</td></tr>
<tr><td class="h">7748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7749</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7749">50</a></div></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$href2-&gt;{$nat_tag2}) {</td></tr>
<tr><td class="h">7750</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$show_err-&gt;($href, $href2);</td></tr>
<tr><td class="h">7751</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NAT_TAG;</td></tr>
<tr><td class="h">7752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7757</td><td colspan="7"></td></tr><tr><td class="h">7758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All elements are hidden. Always ok.</td></tr>
<tr><td class="h">7759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7760</td><td colspan="7"></td></tr><tr><td class="h">7761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark this type of href for easier checks.</td></tr>
<tr><td class="h">7762</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$all_hidden{$href} = 1;</td></tr>
<tr><td class="h">7763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7764</td><td colspan="7"></td></tr><tr><td class="h">7765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If current href and some previous href are in subset</td></tr>
<tr><td class="h">7766</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# relation, then take larger set.</td></tr>
<tr><td class="h">7767</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $href2 (@$aref) {</td></tr>
<tr><td class="h">7768</td><td><div class="c3">28</div><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>46</div><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $common_size = grep { $href2-&gt;{$_} } keys %$href;</td></tr>
<tr><td class="h">7769</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7769">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7769">50</a></div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($common_size eq keys %$href) {</td></tr>
<tr><td class="h">7770</td><td colspan="7"></td></tr><tr><td class="h">7771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore new href, because it is subset.</td></tr>
<tr><td class="h">7772</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NAT_TAG;</td></tr>
<tr><td class="h">7773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($common_size eq keys %$href2) {</td></tr>
<tr><td class="h">7775</td><td colspan="7"></td></tr><tr><td class="h">7776</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Replace previous href by new superset.</td></tr>
<tr><td class="h">7777</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$href2 = $href;</td></tr>
<tr><td class="h">7778</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NAT_TAG;</td></tr>
<tr><td class="h">7779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7781</td><td colspan="7"></td></tr><tr><td class="h">7782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add new href below.</td></tr>
<tr><td class="h">7783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7786</td><td><div class="c3">224</div><div class="c3">224</div></td><td></td><td></td><td></td><td></td><td><div>179</div><div>1172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $nat_tags2multi{$nat_tag} }, $href;</td></tr>
<tr><td class="h">7787</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7789</td><td colspan="7"></td></tr><tr><td class="h">7790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remove single entries.</td></tr>
<tr><td class="h">7791</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>1301</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %nat_tags2multi) {</td></tr>
<tr><td class="h">7792</td><td><div class="c3">206</div></td><td></td><td></td><td></td><td></td><td><div>214</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref = $nat_tags2multi{$nat_tag};</td></tr>
<tr><td class="h">7793</td><td><div class="c3">206</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7793">100</a></div></td><td></td><td></td><td></td><td><div>354</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if @$aref &gt; 1;</td></tr>
<tr><td class="h">7794</td><td><div class="c3">194</div></td><td></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $aref-&gt;[0];</td></tr>
<tr><td class="h">7795</td><td><div class="c3">194</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7795">100</a></div></td><td></td><td></td><td></td><td><div>322</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if keys %$href &gt; 1;</td></tr>
<tr><td class="h">7796</td><td><div class="c3">134</div></td><td></td><td></td><td></td><td></td><td><div>300</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $nat_tags2multi{$nat_tag};</td></tr>
<tr><td class="h">7797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7798</td><td colspan="7"></td></tr><tr><td class="h">7799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find NAT domains.</td></tr>
<tr><td class="h">7800</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>978</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">7801</td><td><div class="c3">3144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7801">100</a></div></td><td></td><td></td><td></td><td><div>4690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{is_aggregate};</td></tr>
<tr><td class="h">7802</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7802">100</a></div></td><td></td><td></td><td></td><td><div>4850</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{nat_domain};</td></tr>
<tr><td class="h">7803</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>4996</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $name = $network-&gt;{name}) =~ s/^\w+:/nat_domain:/;</td></tr>
<tr><td class="h">7804</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>2214</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $domain = new(</td></tr>
<tr><td class="h">7805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;nat_domain&#39;,</td></tr>
<tr><td class="h">7806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $name,</td></tr>
<tr><td class="h">7807</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;networks =&gt; [],</td></tr>
<tr><td class="h">7808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routers&nbsp;&nbsp;=&gt; [],</td></tr>
<tr><td class="h">7809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nat_set&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">7810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7811</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1030</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @natdomains, $domain;</td></tr>
<tr><td class="h">7812</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1305</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_natdomain($network, $domain, 0);</td></tr>
<tr><td class="h">7813</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7814</td><td colspan="7"></td></tr><tr><td class="h">7815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Distribute NAT tags to NAT domains.</td></tr>
<tr><td class="h">7816</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>879</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $domain (@natdomains) {</td></tr>
<tr><td class="h">7817</td><td><div class="c3">963</div><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>733</div><div>1646</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@{ $domain-&gt;{routers} }) {</td></tr>
<tr><td class="h">7818</td><td><div class="c3">428</div></td><td></td><td></td><td></td><td></td><td><div>615</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_tags = $router-&gt;{nat_tags}-&gt;{$domain};</td></tr>
<tr><td class="h">7819</td><td colspan="7"></td></tr><tr><td class="h">7820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$domain-&gt;{name} $router-&gt;{name}: &quot;, join(&#39;,&#39;, @$nat_tags);</td></tr>
<tr><td class="h">7821</td><td colspan="7"></td></tr><tr><td class="h">7822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Multiple tags are bound to interface.</td></tr>
<tr><td class="h">7823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If some network has multiple matching NAT tags,</td></tr>
<tr><td class="h">7824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the resulting NAT mapping would be ambiguous.</td></tr>
<tr><td class="h">7825</td><td><div class="c3">428</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7825">100</a></div></td><td></td><td></td><td></td><td><div>647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$nat_tags &gt;= 2) {</td></tr>
<tr><td class="h">7826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAT_TAG:</td></tr>
<tr><td class="h">7827</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (@$nat_tags) {</td></tr>
<tr><td class="h">7828</td><td><div class="c3">10</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7828">50</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref = $nat_tags2multi{$nat_tag} or next;</td></tr>
<tr><td class="h">7829</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $href (@$aref) {</td></tr>
<tr><td class="h">7830</td><td><div class="c3">10</div><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7830">100</a></div></td><td></td><td></td><td></td><td><div>13</div><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @tags = grep { $href-&gt;{$_} &amp;&amp; $_ } @$nat_tags;</td></tr>
<tr><td class="h">7831</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7831">100</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@tags &gt;= 2 or next;</td></tr>
<tr><td class="h">7832</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tags = join(&#39;,&#39;, @tags);</td></tr>
<tr><td class="h">7833</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_net = $href-&gt;{ $tags[0] };</td></tr>
<tr><td class="h">7834</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not bind multiple NAT tags&quot;,</td></tr>
<tr><td class="h">7836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;$tags&#39; of $nat_net-&gt;{name}&quot;,</td></tr>
<tr><td class="h">7837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">7838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7839</td><td colspan="7"></td></tr><tr><td class="h">7840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Show only first error. Otherwise we</td></tr>
<tr><td class="h">7841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# would show the same error multiple</td></tr>
<tr><td class="h">7842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# times.</td></tr>
<tr><td class="h">7843</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last NAT_TAG;</td></tr>
<tr><td class="h">7844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7847</td><td><div class="c3">428</div></td><td></td><td></td><td></td><td></td><td><div>690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (@$nat_tags) {</td></tr>
<tr><td class="h">7848</td><td><div class="c3">228</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7848">100</a></div></td><td></td><td></td><td></td><td><div>379</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_definitions{$nat_tag}) {</td></tr>
<tr><td class="h">7849</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>371</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribute_nat($domain, $nat_tag, \%nat_tags2multi,</td></tr>
<tr><td class="h">7850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router);</td></tr>
<tr><td class="h">7851</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_definitions{$nat_tag} = &#39;used&#39;;</td></tr>
<tr><td class="h">7852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7854</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">7855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ignoring useless nat:$nat_tag&quot;,</td></tr>
<tr><td class="h">7856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; bound at $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">7857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7858</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7862</td><td colspan="7"></td></tr><tr><td class="h">7863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check compatibility of host/interface and network NAT.</td></tr>
<tr><td class="h">7864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A NAT definition for a single host/interface is only allowed,</td></tr>
<tr><td class="h">7865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# if the network has a dynamic NAT definition.</td></tr>
<tr><td class="h">7866</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>845</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">7867</td><td><div class="c3">3144</div><div class="c3">3144</div><div class="c3">3144</div></td><td></td><td></td><td></td><td></td><td><div>2243</div><div>3164</div><div>3546</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@{ $network-&gt;{hosts} }, @{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7868</td><td><div class="c3">5191</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7868">100</a></div></td><td></td><td></td><td></td><td><div>9800</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{nat}) {</td></tr>
<tr><td class="h">7869</td><td><div class="c3">11</div><div class="c3">11</div></td><td></td><td></td><td></td><td></td><td><div>11</div><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %{ $obj-&gt;{nat} }) {</td></tr>
<tr><td class="h">7870</td><td><div class="c3">11</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network;</td></tr>
<tr><td class="h">7871</td><td><div class="c3">11</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7871">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7871">33</a></div></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$nat_network = $network-&gt;{nat}-&gt;{$nat_tag}</td></tr>
<tr><td class="h">7872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $nat_network-&gt;{dynamic})</td></tr>
<tr><td class="h">7873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">7874</td><td><div class="c3">11</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj_ip = $obj-&gt;{nat}-&gt;{$nat_tag};</td></tr>
<tr><td class="h">7875</td><td><div class="c3">11</div><div class="c3">11</div></td><td></td><td></td><td></td><td></td><td><div>17</div><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_network}{ &#39;ip&#39;, &#39;mask&#39; };</td></tr>
<tr><td class="h">7876</td><td><div class="c3">11</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7876">50</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not(match_ip($obj_ip, $ip, $mask))) {</td></tr>
<tr><td class="h">7877</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;nat:$nat_tag: $obj-&gt;{name}&#39;s IP &quot;,</td></tr>
<tr><td class="h">7878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;doesn&#39;t match $network-&gt;{name}&#39;s IP/mask&quot;;</td></tr>
<tr><td class="h">7879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">7882</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;nat:$nat_tag not allowed for &quot;,</td></tr>
<tr><td class="h">7883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$obj-&gt;{name} because $network-&gt;{name} &quot;,</td></tr>
<tr><td class="h">7884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;doesn&#39;t have dynamic NAT definition&quot;;</td></tr>
<tr><td class="h">7885</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7890</td><td colspan="7"></td></tr><tr><td class="h">7891</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>1301</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $name (keys %nat_definitions) {</td></tr>
<tr><td class="h">7892</td><td><div class="c3">206</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7892">100</a></div></td><td></td><td></td><td></td><td><div>496</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_definitions{$name} eq &#39;used&#39;</td></tr>
<tr><td class="h">7893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;nat:$name is defined, but not bound to any interface&quot;);</td></tr>
<tr><td class="h">7894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7895</td><td colspan="7"></td></tr><tr><td class="h">7896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find interfaces with dynamic NAT which is applied at the same device.</td></tr>
<tr><td class="h">7897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This is incomatible with device with &quot;need_protect&quot;.</td></tr>
<tr><td class="h">7898</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>865</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">7899</td><td><div class="c3">3144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7899">100</a></div></td><td></td><td></td><td></td><td><div>5216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">7900</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$nat) {</td></tr>
<tr><td class="h">7901</td><td><div class="c3">268</div></td><td></td><td></td><td></td><td></td><td><div>278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_info = $nat-&gt;{$nat_tag};</td></tr>
<tr><td class="h">7902</td><td><div class="c3">268</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7902">100</a></div></td><td></td><td></td><td></td><td><div>530</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_info-&gt;{dynamic} or next;</td></tr>
<tr><td class="h">7903</td><td><div class="c3">155</div><div class="c3">155</div></td><td></td><td></td><td></td><td></td><td><div>118</div><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7904</td><td><div class="c3">188</div></td><td></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf_nat = $interface-&gt;{nat};</td></tr>
<tr><td class="h">7905</td><td colspan="7"></td></tr><tr><td class="h">7906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Interface has static translation,</td></tr>
<tr><td class="h">7907</td><td><div class="c3">188</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7907">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7907">67</a></div></td><td></td><td></td><td><div>363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf_nat &amp;&amp; $intf_nat-&gt;{$nat_tag};</td></tr>
<tr><td class="h">7908</td><td colspan="7"></td></tr><tr><td class="h">7909</td><td><div class="c3">179</div></td><td></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">7910</td><td><div class="c3">179</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7910">50</a></div></td><td></td><td></td><td></td><td><div>512</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$router-&gt;{need_protect};</td></tr>
<tr><td class="h">7911</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $bind_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7912</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7912">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $bind = $bind_intf-&gt;{bind_nat} or next;</td></tr>
<tr><td class="h">7913</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7913">0</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_ eq $nat_tag } @$bind or next;</td></tr>
<tr><td class="h">7914</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">7915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not apply dynamic NAT to $interface-&gt;{name}&quot;,</td></tr>
<tr><td class="h">7916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $bind_intf-&gt;{name} of same device.\n&quot;,</td></tr>
<tr><td class="h">7917</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; This isn&#39;t supported for model&quot;,</td></tr>
<tr><td class="h">7918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $router-&gt;{model}-&gt;{name}.&quot;</td></tr>
<tr><td class="h">7919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">7920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7924</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>1091</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;invert_nat_set();</td></tr>
<tr><td class="h">7925</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>1198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">7926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">7927</td><td colspan="7"></td></tr><tr><td class="h">7928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub invert_nat_set {</td></tr>
<tr><td class="h">7929</td><td colspan="7"></td></tr><tr><td class="h">7930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find NAT partitions.</td></tr>
<tr><td class="h">7931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# NAT partitions arise, if parts of the topology are strictly</td></tr>
<tr><td class="h">7932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# separated by crypto interfaces.</td></tr>
<tr><td class="h">7933</td><td><div class="c3">726</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7933">726</a></div></td><td><div class="c0">0</div></td><td><div>639</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %partitions;</td></tr>
<tr><td class="h">7934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mark_nat_partition;</td></tr>
<tr><td class="h">7935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$mark_nat_partition = sub {</td></tr>
<tr><td class="h">7936</td><td><div class="c3">1455</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L7936">1455</a></div></td><td></td><td><div>1336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($domain, $mark) = @_;</td></tr>
<tr><td class="h">7937</td><td><div class="c3">1455</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7937">100</a></div></td><td></td><td></td><td></td><td><div>3042</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $partitions{$domain};</td></tr>
<tr><td class="h">7938</td><td colspan="7"></td></tr><tr><td class="h">7939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$mark $domain-&gt;{name}&quot;;</td></tr>
<tr><td class="h">7940</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1457</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$partitions{$domain} = $mark;</td></tr>
<tr><td class="h">7941</td><td><div class="c3">963</div><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>793</div><div>1966</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@{ $domain-&gt;{routers} }) {</td></tr>
<tr><td class="h">7942</td><td><div class="c3">428</div><div class="c3">428</div></td><td></td><td></td><td></td><td></td><td><div>322</div><div>517</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_domain (@{ $router-&gt;{nat_domains} }) {</td></tr>
<tr><td class="h">7943</td><td><div class="c3">920</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7943">100</a></div></td><td></td><td></td><td></td><td><div>2172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_domain eq $domain;</td></tr>
<tr><td class="h">7944</td><td><div class="c3">492</div></td><td></td><td></td><td></td><td></td><td><div>897</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark_nat_partition-&gt;($out_domain, $mark);</td></tr>
<tr><td class="h">7945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7947</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>2127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">7948</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>736</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mark = 0;</td></tr>
<tr><td class="h">7949</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>792</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $domain (@natdomains) {</td></tr>
<tr><td class="h">7950</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>781</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark++;</td></tr>
<tr><td class="h">7951</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1265</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark_nat_partition-&gt;($domain, $mark);</td></tr>
<tr><td class="h">7952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7953</td><td colspan="7"></td></tr><tr><td class="h">7954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect NAT tags used in each partition.</td></tr>
<tr><td class="h">7955</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>662</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %partition2tags;</td></tr>
<tr><td class="h">7956</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>767</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $domain (@natdomains) {</td></tr>
<tr><td class="h">7957</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1227</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mark = $partitions{$domain};</td></tr>
<tr><td class="h">7958</td><td><div class="c3">963</div><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>785</div><div>1229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $domain-&gt;{networks} }) {</td></tr>
<tr><td class="h">7959</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7959">100</a></div></td><td></td><td></td><td></td><td><div>5613</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">7960</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$href) {</td></tr>
<tr><td class="h">7961</td><td><div class="c3">268</div></td><td></td><td></td><td></td><td></td><td><div>729</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$partition2tags{$mark}-&gt;{$nat_tag} = 1;</td></tr>
<tr><td class="h">7962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7965</td><td colspan="7"></td></tr><tr><td class="h">7966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Invert {nat_set} to {no_nat_set}</td></tr>
<tr><td class="h">7967</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>828</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $domain (@natdomains) {</td></tr>
<tr><td class="h">7968</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= delete $domain-&gt;{nat_set};</td></tr>
<tr><td class="h">7969</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $partitions{$domain};</td></tr>
<tr><td class="h">7970</td><td><div class="c3">963</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7970">100</a></div></td><td></td><td></td><td><div>2648</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $all_nat_set = $partition2tags{$mark} ||= {};</td></tr>
<tr><td class="h">7971</td><td colspan="7"></td></tr><tr><td class="h">7972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$mark $domain-&gt;{name} all: &quot;, join(&#39;,&#39;, keys %$all_nat_set);</td></tr>
<tr><td class="h">7973</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1656</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = {%$all_nat_set};</td></tr>
<tr><td class="h">7974</td><td><div class="c3">963</div><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>1189</div><div>1041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete @{$no_nat_set}{ keys %$nat_set };</td></tr>
<tr><td class="h">7975</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>2427</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domain-&gt;{no_nat_set} = $no_nat_set;</td></tr>
<tr><td class="h">7976</td><td colspan="7"></td></tr><tr><td class="h">7977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$mark $domain-&gt;{name} no: &quot;, join(&#39;,&#39;, keys %$no_nat_set);</td></tr>
<tr><td class="h">7978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7979</td><td colspan="7"></td></tr><tr><td class="h">7980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Distribute {no_nat_set} to interfaces.</td></tr>
<tr><td class="h">7981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# no_nat_set is needed at logical and hardware interfaces of</td></tr>
<tr><td class="h">7982</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# managed routers. Set it also for semi_managed routers to</td></tr>
<tr><td class="h">7983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# calculate {up} relation between subnets.</td></tr>
<tr><td class="h">7984</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>916</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $domain (@natdomains) {</td></tr>
<tr><td class="h">7985</td><td><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $domain-&gt;{no_nat_set};</td></tr>
<tr><td class="h">7986</td><td><div class="c3">963</div><div class="c3">963</div></td><td></td><td></td><td></td><td></td><td><div>772</div><div>1140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $domain-&gt;{networks} }) {</td></tr>
<tr><td class="h">7987</td><td><div class="c3">3036</div><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>2225</div><div>3427</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">7988</td><td><div class="c3">4760</div></td><td></td><td></td><td></td><td></td><td><div>4014</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">7989</td><td><div class="c3">4760</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7989">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7989">100</a></div></td><td></td><td></td><td><div>10623</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($router-&gt;{managed} || $router-&gt;{semi_managed}) or next;</td></tr>
<tr><td class="h">7990</td><td colspan="7"></td></tr><tr><td class="h">7991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$domain-&gt;{name}: NAT $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">7992</td><td><div class="c3">3372</div></td><td></td><td></td><td></td><td></td><td><div>3955</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{no_nat_set} = $no_nat_set;</td></tr>
<tr><td class="h">7993</td><td><div class="c3">3372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L7993">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L7993">100</a></div></td><td></td><td></td><td><div>9316</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hardware}-&gt;{no_nat_set} = $no_nat_set</td></tr>
<tr><td class="h">7994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $router-&gt;{managed} || $router-&gt;{routing_only};</td></tr>
<tr><td class="h">7995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">7998</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>1443</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ();</td></tr>
<tr><td class="h">7999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8000</td><td colspan="7"></td></tr><tr><td class="h">8001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Real interface of crypto tunnel has got {no_nat_set} of that NAT domain,</td></tr>
<tr><td class="h">8002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># where encrypted traffic passes. But real interface gets ACL that filter</td></tr>
<tr><td class="h">8003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># both encrypted and unencrypted traffic. Hence no_nat_set must be extended by</td></tr>
<tr><td class="h">8004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># no_nat_set of some corresponding tunnel interface.</td></tr>
<tr><td class="h">8005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub adjust_crypto_nat {</td></tr>
<tr><td class="h">8006</td><td><div class="c3">660</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8006">660</a></div></td><td><div class="c0">0</div></td><td><div>525</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">8007</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>1090</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (values %crypto) {</td></tr>
<tr><td class="h">8008</td><td><div class="c3">39</div><div class="c3">39</div></td><td></td><td></td><td></td><td></td><td><div>34</div><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tunnel (@{ $crypto-&gt;{tunnels} }) {</td></tr>
<tr><td class="h">8009</td><td><div class="c3">39</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8009">50</a></div></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $tunnel-&gt;{disabled};</td></tr>
<tr><td class="h">8010</td><td><div class="c3">39</div><div class="c3">39</div></td><td></td><td></td><td></td><td></td><td><div>33</div><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tunnel_intf (@{ $tunnel-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8011</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_intf = $tunnel_intf-&gt;{real_interface};</td></tr>
<tr><td class="h">8012</td><td><div class="c3">78</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8012">100</a></div></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$real_intf}++;</td></tr>
<tr><td class="h">8013</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8013">100</a></div></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_intf-&gt;{router}-&gt;{managed} or next;</td></tr>
<tr><td class="h">8014</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tunnel_set = $tunnel_intf-&gt;{no_nat_set};</td></tr>
<tr><td class="h">8015</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8015">100</a></div></td><td></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys %$tunnel_set or next;</td></tr>
<tr><td class="h">8016</td><td colspan="7"></td></tr><tr><td class="h">8017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Copy hash, because it is shared with other interfaces.</td></tr>
<tr><td class="h">8018</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_set = $real_intf-&gt;{no_nat_set};</td></tr>
<tr><td class="h">8019</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_set = $real_intf-&gt;{no_nat_set} = {%$real_set};</td></tr>
<tr><td class="h">8020</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hardware = $real_intf-&gt;{hardware};</td></tr>
<tr><td class="h">8021</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8021">50</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{no_nat_set} = $real_set if ref $hardware;</td></tr>
<tr><td class="h">8022</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$tunnel_set) {</td></tr>
<tr><td class="h">8023</td><td colspan="7"></td></tr><tr><td class="h">8024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Adjust NAT of $real_intf-&gt;{name}: $nat_tag&quot;;</td></tr>
<tr><td class="h">8025</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_set-&gt;{$nat_tag} = 1;</td></tr>
<tr><td class="h">8026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8030</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>716</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8032</td><td colspan="7"></td></tr><tr><td class="h">8033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_nat_network {</td></tr>
<tr><td class="h">8034</td><td><div class="c3">10030</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8034">10030</a></div></td><td><div class="c0">0</div></td><td><div>8763</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($network, $no_nat_set) = @_;</td></tr>
<tr><td class="h">8035</td><td><div class="c3">10030</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8035">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8035">67</a></div></td><td></td><td></td><td><div>18084</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $href = $network-&gt;{nat} and $no_nat_set) {</td></tr>
<tr><td class="h">8036</td><td><div class="c3">722</div></td><td></td><td></td><td></td><td></td><td><div>1164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tag (keys %$href) {</td></tr>
<tr><td class="h">8037</td><td><div class="c3">781</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8037">100</a></div></td><td></td><td></td><td></td><td><div>1477</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $no_nat_set-&gt;{$tag};</td></tr>
<tr><td class="h">8038</td><td><div class="c3">366</div></td><td></td><td></td><td></td><td></td><td><div>640</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $href-&gt;{$tag};</td></tr>
<tr><td class="h">8039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8041</td><td><div class="c3">9664</div></td><td></td><td></td><td></td><td></td><td><div>11162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $network;</td></tr>
<tr><td class="h">8042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8043</td><td colspan="7"></td></tr><tr><td class="h">8044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">8045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find sub-networks</td></tr>
<tr><td class="h">8046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark each network with the smallest network enclosing it.</td></tr>
<tr><td class="h">8047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">8048</td><td colspan="7"></td></tr><tr><td class="h">8049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># All interfaces and hosts of a network must be located in that part</td></tr>
<tr><td class="h">8050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># of the network which doesn&#39;t overlap with some subnet.</td></tr>
<tr><td class="h">8051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_subnets {</td></tr>
<tr><td class="h">8052</td><td><div class="c3">990</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8052">990</a></div></td><td><div class="c0">0</div></td><td><div>903</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($network, $subnet) = @_;</td></tr>
<tr><td class="h">8053</td><td><div class="c3">990</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8053">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8053">100</a></div></td><td></td><td></td><td><div>2498</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $network-&gt;{is_aggregate} || $subnet-&gt;{is_aggregate};</td></tr>
<tr><td class="h">8054</td><td><div class="c3">344</div><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>283</div><div>510</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($sub_ip, $sub_mask) = @{$subnet}{qw(ip mask)};</td></tr>
<tr><td class="h">8055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $check = sub {</td></tr>
<tr><td class="h">8056</td><td><div class="c3">300</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8056">300</a></div></td><td></td><td><div>296</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip1, $ip2, $object) = @_;</td></tr>
<tr><td class="h">8057</td><td><div class="c3">300</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8057">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8057">20</a></div></td><td></td><td></td><td><div>474</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">8058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_ip($ip1, $sub_ip, $sub_mask)</td></tr>
<tr><td class="h">8059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $ip2 &amp;&amp; (match_ip($ip2, $sub_ip, $sub_mask)</td></tr>
<tr><td class="h">8060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| ($ip1 &lt;= $sub_ip &amp;&amp; $sub_ip &lt;= $ip2))</td></tr>
<tr><td class="h">8061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">8062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8063</td><td colspan="7"></td></tr><tr><td class="h">8064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# NAT to an interface address (masquerading) is allowed.</td></tr>
<tr><td class="h">8065</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8065">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8065">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;(my $nat_tags = $object-&gt;{bind_nat})</td></tr>
<tr><td class="h">8066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and (my ($nat_tag2) = ($subnet-&gt;{name} =~ /^nat:(.*)\(/)))</td></tr>
<tr><td class="h">8067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8068</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8068">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8068">0</a></div></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;grep { $_ eq $nat_tag2 } @$nat_tags</td></tr>
<tr><td class="h">8069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $object-&gt;{ip} == $subnet-&gt;{ip}</td></tr>
<tr><td class="h">8070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $subnet-&gt;{mask} == 0xffffffff)</td></tr>
<tr><td class="h">8071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8072</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8075</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;$object-&gt;{name}&#39;s IP overlaps with subnet&quot;,</td></tr>
<tr><td class="h">8076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $subnet-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8078</td><td><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>1148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8079</td><td><div class="c3">344</div><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>304</div><div>487</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8080</td><td><div class="c3">658</div></td><td></td><td></td><td></td><td></td><td><div>630</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $interface-&gt;{ip};</td></tr>
<tr><td class="h">8081</td><td><div class="c3">658</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8081">100</a></div></td><td></td><td></td><td></td><td><div>1702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $ip =~ /^(?:unnumbered|negotiated|tunnel|short|bridged)$/;</td></tr>
<tr><td class="h">8082</td><td><div class="c3">288</div></td><td></td><td></td><td></td><td></td><td><div>376</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check-&gt;($ip, undef, $interface);</td></tr>
<tr><td class="h">8083</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8084</td><td><div class="c3">344</div><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>352</div><div>498</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">8085</td><td><div class="c3">12</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8085">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8085">0</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = $host-&gt;{ip}) {</td></tr>
<tr><td class="h">8086</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check-&gt;($ip, undef, $host);</td></tr>
<tr><td class="h">8087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $range = $host-&gt;{range}) {</td></tr>
<tr><td class="h">8089</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check-&gt;($range-&gt;[0], $range-&gt;[1], $host);</td></tr>
<tr><td class="h">8090</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8092</td><td><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>1595</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8094</td><td colspan="7"></td></tr><tr><td class="h">8095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Dynamic NAT to loopback interface is OK,</td></tr>
<tr><td class="h">8096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># if NAT is applied at device of loopback interface.</td></tr>
<tr><td class="h">8097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub nat_to_loopback_ok {</td></tr>
<tr><td class="h">8098</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8098">6</a></div></td><td><div class="c0">0</div></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($loopback_network, $nat_network) = @_;</td></tr>
<tr><td class="h">8099</td><td colspan="7"></td></tr><tr><td class="h">8100</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nat_tag1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $nat_network-&gt;{dynamic};</td></tr>
<tr><td class="h">8101</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $device_count&nbsp;&nbsp;= 0;</td></tr>
<tr><td class="h">8102</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $all_device_ok = 0;</td></tr>
<tr><td class="h">8103</td><td colspan="7"></td></tr><tr><td class="h">8104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# In case of virtual loopback, the loopback network</td></tr>
<tr><td class="h">8105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# is attached to two or more routers.</td></tr>
<tr><td class="h">8106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Loop over these devices.</td></tr>
<tr><td class="h">8107</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $loop_intf (@{ $loopback_network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8108</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$device_count++;</td></tr>
<tr><td class="h">8109</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $this_device_ok = 0;</td></tr>
<tr><td class="h">8110</td><td colspan="7"></td></tr><tr><td class="h">8111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check all interfaces of attached device.</td></tr>
<tr><td class="h">8112</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>8</div><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $all_intf (@{ $loop_intf-&gt;{router}-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8113</td><td><div class="c3">10</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8113">50</a></div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $nat_tags = $all_intf-&gt;{bind_nat}) {</td></tr>
<tr><td class="h">8114</td><td><div class="c3">10</div><div class="c3">10</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8114">50</a></div></td><td></td><td></td><td></td><td><div>13</div><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_ eq $nat_tag1 } @$nat_tags) {</td></tr>
<tr><td class="h">8115</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this_device_ok = 1;</td></tr>
<tr><td class="h">8116</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">8117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8120</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$all_device_ok += $this_device_ok;</td></tr>
<tr><td class="h">8121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8122</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ($all_device_ok == $device_count);</td></tr>
<tr><td class="h">8123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8124</td><td colspan="7"></td></tr><tr><td class="h">8125</td><td><div class="c3">10314</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8125">10314</a></div></td><td><div class="c0">0</div></td><td><div>12648</div></td><td class="s">sub by_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ return $a-&gt;{name} cmp $b-&gt;{name} }</td></tr>
<tr><td class="h">8126</td><td colspan="7"></td></tr><tr><td class="h">8127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_reroute_permit;</td></tr>
<tr><td class="h">8128</td><td colspan="7"></td></tr><tr><td class="h">8129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find subnet relation between networks inside a zone.</td></tr>
<tr><td class="h">8130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - $subnet-&gt;{up} = $bignet;</td></tr>
<tr><td class="h">8131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_subnets_in_zone {</td></tr>
<tr><td class="h">8132</td><td><div class="c3">726</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8132">726</a></div></td><td><div class="c0">0</div></td><td><div>1464</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Finding subnets in zone&#39;);</td></tr>
<tr><td class="h">8133</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>800</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">8134</td><td colspan="7"></td></tr><tr><td class="h">8135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check NAT inside zone.</td></tr>
<tr><td class="h">8136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find networks of zone which use a NATed address inside the zone.</td></tr>
<tr><td class="h">8137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - Use this NATed address in subnet checks.</td></tr>
<tr><td class="h">8138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - If a subnet relation exists, then this NAT must be unique inside</td></tr>
<tr><td class="h">8139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;the zone.</td></tr>
<tr><td class="h">8140</td><td colspan="7"></td></tr><tr><td class="h">8141</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2344</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $first_intf = $zone-&gt;{interfaces}-&gt;[0];</td></tr>
<tr><td class="h">8142</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>1730</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">8143</td><td colspan="7"></td></tr><tr><td class="h">8144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect NAT tags, that are defined and applied inside the zone.</td></tr>
<tr><td class="h">8145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %net2zone_nat_tags;</td></tr>
<tr><td class="h">8146</td><td colspan="7"></td></tr><tr><td class="h">8147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle different no_nat_sets visible at border of zone.</td></tr>
<tr><td class="h">8148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For a zone without NAT, this loop is executed only once.</td></tr>
<tr><td class="h">8149</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>1700</div><div>2545</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8150</td><td><div class="c3">3372</div></td><td></td><td></td><td></td><td></td><td><div>3016</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">8151</td><td colspan="7"></td></tr><tr><td class="h">8152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug $interface-&gt;{name};</td></tr>
<tr><td class="h">8153</td><td><div class="c3">3372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8153">100</a></div></td><td></td><td></td><td></td><td><div>7829</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$no_nat_set}++;</td></tr>
<tr><td class="h">8154</td><td colspan="7"></td></tr><tr><td class="h">8155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add networks of zone to %mask_ip_hash.</td></tr>
<tr><td class="h">8156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use NAT IP/mask.</td></tr>
<tr><td class="h">8157</td><td><div class="c3">2121</div></td><td></td><td></td><td></td><td></td><td><div>1610</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %mask_ip_hash;</td></tr>
<tr><td class="h">8158</td><td colspan="7"></td></tr><tr><td class="h">8159</td><td><div class="c3">2121</div><div class="c3">2121</div><div class="c3">2121</div></td><td></td><td></td><td></td><td></td><td><div>1593</div><div>2193</div><div>2703</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} },</td></tr>
<tr><td class="h">8160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %{ $zone-&gt;{ipmask2aggregate} })</td></tr>
<tr><td class="h">8161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8162</td><td><div class="c3">3034</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8162">50</a></div></td><td></td><td></td><td></td><td><div>6776</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{ip} =~ /^(?:unnumbered|tunnel)$/;</td></tr>
<tr><td class="h">8163</td><td colspan="7"></td></tr><tr><td class="h">8164</td><td><div class="c3">3034</div></td><td></td><td></td><td></td><td></td><td><div>2441</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $network;</td></tr>
<tr><td class="h">8165</td><td><div class="c3">3034</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8165">100</a></div></td><td></td><td></td><td></td><td><div>4509</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $href = $network-&gt;{nat}) {</td></tr>
<tr><td class="h">8166</td><td><div class="c3">243</div></td><td></td><td></td><td></td><td></td><td><div>373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tag (keys %$href) {</td></tr>
<tr><td class="h">8167</td><td><div class="c3">271</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8167">100</a></div></td><td></td><td></td><td></td><td><div>629</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $no_nat_set-&gt;{$tag};</td></tr>
<tr><td class="h">8168</td><td><div class="c3">37</div><div class="c3">37</div></td><td></td><td></td><td></td><td></td><td><div>36</div><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $net2zone_nat_tags{$network} }, $tag;</td></tr>
<tr><td class="h">8169</td><td><div class="c3">37</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_network = $href-&gt;{$tag};</td></tr>
<tr><td class="h">8170</td><td><div class="c3">37</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">8171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8173</td><td colspan="7"></td></tr><tr><td class="h">8174</td><td><div class="c3">3034</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8174">100</a></div></td><td></td><td></td><td></td><td><div>4306</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_network-&gt;{hidden}) {</td></tr>
<tr><td class="h">8175</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8175">100</a></div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other = $network-&gt;{up} or next;</td></tr>
<tr><td class="h">8176</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8176">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if get_nat_network($other, $no_nat_set)-&gt;{hidden};</td></tr>
<tr><td class="h">8177</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ambiguous subnet relation from NAT.\n&quot;,</td></tr>
<tr><td class="h">8179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $network-&gt;{name} is subnet of\n&quot;,</td></tr>
<tr><td class="h">8180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $other-&gt;{name} at&quot;,</td></tr>
<tr><td class="h">8181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $first_intf-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">8182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - but it is hidden $nat_network-&gt;{name} at&quot;,</td></tr>
<tr><td class="h">8183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">8184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8185</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">8186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8187</td><td><div class="c3">3020</div><div class="c3">3020</div></td><td></td><td></td><td></td><td></td><td><div>2363</div><div>4307</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_network}{ &#39;ip&#39;, &#39;mask&#39; };</td></tr>
<tr><td class="h">8188</td><td colspan="7"></td></tr><tr><td class="h">8189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found two different networks with identical IP/mask.</td></tr>
<tr><td class="h">8190</td><td><div class="c3">3020</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8190">100</a></div></td><td></td><td></td><td></td><td><div>5993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other_net = $mask_ip_hash{$mask}-&gt;{$ip}) {</td></tr>
<tr><td class="h">8191</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name1 = $network-&gt;{name};</td></tr>
<tr><td class="h">8192</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name2 = $other_net-&gt;{name};</td></tr>
<tr><td class="h">8193</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$name1 and $name2 have identical IP/mask&quot;,</td></tr>
<tr><td class="h">8194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8197</td><td colspan="7"></td></tr><tr><td class="h">8198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store original network under NAT IP/mask.</td></tr>
<tr><td class="h">8199</td><td><div class="c3">3018</div></td><td></td><td></td><td></td><td></td><td><div>6754</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mask_ip_hash{$mask}-&gt;{$ip} = $network;</td></tr>
<tr><td class="h">8200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8202</td><td colspan="7"></td></tr><tr><td class="h">8203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Compare networks of zone.</td></tr>
<tr><td class="h">8204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Go from smaller to larger networks.</td></tr>
<tr><td class="h">8205</td><td><div class="c3">2121</div></td><td></td><td></td><td></td><td></td><td><div>5712</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @mask_list = reverse sort numerically keys %mask_ip_hash;</td></tr>
<tr><td class="h">8206</td><td><div class="c3">2121</div></td><td></td><td></td><td></td><td></td><td><div>4094</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my $mask = shift @mask_list) {</td></tr>
<tr><td class="h">8207</td><td colspan="7"></td></tr><tr><td class="h">8208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No supernets available</td></tr>
<tr><td class="h">8209</td><td><div class="c3">2286</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8209">100</a></div></td><td></td><td></td><td></td><td><div>7557</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if not @mask_list;</td></tr>
<tr><td class="h">8210</td><td colspan="7"></td></tr><tr><td class="h">8211</td><td><div class="c3">280</div></td><td></td><td></td><td></td><td></td><td><div>300</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip_hash = $mask_ip_hash{$mask};</td></tr>
<tr><td class="h">8212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUBNET:</td></tr>
<tr><td class="h">8213</td><td><div class="c3">280</div></td><td></td><td></td><td></td><td></td><td><div>716</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ip (sort numerically keys %$ip_hash) {</td></tr>
<tr><td class="h">8214</td><td colspan="7"></td></tr><tr><td class="h">8215</td><td><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>362</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnet = $ip_hash-&gt;{$ip};</td></tr>
<tr><td class="h">8216</td><td colspan="7"></td></tr><tr><td class="h">8217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find networks which include current subnet.</td></tr>
<tr><td class="h">8218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# @mask_list holds masks of potential supernets.</td></tr>
<tr><td class="h">8219</td><td><div class="c3">344</div></td><td></td><td></td><td></td><td></td><td><div>366</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $m (@mask_list) {</td></tr>
<tr><td class="h">8220</td><td colspan="7"></td></tr><tr><td class="h">8221</td><td><div class="c3">398</div></td><td></td><td></td><td></td><td></td><td><div>450</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $i = $ip &amp; $m;</td></tr>
<tr><td class="h">8222</td><td><div class="c3">398</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8222">100</a></div></td><td></td><td></td><td></td><td><div>908</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $bignet = $mask_ip_hash{$m}-&gt;{$i} or next;</td></tr>
<tr><td class="h">8223</td><td colspan="7"></td></tr><tr><td class="h">8224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect subnet relation for first no_nat_set.</td></tr>
<tr><td class="h">8225</td><td><div class="c3">242</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8225">100</a></div></td><td></td><td></td><td></td><td><div>486</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface eq $first_intf) {</td></tr>
<tr><td class="h">8226</td><td><div class="c3">224</div></td><td></td><td></td><td></td><td></td><td><div>272</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{up} = $bignet;</td></tr>
<tr><td class="h">8227</td><td colspan="7"></td></tr><tr><td class="h">8228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$subnet-&gt;{name} -up-&gt; $bignet-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8229</td><td colspan="7"></td></tr><tr><td class="h">8230</td><td><div class="c3">224</div></td><td></td><td></td><td></td><td></td><td><div>498</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">8231</td><td><div class="c3">32</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8231">50</a></div></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $bignet-&gt;{networks} },</td></tr>
<tr><td class="h">8232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{is_aggregate}</td></tr>
<tr><td class="h">8233</td><td><div class="c3">224</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8233">100</a></div></td><td></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? @{ $subnet-&gt;{networks} || [] }</td></tr>
<tr><td class="h">8234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ($subnet)</td></tr>
<tr><td class="h">8235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8236</td><td colspan="7"></td></tr><tr><td class="h">8237</td><td><div class="c3">224</div></td><td></td><td></td><td></td><td></td><td><div>346</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_subnets($bignet, $subnet);</td></tr>
<tr><td class="h">8238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8239</td><td colspan="7"></td></tr><tr><td class="h">8240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for ambiguous subnet relation with</td></tr>
<tr><td class="h">8241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# other no_nat_sets.</td></tr>
<tr><td class="h">8242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8243</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8243">100</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $subnet-&gt;{up}) {</td></tr>
<tr><td class="h">8244</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8244">100</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($other ne $bignet) {</td></tr>
<tr><td class="h">8245</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ambiguous subnet relation from NAT.\n&quot;,</td></tr>
<tr><td class="h">8247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $subnet-&gt;{name} is subnet of\n&quot;,</td></tr>
<tr><td class="h">8248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $other-&gt;{name} at&quot;,</td></tr>
<tr><td class="h">8249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $first_intf-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">8250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $bignet-&gt;{name} at&quot;,</td></tr>
<tr><td class="h">8251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">8252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8256</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ambiguous subnet relation from NAT.\n&quot;,</td></tr>
<tr><td class="h">8258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $subnet-&gt;{name} is subnet of\n&quot;,</td></tr>
<tr><td class="h">8259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $bignet-&gt;{name} at&quot;,</td></tr>
<tr><td class="h">8260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">8261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - but has no subnet relation at&quot;,</td></tr>
<tr><td class="h">8262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $first_intf-&gt;{name}&quot;</td></tr>
<tr><td class="h">8263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8266</td><td colspan="7"></td></tr><tr><td class="h">8267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We only need to find the smallest enclosing</td></tr>
<tr><td class="h">8268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# network.</td></tr>
<tr><td class="h">8269</td><td><div class="c3">242</div></td><td></td><td></td><td></td><td></td><td><div>1043</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next SUBNET;</td></tr>
<tr><td class="h">8270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8271</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8271">100</a></div></td><td></td><td></td><td></td><td><div>359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface ne $first_intf) {</td></tr>
<tr><td class="h">8272</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8272">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $subnet-&gt;{up}) {</td></tr>
<tr><td class="h">8273</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Ambiguous subnet relation from NAT.\n&quot;,</td></tr>
<tr><td class="h">8275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $subnet-&gt;{name} is subnet of\n&quot;,</td></tr>
<tr><td class="h">8276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $other-&gt;{name} at&quot;,</td></tr>
<tr><td class="h">8277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $first_intf-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">8278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - but has no subnet relation at&quot;,</td></tr>
<tr><td class="h">8279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">8280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8286</td><td colspan="7"></td></tr><tr><td class="h">8287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For each subnet N find the largest non-aggregate network</td></tr>
<tr><td class="h">8288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# which encloses N. If one exists, store it in %max_up_net.</td></tr>
<tr><td class="h">8289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is used to exclude subnets from $zone-&gt;{networks} below.</td></tr>
<tr><td class="h">8290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It is also used to derive attribute {max_routing_net}.</td></tr>
<tr><td class="h">8291</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2008</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %max_up_net;</td></tr>
<tr><td class="h">8292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $set_max_net;</td></tr>
<tr><td class="h">8293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$set_max_net = sub {</td></tr>
<tr><td class="h">8294</td><td><div class="c3">6140</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8294">6140</a></div></td><td></td><td><div>6699</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network) = @_;</td></tr>
<tr><td class="h">8295</td><td><div class="c3">6140</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8295">100</a></div></td><td></td><td></td><td></td><td><div>11033</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if not $network;</td></tr>
<tr><td class="h">8296</td><td><div class="c3">3187</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8296">100</a></div></td><td></td><td></td><td></td><td><div>5683</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $max_net = $max_up_net{$network}) {</td></tr>
<tr><td class="h">8297</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $max_net;</td></tr>
<tr><td class="h">8298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8299</td><td><div class="c3">3179</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8299">100</a></div></td><td></td><td></td><td></td><td><div>7843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $max_net = $set_max_net-&gt;($network-&gt;{up})) {</td></tr>
<tr><td class="h">8300</td><td><div class="c3">140</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8300">100</a></div></td><td></td><td></td><td></td><td><div>240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$network-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">8301</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>223</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max_up_net{$network} = $max_net;</td></tr>
<tr><td class="h">8302</td><td colspan="7"></td></tr><tr><td class="h">8303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$network-&gt;{name} max_up $max_net-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8305</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>282</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $max_net;</td></tr>
<tr><td class="h">8306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8307</td><td><div class="c3">3039</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8307">100</a></div></td><td></td><td></td><td></td><td><div>5375</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">8308</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8310</td><td><div class="c3">2953</div></td><td></td><td></td><td></td><td></td><td><div>4964</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $network;</td></tr>
<tr><td class="h">8311</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>6173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8312</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>1921</div><div>5191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$set_max_net-&gt;($_) for @{ $zone-&gt;{networks} };</td></tr>
<tr><td class="h">8313</td><td colspan="7"></td></tr><tr><td class="h">8314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For each subnet N find the largest non-aggregate network</td></tr>
<tr><td class="h">8315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# which encloses N and which has the same NAT settings as N.</td></tr>
<tr><td class="h">8316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If one exists, store it in {max_routing_net}. This is used</td></tr>
<tr><td class="h">8317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# for generating static routes.</td></tr>
<tr><td class="h">8318</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>1935</div><div>2819</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} }) {</td></tr>
<tr><td class="h">8319</td><td><div class="c3">2961</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8319">100</a></div></td><td></td><td></td><td></td><td><div>6747</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max = $max_up_net{$network} or next;</td></tr>
<tr><td class="h">8320</td><td colspan="7"></td></tr><tr><td class="h">8321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Check $network-&gt;{name} $max-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8322</td><td colspan="7"></td></tr><tr><td class="h">8323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $get_zone_nat = sub {</td></tr>
<tr><td class="h">8324</td><td><div class="c3">276</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8324">276</a></div></td><td></td><td><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network) = @_;</td></tr>
<tr><td class="h">8325</td><td><div class="c3">276</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8325">100</a></div></td><td></td><td></td><td><div>722</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $network-&gt;{nat} || {};</td></tr>
<tr><td class="h">8326</td><td colspan="7"></td></tr><tr><td class="h">8327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Special case:</td></tr>
<tr><td class="h">8328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# NAT is applied to $network inside the zone.</td></tr>
<tr><td class="h">8329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore NAT tag when comparing with NAT of $up.</td></tr>
<tr><td class="h">8330</td><td><div class="c3">276</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8330">100</a></div></td><td></td><td></td><td></td><td><div>523</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $aref = $net2zone_nat_tags{$network}) {</td></tr>
<tr><td class="h">8331</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat = {%$nat};</td></tr>
<tr><td class="h">8332</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (@$aref) {</td></tr>
<tr><td class="h">8333</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $nat-&gt;{$nat_tag};</td></tr>
<tr><td class="h">8334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8336</td><td><div class="c3">276</div></td><td></td><td></td><td></td><td></td><td><div>341</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $nat;</td></tr>
<tr><td class="h">8337</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8338</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $get_zone_nat-&gt;($network);</td></tr>
<tr><td class="h">8339</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max_routing;</td></tr>
<tr><td class="h">8340</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up = $network-&gt;{up};</td></tr>
<tr><td class="h">8341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UP:</td></tr>
<tr><td class="h">8342</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($up) {</td></tr>
<tr><td class="h">8343</td><td colspan="7"></td></tr><tr><td class="h">8344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check if NAT settings are identical.</td></tr>
<tr><td class="h">8345</td><td><div class="c3">156</div></td><td></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up_nat = $get_zone_nat-&gt;($up);</td></tr>
<tr><td class="h">8346</td><td><div class="c3">156</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8346">100</a></div></td><td></td><td></td><td></td><td><div>339</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys %$nat == keys %$up_nat or last UP;</td></tr>
<tr><td class="h">8347</td><td><div class="c3">142</div></td><td></td><td></td><td></td><td></td><td><div>273</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tag (keys %$nat) {</td></tr>
<tr><td class="h">8348</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8348">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up_nat_info = $up_nat-&gt;{$tag} or last UP;</td></tr>
<tr><td class="h">8349</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_info = $nat-&gt;{$tag};</td></tr>
<tr><td class="h">8350</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8350">50</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_info-&gt;{hidden}) {</td></tr>
<tr><td class="h">8351</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8351">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up_nat_info-&gt;{hidden} or last UP;</td></tr>
<tr><td class="h">8352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8354</td><td colspan="7"></td></tr><tr><td class="h">8355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check if subnet relation is maintained</td></tr>
<tr><td class="h">8356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# for NAT addresses.</td></tr>
<tr><td class="h">8357</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8357">50</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up_nat_info-&gt;{hidden} and last UP;</td></tr>
<tr><td class="h">8358</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_info}{qw(ip mask)};</td></tr>
<tr><td class="h">8359</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8359">100</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_ip($up_nat_info-&gt;{ip}, $ip, $mask) or last UP;</td></tr>
<tr><td class="h">8360</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8360">50</a></div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up_nat_info-&gt;{mask} &gt;= $mask or last UP;</td></tr>
<tr><td class="h">8361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8363</td><td><div class="c3">138</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8363">100</a></div></td><td></td><td></td><td></td><td><div>635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$up-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">8364</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>479</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max_routing = $up;</td></tr>
<tr><td class="h">8365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8366</td><td><div class="c3">138</div></td><td></td><td></td><td></td><td></td><td><div>290</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = $up-&gt;{up};</td></tr>
<tr><td class="h">8367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8368</td><td><div class="c3">120</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8368">100</a></div></td><td></td><td></td><td></td><td><div>1743</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($max_routing) {</td></tr>
<tr><td class="h">8369</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>800</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{max_routing_net} = $max_routing;</td></tr>
<tr><td class="h">8370</td><td colspan="7"></td></tr><tr><td class="h">8371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Found $max_routing-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8374</td><td colspan="7"></td></tr><tr><td class="h">8375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove subnets of non-aggregate networks.</td></tr>
<tr><td class="h">8376</td><td><div class="c3">2961</div></td><td></td><td></td><td></td><td></td><td><div>6431</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{networks} =</td></tr>
<tr><td class="h">8377</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2327</div><div>2973</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ grep { !$max_up_net{$_} } @{ $zone-&gt;{networks} } ];</td></tr>
<tr><td class="h">8378</td><td colspan="7"></td></tr><tr><td class="h">8379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Propagate managed hosts to aggregates.</td></tr>
<tr><td class="h">8380</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2285</div><div>6626</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $aggregate (values %{ $zone-&gt;{ipmask2aggregate} }) {</td></tr>
<tr><td class="h">8381</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>774</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_managed_hosts_to_aggregate($aggregate);</td></tr>
<tr><td class="h">8382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8384</td><td colspan="7"></td></tr><tr><td class="h">8385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# It is valid to have an aggregate in a zone which has no matching</td></tr>
<tr><td class="h">8386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# networks. This can be useful to add optimization rules at an</td></tr>
<tr><td class="h">8387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# intermediate device.</td></tr>
<tr><td class="h">8388</td><td colspan="7"></td></tr><tr><td class="h">8389</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>811</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8391</td><td colspan="7"></td></tr><tr><td class="h">8392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find subnet relation inside a NAT domain.</td></tr>
<tr><td class="h">8393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - $subnet-&gt;{is_in}-&gt;{$no_nat_set} = $bignet;</td></tr>
<tr><td class="h">8394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - $net1-&gt;{is_identical}-&gt;{$no_nat_set} = $net2</td></tr>
<tr><td class="h">8395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">8396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark networks, having subnet in other zone: $bignet-&gt;{has_other_subnet}</td></tr>
<tr><td class="h">8397</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If set, this prevents secondary optimization.</td></tr>
<tr><td class="h">8398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_subnets_in_nat_domain {</td></tr>
<tr><td class="h">8399</td><td><div class="c3">508</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8399">508</a></div></td><td><div class="c0">0</div></td><td><div>493</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $count = @natdomains;</td></tr>
<tr><td class="h">8400</td><td><div class="c3">508</div></td><td></td><td></td><td></td><td></td><td><div>1347</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&quot;Finding subnets in $count NAT domains&quot;);</td></tr>
<tr><td class="h">8401</td><td><div class="c3">508</div></td><td></td><td></td><td></td><td></td><td><div>458</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">8402</td><td colspan="7"></td></tr><tr><td class="h">8403</td><td><div class="c3">508</div></td><td></td><td></td><td></td><td></td><td><div>614</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $domain (@natdomains) {</td></tr>
<tr><td class="h">8404</td><td><div class="c3">624</div></td><td></td><td></td><td></td><td></td><td><div>652</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $domain-&gt;{no_nat_set};</td></tr>
<tr><td class="h">8405</td><td colspan="7"></td></tr><tr><td class="h">8406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$domain-&gt;{name} &quot;, join &#39;,&#39;, sort keys %$no_nat_set);</td></tr>
<tr><td class="h">8407</td><td><div class="c3">624</div></td><td></td><td></td><td></td><td></td><td><div>514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %mask_ip_hash;</td></tr>
<tr><td class="h">8408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %identical;</td></tr>
<tr><td class="h">8409</td><td><div class="c3">624</div></td><td></td><td></td><td></td><td></td><td><div>638</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">8410</td><td><div class="c3">3394</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8410">100</a></div></td><td></td><td></td><td></td><td><div>6784</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{ip} =~ /^(?:unnumbered|tunnel)$/;</td></tr>
<tr><td class="h">8411</td><td><div class="c3">3272</div></td><td></td><td></td><td></td><td></td><td><div>4048</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = get_nat_network($network, $no_nat_set);</td></tr>
<tr><td class="h">8412</td><td><div class="c3">3272</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8412">100</a></div></td><td></td><td></td><td></td><td><div>4850</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_network-&gt;{hidden};</td></tr>
<tr><td class="h">8413</td><td><div class="c3">3242</div><div class="c3">3242</div></td><td></td><td></td><td></td><td></td><td><div>2498</div><div>4071</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_network}{ &#39;ip&#39;, &#39;mask&#39; };</td></tr>
<tr><td class="h">8414</td><td colspan="7"></td></tr><tr><td class="h">8415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found two different networks with identical IP/mask.</td></tr>
<tr><td class="h">8416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# in current NAT domain.</td></tr>
<tr><td class="h">8417</td><td><div class="c3">3242</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8417">100</a></div></td><td></td><td></td><td></td><td><div>5725</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $old_net = $mask_ip_hash{$mask}-&gt;{$ip}) {</td></tr>
<tr><td class="h">8418</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_old_net = get_nat_network($old_net, $no_nat_set);</td></tr>
<tr><td class="h">8419</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $error;</td></tr>
<tr><td class="h">8420</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8420">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8420">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8420">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8420">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8420">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8420">50</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8420">67</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8420">67</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8420">67</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8420">33</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8420">50</a></div></td><td></td><td></td><td><div>520</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($old_net-&gt;{is_aggregate} || $network-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">8421</td><td><div class="c3">86</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8421">50</a></div></td><td></td><td></td><td></td><td><div>224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($old_net-&gt;{zone} eq $network-&gt;{zone}) {</td></tr>
<tr><td class="h">8422</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error = 1;</td></tr>
<tr><td class="h">8423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8425</td><td colspan="7"></td></tr><tr><td class="h">8426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check supernet rules and prevent secondary</td></tr>
<tr><td class="h">8427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# optimization, if identical IP address</td></tr>
<tr><td class="h">8428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# occurrs in different zones.</td></tr>
<tr><td class="h">8429</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$old_net-&gt;{has_other_subnet} = 1;</td></tr>
<tr><td class="h">8430</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{has_other_subnet} = 1;</td></tr>
<tr><td class="h">8431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8433</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nat_old_net-&gt;{dynamic} and $nat_network-&gt;{dynamic}) {</td></tr>
<tr><td class="h">8434</td><td colspan="7"></td></tr><tr><td class="h">8435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Dynamic NAT of different networks</td></tr>
<tr><td class="h">8436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to a single new IP/mask is OK.</td></tr>
<tr><td class="h">8437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($old_net-&gt;{loopback} and $nat_network-&gt;{dynamic}) {</td></tr>
<tr><td class="h">8439</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8439">50</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nat_to_loopback_ok($old_net, $nat_network) or $error = 1;</td></tr>
<tr><td class="h">8440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($nat_old_net-&gt;{dynamic} and $network-&gt;{loopback}) {</td></tr>
<tr><td class="h">8442</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8442">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nat_to_loopback_ok($network, $nat_old_net) or $error = 1;</td></tr>
<tr><td class="h">8443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (($network-&gt;{bridged} || 0) eq ($old_net-&gt;{bridged} || 1))</td></tr>
<tr><td class="h">8445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8446</td><td colspan="7"></td></tr><tr><td class="h">8447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Parts of bridged network have identical IP by design.</td></tr>
<tr><td class="h">8448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8450</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error = 1;</td></tr>
<tr><td class="h">8451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8452</td><td><div class="c3">116</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8452">50</a></div></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($error) {</td></tr>
<tr><td class="h">8453</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name1 = $nat_network-&gt;{name};</td></tr>
<tr><td class="h">8454</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name2 = $nat_old_net-&gt;{name};</td></tr>
<tr><td class="h">8455</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$name1 and $name2 have identical IP/mask\n&quot;,</td></tr>
<tr><td class="h">8456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $domain-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8459</td><td colspan="7"></td></tr><tr><td class="h">8460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember identical networks.</td></tr>
<tr><td class="h">8461</td><td><div class="c3">116</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8461">100</a></div></td><td></td><td></td><td><div>407</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$identical{$old_net} ||= [$old_net];</td></tr>
<tr><td class="h">8462</td><td><div class="c3">116</div><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>105</div><div>340</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $identical{$old_net} }, $network;</td></tr>
<tr><td class="h">8463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8466</td><td colspan="7"></td></tr><tr><td class="h">8467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store original network under NAT IP/mask.</td></tr>
<tr><td class="h">8468</td><td><div class="c3">3126</div></td><td></td><td></td><td></td><td></td><td><div>5643</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mask_ip_hash{$mask}-&gt;{$ip} = $network;</td></tr>
<tr><td class="h">8469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8471</td><td colspan="7"></td></tr><tr><td class="h">8472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Link identical networks to one representative one.</td></tr>
<tr><td class="h">8473</td><td><div class="c3">624</div></td><td></td><td></td><td></td><td></td><td><div>1162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $networks (values %identical) {</td></tr>
<tr><td class="h">8474</td><td><div class="c3">84</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $one_net = shift(@$networks);</td></tr>
<tr><td class="h">8475</td><td><div class="c3">84</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$networks) {</td></tr>
<tr><td class="h">8476</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>349</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{is_identical}-&gt;{$no_nat_set} = $one_net;</td></tr>
<tr><td class="h">8477</td><td colspan="7"></td></tr><tr><td class="h">8478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Identical: $network-&gt;{name}: $one_net-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8481</td><td colspan="7"></td></tr><tr><td class="h">8482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Go from smaller to larger networks.</td></tr>
<tr><td class="h">8483</td><td><div class="c3">624</div></td><td></td><td></td><td></td><td></td><td><div>1877</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @mask_list = reverse sort numerically keys %mask_ip_hash;</td></tr>
<tr><td class="h">8484</td><td><div class="c3">624</div></td><td></td><td></td><td></td><td></td><td><div>1327</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my $mask = shift @mask_list) {</td></tr>
<tr><td class="h">8485</td><td colspan="7"></td></tr><tr><td class="h">8486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No supernets available</td></tr>
<tr><td class="h">8487</td><td><div class="c3">1142</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8487">100</a></div></td><td></td><td></td><td></td><td><div>3048</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if not @mask_list;</td></tr>
<tr><td class="h">8488</td><td colspan="7"></td></tr><tr><td class="h">8489</td><td><div class="c3">684</div></td><td></td><td></td><td></td><td></td><td><div>686</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip_hash = $mask_ip_hash{$mask};</td></tr>
<tr><td class="h">8490</td><td><div class="c3">684</div></td><td></td><td></td><td></td><td></td><td><div>1866</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ip (sort numerically keys %$ip_hash) {</td></tr>
<tr><td class="h">8491</td><td colspan="7"></td></tr><tr><td class="h">8492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It is sufficient to set subset relation for only one</td></tr>
<tr><td class="h">8493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# network out of multiple identical networks.</td></tr>
<tr><td class="h">8494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# In all contexts where {is_in} is used,</td></tr>
<tr><td class="h">8495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# we apply {is_identical} to the network before.</td></tr>
<tr><td class="h">8496</td><td><div class="c3">1682</div></td><td></td><td></td><td></td><td></td><td><div>1492</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnet = $ip_hash-&gt;{$ip};</td></tr>
<tr><td class="h">8497</td><td colspan="7"></td></tr><tr><td class="h">8498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find networks which include current subnet.</td></tr>
<tr><td class="h">8499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# @mask_list holds masks of potential supernets.</td></tr>
<tr><td class="h">8500</td><td><div class="c3">1682</div></td><td></td><td></td><td></td><td></td><td><div>1596</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $m (@mask_list) {</td></tr>
<tr><td class="h">8501</td><td><div class="c3">2114</div></td><td></td><td></td><td></td><td></td><td><div>1842</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $ip &amp; $m;</td></tr>
<tr><td class="h">8502</td><td><div class="c3">2114</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8502">100</a></div></td><td></td><td></td><td></td><td><div>4765</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $bignet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $mask_ip_hash{$m}-&gt;{$i} or next;</td></tr>
<tr><td class="h">8503</td><td><div class="c3">966</div></td><td></td><td></td><td></td><td></td><td><div>1178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_subnet = get_nat_network($subnet, $no_nat_set);</td></tr>
<tr><td class="h">8504</td><td><div class="c3">966</div></td><td></td><td></td><td></td><td></td><td><div>1162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_bignet = get_nat_network($bignet, $no_nat_set);</td></tr>
<tr><td class="h">8505</td><td colspan="7"></td></tr><tr><td class="h">8506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark subnet relation.</td></tr>
<tr><td class="h">8507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This may differ for different NAT domains.</td></tr>
<tr><td class="h">8508</td><td><div class="c3">966</div></td><td></td><td></td><td></td><td></td><td><div>1746</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subnet-&gt;{is_in}-&gt;{$no_nat_set} = $bignet;</td></tr>
<tr><td class="h">8509</td><td colspan="7"></td></tr><tr><td class="h">8510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$subnet-&gt;{name} -is_in-&gt; $bignet-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8511</td><td colspan="7"></td></tr><tr><td class="h">8512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark network having subnet in other zone.</td></tr>
<tr><td class="h">8513</td><td><div class="c3">966</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8513">100</a></div></td><td></td><td></td><td></td><td><div>1930</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($bignet-&gt;{zone} eq $subnet-&gt;{zone}) {</td></tr>
<tr><td class="h">8514</td><td><div class="c3">388</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8514">100</a></div></td><td></td><td></td><td></td><td><div>643</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($subnet-&gt;{has_other_subnet}) {</td></tr>
<tr><td class="h">8515</td><td colspan="7"></td></tr><tr><td class="h">8516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;has other1: $bignet-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8517</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bignet-&gt;{has_other_subnet} = 1;</td></tr>
<tr><td class="h">8518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8521</td><td colspan="7"></td></tr><tr><td class="h">8522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;has other: $bignet-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8523</td><td><div class="c3">578</div></td><td></td><td></td><td></td><td></td><td><div>616</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bignet-&gt;{has_other_subnet} = 1;</td></tr>
<tr><td class="h">8524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8525</td><td colspan="7"></td></tr><tr><td class="h">8526</td><td><div class="c3">966</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8526">100</a></div></td><td></td><td></td><td></td><td><div>2181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($seen{$nat_bignet}-&gt;{$nat_subnet}) {</td></tr>
<tr><td class="h">8527</td><td><div class="c3">200</div></td><td></td><td></td><td></td><td></td><td><div>507</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">8528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8529</td><td><div class="c3">766</div></td><td></td><td></td><td></td><td></td><td><div>1268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$nat_bignet}-&gt;{$nat_subnet} = 1;</td></tr>
<tr><td class="h">8530</td><td colspan="7"></td></tr><tr><td class="h">8531</td><td><div class="c3">766</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8531">50</a></div></td><td></td><td></td><td></td><td><div>1253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($config-&gt;{check_subnets}) {</td></tr>
<tr><td class="h">8532</td><td colspan="7"></td></tr><tr><td class="h">8533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take original $bignet, because currently</td></tr>
<tr><td class="h">8534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# there&#39;s no method to specify a natted network</td></tr>
<tr><td class="h">8535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# as value of subnet_of.</td></tr>
<tr><td class="h">8536</td><td><div class="c3">766</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8536">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8536">62</a></div></td><td></td><td></td><td><div>2589</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">8537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not(&nbsp;&nbsp;&nbsp;$bignet-&gt;{is_aggregate}</td></tr>
<tr><td class="h">8538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $subnet-&gt;{is_aggregate}</td></tr>
<tr><td class="h">8539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $bignet-&gt;{has_subnets}</td></tr>
<tr><td class="h">8540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $nat_subnet-&gt;{subnet_of}</td></tr>
<tr><td class="h">8541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $nat_subnet-&gt;{subnet_of} eq $bignet</td></tr>
<tr><td class="h">8542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $nat_subnet-&gt;{is_layer3})</td></tr>
<tr><td class="h">8543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">8544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8545</td><td colspan="7"></td></tr><tr><td class="h">8546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent multiple error messages in</td></tr>
<tr><td class="h">8547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# different NAT domains.</td></tr>
<tr><td class="h">8548</td><td><div class="c3">4</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8548">33</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_subnet-&gt;{subnet_of} ||= $bignet;</td></tr>
<tr><td class="h">8549</td><td colspan="7"></td></tr><tr><td class="h">8550</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg =</td></tr>
<tr><td class="h">8551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$nat_subnet-&gt;{name} is subnet of&quot;</td></tr>
<tr><td class="h">8552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; $nat_bignet-&gt;{name}\n&quot;</td></tr>
<tr><td class="h">8553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; in $domain-&gt;{name}.\n&quot;</td></tr>
<tr><td class="h">8554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; If desired, either declare attribute&quot;</td></tr>
<tr><td class="h">8555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. &quot; &#39;subnet_of&#39; or attribute &#39;has_subnets&#39;&quot;;</td></tr>
<tr><td class="h">8556</td><td colspan="7"></td></tr><tr><td class="h">8557</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8557">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($config-&gt;{check_subnets} eq &#39;warn&#39;) {</td></tr>
<tr><td class="h">8558</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg($msg);</td></tr>
<tr><td class="h">8559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8561</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg($msg);</td></tr>
<tr><td class="h">8562</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8565</td><td colspan="7"></td></tr><tr><td class="h">8566</td><td><div class="c3">766</div></td><td></td><td></td><td></td><td></td><td><div>928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_subnets($nat_bignet, $nat_subnet);</td></tr>
<tr><td class="h">8567</td><td><div class="c3">766</div></td><td></td><td></td><td></td><td></td><td><div>2441</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">8568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8572</td><td colspan="7"></td></tr><tr><td class="h">8573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Secondary optimization substitutes a host or interface by its</td></tr>
<tr><td class="h">8574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# largest valid supernet inside the same security zone. This</td></tr>
<tr><td class="h">8575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# supernet has already been calculated and stored in</td></tr>
<tr><td class="h">8576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# {max_routing_net}. But {max_routing_net} can&#39;t be used if it has</td></tr>
<tr><td class="h">8577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# a subnet in some other security zone. In this case we have to</td></tr>
<tr><td class="h">8578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# search again for a supernet without attribute {has_other_subnet}.</td></tr>
<tr><td class="h">8579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# The result is stored in {max_secondary_net}.</td></tr>
<tr><td class="h">8580</td><td><div class="c3">508</div></td><td></td><td></td><td></td><td></td><td><div>668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">8581</td><td><div class="c3">2744</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8581">100</a></div></td><td></td><td></td><td></td><td><div>4561</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max = $network-&gt;{max_routing_net} or next;</td></tr>
<tr><td class="h">8582</td><td><div class="c3">82</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8582">100</a></div></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$max-&gt;{has_other_subnet}) {</td></tr>
<tr><td class="h">8583</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{max_secondary_net} = $max;</td></tr>
<tr><td class="h">8584</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">8585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8586</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max_secondary;</td></tr>
<tr><td class="h">8587</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $up = $network-&gt;{up};</td></tr>
<tr><td class="h">8588</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($up) {</td></tr>
<tr><td class="h">8589</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8589">100</a></div></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($up-&gt;{has_other_subnet}) {</td></tr>
<tr><td class="h">8590</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">8591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8593</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8593">100</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$up-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">8594</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max_secondary = $up;</td></tr>
<tr><td class="h">8595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8596</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = $up-&gt;{up};</td></tr>
<tr><td class="h">8597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8599</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8599">100</a></div></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{max_secondary_net} = $max_secondary if $max_secondary;</td></tr>
<tr><td class="h">8600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8601</td><td><div class="c3">508</div></td><td></td><td></td><td></td><td></td><td><div>789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8603</td><td colspan="7"></td></tr><tr><td class="h">8604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If routers are connected by crosslink network then</td></tr>
<tr><td class="h">8605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># no filter is needed if both have equal strength.</td></tr>
<tr><td class="h">8606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If routers have different strength,</td></tr>
<tr><td class="h">8607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># then only the weakest devices omit the filter.</td></tr>
<tr><td class="h">8608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %crosslink_strength = (</td></tr>
<tr><td class="h">8609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 10,</td></tr>
<tr><td class="h">8610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 10,</td></tr>
<tr><td class="h">8611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;standard&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 9,</td></tr>
<tr><td class="h">8612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;secondary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 8,</td></tr>
<tr><td class="h">8613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 7,</td></tr>
<tr><td class="h">8614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local_secondary =&gt; 6,</td></tr>
<tr><td class="h">8615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">8616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">8617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;: Find clusters of routers connected directly or indirectly by</td></tr>
<tr><td class="h">8618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crosslink networks and having at least one device with</td></tr>
<tr><td class="h">8619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;need_protect&quot;.</td></tr>
<tr><td class="h">8620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter : Hash reference storing crosslinked routers with {need_protect} </td></tr>
<tr><td class="h">8621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag set.</td></tr>
<tr><td class="h">8622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cluster_crosslink_routers {</td></tr>
<tr><td class="h">8623</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8623">736</a></div></td><td><div class="c0">0</div></td><td><div>758</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($crosslink_routers) = @_;</td></tr>
<tr><td class="h">8624</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>617</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %cluster;</td></tr>
<tr><td class="h">8625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">8626</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $walk;</td></tr>
<tr><td class="h">8627</td><td colspan="7"></td></tr><tr><td class="h">8628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Add routers to cluster via depth first search.</td></tr>
<tr><td class="h">8629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$walk = sub {</td></tr>
<tr><td class="h">8630</td><td><div class="c3">34</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8630">34</a></div></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">8631</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cluster{$router} = $router;</td></tr>
<tr><td class="h">8632</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$router}&nbsp;&nbsp;&nbsp;&nbsp;= $router;</td></tr>
<tr><td class="h">8633</td><td><div class="c3">34</div><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>28</div><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $in_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8634</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $in_intf-&gt;{network};</td></tr>
<tr><td class="h">8635</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8635">100</a></div></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $network-&gt;{crosslink};</td></tr>
<tr><td class="h">8636</td><td><div class="c3">36</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8636">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{disabled};</td></tr>
<tr><td class="h">8637</td><td><div class="c3">36</div><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>28</div><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8638</td><td><div class="c3">84</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8638">100</a></div></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $in_intf;</td></tr>
<tr><td class="h">8639</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router2 = $out_intf-&gt;{router};</td></tr>
<tr><td class="h">8640</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8640">100</a></div></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $cluster{$router2};</td></tr>
<tr><td class="h">8641</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$walk-&gt;($router2);</td></tr>
<tr><td class="h">8642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8644</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8645</td><td colspan="7"></td></tr><tr><td class="h">8646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process all need_protect crosslinked routers.</td></tr>
<tr><td class="h">8647</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1589</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (values %$crosslink_routers) {</td></tr>
<tr><td class="h">8648</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8648">100</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$router};</td></tr>
<tr><td class="h">8649</td><td colspan="7"></td></tr><tr><td class="h">8650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Fill router cluster</td></tr>
<tr><td class="h">8651</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%cluster = ();</td></tr>
<tr><td class="h">8652</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$walk-&gt;($router);</td></tr>
<tr><td class="h">8653</td><td colspan="7"></td></tr><tr><td class="h">8654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect all interfaces belonging to need_protect routers of cluster...</td></tr>
<tr><td class="h">8655</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @crosslink_interfaces =</td></tr>
<tr><td class="h">8656</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { !$_-&gt;{vip} }</td></tr>
<tr><td class="h">8657</td><td><div class="c3">20</div><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>15</div><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;{ @{ $_-&gt;{interfaces} } }</td></tr>
<tr><td class="h">8658</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $crosslink_routers-&gt;{$_} }</td></tr>
<tr><td class="h">8659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort by_name values %cluster;&nbsp;&nbsp;&nbsp;&nbsp;# Sort to make output deterministic.</td></tr>
<tr><td class="h">8660</td><td colspan="7"></td></tr><tr><td class="h">8661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ... add information to every cluster member as list </td></tr>
<tr><td class="h">8662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# used in print_acls.</td></tr>
<tr><td class="h">8663</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router2 (values %cluster) {</td></tr>
<tr><td class="h">8664</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router2-&gt;{crosslink_interfaces} = \@crosslink_interfaces;</td></tr>
<tr><td class="h">8665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8667</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>983</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">8670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A crosslink network combines two or more routers to one virtual router.</td></tr>
<tr><td class="h">8671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Assures proper usage of crosslink networks and applies the</td></tr>
<tr><td class="h">8672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crosslink attribute to the networks weakest interfaces (no</td></tr>
<tr><td class="h">8673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filtering needed at these interfaces).</td></tr>
<tr><td class="h">8674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;: Hash storing crosslinked routers with {need_protect} flag set.</td></tr>
<tr><td class="h">8675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Function uses hardware attributes from sub check_no_in_acl.</td></tr>
<tr><td class="h">8676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_crosslink {</td></tr>
<tr><td class="h">8677</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8677">736</a></div></td><td><div class="c0">0</div></td><td><div>796</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %crosslink_routers;&nbsp;&nbsp;&nbsp;&nbsp;# Collect crosslinked routers with {need_protect}</td></tr>
<tr><td class="h">8678</td><td colspan="7"></td></tr><tr><td class="h">8679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process all crosslink networks</td></tr>
<tr><td class="h">8680</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %networks) {</td></tr>
<tr><td class="h">8681</td><td><div class="c3">3042</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8681">100</a></div></td><td></td><td></td><td></td><td><div>5042</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $network-&gt;{crosslink};</td></tr>
<tr><td class="h">8682</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8682">50</a></div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{disabled};</td></tr>
<tr><td class="h">8683</td><td colspan="7"></td></tr><tr><td class="h">8684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepare tests.</td></tr>
<tr><td class="h">8685</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %strength2intf;&nbsp;&nbsp;&nbsp;&nbsp;# To identify interfaces with min router strength</td></tr>
<tr><td class="h">8686</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_acl_count = 0;&nbsp;&nbsp;&nbsp;&nbsp;# Assure out_ACL at all/none of the interfaces</td></tr>
<tr><td class="h">8687</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @no_in_acl_intf;&nbsp;&nbsp;&nbsp;# Assure all no_in_acl IFs to border the same zone</td></tr>
<tr><td class="h">8688</td><td colspan="7"></td></tr><tr><td class="h">8689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Process network interfaces to fill above variables.</td></tr>
<tr><td class="h">8690</td><td><div class="c3">20</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>17</div><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8691</td><td><div class="c3">38</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8691">100</a></div></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">8692</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router&nbsp;&nbsp;&nbsp;= $interface-&gt;{router};</td></tr>
<tr><td class="h">8693</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hardware = $interface-&gt;{hardware};</td></tr>
<tr><td class="h">8694</td><td colspan="7"></td></tr><tr><td class="h">8695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure correct usage of crosslink network.</td></tr>
<tr><td class="h">8696</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8696">100</a></div></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$router-&gt;{managed}) {</td></tr>
<tr><td class="h">8697</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Crosslink $network-&gt;{name} must not be&quot;,</td></tr>
<tr><td class="h">8699</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; connected to unmanged $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">8700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8701</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">8702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8703</td><td><div class="c3">34</div><div class="c3">36</div><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8703">50</a></div></td><td></td><td></td><td></td><td><div>30</div><div>83</div><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 == grep({ !$_-&gt;{main_interface} } @{ $hardware-&gt;{interfaces} })</td></tr>
<tr><td class="h">8704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg</td></tr>
<tr><td class="h">8705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Crosslink $network-&gt;{name} must be the only network\n&quot;,</td></tr>
<tr><td class="h">8706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; connected to $hardware-&gt;{name} of $router-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8707</td><td colspan="7"></td></tr><tr><td class="h">8708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Fill variables.</td></tr>
<tr><td class="h">8709</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed&nbsp;&nbsp;= $router-&gt;{managed};</td></tr>
<tr><td class="h">8710</td><td><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8710">50</a></div></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $strength = $crosslink_strength{$managed}</td></tr>
<tr><td class="h">8711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Unexptected managed=$managed&quot;);</td></tr>
<tr><td class="h">8712</td><td><div class="c3">34</div><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>32</div><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $strength2intf{$strength} }, $interface;</td></tr>
<tr><td class="h">8713</td><td colspan="7"></td></tr><tr><td class="h">8714</td><td><div class="c3">34</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8714">100</a></div></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{need_protect}) {</td></tr>
<tr><td class="h">8715</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crosslink_routers{$router} = $router;</td></tr>
<tr><td class="h">8716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8717</td><td colspan="7"></td></tr><tr><td class="h">8718</td><td><div class="c3">34</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8718">50</a></div></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hardware-&gt;{need_out_acl}) {</td></tr>
<tr><td class="h">8719</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_acl_count++;</td></tr>
<tr><td class="h">8720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8721</td><td colspan="7"></td></tr><tr><td class="h">8722</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @no_in_acl_intf,</td></tr>
<tr><td class="h">8723</td><td><div class="c3">34</div><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>31</div><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $_-&gt;{hardware}-&gt;{no_in_acl} } @{ $router-&gt;{interfaces} });</td></tr>
<tr><td class="h">8724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8725</td><td colspan="7"></td></tr><tr><td class="h">8726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Apply attribute {crosslink} to the networks weakest interfaces.</td></tr>
<tr><td class="h">8727</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8727">100</a></div></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my ($weakest) = sort numerically keys %strength2intf) {</td></tr>
<tr><td class="h">8728</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $strength2intf{$weakest} }) {</td></tr>
<tr><td class="h">8729</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hardware}-&gt;{crosslink} = 1;</td></tr>
<tr><td class="h">8730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8731</td><td colspan="7"></td></tr><tr><td class="h">8732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure &#39;secondary&#39; and &#39;local&#39; are not mixed in crosslink network.</td></tr>
<tr><td class="h">8733</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8733">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8733">100</a></div></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$weakest == $crosslink_strength{local}</td></tr>
<tr><td class="h">8734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $strength2intf{ $crosslink_strength{secondary} })</td></tr>
<tr><td class="h">8735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">8736</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not use &#39;managed=local&#39; and &#39;managed=secondary&#39;&quot;,</td></tr>
<tr><td class="h">8738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; together\n at crosslink $network-&gt;{name}&quot;</td></tr>
<tr><td class="h">8739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8742</td><td colspan="7"></td></tr><tr><td class="h">8743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure proper usage of crosslink network.</td></tr>
<tr><td class="h">8744</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not $out_acl_count</td></tr>
<tr><td class="h">8745</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8745">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8745">33</a></div></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $out_acl_count == @{ $network-&gt;{interfaces} }</td></tr>
<tr><td class="h">8746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;All interfaces must equally use or not use outgoing ACLs&quot;,</td></tr>
<tr><td class="h">8747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at crosslink $network-&gt;{name}&quot;;</td></tr>
<tr><td class="h">8748</td><td><div class="c3">20</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8748">50</a></div></td><td></td><td></td><td></td><td><div>32</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal(map { $_-&gt;{zone} } @no_in_acl_intf)</td></tr>
<tr><td class="h">8749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;All interfaces with attribute &#39;no_in_acl&#39;&quot;,</td></tr>
<tr><td class="h">8750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at routers connected by\n crosslink $network-&gt;{name}&quot;,</td></tr>
<tr><td class="h">8751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must be border of the same security zone&quot;;</td></tr>
<tr><td class="h">8752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8753</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1082</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \%crosslink_routers;</td></tr>
<tr><td class="h">8754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8755</td><td colspan="7"></td></tr><tr><td class="h">8756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Used</td></tr>
<tr><td class="h">8757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - for crypto_rules,</td></tr>
<tr><td class="h">8758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - rules from general_permit,</td></tr>
<tr><td class="h">8759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - for default route optimization,</td></tr>
<tr><td class="h">8760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - while generating chains of iptables and</td></tr>
<tr><td class="h">8761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - in local optimization.</td></tr>
<tr><td class="h">8762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $network_00 = new(</td></tr>
<tr><td class="h">8763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">8764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &quot;network:0/0&quot;,</td></tr>
<tr><td class="h">8765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">8766</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">8767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;is_aggregate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">8768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;has_other_subnet =&gt; 1,</td></tr>
<tr><td class="h">8769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">8770</td><td colspan="7"></td></tr><tr><td class="h">8771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find cluster of zones connected by &#39;local&#39; or &#39;local_secondary&#39; routers.</td></tr>
<tr><td class="h">8772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - Check consistency of attributes.</td></tr>
<tr><td class="h">8773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - Set unique &#39;local_mark&#39; for all zones and managed routers</td></tr>
<tr><td class="h">8774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;belonging to one cluster.</td></tr>
<tr><td class="h">8775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns array of cluster infos, a hash with attributes</td></tr>
<tr><td class="h">8776</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - no_nat_set</td></tr>
<tr><td class="h">8777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - filter_only</td></tr>
<tr><td class="h">8778</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - mark</td></tr>
<tr><td class="h">8779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_managed_local_clusters {</td></tr>
<tr><td class="h">8780</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8780">486</a></div></td><td><div class="c0">0</div></td><td><div>442</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $local_mark = 1;</td></tr>
<tr><td class="h">8781</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>704</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">8782</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>538</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router0 (@managed_routers) {</td></tr>
<tr><td class="h">8783</td><td><div class="c3">1178</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8783">100</a></div></td><td></td><td></td><td></td><td><div>2461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router0-&gt;{managed} =~ /^local/ or next;</td></tr>
<tr><td class="h">8784</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8784">100</a></div></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router0-&gt;{local_mark};</td></tr>
<tr><td class="h">8785</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $filter_only = $router0-&gt;{filter_only};</td></tr>
<tr><td class="h">8786</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $info = { mark =&gt; $local_mark, filter_only =&gt; $filter_only };</td></tr>
<tr><td class="h">8787</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set;</td></tr>
<tr><td class="h">8788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $k0;</td></tr>
<tr><td class="h">8789</td><td colspan="7"></td></tr><tr><td class="h">8790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark network outside of cluster, that</td></tr>
<tr><td class="h">8791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - is supernet of network inside current cluster</td></tr>
<tr><td class="h">8792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - and doesn&#39;t match {filter_only} and hence wouldn&#39;t be</td></tr>
<tr><td class="h">8793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;found in mark_managed_local.</td></tr>
<tr><td class="h">8794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mark_supernets = sub {</td></tr>
<tr><td class="h">8795</td><td><div class="c3">94</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8795">94</a></div></td><td></td><td><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network, $i, $m) = @_;</td></tr>
<tr><td class="h">8796</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $bignet = $network-&gt;{is_in}-&gt;{$no_nat_set};</td></tr>
<tr><td class="h">8797</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($bignet) {</td></tr>
<tr><td class="h">8798</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8798">100</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $bignet-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">8799</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my (undef, $mask) = @{ address($bignet, $no_nat_set) };</td></tr>
<tr><td class="h">8800</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8800">100</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($mask &gt;= $m) {</td></tr>
<tr><td class="h">8801</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bignet-&gt;{filter_at}-&gt;{$local_mark} = 1;</td></tr>
<tr><td class="h">8802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8803</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8804</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bignet = $bignet-&gt;{is_in}-&gt;{$no_nat_set};</td></tr>
<tr><td class="h">8805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8806</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8807</td><td colspan="7"></td></tr><tr><td class="h">8808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# IP/mask pairs of current cluster matching {filter_only}.</td></tr>
<tr><td class="h">8809</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %matched;</td></tr>
<tr><td class="h">8810</td><td colspan="7"></td></tr><tr><td class="h">8811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $walk;</td></tr>
<tr><td class="h">8812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$walk = sub {</td></tr>
<tr><td class="h">8813</td><td><div class="c3">56</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8813">56</a></div></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">8814</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{local_mark} = $local_mark;</td></tr>
<tr><td class="h">8815</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8815">100</a></div></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($filter_only ne $router-&gt;{filter_only}) {</td></tr>
<tr><td class="h">8816</td><td colspan="7"></td></tr><tr><td class="h">8817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All routers of a cluster must have same values in</td></tr>
<tr><td class="h">8818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# {filter_only}.</td></tr>
<tr><td class="h">8819</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$k0 ||= join(&#39;,&#39;,</td></tr>
<tr><td class="h">8820</td><td><div class="c3">16</div><div class="c3">12</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8820">67</a></div></td><td></td><td></td><td><div>38</div><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ join(&#39;/&#39;, @$_) } @{ $router0-&gt;{filter_only} }));</td></tr>
<tr><td class="h">8821</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $k =</td></tr>
<tr><td class="h">8822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;,&#39;,</td></tr>
<tr><td class="h">8823</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>15</div><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ join(&#39;/&#39;, @$_) } @{ $router-&gt;{filter_only} }));</td></tr>
<tr><td class="h">8824</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8824">100</a></div></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$k eq $k0</td></tr>
<tr><td class="h">8825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">8826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$router0-&gt;{name} and $router-&gt;{name}&quot;,</td></tr>
<tr><td class="h">8827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must have identical values in&quot;,</td></tr>
<tr><td class="h">8828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; attribute &#39;filter_only&#39;&quot;</td></tr>
<tr><td class="h">8829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8830</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8831</td><td colspan="7"></td></tr><tr><td class="h">8832</td><td><div class="c3">56</div><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>45</div><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $in_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8833</td><td colspan="7"></td></tr><tr><td class="h">8834</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# no_nat_set is known to be identical inside &#39;local&#39; cluster,</td></tr>
<tr><td class="h">8835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because attribute &#39;bind_nat&#39; is not valid at &#39;local&#39; routers.</td></tr>
<tr><td class="h">8836</td><td><div class="c3">118</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8836">67</a></div></td><td></td><td></td><td><div>228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_nat_set ||= $in_intf-&gt;{no_nat_set};</td></tr>
<tr><td class="h">8837</td><td><div class="c3">118</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8837">67</a></div></td><td></td><td></td><td><div>217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info-&gt;{no_nat_set} ||= $no_nat_set;</td></tr>
<tr><td class="h">8838</td><td><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $in_intf-&gt;{zone};</td></tr>
<tr><td class="h">8839</td><td><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone_cluster = $zone0-&gt;{zone_cluster};</td></tr>
<tr><td class="h">8840</td><td><div class="c3">118</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8840">50</a></div></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone ($zone_cluster ? @$zone_cluster : ($zone0)) {</td></tr>
<tr><td class="h">8841</td><td><div class="c3">118</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8841">50</a></div></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone-&gt;{disabled};</td></tr>
<tr><td class="h">8842</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8842">100</a></div></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone-&gt;{local_mark};</td></tr>
<tr><td class="h">8843</td><td colspan="7"></td></tr><tr><td class="h">8844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Needed for local_secondary optimization.</td></tr>
<tr><td class="h">8845</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{local_mark} = $local_mark;</td></tr>
<tr><td class="h">8846</td><td colspan="7"></td></tr><tr><td class="h">8847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All networks in local zone must match {filter_only}.</td></tr>
<tr><td class="h">8848</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETWORK:</td></tr>
<tr><td class="h">8849</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} }) {</td></tr>
<tr><td class="h">8850</td><td><div class="c3">96</div><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>75</div><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{ address($network, $no_nat_set) };</td></tr>
<tr><td class="h">8851</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@$filter_only) {</td></tr>
<tr><td class="h">8852</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($i, $m) = @$pair;</td></tr>
<tr><td class="h">8853</td><td><div class="c3">114</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8853">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8853">67</a></div></td><td></td><td></td><td><div>299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($mask &gt;= $m &amp;&amp; match_ip($ip, $i, $m)) {</td></tr>
<tr><td class="h">8854</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$matched{&quot;$i/$m&quot;} = 1;</td></tr>
<tr><td class="h">8855</td><td colspan="7"></td></tr><tr><td class="h">8856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find supernets of $network, that match $pair.</td></tr>
<tr><td class="h">8857</td><td><div class="c3">94</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8857">50</a></div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($mask &gt; $m) {</td></tr>
<tr><td class="h">8858</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark_supernets-&gt;($network, $i, $m);</td></tr>
<tr><td class="h">8859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8860</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NETWORK;</td></tr>
<tr><td class="h">8861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8864</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$network-&gt;{name} doesn&#39;t match attribute&quot;,</td></tr>
<tr><td class="h">8865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;filter_only&#39; of $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">8866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8868</td><td colspan="7"></td></tr><tr><td class="h">8869</td><td><div class="c3">96</div><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>89</div><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8870</td><td><div class="c3">148</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8870">100</a></div></td><td></td><td></td><td></td><td><div>448</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $in_intf;</td></tr>
<tr><td class="h">8871</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router2 = $out_intf-&gt;{router};</td></tr>
<tr><td class="h">8872</td><td><div class="c3">52</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8872">50</a></div></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $router2-&gt;{managed} or next;</td></tr>
<tr><td class="h">8873</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8873">100</a></div></td><td></td><td></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $managed !~ /^local/;</td></tr>
<tr><td class="h">8874</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8874">100</a></div></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router2-&gt;{local_mark};</td></tr>
<tr><td class="h">8875</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$walk-&gt;($router2);</td></tr>
<tr><td class="h">8876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8879</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8880</td><td colspan="7"></td></tr><tr><td class="h">8881</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$walk-&gt;($router0);</td></tr>
<tr><td class="h">8882</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $info;</td></tr>
<tr><td class="h">8883</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$local_mark++;</td></tr>
<tr><td class="h">8884</td><td colspan="7"></td></tr><tr><td class="h">8885</td><td><div class="c3">40</div><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>30</div><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@{ $router0-&gt;{filter_only} }) {</td></tr>
<tr><td class="h">8886</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($i, $m) = @$pair;</td></tr>
<tr><td class="h">8887</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8887">100</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$matched{&quot;$i/$m&quot;} and next;</td></tr>
<tr><td class="h">8888</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip($i);</td></tr>
<tr><td class="h">8889</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = mask2prefix($m);</td></tr>
<tr><td class="h">8890</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Useless $ip/$prefix in attribute &#39;filter_only&#39;&quot;,</td></tr>
<tr><td class="h">8891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $router0-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8894</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>749</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@result;</td></tr>
<tr><td class="h">8895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8896</td><td colspan="7"></td></tr><tr><td class="h">8897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark networks and aggregates, that are filtered at some</td></tr>
<tr><td class="h">8898</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># managed=local devices.</td></tr>
<tr><td class="h">8899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A network is marked by adding the number of the corresponding</td></tr>
<tr><td class="h">8900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># managed=local cluster as key to a hash in attribute {filter_at}.</td></tr>
<tr><td class="h">8901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_managed_local {</td></tr>
<tr><td class="h">8902</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8902">486</a></div></td><td><div class="c0">0</div></td><td><div>659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $managed_local_clusters = get_managed_local_clusters();</td></tr>
<tr><td class="h">8903</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $cluster (@$managed_local_clusters) {</td></tr>
<tr><td class="h">8904</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($no_nat_set, $filter_only, $mark) =</td></tr>
<tr><td class="h">8905</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$cluster}{qw(no_nat_set filter_only mark)};</td></tr>
<tr><td class="h">8906</td><td colspan="7"></td></tr><tr><td class="h">8907</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mark_networks;</td></tr>
<tr><td class="h">8908</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark_networks = sub {</td></tr>
<tr><td class="h">8909</td><td><div class="c3">124</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8909">124</a></div></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($networks) = @_;</td></tr>
<tr><td class="h">8910</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$networks) {</td></tr>
<tr><td class="h">8911</td><td colspan="7"></td></tr><tr><td class="h">8912</td><td><div class="c3">126</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8912">100</a></div></td><td></td><td></td><td></td><td><div>204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $subnetworks = $network-&gt;{networks}) {</td></tr>
<tr><td class="h">8913</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark_networks-&gt;($subnetworks);</td></tr>
<tr><td class="h">8914</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8915</td><td colspan="7"></td></tr><tr><td class="h">8916</td><td><div class="c3">126</div></td><td></td><td></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = get_nat_network($network, $no_nat_set);</td></tr>
<tr><td class="h">8917</td><td><div class="c3">126</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8917">50</a></div></td><td></td><td></td><td></td><td><div>203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_network-&gt;{hidden};</td></tr>
<tr><td class="h">8918</td><td><div class="c3">126</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8918">50</a></div></td><td></td><td></td><td></td><td><div>189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_network-&gt;{ip} eq &#39;unnumbered&#39;;</td></tr>
<tr><td class="h">8919</td><td><div class="c3">126</div><div class="c3">126</div></td><td></td><td></td><td></td><td></td><td><div>96</div><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_network}{qw(ip mask)};</td></tr>
<tr><td class="h">8920</td><td><div class="c3">126</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@$filter_only) {</td></tr>
<tr><td class="h">8921</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>163</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($i, $m) = @$pair;</td></tr>
<tr><td class="h">8922</td><td><div class="c3">178</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8922">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L8922">100</a></div></td><td></td><td></td><td><div>423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($mask &gt; $m &amp;&amp; match_ip($ip, $i, $m)) or next;</td></tr>
<tr><td class="h">8923</td><td colspan="7"></td></tr><tr><td class="h">8924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark network and enclosing aggregates.</td></tr>
<tr><td class="h">8925</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $network;</td></tr>
<tr><td class="h">8926</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($obj) {</td></tr>
<tr><td class="h">8927</td><td colspan="7"></td></tr><tr><td class="h">8928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Has already been processed as supernet of</td></tr>
<tr><td class="h">8929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# other network.</td></tr>
<tr><td class="h">8930</td><td><div class="c3">112</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8930">100</a></div></td><td></td><td></td><td></td><td><div>233</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if $obj-&gt;{filter_at}-&gt;{$mark};</td></tr>
<tr><td class="h">8931</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{filter_at}-&gt;{$mark} = 1;</td></tr>
<tr><td class="h">8932</td><td colspan="7"></td></tr><tr><td class="h">8933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Filter $obj-&gt;{name} at $mark&quot;;</td></tr>
<tr><td class="h">8934</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>337</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj = $obj-&gt;{up};</td></tr>
<tr><td class="h">8935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8938</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">8939</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">8940</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark_networks-&gt;($zone-&gt;{networks});</td></tr>
<tr><td class="h">8941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8942</td><td colspan="7"></td></tr><tr><td class="h">8943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Rules from general_permit should be applied to all devices</td></tr>
<tr><td class="h">8944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with &#39;managed=local&#39;.</td></tr>
<tr><td class="h">8945</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network_00-&gt;{filter_at}-&gt;{$mark} = 1;</td></tr>
<tr><td class="h">8946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8947</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>505</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8948</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8949</td><td colspan="7"></td></tr><tr><td class="h">8950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># group of reroute_permit networks must be expanded late, after areas,</td></tr>
<tr><td class="h">8951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># aggregates and subnets have been set up. Otherwise automatic groups</td></tr>
<tr><td class="h">8952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># wouldn&#39;t work.</td></tr>
<tr><td class="h">8953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">8954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Reroute permit is not allowed between different security zones.</td></tr>
<tr><td class="h">8955</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_reroute_permit {</td></tr>
<tr><td class="h">8956</td><td><div class="c3">688</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8956">688</a></div></td><td><div class="c0">0</div></td><td><div>832</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">8957</td><td><div class="c3">2026</div><div class="c3">2026</div></td><td></td><td></td><td></td><td></td><td><div>1504</div><div>2403</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">8958</td><td><div class="c3">3192</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8958">100</a></div></td><td></td><td></td><td></td><td><div>6456</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group = $interface-&gt;{reroute_permit} or next;</td></tr>
<tr><td class="h">8959</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$group =</td></tr>
<tr><td class="h">8960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand_group($group, &quot;&#39;reroute_permit&#39; of $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">8961</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @checked;</td></tr>
<tr><td class="h">8962</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$group) {</td></tr>
<tr><td class="h">8963</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8963">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_network($obj)) {</td></tr>
<tr><td class="h">8964</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_zone = $obj-&gt;{zone};</td></tr>
<tr><td class="h">8965</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8965">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!zone_eq($net_zone, $zone)) {</td></tr>
<tr><td class="h">8966</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Invalid reroute_permit for $obj-&gt;{name} &quot;,</td></tr>
<tr><td class="h">8968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;at $interface-&gt;{name}:&quot;,</td></tr>
<tr><td class="h">8969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; different security zones&quot;</td></tr>
<tr><td class="h">8970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8973</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @checked, $obj;</td></tr>
<tr><td class="h">8974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8975</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">8977</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">8978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$obj-&gt;{name} not allowed in attribute&quot;,</td></tr>
<tr><td class="h">8979</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;reroute_permit&#39; of $interface-&gt;{name}&quot;</td></tr>
<tr><td class="h">8980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">8981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8982</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8983</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{reroute_permit} = \@checked;</td></tr>
<tr><td class="h">8984</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">8986</td><td><div class="c3">688</div></td><td></td><td></td><td></td><td></td><td><div>658</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">8987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">8988</td><td colspan="7"></td></tr><tr><td class="h">8989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">8990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;:</td></tr>
<tr><td class="h">8991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_managed_hosts_to_aggregate {</td></tr>
<tr><td class="h">8992</td><td><div class="c3">336</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L8992">336</a></div></td><td><div class="c0">0</div></td><td><div>323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aggregate) = @_;</td></tr>
<tr><td class="h">8993</td><td colspan="7"></td></tr><tr><td class="h">8994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect managed hosts of sub-networks.</td></tr>
<tr><td class="h">8995</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>340</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $networks = $aggregate-&gt;{networks};</td></tr>
<tr><td class="h">8996</td><td><div class="c3">336</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8996">100</a></div></td><td></td><td></td><td></td><td><div>475</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@$networks) {</td></tr>
<tr><td class="h">8997</td><td><div class="c3">268</div></td><td></td><td></td><td></td><td></td><td><div>320</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$networks) {</td></tr>
<tr><td class="h">8998</td><td><div class="c3">312</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L8998">100</a></div></td><td></td><td></td><td></td><td><div>865</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed_hosts = $network-&gt;{managed_hosts} or next;</td></tr>
<tr><td class="h">8999</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $aggregate-&gt;{managed_hosts} }, @$managed_hosts);</td></tr>
<tr><td class="h">9000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9002</td><td colspan="7"></td></tr><tr><td class="h">9003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect matching managed hosts of all networks of zone.</td></tr>
<tr><td class="h">9004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore sub-networks of aggregate, because they would have been</td></tr>
<tr><td class="h">9005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# found in $networks above.</td></tr>
<tr><td class="h">9006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9007</td><td><div class="c3">68</div><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>69</div><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$aggregate}{qw(ip mask)};</td></tr>
<tr><td class="h">9008</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $aggregate-&gt;{zone};</td></tr>
<tr><td class="h">9009</td><td><div class="c3">68</div><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>56</div><div>104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} }) {</td></tr>
<tr><td class="h">9010</td><td><div class="c3">62</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9010">100</a></div></td><td></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{mask} &gt; $mask;</td></tr>
<tr><td class="h">9011</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9011">100</a></div></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed_hosts = $network-&gt;{managed_hosts} or next;</td></tr>
<tr><td class="h">9012</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">9013</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $aggregate-&gt;{managed_hosts} },</td></tr>
<tr><td class="h">9014</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { match_ip($_-&gt;{ip}, $ip, $mask) } @$managed_hosts</td></tr>
<tr><td class="h">9015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9018</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>524</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9020</td><td colspan="7"></td></tr><tr><td class="h">9021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">9022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Borders of security zones are</td></tr>
<tr><td class="h">9023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># a) interfaces of managed devices and</td></tr>
<tr><td class="h">9024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># b) interfaces of devices, which have at least one pathrestriction applied.</td></tr>
<tr><td class="h">9025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">9026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># For each security zone create a zone object.</td></tr>
<tr><td class="h">9027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Link each interface at the border with the zone and vice versa.</td></tr>
<tr><td class="h">9028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Additionally link each network and unmanaged router with the zone.</td></tr>
<tr><td class="h">9029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Add a list of all its numbered networks to the zone.</td></tr>
<tr><td class="h">9030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">9031</td><td colspan="7"></td></tr><tr><td class="h">9032</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Link aggregate and zone via references in both objects, set</td></tr>
<tr><td class="h">9034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregate properties according to those of the linked zone.</td></tr>
<tr><td class="h">9035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Store aggregates in @networks (providing all srcs and dsts).</td></tr>
<tr><td class="h">9036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_aggregate_to_zone {</td></tr>
<tr><td class="h">9037</td><td><div class="c3">336</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9037">336</a></div></td><td><div class="c0">0</div></td><td><div>406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aggregate, $zone, $key) = @_;</td></tr>
<tr><td class="h">9038</td><td colspan="7"></td></tr><tr><td class="h">9039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Link aggregate with zone.</td></tr>
<tr><td class="h">9040</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{zone} = $zone;</td></tr>
<tr><td class="h">9041</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>475</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{ipmask2aggregate}-&gt;{$key} = $aggregate;</td></tr>
<tr><td class="h">9042</td><td colspan="7"></td></tr><tr><td class="h">9043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Take a new array for each aggregate, otherwise we would share</td></tr>
<tr><td class="h">9044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the same array between different aggregates.</td></tr>
<tr><td class="h">9045</td><td><div class="c3">336</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9045">100</a></div></td><td></td><td></td><td><div>771</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{networks} ||= [];&nbsp;&nbsp;# Has to be initialized, even if it is empty</td></tr>
<tr><td class="h">9046</td><td colspan="7"></td></tr><tr><td class="h">9047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Set aggregate properties</td></tr>
<tr><td class="h">9048</td><td><div class="c3">336</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9048">50</a></div></td><td></td><td></td><td></td><td><div>554</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{is_tunnel}&nbsp;&nbsp;&nbsp;&nbsp;and $aggregate-&gt;{is_tunnel}&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">9049</td><td><div class="c3">336</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9049">100</a></div></td><td></td><td></td><td></td><td><div>526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{has_id_hosts} and $aggregate-&gt;{has_id_hosts} = 1;</td></tr>
<tr><td class="h">9050</td><td colspan="7"></td></tr><tr><td class="h">9051</td><td><div class="c3">336</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9051">50</a></div></td><td></td><td></td><td></td><td><div>473</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($zone-&gt;{disabled}) {</td></tr>
<tr><td class="h">9052</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">9053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9054</td><td colspan="7"></td></tr><tr><td class="h">9055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Store aggregate reference in global network hash</td></tr>
<tr><td class="h">9056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9057</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>361</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @networks, $aggregate;&nbsp;&nbsp;&nbsp;&nbsp;# @networks provides all srcs/dsts</td></tr>
<tr><td class="h">9058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9059</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>489</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9061</td><td colspan="7"></td></tr><tr><td class="h">9062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Update relations {networks}, {up} and {owner} for implicitly defined</td></tr>
<tr><td class="h">9064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># aggregates.</td></tr>
<tr><td class="h">9065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Remember:</td></tr>
<tr><td class="h">9066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># {up} is relation inside set of all networks and aggregates.</td></tr>
<tr><td class="h">9067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># {networks} is attribute of aggregates and networks,</td></tr>
<tr><td class="h">9068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but value is list of networks.</td></tr>
<tr><td class="h">9069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_implicit_aggregate_to_zone {</td></tr>
<tr><td class="h">9070</td><td><div class="c3">228</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9070">228</a></div></td><td><div class="c0">0</div></td><td><div>261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aggregate, $zone, $key) = @_;</td></tr>
<tr><td class="h">9071</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = split &#39;/&#39;, $key;</td></tr>
<tr><td class="h">9072</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ipmask2aggregate = $zone-&gt;{ipmask2aggregate};</td></tr>
<tr><td class="h">9073</td><td colspan="7"></td></tr><tr><td class="h">9074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect all aggregates, networks and subnets of current zone.</td></tr>
<tr><td class="h">9075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Get aggregates in deterministic order.</td></tr>
<tr><td class="h">9076</td><td><div class="c3">228</div><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>328</div><div>292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @objects = @{$ipmask2aggregate}{ sort keys %$ipmask2aggregate };</td></tr>
<tr><td class="h">9077</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $add_subnets;</td></tr>
<tr><td class="h">9078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$add_subnets = sub {</td></tr>
<tr><td class="h">9079</td><td><div class="c3">272</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9079">272</a></div></td><td></td><td><div>265</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network) = @_;</td></tr>
<tr><td class="h">9080</td><td><div class="c3">272</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9080">100</a></div></td><td></td><td></td><td></td><td><div>755</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnets = $network-&gt;{networks} or return;</td></tr>
<tr><td class="h">9081</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @objects, @$subnets;</td></tr>
<tr><td class="h">9082</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$add_subnets-&gt;($_) for @$subnets;</td></tr>
<tr><td class="h">9083</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>689</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">9084</td><td><div class="c3">228</div><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>219</div><div>343</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @objects, @{ $zone-&gt;{networks} };</td></tr>
<tr><td class="h">9085</td><td><div class="c3">228</div><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>200</div><div>476</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$add_subnets-&gt;($_) for @{ $zone-&gt;{networks} };</td></tr>
<tr><td class="h">9086</td><td colspan="7"></td></tr><tr><td class="h">9087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect all objects being larger and smaller than new aggregate.</td></tr>
<tr><td class="h">9088</td><td><div class="c3">228</div><div class="c3">302</div></td><td></td><td></td><td></td><td></td><td><div>287</div><div>601</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @larger&nbsp;&nbsp;= grep { $_-&gt;{mask} &lt; $mask } @objects;</td></tr>
<tr><td class="h">9089</td><td><div class="c3">228</div><div class="c3">302</div></td><td></td><td></td><td></td><td></td><td><div>238</div><div>494</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @smaller = grep { $_-&gt;{mask} &gt; $mask } @objects;</td></tr>
<tr><td class="h">9090</td><td colspan="7"></td></tr><tr><td class="h">9091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find subnets of new aggregate.</td></tr>
<tr><td class="h">9092</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>280</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@smaller) {</td></tr>
<tr><td class="h">9093</td><td><div class="c3">278</div><div class="c3">278</div></td><td></td><td></td><td></td><td></td><td><div>236</div><div>399</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($i, $m) = @{$obj}{qw(ip mask)};</td></tr>
<tr><td class="h">9094</td><td><div class="c3">278</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9094">100</a></div></td><td></td><td></td><td></td><td><div>490</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_ip($i, $ip, $mask) or next;</td></tr>
<tr><td class="h">9095</td><td colspan="7"></td></tr><tr><td class="h">9096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore sub-subnets, i.e. supernet is smaller than new aggregate.</td></tr>
<tr><td class="h">9097</td><td><div class="c3">246</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9097">100</a></div></td><td></td><td></td><td></td><td><div>1101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $up = $obj-&gt;{up}) {</td></tr>
<tr><td class="h">9098</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9098">100</a></div></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $up-&gt;{mask} &gt;= $mask;</td></tr>
<tr><td class="h">9099</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9100</td><td><div class="c3">222</div></td><td></td><td></td><td></td><td></td><td><div>258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{up} = $aggregate;</td></tr>
<tr><td class="h">9101</td><td colspan="7"></td></tr><tr><td class="h">9102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$obj-&gt;{name} -up1-&gt; $aggregate-&gt;{name}&quot;;</td></tr>
<tr><td class="h">9103</td><td><div class="c3">222</div></td><td></td><td></td><td></td><td></td><td><div>681</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">9104</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $aggregate-&gt;{networks} },</td></tr>
<tr><td class="h">9105</td><td><div class="c3">222</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9105">100</a></div></td><td></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{is_aggregate} ? @{ $obj-&gt;{networks} } : $obj</td></tr>
<tr><td class="h">9106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9108</td><td colspan="7"></td></tr><tr><td class="h">9109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find supernet of new aggregate.</td></tr>
<tr><td class="h">9110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Iterate from smaller to larger supernets.</td></tr>
<tr><td class="h">9111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Stop after smallest supernet has been found.</td></tr>
<tr><td class="h">9112</td><td><div class="c3">228</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>434</div><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (sort { $a-&gt;{mask} &lt; $b-&gt;{mask} } @larger) {</td></tr>
<tr><td class="h">9113</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($i, $m) = @{$obj}{qw(ip mask)};</td></tr>
<tr><td class="h">9114</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9114">100</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_ip($ip, $i, $m) or next;</td></tr>
<tr><td class="h">9115</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{up} = $obj;</td></tr>
<tr><td class="h">9116</td><td colspan="7"></td></tr><tr><td class="h">9117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$aggregate-&gt;{name} -up2-&gt; $obj-&gt;{name}&quot;;</td></tr>
<tr><td class="h">9118</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">9119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9120</td><td colspan="7"></td></tr><tr><td class="h">9121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Inherit owner from smallest supernet having owner or from zone.</td></tr>
<tr><td class="h">9122</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>236</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $up = $aggregate-&gt;{up};</td></tr>
<tr><td class="h">9123</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $owner;</td></tr>
<tr><td class="h">9124</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ($up) {</td></tr>
<tr><td class="h">9125</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9125">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$owner = $up-&gt;{owner} and last;</td></tr>
<tr><td class="h">9126</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = $up-&gt;{up};</td></tr>
<tr><td class="h">9127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9128</td><td><div class="c3">228</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9128">67</a></div></td><td></td><td></td><td><div>653</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$owner ||= $zone-&gt;{owner};</td></tr>
<tr><td class="h">9129</td><td><div class="c3">228</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9129">100</a></div></td><td></td><td></td><td></td><td><div>333</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$owner and $aggregate-&gt;{owner} = $owner;</td></tr>
<tr><td class="h">9130</td><td colspan="7"></td></tr><tr><td class="h">9131</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>307</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_aggregate_to_zone($aggregate, $zone, $key);</td></tr>
<tr><td class="h">9132</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>288</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_managed_hosts_to_aggregate($aggregate);</td></tr>
<tr><td class="h">9133</td><td><div class="c3">228</div></td><td></td><td></td><td></td><td></td><td><div>386</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9135</td><td colspan="7"></td></tr><tr><td class="h">9136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Process all explicitly defined aggregates. Check proper usage of</td></tr>
<tr><td class="h">9138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregates. For every aggregate, link aggregate objects to all</td></tr>
<tr><td class="h">9139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zones inside the zone cluster containing the aggregates link</td></tr>
<tr><td class="h">9140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network and set aggregate and zone properties. Add aggregate</td></tr>
<tr><td class="h">9141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects to global @networks array.</td></tr>
<tr><td class="h">9142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Has to be called after zones have been set up. But before</td></tr>
<tr><td class="h">9143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_subnets_in_zone calculates {up} and {networks} relation.</td></tr>
<tr><td class="h">9144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_aggregates {</td></tr>
<tr><td class="h">9145</td><td colspan="7"></td></tr><tr><td class="h">9146</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9146">736</a></div></td><td><div class="c0">0</div></td><td><div>775</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @aggregates_in_cluster;&nbsp;&nbsp;&nbsp;&nbsp;# Collect all aggregates inside clusters</td></tr>
<tr><td class="h">9147</td><td colspan="7"></td></tr><tr><td class="h">9148</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1350</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $name (sort keys %aggregates) {</td></tr>
<tr><td class="h">9149</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aggregate = $aggregates{$name};</td></tr>
<tr><td class="h">9150</td><td><div class="c3">106</div><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>98</div><div>206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @{ delete($aggregate-&gt;{link}) };</td></tr>
<tr><td class="h">9151</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err;</td></tr>
<tr><td class="h">9152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router;</td></tr>
<tr><td class="h">9153</td><td colspan="7"></td></tr><tr><td class="h">9154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure aggregates to be linked to networks only</td></tr>
<tr><td class="h">9155</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9155">100</a></div></td><td></td><td></td><td></td><td><div>235</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type ne &#39;network&#39;) {</td></tr>
<tr><td class="h">9156</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$aggregate-&gt;{name} must not be linked to $type:$name&quot;);</td></tr>
<tr><td class="h">9157</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">9158</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9160</td><td colspan="7"></td></tr><tr><td class="h">9161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure aggregate link to exist/disable aggregates without active links</td></tr>
<tr><td class="h">9162</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $networks{$name};</td></tr>
<tr><td class="h">9163</td><td><div class="c3">104</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9163">50</a></div></td><td></td><td></td><td></td><td><div>192</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $network) {</td></tr>
<tr><td class="h">9164</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Referencing undefined $type:$name&quot;,</td></tr>
<tr><td class="h">9165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $aggregate-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9166</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">9167</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9169</td><td><div class="c3">104</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9169">100</a></div></td><td></td><td></td><td></td><td><div>203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{disabled}) {</td></tr>
<tr><td class="h">9170</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{disabled} = 1;</td></tr>
<tr><td class="h">9171</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9173</td><td colspan="7"></td></tr><tr><td class="h">9174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reference network link in security zone.</td></tr>
<tr><td class="h">9175</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $network-&gt;{zone};</td></tr>
<tr><td class="h">9176</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{link} = $network;&nbsp;&nbsp;&nbsp;&nbsp;# only used in cut-netspoc</td></tr>
<tr><td class="h">9177</td><td colspan="7"></td></tr><tr><td class="h">9178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure aggregate and network private status to be equal</td></tr>
<tr><td class="h">9179</td><td><div class="c3">102</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9179">50</a></div></td><td></td><td></td><td><div>311</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private1 = $aggregate-&gt;{private} || &#39;public&#39;;</td></tr>
<tr><td class="h">9180</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private2 = $network-&gt;{private};</td></tr>
<tr><td class="h">9181</td><td><div class="c3">102</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9181">50</a></div></td><td></td><td></td><td><div>308</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private2 ||= &#39;public&#39;;</td></tr>
<tr><td class="h">9182</td><td><div class="c3">102</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9182">50</a></div></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private1 eq $private2</td></tr>
<tr><td class="h">9183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;$private1 $aggregate-&gt;{name} must not be linked&quot;,</td></tr>
<tr><td class="h">9184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to $private2 $type:$name&quot;);</td></tr>
<tr><td class="h">9185</td><td colspan="7"></td></tr><tr><td class="h">9186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure that no other aggregate with same IP and mask exists in cluster</td></tr>
<tr><td class="h">9187</td><td><div class="c3">102</div><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>104</div><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$aggregate}{qw(ip mask)};</td></tr>
<tr><td class="h">9188</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>215</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;$ip/$mask&quot;;</td></tr>
<tr><td class="h">9189</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = $zone-&gt;{zone_cluster};</td></tr>
<tr><td class="h">9190</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9190">100</a></div></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone2 ($cluster ? @$cluster : ($zone)) {</td></tr>
<tr><td class="h">9191</td><td><div class="c3">112</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9191">100</a></div></td><td></td><td></td><td></td><td><div>318</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $zone2-&gt;{ipmask2aggregate}-&gt;{$key}) {</td></tr>
<tr><td class="h">9192</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Duplicate $other-&gt;{name} and $aggregate-&gt;{name}&quot;,</td></tr>
<tr><td class="h">9193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $zone-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9196</td><td colspan="7"></td></tr><tr><td class="h">9197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect aggregates inside clusters</td></tr>
<tr><td class="h">9198</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9198">100</a></div></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($cluster) {</td></tr>
<tr><td class="h">9199</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@aggregates_in_cluster, $aggregate);</td></tr>
<tr><td class="h">9200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9201</td><td colspan="7"></td></tr><tr><td class="h">9202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use aggregate with ip 0/0 to set attributes of all zones in cluster.</td></tr>
<tr><td class="h">9203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">9204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Even NAT is moved to zone for aggregate 0/0 although we</td></tr>
<tr><td class="h">9205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# retain NAT at other aggregates.</td></tr>
<tr><td class="h">9206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is an optimization to prevent the creation of many aggregates 0/0</td></tr>
<tr><td class="h">9207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# if only inheritance of NAT from area to network is needed.</td></tr>
<tr><td class="h">9208</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9208">100</a></div></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($mask == 0) {</td></tr>
<tr><td class="h">9209</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(has_unenforceable owner nat)) {</td></tr>
<tr><td class="h">9210</td><td><div class="c3">174</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9210">100</a></div></td><td></td><td></td><td></td><td><div>359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $v = delete $aggregate-&gt;{$attr}) {</td></tr>
<tr><td class="h">9211</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9211">100</a></div></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone2 ($cluster ? @$cluster : ($zone)) {</td></tr>
<tr><td class="h">9212</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone2-&gt;{$attr} = $v;</td></tr>
<tr><td class="h">9213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9217</td><td colspan="7"></td></tr><tr><td class="h">9218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Link aggragate and zone (also setting zone{ipmask2aggregate}</td></tr>
<tr><td class="h">9219</td><td><div class="c3">102</div></td><td></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_aggregate_to_zone($aggregate, $zone, $key);</td></tr>
<tr><td class="h">9220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9221</td><td colspan="7"></td></tr><tr><td class="h">9222</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# add aggregate to all zones in the zone cluster</td></tr>
<tr><td class="h">9223</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>910</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $aggregate (@aggregates_in_cluster) {</td></tr>
<tr><td class="h">9224</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duplicate_aggregate_to_cluster($aggregate);</td></tr>
<tr><td class="h">9225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9226</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>675</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9227</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter: $aggregate object reference, $implicit flag</td></tr>
<tr><td class="h">9230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Create an aggregate object for every zone inside the zones cluster</td></tr>
<tr><td class="h">9231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containing the aggregates link-network.</td></tr>
<tr><td class="h">9232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : From users point of view, an aggregate refers to networks of a zone</td></tr>
<tr><td class="h">9233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster. Internally, an aggregate object represents a set of</td></tr>
<tr><td class="h">9234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;networks inside a zone. Therefeore, every zone inside a cluster</td></tr>
<tr><td class="h">9235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets its own copy of the defined aggregate to collect the zones</td></tr>
<tr><td class="h">9236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;networks matching the aggregates IP address.</td></tr>
<tr><td class="h">9237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># TDOD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Aggregate may be a non aggregate network,</td></tr>
<tr><td class="h">9238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g. a network with ip/mask 0/0. ??</td></tr>
<tr><td class="h">9239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub duplicate_aggregate_to_cluster {</td></tr>
<tr><td class="h">9240</td><td><div class="c3">22</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9240">22</a></div></td><td><div class="c0">0</div></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($aggregate, $implicit) = @_;</td></tr>
<tr><td class="h">9241</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = $aggregate-&gt;{zone}-&gt;{zone_cluster};</td></tr>
<tr><td class="h">9242</td><td><div class="c3">22</div><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>22</div><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$aggregate}{qw(ip mask)};</td></tr>
<tr><td class="h">9243</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $key = &quot;$ip/$mask&quot;;</td></tr>
<tr><td class="h">9244</td><td colspan="7"></td></tr><tr><td class="h">9245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process every zone of the zone cluster</td></tr>
<tr><td class="h">9246</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@$cluster) {</td></tr>
<tr><td class="h">9247</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9247">100</a></div></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone-&gt;{ipmask2aggregate}-&gt;{$key};</td></tr>
<tr><td class="h">9248</td><td colspan="7"></td></tr><tr><td class="h">9249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Dupl. $aggregate-&gt;{name} to $zone-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9250</td><td colspan="7"></td></tr><tr><td class="h">9251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create new aggregate object for every zone inside the cluster</td></tr>
<tr><td class="h">9252</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aggregate2 = new(</td></tr>
<tr><td class="h">9253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">9254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $aggregate-&gt;{name},</td></tr>
<tr><td class="h">9255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_aggregate =&gt; 1,</td></tr>
<tr><td class="h">9256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $aggregate-&gt;{ip},</td></tr>
<tr><td class="h">9257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $aggregate-&gt;{mask},</td></tr>
<tr><td class="h">9258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9259</td><td colspan="7"></td></tr><tr><td class="h">9260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Link new aggregate object and cluster</td></tr>
<tr><td class="h">9261</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9261">100</a></div></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($implicit) {</td></tr>
<tr><td class="h">9262</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_implicit_aggregate_to_zone($aggregate2, $zone, $key);</td></tr>
<tr><td class="h">9263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9265</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_aggregate_to_zone($aggregate2, $zone, $key);</td></tr>
<tr><td class="h">9266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9268</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9270</td><td colspan="7"></td></tr><tr><td class="h">9271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find aggregate referenced from any:[..].</td></tr>
<tr><td class="h">9273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Creates new anonymous aggregate if missing.</td></tr>
<tr><td class="h">9274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If zone is part of a zone_cluster,</td></tr>
<tr><td class="h">9275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># return aggregates for each zone of the cluster.</td></tr>
<tr><td class="h">9276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_any {</td></tr>
<tr><td class="h">9277</td><td><div class="c3">402</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9277">402</a></div></td><td><div class="c0">0</div></td><td><div>405</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $ip, $mask) = @_;</td></tr>
<tr><td class="h">9278</td><td><div class="c3">402</div></td><td></td><td></td><td></td><td></td><td><div>739</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &quot;$ip/$mask&quot;;</td></tr>
<tr><td class="h">9279</td><td><div class="c3">402</div></td><td></td><td></td><td></td><td></td><td><div>388</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = $zone-&gt;{zone_cluster};</td></tr>
<tr><td class="h">9280</td><td><div class="c3">402</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9280">100</a></div></td><td></td><td></td><td></td><td><div>764</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$zone-&gt;{ipmask2aggregate}-&gt;{$key}) {</td></tr>
<tr><td class="h">9281</td><td colspan="7"></td></tr><tr><td class="h">9282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check, if there is a network with same IP as the requested</td></tr>
<tr><td class="h">9283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# aggregate.&nbsp;&nbsp;If found, don&#39;t create a new aggregate in zone,</td></tr>
<tr><td class="h">9284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# but use the network instead. Otherwise {up} relation</td></tr>
<tr><td class="h">9285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# wouldn&#39;t be well defined.</td></tr>
<tr><td class="h">9286</td><td><div class="c3">210</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9286">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9286">100</a></div></td><td></td><td></td><td></td><td><div>330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">9287</td><td><div class="c3">268</div><div class="c3">230</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9287">100</a></div></td><td></td><td></td><td></td><td><div>1258</div><div>843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @networks = grep({ $_-&gt;{mask} == $mask &amp;&amp; $_-&gt;{ip} == $ip }</td></tr>
<tr><td class="h">9288</td><td><div class="c3">230</div></td><td></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { @{ $_-&gt;{networks} } } $cluster ? @$cluster : ($zone))</td></tr>
<tr><td class="h">9289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">9290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">9291</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9291">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@networks &gt; 1 and internal_err;</td></tr>
<tr><td class="h">9292</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network) = @networks;</td></tr>
<tr><td class="h">9293</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone2 = $network-&gt;{zone};</td></tr>
<tr><td class="h">9294</td><td colspan="7"></td></tr><tr><td class="h">9295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle $network like an aggregate.</td></tr>
<tr><td class="h">9296</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone2-&gt;{ipmask2aggregate}-&gt;{$key} = $network;</td></tr>
<tr><td class="h">9297</td><td colspan="7"></td></tr><tr><td class="h">9298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create aggregates in cluster, using the name of the network.</td></tr>
<tr><td class="h">9299</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9299">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duplicate_aggregate_to_cluster($network, 1) if $cluster;</td></tr>
<tr><td class="h">9300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9302</td><td colspan="7"></td></tr><tr><td class="h">9303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# any:[network:x] =&gt; any:[ip=i.i.i.i/pp &amp; network:x]</td></tr>
<tr><td class="h">9304</td><td><div class="c3">208</div></td><td></td><td></td><td></td><td></td><td><div>290</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $p_ip&nbsp;&nbsp;&nbsp;= print_ip($ip);</td></tr>
<tr><td class="h">9305</td><td><div class="c3">208</div></td><td></td><td></td><td></td><td></td><td><div>396</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = mask2prefix($mask);</td></tr>
<tr><td class="h">9306</td><td><div class="c3">208</div></td><td></td><td></td><td></td><td></td><td><div>247</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;= $zone-&gt;{name};</td></tr>
<tr><td class="h">9307</td><td><div class="c3">208</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9307">100</a></div></td><td></td><td></td><td></td><td><div>758</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name =~ s/\[/[ip=$p_ip\/$prefix &amp; / if $prefix != 0;</td></tr>
<tr><td class="h">9308</td><td><div class="c3">208</div></td><td></td><td></td><td></td><td></td><td><div>319</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aggregate = new(</td></tr>
<tr><td class="h">9309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">9310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $name,</td></tr>
<tr><td class="h">9311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_aggregate =&gt; 1,</td></tr>
<tr><td class="h">9312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $ip,</td></tr>
<tr><td class="h">9313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $mask,</td></tr>
<tr><td class="h">9314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9315</td><td><div class="c3">208</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9315">50</a></div></td><td></td><td></td><td></td><td><div>395</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $private = $zone-&gt;{private}) {</td></tr>
<tr><td class="h">9316</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;{private} = $private;</td></tr>
<tr><td class="h">9317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9318</td><td><div class="c3">208</div></td><td></td><td></td><td></td><td></td><td><div>296</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link_implicit_aggregate_to_zone($aggregate, $zone, $key);</td></tr>
<tr><td class="h">9319</td><td><div class="c3">208</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9319">100</a></div></td><td></td><td></td><td></td><td><div>410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duplicate_aggregate_to_cluster($aggregate, 1) if $cluster;</td></tr>
<tr><td class="h">9320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9322</td><td><div class="c3">402</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9322">100</a></div></td><td></td><td></td><td></td><td><div>547</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($cluster) {</td></tr>
<tr><td class="h">9323</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return get_cluster_aggregates($zone, $ip, $mask);</td></tr>
<tr><td class="h">9324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9326</td><td><div class="c3">374</div></td><td></td><td></td><td></td><td></td><td><div>1171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $zone-&gt;{ipmask2aggregate}-&gt;{$key};</td></tr>
<tr><td class="h">9327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9329</td><td colspan="7"></td></tr><tr><td class="h">9330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Get set of aggregates of a zone cluster.</td></tr>
<tr><td class="h">9331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Ignore zone having no aggregate from unnumbered network.</td></tr>
<tr><td class="h">9332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_cluster_aggregates {</td></tr>
<tr><td class="h">9333</td><td><div class="c3">28</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9333">28</a></div></td><td><div class="c0">0</div></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $ip, $mask) = @_;</td></tr>
<tr><td class="h">9334</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $key = &quot;$ip/$mask&quot;;</td></tr>
<tr><td class="h">9335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return</td></tr>
<tr><td class="h">9336</td><td><div class="c3">28</div><div class="c3">72</div><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9336">50</a></div></td><td></td><td></td><td></td><td><div>26</div><div>242</div><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{ipmask2aggregate}-&gt;{$key} || () } @{ $zone-&gt;{zone_cluster} };</td></tr>
<tr><td class="h">9337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9338</td><td colspan="7"></td></tr><tr><td class="h">9339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Collects all elements (networks, unmanaged routers, interfaces) of</td></tr>
<tr><td class="h">9341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a zone object and references the zone in its elements. Sets zone</td></tr>
<tr><td class="h">9342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property flags and private status.</td></tr>
<tr><td class="h">9343</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Unnumbered and tunnel networks are not referenced in zone objects,</td></tr>
<tr><td class="h">9344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as they are no valid src or dst.</td></tr>
<tr><td class="h">9345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_zone1 {</td></tr>
<tr><td class="h">9346</td><td><div class="c3">3108</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9346">3108</a></div></td><td><div class="c0">0</div></td><td><div>2954</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($network, $zone, $in_interface) = @_;</td></tr>
<tr><td class="h">9347</td><td colspan="7"></td></tr><tr><td class="h">9348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return if network was processed already (= loop was found).</td></tr>
<tr><td class="h">9349</td><td><div class="c3">3108</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9349">100</a></div></td><td></td><td></td><td></td><td><div>4849</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{zone}) {</td></tr>
<tr><td class="h">9350</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9352</td><td colspan="7"></td></tr><tr><td class="h">9353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Reference zone in network and vice versa...</td></tr>
<tr><td class="h">9354</td><td><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>3349</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{zone} = $zone;</td></tr>
<tr><td class="h">9355</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9355">100</a></div></td><td></td><td></td><td></td><td><div>6970</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not($network-&gt;{ip} =~ /^(?:unnumbered|tunnel)$/)) {&nbsp;&nbsp;&nbsp;# no valid src/dst</td></tr>
<tr><td class="h">9356</td><td><div class="c3">2961</div><div class="c3">2961</div></td><td></td><td></td><td></td><td></td><td><div>2203</div><div>4305</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $zone-&gt;{networks} }, $network;</td></tr>
<tr><td class="h">9357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9358</td><td colspan="7"></td></tr><tr><td class="h">9359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$network-&gt;{name} in $zone-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9360</td><td colspan="7"></td></tr><tr><td class="h">9361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Set zone property flags depending on network properties...</td></tr>
<tr><td class="h">9362</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9362">100</a></div></td><td></td><td></td><td></td><td><div>4924</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{ip} eq &#39;tunnel&#39; and $zone-&gt;{is_tunnel}&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">9363</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9363">100</a></div></td><td></td><td></td><td></td><td><div>4343</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{has_id_hosts}&nbsp;&nbsp;&nbsp;and $zone-&gt;{has_id_hosts} = 1;</td></tr>
<tr><td class="h">9364</td><td colspan="7"></td></tr><tr><td class="h">9365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check network &#39;private&#39; status and zone &#39;private&#39; status to be equal.</td></tr>
<tr><td class="h">9366</td><td><div class="c3">3036</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9366">100</a></div></td><td></td><td></td><td><div>7734</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $private1 = $network-&gt;{private} || &#39;public&#39;;</td></tr>
<tr><td class="h">9367</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9367">100</a></div></td><td></td><td></td><td></td><td><div>4412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($zone-&gt;{private}) {</td></tr>
<tr><td class="h">9368</td><td><div class="c3">884</div></td><td></td><td></td><td></td><td></td><td><div>778</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private2 = $zone-&gt;{private};</td></tr>
<tr><td class="h">9369</td><td><div class="c3">884</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9369">100</a></div></td><td></td><td></td><td></td><td><div>1409</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($private1 ne $private2) {</td></tr>
<tr><td class="h">9370</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other = $zone-&gt;{networks}-&gt;[0];</td></tr>
<tr><td class="h">9371</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">9372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;All networks of $zone-&gt;{name} must have&quot;,</td></tr>
<tr><td class="h">9373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; identical &#39;private&#39; status\n&quot;,</td></tr>
<tr><td class="h">9374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $other-&gt;{name}: $private2\n&quot;,</td></tr>
<tr><td class="h">9375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $network-&gt;{name}: $private1&quot;</td></tr>
<tr><td class="h">9376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9379</td><td colspan="7"></td></tr><tr><td class="h">9380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Set zone private status (attribute will be removed if value is &#39;public&#39;)</td></tr>
<tr><td class="h">9381</td><td><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>3106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{private} =</td></tr>
<tr><td class="h">9382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private1;&nbsp;&nbsp;&nbsp;&nbsp;# TODO: is set in every iteration. else clause?</td></tr>
<tr><td class="h">9383</td><td colspan="7"></td></tr><tr><td class="h">9384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Proceed with adjacent elements...</td></tr>
<tr><td class="h">9385</td><td><div class="c3">3036</div><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>2280</div><div>3986</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">9386</td><td><div class="c3">4760</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9386">100</a></div></td><td></td><td></td><td></td><td><div>8911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_interface;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore Interface we came from.</td></tr>
<tr><td class="h">9387</td><td><div class="c3">3876</div></td><td></td><td></td><td></td><td></td><td><div>3449</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">9388</td><td colspan="7"></td></tr><tr><td class="h">9389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If its a zone delimiting router, reference interface in zone and v.v.</td></tr>
<tr><td class="h">9390</td><td><div class="c3">3876</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9390">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9390">100</a></div></td><td></td><td></td><td><div>7946</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed} or $router-&gt;{semi_managed}) {</td></tr>
<tr><td class="h">9391</td><td><div class="c3">3372</div></td><td></td><td></td><td></td><td></td><td><div>3289</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{zone} = $zone;</td></tr>
<tr><td class="h">9392</td><td><div class="c3">3372</div><div class="c3">3372</div></td><td></td><td></td><td></td><td></td><td><div>2445</div><div>6979</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $zone-&gt;{interfaces} }, $interface;</td></tr>
<tr><td class="h">9393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9395</td><td colspan="7"></td></tr><tr><td class="h">9396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#If its an unmanaged router, reference router in zone and v.v.</td></tr>
<tr><td class="h">9397</td><td><div class="c3">504</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9397">100</a></div></td><td></td><td></td><td></td><td><div>842</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{zone}; # Traverse each unmanaged router only once.</td></tr>
<tr><td class="h">9398</td><td><div class="c3">432</div></td><td></td><td></td><td></td><td></td><td><div>455</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{zone} = $zone; # added only to prevent double traversal</td></tr>
<tr><td class="h">9399</td><td><div class="c3">432</div><div class="c3">432</div></td><td></td><td></td><td></td><td></td><td><div>341</div><div>576</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $zone-&gt;{unmanaged_routers} }, $router;</td></tr>
<tr><td class="h">9400</td><td colspan="7"></td></tr><tr><td class="h">9401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Recursively add adjacent networks.</td></tr>
<tr><td class="h">9402</td><td><div class="c3">432</div><div class="c3">432</div></td><td></td><td></td><td></td><td></td><td><div>382</div><div>553</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">9403</td><td><div class="c3">1388</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9403">100</a></div></td><td></td><td></td><td></td><td><div>2789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $interface;&nbsp;&nbsp;# Ignore IF we came from.</td></tr>
<tr><td class="h">9404</td><td><div class="c3">956</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9404">50</a></div></td><td></td><td></td><td></td><td><div>1414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{disabled};</td></tr>
<tr><td class="h">9405</td><td><div class="c3">956</div></td><td></td><td></td><td></td><td></td><td><div>1524</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_zone1($out_interface-&gt;{network}, $zone, $out_interface);</td></tr>
<tr><td class="h">9406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9409</td><td><div class="c3">3036</div></td><td></td><td></td><td></td><td></td><td><div>4071</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9411</td><td colspan="7"></td></tr><tr><td class="h">9412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Collect zones connected by semi_managed devices into a cluster.</td></tr>
<tr><td class="h">9414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Tunnel_zones are not included in zone clusters, because</td></tr>
<tr><td class="h">9415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- it is useless in rules and</td></tr>
<tr><td class="h">9416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- we would get inconsistent owner since zone of tunnel</td></tr>
<tr><td class="h">9417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doesn&#39;t inherit from area.</td></tr>
<tr><td class="h">9418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_zone_cluster {</td></tr>
<tr><td class="h">9419</td><td><div class="c3">2152</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9419">2152</a></div></td><td><div class="c0">0</div></td><td><div>1999</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $in_interface, $zone_aref) = @_;</td></tr>
<tr><td class="h">9420</td><td colspan="7"></td></tr><tr><td class="h">9421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Reference zone in cluster object and vice versa</td></tr>
<tr><td class="h">9422</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9422">100</a></div></td><td></td><td></td><td></td><td><div>3774</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @$zone_aref, $zone if !$zone-&gt;{is_tunnel};</td></tr>
<tr><td class="h">9423</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{zone_cluster} = $zone_aref;</td></tr>
<tr><td class="h">9424</td><td colspan="7"></td></tr><tr><td class="h">9425</td><td><div class="c3">2152</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9425">100</a></div></td><td></td><td></td><td><div>5041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $private1 = $zone-&gt;{private} || &#39;public&#39;;</td></tr>
<tr><td class="h">9426</td><td colspan="7"></td></tr><tr><td class="h">9427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find zone interfaces connected to semi-managed routers...</td></tr>
<tr><td class="h">9428</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>1645</div><div>2734</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">9429</td><td><div class="c3">3372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9429">100</a></div></td><td></td><td></td><td></td><td><div>5584</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_interface;</td></tr>
<tr><td class="h">9430</td><td><div class="c3">3315</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9430">100</a></div></td><td></td><td></td><td></td><td><div>4890</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">9431</td><td><div class="c3">3201</div></td><td></td><td></td><td></td><td></td><td><div>2715</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">9432</td><td><div class="c3">3201</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9432">100</a></div></td><td></td><td></td><td></td><td><div>6261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{managed};</td></tr>
<tr><td class="h">9433</td><td><div class="c3">43</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9433">50</a></div></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{active_path};</td></tr>
<tr><td class="h">9434</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $router-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">9435</td><td colspan="7"></td></tr><tr><td class="h">9436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Process adjacent zones...</td></tr>
<tr><td class="h">9437</td><td><div class="c3">43</div><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>41</div><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">9438</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9438">100</a></div></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $interface;</td></tr>
<tr><td class="h">9439</td><td><div class="c3">59</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = $out_interface-&gt;{zone};</td></tr>
<tr><td class="h">9440</td><td><div class="c3">59</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9440">100</a></div></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $next-&gt;{zone_cluster};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#traverse zones only once</td></tr>
<tr><td class="h">9441</td><td><div class="c3">57</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9441">50</a></div></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">9442</td><td colspan="7"></td></tr><tr><td class="h">9443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for equal private status.</td></tr>
<tr><td class="h">9444</td><td><div class="c3">57</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9444">50</a></div></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private2 = $next-&gt;{private} || &#39;public&#39;;</td></tr>
<tr><td class="h">9445</td><td><div class="c3">57</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9445">100</a></div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$private1 eq $private2</td></tr>
<tr><td class="h">9446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">9447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Zones connected by $router-&gt;{name}&quot;,</td></tr>
<tr><td class="h">9448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must all have identical &#39;private&#39; status\n&quot;,</td></tr>
<tr><td class="h">9449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $zone-&gt;{name}: $private1\n&quot;,</td></tr>
<tr><td class="h">9450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $next-&gt;{name}: $private2&quot;</td></tr>
<tr><td class="h">9451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9452</td><td colspan="7"></td></tr><tr><td class="h">9453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add adjacent zone recursively.</td></tr>
<tr><td class="h">9454</td><td><div class="c3">57</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_zone_cluster($next, $out_interface, $zone_aref);</td></tr>
<tr><td class="h">9455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9457</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2454</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9459</td><td colspan="7"></td></tr><tr><td class="h">9460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Two zones are zone_eq, if</td></tr>
<tr><td class="h">9461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - zones are equal or</td></tr>
<tr><td class="h">9462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - both belong to the same zone cluster.</td></tr>
<tr><td class="h">9463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub zone_eq {</td></tr>
<tr><td class="h">9464</td><td><div class="c3">32</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9464">32</a></div></td><td><div class="c0">0</div></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone1, $zone2) = @_;</td></tr>
<tr><td class="h">9465</td><td><div class="c3">32</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9465">33</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9465">33</a></div></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return (($zone1-&gt;{zone_cluster} || $zone1) eq</td></tr>
<tr><td class="h">9466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($zone2-&gt;{zone_cluster} || $zone2));</td></tr>
<tr><td class="h">9467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9468</td><td colspan="7"></td></tr><tr><td class="h">9469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Collect zones and managed routers of an area object and set a</td></tr>
<tr><td class="h">9471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reference to the area in its zones and routers.</td></tr>
<tr><td class="h">9472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For areas with defined borders: Keep track of area borders found</td></tr>
<tr><td class="h">9473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;during area traversal.</td></tr>
<tr><td class="h">9474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For anchor/auto_border areas: fill {border} and {inclusive_border}</td></tr>
<tr><td class="h">9475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrays.</td></tr>
<tr><td class="h">9476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;: undef (or aref of interfaces, if invalid path was found).</td></tr>
<tr><td class="h">9477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_area1 {</td></tr>
<tr><td class="h">9478</td><td><div class="c3">372</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9478">372</a></div></td><td><div class="c0">0</div></td><td><div>347</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $area, $in_interface) = @_;</td></tr>
<tr><td class="h">9479</td><td colspan="7"></td></tr><tr><td class="h">9480</td><td><div class="c3">372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9480">100</a></div></td><td></td><td></td><td></td><td><div>767</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $obj-&gt;{areas}-&gt;{$area};&nbsp;&nbsp;&nbsp;&nbsp;# Found a loop.</td></tr>
<tr><td class="h">9481</td><td colspan="7"></td></tr><tr><td class="h">9482</td><td><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>549</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{areas}-&gt;{$area} = $area;&nbsp;&nbsp;# Find duplicate/overlapping areas or loops</td></tr>
<tr><td class="h">9483</td><td colspan="7"></td></tr><tr><td class="h">9484</td><td><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $is_zone = is_zone($obj);</td></tr>
<tr><td class="h">9485</td><td colspan="7"></td></tr><tr><td class="h">9486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Reference zones and managed routers in the corresponding area</td></tr>
<tr><td class="h">9487</td><td><div class="c3">364</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9487">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9487">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9487">33</a></div></td><td></td><td></td><td><div>688</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($is_zone) {</td></tr>
<tr><td class="h">9488</td><td><div class="c3">250</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9488">50</a></div></td><td></td><td></td><td></td><td><div>414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$obj-&gt;{is_tunnel}) {</td></tr>
<tr><td class="h">9489</td><td><div class="c3">250</div><div class="c3">250</div></td><td></td><td></td><td></td><td></td><td><div>192</div><div>333</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $area-&gt;{zones} }, $obj;</td></tr>
<tr><td class="h">9490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($obj-&gt;{managed} || $obj-&gt;{routing_only}) {</td></tr>
<tr><td class="h">9493</td><td><div class="c3">114</div><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>99</div><div>169</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $area-&gt;{managed_routers} }, $obj;</td></tr>
<tr><td class="h">9494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9495</td><td colspan="7"></td></tr><tr><td class="h">9496</td><td><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>350</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $auto_border = $area-&gt;{auto_border};</td></tr>
<tr><td class="h">9497</td><td><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>320</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $lookup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $area-&gt;{intf_lookup};</td></tr>
<tr><td class="h">9498</td><td colspan="7"></td></tr><tr><td class="h">9499</td><td><div class="c3">364</div><div class="c3">364</div></td><td></td><td></td><td></td><td></td><td><div>289</div><div>450</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $obj-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">9500</td><td colspan="7"></td></tr><tr><td class="h">9501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore interface we came from.</td></tr>
<tr><td class="h">9502</td><td><div class="c3">602</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9502">100</a></div></td><td></td><td></td><td></td><td><div>1261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_interface;</td></tr>
<tr><td class="h">9503</td><td colspan="7"></td></tr><tr><td class="h">9504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No further traversal at secondary interfaces</td></tr>
<tr><td class="h">9505</td><td><div class="c3">278</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9505">100</a></div></td><td></td><td></td><td></td><td><div>420</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">9506</td><td colspan="7"></td></tr><tr><td class="h">9507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For areas with defined borders, check if border was found...</td></tr>
<tr><td class="h">9508</td><td><div class="c3">270</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9508">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9508">100</a></div></td><td></td><td></td><td></td><td><div>577</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($lookup-&gt;{$interface}) {</td></tr>
<tr><td class="h">9509</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $is_inclusive = $interface-&gt;{is_inclusive};</td></tr>
<tr><td class="h">9510</td><td colspan="7"></td></tr><tr><td class="h">9511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reached border from wrong side or border classification wrong.</td></tr>
<tr><td class="h">9512</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9512">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9512">100</a></div></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($is_inclusive-&gt;{$area} xor !$is_zone) {</td></tr>
<tr><td class="h">9513</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [$interface];&nbsp;&nbsp;&nbsp;&nbsp;# will be collected to show invalid path</td></tr>
<tr><td class="h">9514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9515</td><td colspan="7"></td></tr><tr><td class="h">9516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ...mark found border in lookup hash.</td></tr>
<tr><td class="h">9517</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lookup-&gt;{$interface} = &#39;found&#39;;</td></tr>
<tr><td class="h">9518</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9520</td><td colspan="7"></td></tr><tr><td class="h">9521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For auto_border areas, just collect border/inclusive_border interface</td></tr>
<tr><td class="h">9522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($auto_border) {</td></tr>
<tr><td class="h">9523</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9523">100</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{is_border}) {</td></tr>
<tr><td class="h">9524</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9524">100</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">9525</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $area-&gt;{ $is_zone ? &#39;border&#39; : &#39;inclusive_border&#39; } },</td></tr>
<tr><td class="h">9526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface</td></tr>
<tr><td class="h">9527</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9528</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9531</td><td colspan="7"></td></tr><tr><td class="h">9532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Proceed traversal with next element</td></tr>
<tr><td class="h">9533</td><td><div class="c3">240</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9533">100</a></div></td><td></td><td></td><td></td><td><div>348</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = $interface-&gt;{ $is_zone ? &#39;router&#39; : &#39;zone&#39; };</td></tr>
<tr><td class="h">9534</td><td><div class="c3">240</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9534">100</a></div></td><td></td><td></td><td></td><td><div>450</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $err_path = set_area1($next, $area, $interface)) {</td></tr>
<tr><td class="h">9535</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$err_path, $interface;&nbsp;&nbsp;&nbsp;&nbsp;# collect interfaces of invalid path</td></tr>
<tr><td class="h">9536</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $err_path;</td></tr>
<tr><td class="h">9537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9539</td><td><div class="c3">354</div></td><td></td><td></td><td></td><td></td><td><div>880</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9541</td><td colspan="7"></td></tr><tr><td class="h">9542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Distribute router_attributes from the area definition to the managed</td></tr>
<tr><td class="h">9544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routers of the area.</td></tr>
<tr><td class="h">9545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub inherit_router_attributes {</td></tr>
<tr><td class="h">9546</td><td><div class="c3">132</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9546">132</a></div></td><td><div class="c0">0</div></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($area) = @_;</td></tr>
<tr><td class="h">9547</td><td colspan="7"></td></tr><tr><td class="h">9548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check for attributes to be inherited.</td></tr>
<tr><td class="h">9549</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9549">100</a></div></td><td></td><td></td><td></td><td><div>265</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $attributes = $area-&gt;{router_attributes} or return;</td></tr>
<tr><td class="h">9550</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9550">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9550">33</a></div></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$attributes-&gt;{owner} and keys %$attributes == 1 and return;&nbsp;&nbsp;# handled later</td></tr>
<tr><td class="h">9551</td><td colspan="7"></td></tr><tr><td class="h">9552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#Process all managed routers of the area inherited from.</td></tr>
<tr><td class="h">9553</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@{ $area-&gt;{managed_routers} }) {</td></tr>
<tr><td class="h">9554</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$attributes) {</td></tr>
<tr><td class="h">9555</td><td colspan="7"></td></tr><tr><td class="h">9556</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9556">50</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $key eq &#39;owner&#39;;&nbsp;&nbsp;&nbsp;&nbsp;# Owner is handled in propagate_owners.</td></tr>
<tr><td class="h">9557</td><td colspan="7"></td></tr><tr><td class="h">9558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# if attribute exists in router (router or smaller area definition)</td></tr>
<tr><td class="h">9559</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val = $attributes-&gt;{$key};</td></tr>
<tr><td class="h">9560</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9560">100</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $r_val = $router-&gt;{$key}) {</td></tr>
<tr><td class="h">9561</td><td><div class="c3">16</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9561">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9561">20</a></div></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">9562</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$r_val eq $val&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# warn, if attributes are equal</td></tr>
<tr><td class="h">9563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| ref $r_val eq &#39;ARRAY&#39;</td></tr>
<tr><td class="h">9564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; ref $val eq &#39;ARRAY&#39;</td></tr>
<tr><td class="h">9565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; aref_eq($r_val, $val)</td></tr>
<tr><td class="h">9566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">9567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">9568</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">9569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Useless attribute &#39;$key&#39; at $router-&gt;{name},\n&quot;,</td></tr>
<tr><td class="h">9570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; it was already inherited from $attributes-&gt;{name}&quot;</td></tr>
<tr><td class="h">9571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9574</td><td colspan="7"></td></tr><tr><td class="h">9575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add attribute to the router object if not yet set.</td></tr>
<tr><td class="h">9576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9577</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{$key} = $val;</td></tr>
<tr><td class="h">9578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9581</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9583</td><td colspan="7"></td></tr><tr><td class="h">9584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Returns true if nat hashes are equal.</td></tr>
<tr><td class="h">9586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub nat_equal {</td></tr>
<tr><td class="h">9587</td><td><div class="c3">46</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9587">46</a></div></td><td><div class="c0">0</div></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($nat1, $nat2) = @_;</td></tr>
<tr><td class="h">9588</td><td colspan="7"></td></tr><tr><td class="h">9589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check whether nat attributes are different...</td></tr>
<tr><td class="h">9590</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(ip mask dynamic hidden identity)) {</td></tr>
<tr><td class="h">9591</td><td><div class="c3">100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9591">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9591">100</a></div></td><td></td><td></td><td><div>367</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if defined $nat1-&gt;{$attr} xor defined $nat2-&gt;{$attr};</td></tr>
<tr><td class="h">9592</td><td><div class="c3">74</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9592">100</a></div></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !defined $nat1-&gt;{$attr};&nbsp;&nbsp;# none of the Nats holds the attribute</td></tr>
<tr><td class="h">9593</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9593">100</a></div></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $nat1-&gt;{$attr} ne $nat2-&gt;{$attr}; # values of attribute differ</td></tr>
<tr><td class="h">9594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9595</td><td colspan="7"></td></tr><tr><td class="h">9596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# ...return true if no difference found.</td></tr>
<tr><td class="h">9597</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">9598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : 1. Generate warning if NAT value of two objects hold the same</td></tr>
<tr><td class="h">9601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes.</td></tr>
<tr><td class="h">9602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. Mark occurence of identity NAT that masks inheritance.</td></tr>
<tr><td class="h">9603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is used later to warn on useless identity NAT.</td></tr>
<tr><td class="h">9604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_useless_nat {</td></tr>
<tr><td class="h">9605</td><td><div class="c3">46</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9605">46</a></div></td><td><div class="c0">0</div></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($nat_tag, $nat1, $nat2, $obj1, $obj2) = @_;</td></tr>
<tr><td class="h">9606</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9606">100</a></div></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (nat_equal($nat1, $nat2)) {</td></tr>
<tr><td class="h">9607</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">9608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Useless nat:$nat_tag at $obj2-&gt;{name},\n&quot;,</td></tr>
<tr><td class="h">9609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; it is already inherited from $obj1-&gt;{name}&quot;</td></tr>
<tr><td class="h">9610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9612</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9612">100</a></div></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($nat2-&gt;{identity}) {</td></tr>
<tr><td class="h">9613</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat2-&gt;{is_used} = 1;</td></tr>
<tr><td class="h">9614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9615</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9617</td><td colspan="7"></td></tr><tr><td class="h">9618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Distribute NAT from area to zones.</td></tr>
<tr><td class="h">9620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub inherit_area_nat {</td></tr>
<tr><td class="h">9621</td><td colspan="7"></td></tr><tr><td class="h">9622</td><td><div class="c3">132</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9622">132</a></div></td><td><div class="c0">0</div></td><td><div>260</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($area) = @_;</td></tr>
<tr><td class="h">9623</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9623">100</a></div></td><td></td><td></td><td></td><td><div>301</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $area-&gt;{nat} or return;</td></tr>
<tr><td class="h">9624</td><td colspan="7"></td></tr><tr><td class="h">9625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process every nat definition of area.</td></tr>
<tr><td class="h">9626</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$hash) {</td></tr>
<tr><td class="h">9627</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $hash-&gt;{$nat_tag};</td></tr>
<tr><td class="h">9628</td><td colspan="7"></td></tr><tr><td class="h">9629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Distribute nat definitions to every zone of area.</td></tr>
<tr><td class="h">9630</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>8</div><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@{ $area-&gt;{zones} }) {</td></tr>
<tr><td class="h">9631</td><td colspan="7"></td></tr><tr><td class="h">9632</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip zone, if NAT tag exists in zone already...</td></tr>
<tr><td class="h">9633</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9633">100</a></div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $z_nat = $zone-&gt;{nat}-&gt;{$nat_tag}) {</td></tr>
<tr><td class="h">9634</td><td colspan="7"></td></tr><tr><td class="h">9635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ... and warn if zones NAT value holds the same attributes.</td></tr>
<tr><td class="h">9636</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_useless_nat($nat_tag, $nat, $z_nat, $area, $zone);</td></tr>
<tr><td class="h">9637</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9639</td><td colspan="7"></td></tr><tr><td class="h">9640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store NAT definition in zone otherwise</td></tr>
<tr><td class="h">9641</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{nat}-&gt;{$nat_tag} = $nat;</td></tr>
<tr><td class="h">9642</td><td colspan="7"></td></tr><tr><td class="h">9643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$zone-&gt;{name}: $nat_tag from $area-&gt;{name}&quot;;</td></tr>
<tr><td class="h">9644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9646</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9648</td><td colspan="7"></td></tr><tr><td class="h">9649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Assure that areas are processed in the right order and distribute</td></tr>
<tr><td class="h">9651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area attributes to zones and managed routers.</td></tr>
<tr><td class="h">9652</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub inherit_attributes_from_area {</td></tr>
<tr><td class="h">9653</td><td colspan="7"></td></tr><tr><td class="h">9654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Areas can be nested. Proceed from small to larger ones.</td></tr>
<tr><td class="h">9655</td><td><div class="c3">736</div><div class="c3">58</div><div class="c3">58</div><div class="c3">58</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9655">736</a></div></td><td><div class="c0">0</div></td><td><div>1182</div><div>46</div><div>65</div><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (sort { @{ $a-&gt;{zones} } &lt;=&gt; @{ $b-&gt;{zones} } } @areas) {</td></tr>
<tr><td class="h">9656</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inherit_router_attributes($area);</td></tr>
<tr><td class="h">9657</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inherit_area_nat($area);</td></tr>
<tr><td class="h">9658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9659</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>707</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9661</td><td colspan="7"></td></tr><tr><td class="h">9662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Distributes NAT from aggregates and networks to other networks</td></tr>
<tr><td class="h">9664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in same zone, that are in subnet relation.</td></tr>
<tr><td class="h">9665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If a network A is subnet of multiple networks B &lt; C,</td></tr>
<tr><td class="h">9666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then NAT of B is used.</td></tr>
<tr><td class="h">9667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub inherit_nat_to_subnets_in_zone {</td></tr>
<tr><td class="h">9668</td><td><div class="c3">226</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9668">226</a></div></td><td><div class="c0">0</div></td><td><div>218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($net_or_zone, $zone) = @_;</td></tr>
<tr><td class="h">9669</td><td><div class="c3">208</div></td><td></td><td></td><td></td><td></td><td><div>321</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip1, $mask1) =</td></tr>
<tr><td class="h">9670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_network($net_or_zone)</td></tr>
<tr><td class="h">9671</td><td><div class="c3">226</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9671">100</a></div></td><td></td><td></td><td></td><td><div>429</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? @{$net_or_zone}{qw(ip mask)}</td></tr>
<tr><td class="h">9672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (0, 0);</td></tr>
<tr><td class="h">9673</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>273</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $net_or_zone-&gt;{nat};</td></tr>
<tr><td class="h">9674</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>453</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$hash) {</td></tr>
<tr><td class="h">9675</td><td><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>327</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat = $hash-&gt;{$nat_tag};</td></tr>
<tr><td class="h">9676</td><td colspan="7"></td></tr><tr><td class="h">9677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;inherit $nat_tag from $net_or_zone-&gt;{name}&quot;;</td></tr>
<tr><td class="h">9678</td><td colspan="7"></td></tr><tr><td class="h">9679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Distribute nat definitions to every subnet of supernet, aggregate or zone.</td></tr>
<tr><td class="h">9680</td><td><div class="c3">284</div><div class="c3">284</div></td><td></td><td></td><td></td><td></td><td><div>211</div><div>364</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $zone-&gt;{networks} }) {</td></tr>
<tr><td class="h">9681</td><td><div class="c3">524</div><div class="c3">524</div></td><td></td><td></td><td></td><td></td><td><div>397</div><div>621</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip2, $mask2) = @{$network}{qw(ip mask)};</td></tr>
<tr><td class="h">9682</td><td colspan="7"></td></tr><tr><td class="h">9683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only process subnets.</td></tr>
<tr><td class="h">9684</td><td><div class="c3">524</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9684">100</a></div></td><td></td><td></td><td></td><td><div>1157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mask2 &gt; $mask1 or next;</td></tr>
<tr><td class="h">9685</td><td><div class="c3">117</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9685">100</a></div></td><td></td><td></td><td></td><td><div>195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_ip($ip2, $ip1, $mask1) or next;</td></tr>
<tr><td class="h">9686</td><td colspan="7"></td></tr><tr><td class="h">9687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip network, if NAT tag exists in network already...</td></tr>
<tr><td class="h">9688</td><td><div class="c3">66</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9688">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9688">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9688">33</a></div></td><td></td><td></td><td><div>187</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $n_nat = $network-&gt;{nat}-&gt;{$nat_tag}) {</td></tr>
<tr><td class="h">9689</td><td colspan="7"></td></tr><tr><td class="h">9690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ... and warn if networks NAT value holds the</td></tr>
<tr><td class="h">9691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# same attributes.</td></tr>
<tr><td class="h">9692</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_useless_nat($nat_tag, $nat, $n_nat, $net_or_zone,</td></tr>
<tr><td class="h">9693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network);</td></tr>
<tr><td class="h">9694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9695</td><td colspan="7"></td></tr><tr><td class="h">9696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($network-&gt;{ip} eq &#39;bridged&#39; and not $nat-&gt;{identity}) {</td></tr>
<tr><td class="h">9697</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">9698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not inherit nat:$nat_tag at bridged&quot;,</td></tr>
<tr><td class="h">9699</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $network-&gt;{name} from $net_or_zone-&gt;{name}&quot;</td></tr>
<tr><td class="h">9700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9702</td><td colspan="7"></td></tr><tr><td class="h">9703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Copy NAT defintion; append name of network.</td></tr>
<tr><td class="h">9704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9705</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sub_nat = {</td></tr>
<tr><td class="h">9706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%$nat,</td></tr>
<tr><td class="h">9707</td><td colspan="7"></td></tr><tr><td class="h">9708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Needed for error messages.</td></tr>
<tr><td class="h">9709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;nat:$nat_tag($network-&gt;{name})&quot;,</td></tr>
<tr><td class="h">9710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">9711</td><td colspan="7"></td></tr><tr><td class="h">9712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For static NAT from net_or_zone,</td></tr>
<tr><td class="h">9713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - merge IP from supernet and subnet,</td></tr>
<tr><td class="h">9714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - adapt mask to size of subnet</td></tr>
<tr><td class="h">9715</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9715">100</a></div></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $nat-&gt;{dynamic}) {</td></tr>
<tr><td class="h">9716</td><td colspan="7"></td></tr><tr><td class="h">9717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take higher bits from NAT IP, lower bits from original IP.</td></tr>
<tr><td class="h">9718</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sub_nat-&gt;{ip} |= $ip2 &amp; complement_32bit($mask1);</td></tr>
<tr><td class="h">9719</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sub_nat-&gt;{mask} = $mask2;</td></tr>
<tr><td class="h">9720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9721</td><td colspan="7"></td></tr><tr><td class="h">9722</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{nat}-&gt;{$nat_tag} = $sub_nat;</td></tr>
<tr><td class="h">9723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9726</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>510</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9727</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9728</td><td colspan="7"></td></tr><tr><td class="h">9729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub inherit_nat_in_zone {</td></tr>
<tr><td class="h">9730</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9730">736</a></div></td><td><div class="c0">0</div></td><td><div>926</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">9731</td><td colspan="7"></td></tr><tr><td class="h">9732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find all networks and aggregates of current zone,</td></tr>
<tr><td class="h">9733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# that have NAT definitions.</td></tr>
<tr><td class="h">9734</td><td><div class="c3">3069</div><div class="c3">2152</div><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>3951</div><div>2287</div><div>3374</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @nat_supernets = grep({ $_-&gt;{nat} } @{ $zone-&gt;{networks} },</td></tr>
<tr><td class="h">9735</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>1699</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %{ $zone-&gt;{ipmask2aggregate} });</td></tr>
<tr><td class="h">9736</td><td colspan="7"></td></tr><tr><td class="h">9737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add zone object instead of aggregate 0/0, because NAT is stored</td></tr>
<tr><td class="h">9738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# at zone in this case.</td></tr>
<tr><td class="h">9739</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9739">100</a></div></td><td></td><td></td><td></td><td><div>3043</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @nat_zone = $zone-&gt;{nat} ? ($zone) : ();</td></tr>
<tr><td class="h">9740</td><td colspan="7"></td></tr><tr><td class="h">9741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Proceed from smaller to larger objects. (Bigger mask first.)</td></tr>
<tr><td class="h">9742</td><td><div class="c3">2152</div><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>4074</div><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $supernet (sort({ $b-&gt;{mask} &lt;=&gt; $a-&gt;{mask} } @nat_supernets),</td></tr>
<tr><td class="h">9743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@nat_zone)</td></tr>
<tr><td class="h">9744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">9745</td><td><div class="c3">226</div></td><td></td><td></td><td></td><td></td><td><div>330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inherit_nat_to_subnets_in_zone($supernet, $zone);</td></tr>
<tr><td class="h">9746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9748</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9750</td><td colspan="7"></td></tr><tr><td class="h">9751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cleanup_after_inheritance {</td></tr>
<tr><td class="h">9752</td><td colspan="7"></td></tr><tr><td class="h">9753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# 1. Remove NAT entries from aggregates.</td></tr>
<tr><td class="h">9754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;These are only used during NAT inheritance.</td></tr>
<tr><td class="h">9755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# 2. Remove identity NAT entries.</td></tr>
<tr><td class="h">9756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;These are only needed during NAT inheritance.</td></tr>
<tr><td class="h">9757</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9757">736</a></div></td><td><div class="c0">0</div></td><td><div>821</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">9758</td><td><div class="c3">3144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9758">100</a></div></td><td></td><td></td><td></td><td><div>5244</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">9759</td><td><div class="c3">236</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9759">100</a></div></td><td></td><td></td><td></td><td><div>381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">9760</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $network-&gt;{nat};</td></tr>
<tr><td class="h">9761</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">9762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9763</td><td><div class="c3">232</div></td><td></td><td></td><td></td><td></td><td><div>333</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$href) {</td></tr>
<tr><td class="h">9764</td><td><div class="c3">288</div></td><td></td><td></td><td></td><td></td><td><div>290</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $href-&gt;{$nat_tag};</td></tr>
<tr><td class="h">9765</td><td><div class="c3">288</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9765">100</a></div></td><td></td><td></td><td></td><td><div>680</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_network-&gt;{identity} or next;</td></tr>
<tr><td class="h">9766</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $href-&gt;{$nat_tag};</td></tr>
<tr><td class="h">9767</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9767">50</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_network-&gt;{is_used}</td></tr>
<tr><td class="h">9768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;Useless identity nat:$nat_tag at $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9770</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9771</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>699</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9773</td><td colspan="7"></td></tr><tr><td class="h">9774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub inherit_attributes {</td></tr>
<tr><td class="h">9775</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9775">736</a></div></td><td><div class="c0">0</div></td><td><div>1005</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;inherit_attributes_from_area();</td></tr>
<tr><td class="h">9776</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1033</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;inherit_nat_in_zone();</td></tr>
<tr><td class="h">9777</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>951</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;cleanup_after_inheritance();</td></tr>
<tr><td class="h">9778</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>735</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9780</td><td colspan="7"></td></tr><tr><td class="h">9781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Create a new zone object for every network without a zone</td></tr>
<tr><td class="h">9783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_zones {</td></tr>
<tr><td class="h">9784</td><td colspan="7"></td></tr><tr><td class="h">9785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process networks without a zone</td></tr>
<tr><td class="h">9786</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9786">736</a></div></td><td><div class="c0">0</div></td><td><div>853</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">9787</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9787">100</a></div></td><td></td><td></td><td></td><td><div>4835</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network-&gt;{zone};</td></tr>
<tr><td class="h">9788</td><td colspan="7"></td></tr><tr><td class="h">9789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create zone object with name of corresponding aggregate and ip 0/0.</td></tr>
<tr><td class="h">9790</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>4661</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name = &quot;any:[$network-&gt;{name}]&quot;;</td></tr>
<tr><td class="h">9791</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>3748</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = new(&#39;Zone&#39;, name =&gt; $name, networks =&gt; []);</td></tr>
<tr><td class="h">9792</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @zones, $zone;</td></tr>
<tr><td class="h">9793</td><td colspan="7"></td></tr><tr><td class="h">9794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect zone elements...</td></tr>
<tr><td class="h">9795</td><td><div class="c3">2152</div></td><td></td><td></td><td></td><td></td><td><div>2746</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_zone1($network, $zone, 0);</td></tr>
<tr><td class="h">9796</td><td colspan="7"></td></tr><tr><td class="h">9797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark zone which consists only of a loopback network.</td></tr>
<tr><td class="h">9798</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{loopback} = 1</td></tr>
<tr><td class="h">9799</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9799">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9799">67</a></div></td><td></td><td></td><td><div>3910</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $network-&gt;{loopback} &amp;&amp; @{ $zone-&gt;{networks} } == 1;</td></tr>
<tr><td class="h">9800</td><td colspan="7"></td></tr><tr><td class="h">9801</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Attribute {is_tunnel} is set only when zone has only tunnel networks.</td></tr>
<tr><td class="h">9802</td><td><div class="c3">2152</div><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9802">100</a></div></td><td></td><td></td><td></td><td><div>1872</div><div>3550</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@{ $zone-&gt;{networks} }) { # tunnel networks arent referenced in zone</td></tr>
<tr><td class="h">9803</td><td><div class="c3">2131</div></td><td></td><td></td><td></td><td></td><td><div>2342</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $zone-&gt;{is_tunnel};</td></tr>
<tr><td class="h">9804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9805</td><td colspan="7"></td></tr><tr><td class="h">9806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove zone reference from unmanaged routers (no longer needed).</td></tr>
<tr><td class="h">9807</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9807">100</a></div></td><td></td><td></td><td></td><td><div>3446</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $unmanaged = $zone-&gt;{unmanaged_routers}) {</td></tr>
<tr><td class="h">9808</td><td><div class="c3">329</div></td><td></td><td></td><td></td><td></td><td><div>826</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $_-&gt;{zone} for @$unmanaged;</td></tr>
<tr><td class="h">9809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9810</td><td colspan="7"></td></tr><tr><td class="h">9811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove private status, if &#39;public&#39;</td></tr>
<tr><td class="h">9812</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9812">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L9812">67</a></div></td><td></td><td></td><td><div>6890</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($zone-&gt;{private} &amp;&amp; $zone-&gt;{private} eq &#39;public&#39;) {</td></tr>
<tr><td class="h">9813</td><td><div class="c3">2147</div></td><td></td><td></td><td></td><td></td><td><div>3555</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $zone-&gt;{private};</td></tr>
<tr><td class="h">9814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9816</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>790</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9818</td><td colspan="7"></td></tr><tr><td class="h">9819</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">9820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Clusters zones connected by semi_managed routers. References of all</td></tr>
<tr><td class="h">9821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zones of a cluster are stored in the {zone_cluster} attribute of</td></tr>
<tr><td class="h">9822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the zones.</td></tr>
<tr><td class="h">9823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : The {zone_cluster} attribute is only set if the cluster has more</td></tr>
<tr><td class="h">9824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than one element.</td></tr>
<tr><td class="h">9825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cluster_zones {</td></tr>
<tr><td class="h">9826</td><td colspan="7"></td></tr><tr><td class="h">9827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process all unclustered zones.</td></tr>
<tr><td class="h">9828</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9828">736</a></div></td><td><div class="c0">0</div></td><td><div>999</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">9829</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9829">100</a></div></td><td></td><td></td><td></td><td><div>3238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone-&gt;{zone_cluster};</td></tr>
<tr><td class="h">9830</td><td colspan="7"></td></tr><tr><td class="h">9831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a new cluster and collect its zones</td></tr>
<tr><td class="h">9832</td><td><div class="c3">2095</div></td><td></td><td></td><td></td><td></td><td><div>2105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = [];</td></tr>
<tr><td class="h">9833</td><td><div class="c3">2095</div></td><td></td><td></td><td></td><td></td><td><div>2590</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_zone_cluster($zone, 0, $cluster);</td></tr>
<tr><td class="h">9834</td><td colspan="7"></td></tr><tr><td class="h">9835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# delete clusters containing a single network only</td></tr>
<tr><td class="h">9836</td><td><div class="c3">2095</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9836">100</a></div></td><td></td><td></td><td></td><td><div>4726</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $zone-&gt;{zone_cluster} if 1 &gt;= @$cluster;</td></tr>
<tr><td class="h">9837</td><td colspan="7"></td></tr><tr><td class="h">9838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&#39;cluster: &#39;, join(&#39;,&#39;,map($_-&gt;{name}, @{$zone-&gt;{zone_cluster}})))</td></tr>
<tr><td class="h">9839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $zone-&gt;{zone_cluster};</td></tr>
<tr><td class="h">9840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9841</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>851</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9843</td><td colspan="7"></td></tr><tr><td class="h">9844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Mark interfaces, which are border of some area, prepare consistency</td></tr>
<tr><td class="h">9846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check for attributes {border} and {inclusive_border}.</td></tr>
<tr><td class="h">9847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Area labeled interfaces are needed to locate auto_borders.</td></tr>
<tr><td class="h">9848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub prepare_area_borders {</td></tr>
<tr><td class="h">9849</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9849">736</a></div></td><td><div class="c0">0</div></td><td><div>601</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %has_inclusive_borders;&nbsp;&nbsp;&nbsp;# collects all routers with inclusive border IF</td></tr>
<tr><td class="h">9850</td><td colspan="7"></td></tr><tr><td class="h">9851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Identify all interfaces which are border of some area</td></tr>
<tr><td class="h">9852</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1020</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (@areas) {</td></tr>
<tr><td class="h">9853</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attribute (qw(border inclusive_border)) {</td></tr>
<tr><td class="h">9854</td><td><div class="c3">264</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9854">100</a></div></td><td></td><td></td><td></td><td><div>605</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $border = $area-&gt;{$attribute} or next;</td></tr>
<tr><td class="h">9855</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$border) {</td></tr>
<tr><td class="h">9856</td><td colspan="7"></td></tr><tr><td class="h">9857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reference delimited area in the interfaces attributes</td></tr>
<tr><td class="h">9858</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{is_border} = $area;&nbsp;&nbsp;&nbsp;&nbsp;# used for auto borders</td></tr>
<tr><td class="h">9859</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9859">100</a></div></td><td></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($attribute eq &#39;inclusive_border&#39;) {</td></tr>
<tr><td class="h">9860</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{is_inclusive}-&gt;{$area} = $area;</td></tr>
<tr><td class="h">9861</td><td colspan="7"></td></tr><tr><td class="h">9862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect routers with inclusive border interface</td></tr>
<tr><td class="h">9863</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">9864</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_inclusive_borders{$router} = $router;</td></tr>
<tr><td class="h">9865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9868</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9869</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>901</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \%has_inclusive_borders;</td></tr>
<tr><td class="h">9870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9871</td><td colspan="7"></td></tr><tr><td class="h">9872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Collect zones, routers (and interfaces, if no borders defined)</td></tr>
<tr><td class="h">9874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of an area.</td></tr>
<tr><td class="h">9875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;: undef (or 1, if error was shown)</td></tr>
<tr><td class="h">9876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_area {</td></tr>
<tr><td class="h">9877</td><td><div class="c3">132</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9877">132</a></div></td><td><div class="c0">0</div></td><td><div>145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $area, $in_interface) = @_;</td></tr>
<tr><td class="h">9878</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9878">100</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $err_path = set_area1($obj, $area, $in_interface)) {</td></tr>
<tr><td class="h">9879</td><td colspan="7"></td></tr><tr><td class="h">9880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print error path, if errors occurred</td></tr>
<tr><td class="h">9881</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9881">50</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$err_path, $in_interface if $in_interface;</td></tr>
<tr><td class="h">9882</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err_intf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $err_path-&gt;[0];</td></tr>
<tr><td class="h">9883</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $is_inclusive = $err_intf-&gt;{is_inclusive};</td></tr>
<tr><td class="h">9884</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9884">100</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err_obj = $err_intf-&gt;{ $is_inclusive-&gt;{$area} ? &#39;router&#39; : &#39;zone&#39; };</td></tr>
<tr><td class="h">9885</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9885">100</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_loop = $err_obj-&gt;{areas}-&gt;{$area} ? &#39; in loop&#39; : &#39;&#39;;</td></tr>
<tr><td class="h">9886</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">9887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Inconsistent definition of $area-&gt;{name}&quot;,</td></tr>
<tr><td class="h">9888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_loop,</td></tr>
<tr><td class="h">9889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;.\n&quot;,</td></tr>
<tr><td class="h">9890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; It is reached from outside via this path:\n&quot;,</td></tr>
<tr><td class="h">9891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - &quot;,</td></tr>
<tr><td class="h">9892</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&quot;\n - &quot;, map { $_-&gt;{name} } reverse @$err_path)</td></tr>
<tr><td class="h">9893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9894</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">9895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9896</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9898</td><td colspan="7"></td></tr><tr><td class="h">9899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################s</td></tr>
<tr><td class="h">9900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Set up area objects, assure proper border definitions.</td></tr>
<tr><td class="h">9901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_areas {</td></tr>
<tr><td class="h">9902</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9902">736</a></div></td><td><div class="c0">0</div></td><td><div>855</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (@areas) {</td></tr>
<tr><td class="h">9903</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{zones} = [];</td></tr>
<tr><td class="h">9904</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9904">100</a></div></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $network = $area-&gt;{anchor}) {</td></tr>
<tr><td class="h">9905</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_area($network-&gt;{zone}, $area, 0);</td></tr>
<tr><td class="h">9906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9908</td><td colspan="7"></td></tr><tr><td class="h">9909</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For efficient look up if some IF is a border of current area.</td></tr>
<tr><td class="h">9910</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $lookup = $area-&gt;{intf_lookup} = {};</td></tr>
<tr><td class="h">9911</td><td colspan="7"></td></tr><tr><td class="h">9912</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $start;</td></tr>
<tr><td class="h">9913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj1;</td></tr>
<tr><td class="h">9914</td><td colspan="7"></td></tr><tr><td class="h">9915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect all area delimiting interfaces in border lookup array</td></tr>
<tr><td class="h">9916</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>119</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(border inclusive_border)) {</td></tr>
<tr><td class="h">9917</td><td><div class="c3">196</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9917">100</a></div></td><td></td><td></td><td></td><td><div>399</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $borders = $area-&gt;{$attr} or next;</td></tr>
<tr><td class="h">9918</td><td><div class="c3">104</div><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>113</div><div>227</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$lookup}{@$borders} = @$borders;</td></tr>
<tr><td class="h">9919</td><td><div class="c3">104</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9919">100</a></div></td><td></td><td></td><td></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $start;</td></tr>
<tr><td class="h">9920</td><td colspan="7"></td></tr><tr><td class="h">9921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# identify start interface and direction for area traversal</td></tr>
<tr><td class="h">9922</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start = $borders-&gt;[0];</td></tr>
<tr><td class="h">9923</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9923">100</a></div></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj1&nbsp;&nbsp;= $attr eq &#39;border&#39;</td></tr>
<tr><td class="h">9924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $start-&gt;{zone}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# proceed with zone</td></tr>
<tr><td class="h">9925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $start-&gt;{router};&nbsp;&nbsp;&nbsp;&nbsp;# proceed with router</td></tr>
<tr><td class="h">9926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9927</td><td colspan="7"></td></tr><tr><td class="h">9928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect zones and routers of area and keep track of borders found.</td></tr>
<tr><td class="h">9929</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lookup-&gt;{$start} = &#39;found&#39;;</td></tr>
<tr><td class="h">9930</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err = set_area($obj1, $area, $start);</td></tr>
<tr><td class="h">9931</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9931">100</a></div></td><td></td><td></td><td></td><td><div>150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $err;</td></tr>
<tr><td class="h">9932</td><td colspan="7"></td></tr><tr><td class="h">9933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assert that all borders were found.</td></tr>
<tr><td class="h">9934</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr (qw(border inclusive_border)) {</td></tr>
<tr><td class="h">9935</td><td><div class="c3">188</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9935">100</a></div></td><td></td><td></td><td></td><td><div>421</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $borders = $area-&gt;{$attr} or next;</td></tr>
<tr><td class="h">9936</td><td><div class="c3">98</div><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9936">100</a></div></td><td></td><td></td><td></td><td><div>123</div><div>550</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @bad_intf = grep { $lookup-&gt;{$_} ne &#39;found&#39; } @$borders</td></tr>
<tr><td class="h">9937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">9938</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">9939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Invalid $attr of $area-&gt;{name}:\n - &quot;,</td></tr>
<tr><td class="h">9940</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&quot;\n - &quot;, map { $_-&gt;{name} } @bad_intf)</td></tr>
<tr><td class="h">9941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">9942</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$area-&gt;{$attr} =</td></tr>
<tr><td class="h">9943</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ grep { $lookup-&gt;{$_} eq &#39;found&#39; } @$borders ];</td></tr>
<tr><td class="h">9944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9946</td><td colspan="7"></td></tr><tr><td class="h">9947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check whether area is empty (= consist of a single router)</td></tr>
<tr><td class="h">9948</td><td><div class="c3">128</div><div class="c3">128</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9948">100</a></div></td><td></td><td></td><td></td><td><div>115</div><div>326</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $area-&gt;{zones} }</td></tr>
<tr><td class="h">9949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;$area-&gt;{name} is empty&quot;);</td></tr>
<tr><td class="h">9950</td><td colspan="7"></td></tr><tr><td class="h">9951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$area-&gt;{name}:\n &quot;, join &quot;\n &quot;, map $_-&gt;{name}, @{$area-&gt;{zones}});</td></tr>
<tr><td class="h">9952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9953</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>660</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">9954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">9955</td><td colspan="7"></td></tr><tr><td class="h">9956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">9957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Find subset relation between areas, assure that no duplicate or</td></tr>
<tr><td class="h">9958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overlapping areas exist</td></tr>
<tr><td class="h">9959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_area_subset_relations {</td></tr>
<tr><td class="h">9960</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L9960">736</a></div></td><td><div class="c0">0</div></td><td><div>613</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;&nbsp;&nbsp;&nbsp;&nbsp;# key:contained area, value: containing area</td></tr>
<tr><td class="h">9961</td><td colspan="7"></td></tr><tr><td class="h">9962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process all zones contained by one or more areas</td></tr>
<tr><td class="h">9963</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>950</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">9964</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9964">100</a></div></td><td></td><td></td><td></td><td><div>3712</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{areas} or next;</td></tr>
<tr><td class="h">9965</td><td colspan="7"></td></tr><tr><td class="h">9966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Sort areas containing zone by ascending size</td></tr>
<tr><td class="h">9967</td><td><div class="c3">63</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @areas = sort(</td></tr>
<tr><td class="h">9968</td><td><div class="c3">63</div><div class="c3">63</div><div class="c3">194</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9968">50</a></div></td><td></td><td></td><td></td><td><div>55</div><div>206</div><div>519</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ @{ $a-&gt;{zones} } &lt;=&gt; @{ $b-&gt;{zones} }</td></tr>
<tr><td class="h">9969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $a-&gt;{name} cmp $b-&gt;{name} }&nbsp;&nbsp;&nbsp;&nbsp;#equal size? sort by name</td></tr>
<tr><td class="h">9970</td><td><div class="c3">194</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9970">50</a></div></td><td></td><td></td><td></td><td><div>161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %{ $zone-&gt;{areas} }) or next;&nbsp;&nbsp;&nbsp;&nbsp;# Skip empty hash.</td></tr>
<tr><td class="h">9971</td><td colspan="7"></td></tr><tr><td class="h">9972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take the smallest area.</td></tr>
<tr><td class="h">9973</td><td><div class="c3">194</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = shift @areas;</td></tr>
<tr><td class="h">9974</td><td colspan="7"></td></tr><tr><td class="h">9975</td><td><div class="c3">194</div></td><td></td><td></td><td></td><td></td><td><div>400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (@areas) {</td></tr>
<tr><td class="h">9976</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $small = $next;</td></tr>
<tr><td class="h">9977</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$next = shift @areas;</td></tr>
<tr><td class="h">9978</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9978">100</a></div></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$small}-&gt;{$next};&nbsp;&nbsp;# Already identified in other zone.</td></tr>
<tr><td class="h">9979</td><td colspan="7"></td></tr><tr><td class="h">9980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check that each zone of $small is part of $next.</td></tr>
<tr><td class="h">9981</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ok = 1;</td></tr>
<tr><td class="h">9982</td><td><div class="c3">36</div><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>31</div><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@{ $small-&gt;{zones} }) {</td></tr>
<tr><td class="h">9983</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9983">100</a></div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$zone-&gt;{areas}-&gt;{$next}) {</td></tr>
<tr><td class="h">9984</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok = 0;</td></tr>
<tr><td class="h">9985</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Overlapping $small-&gt;{name} and $next-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9986</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">9987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9988</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9989</td><td colspan="7"></td></tr><tr><td class="h">9990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# check for duplicates</td></tr>
<tr><td class="h">9991</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9991">100</a></div></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ok) {</td></tr>
<tr><td class="h">9992</td><td><div class="c3">34</div><div class="c3">34</div><div class="c3">34</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L9992">100</a></div></td><td></td><td></td><td></td><td><div>32</div><div>38</div><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@{ $small-&gt;{zones} } == @{ $next-&gt;{zones} }) {</td></tr>
<tr><td class="h">9993</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Duplicate $small-&gt;{name} and $next-&gt;{name}&quot;);</td></tr>
<tr><td class="h">9994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">9995</td><td colspan="7"></td></tr><tr><td class="h">9996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# reference containing area</td></tr>
<tr><td class="h">9997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">9998</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$small-&gt;{subset_of} = $next;</td></tr>
<tr><td class="h">9999</td><td colspan="7"></td></tr><tr><td class="h">10000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$small-&gt;{name} &lt; $next-&gt;{name}&quot;;</td></tr>
<tr><td class="h">10001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10003</td><td colspan="7"></td></tr><tr><td class="h">10004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#keep track of processed areas</td></tr>
<tr><td class="h">10005</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$small}-&gt;{$next} = 1;</td></tr>
<tr><td class="h">10006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10008</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>939</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10009</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10010</td><td colspan="7"></td></tr><tr><td class="h">10011</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">10012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Check, that area subset relations hold for routers:</td></tr>
<tr><td class="h">10013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Case 1: If a router R is located inside areas A1 and A2 via</td></tr>
<tr><td class="h">10014</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;inclusive_border&#39;, then A1 and A2 must be in subset relation.</td></tr>
<tr><td class="h">10015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Case 2: If area A1 and A2 are in subset relation and A1 includes R,</td></tr>
<tr><td class="h">10016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then A2 also needs to include R either from &#39;inclusive_border&#39; or</td></tr>
<tr><td class="h">10017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R is surrounded by zones located inside A2.</td></tr>
<tr><td class="h">10018</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : This is needed to get consistent inheritance with</td></tr>
<tr><td class="h">10019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;router_attributes&#39;.</td></tr>
<tr><td class="h">10020</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_routers_in_nested_areas {</td></tr>
<tr><td class="h">10021</td><td colspan="7"></td></tr><tr><td class="h">10022</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10022">736</a></div></td><td><div class="c0">0</div></td><td><div>728</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($has_inclusive_borders) = @_;</td></tr>
<tr><td class="h">10023</td><td colspan="7"></td></tr><tr><td class="h">10024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Case 1: Identify routers contained by areas via &#39;inclusive_border&#39;</td></tr>
<tr><td class="h">10025</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1920</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (sort by_name values %$has_inclusive_borders) {</td></tr>
<tr><td class="h">10026</td><td colspan="7"></td></tr><tr><td class="h">10027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Sort all areas having this router as inclusive_border by size.</td></tr>
<tr><td class="h">10028</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @areas =</td></tr>
<tr><td class="h">10029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort({</td></tr>
<tr><td class="h">10030</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10030">50</a></div></td><td></td><td></td><td></td><td><div>5</div><div>19</div><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $a-&gt;{zones} } &lt;=&gt; @{ $b-&gt;{zones} } ||&nbsp;&nbsp;&nbsp;&nbsp;# ascending order</td></tr>
<tr><td class="h">10031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;{name} cmp $b-&gt;{name}</td></tr>
<tr><td class="h">10032</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;# equal size? sort by name</td></tr>
<tr><td class="h">10033</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %{ $router-&gt;{areas} });</td></tr>
<tr><td class="h">10034</td><td colspan="7"></td></tr><tr><td class="h">10035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take the smallest area.</td></tr>
<tr><td class="h">10036</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = shift @areas;</td></tr>
<tr><td class="h">10037</td><td colspan="7"></td></tr><tr><td class="h">10038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Pairwisely check containing areas for subset relation.</td></tr>
<tr><td class="h">10039</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (@areas) {</td></tr>
<tr><td class="h">10040</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $small = $next;</td></tr>
<tr><td class="h">10041</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$next = shift @areas;</td></tr>
<tr><td class="h">10042</td><td><div class="c3">6</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10042">100</a></div></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $big = $small-&gt;{subset_of} || &#39;&#39;;&nbsp;&nbsp;&nbsp;&nbsp;# extract containing area</td></tr>
<tr><td class="h">10043</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10043">100</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $next eq $big;</td></tr>
<tr><td class="h">10044</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">10045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$small-&gt;{name} and $next-&gt;{name} must be&quot;,</td></tr>
<tr><td class="h">10046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in subset relation,\n because both have&quot;,</td></tr>
<tr><td class="h">10047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $router-&gt;{name} as &#39;inclusive_border&#39;&quot;</td></tr>
<tr><td class="h">10048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">10049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10051</td><td colspan="7"></td></tr><tr><td class="h">10052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Case 2: Identify areas in subset relation</td></tr>
<tr><td class="h">10053</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1076</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (@areas) {</td></tr>
<tr><td class="h">10054</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10054">100</a></div></td><td></td><td></td><td></td><td><div>299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $big = $area-&gt;{subset_of} or next;</td></tr>
<tr><td class="h">10055</td><td colspan="7"></td></tr><tr><td class="h">10056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Assure routers of the subset area to be located in containing area too</td></tr>
<tr><td class="h">10057</td><td><div class="c3">32</div><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>26</div><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@{ $area-&gt;{managed_routers} }) {</td></tr>
<tr><td class="h">10058</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10058">100</a></div></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{areas}-&gt;{$big};</td></tr>
<tr><td class="h">10059</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">10060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$router-&gt;{name} must be located in $big-&gt;{name},\n&quot;,</td></tr>
<tr><td class="h">10061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; because it is located in $area-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">10062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; and both areas are in subset relation\n&quot;,</td></tr>
<tr><td class="h">10063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; (use attribute &#39;inclusive_border&#39;)&quot;</td></tr>
<tr><td class="h">10064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">10065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10067</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>691</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10069</td><td colspan="7"></td></tr><tr><td class="h">10070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">10071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Delete unused attributes in area objects.</td></tr>
<tr><td class="h">10072</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub clean_areas {</td></tr>
<tr><td class="h">10073</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10073">736</a></div></td><td><div class="c0">0</div></td><td><div>846</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $area (@areas) {</td></tr>
<tr><td class="h">10074</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $area-&gt;{intf_lookup};</td></tr>
<tr><td class="h">10075</td><td><div class="c3">132</div><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>114</div><div>233</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $area-&gt;{border} }) {</td></tr>
<tr><td class="h">10076</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{is_border};</td></tr>
<tr><td class="h">10077</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{is_inclusive};</td></tr>
<tr><td class="h">10078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10080</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>633</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10082</td><td colspan="7"></td></tr><tr><td class="h">10083</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">10084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Create zones and areas.</td></tr>
<tr><td class="h">10085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_zone {</td></tr>
<tr><td class="h">10086</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10086">736</a></div></td><td><div class="c0">0</div></td><td><div>1400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Preparing security zones and areas&#39;);</td></tr>
<tr><td class="h">10087</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1032</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;set_zones();</td></tr>
<tr><td class="h">10088</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;cluster_zones();</td></tr>
<tr><td class="h">10089</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crosslink_routers = check_crosslink();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#TODO: place somewhere else?</td></tr>
<tr><td class="h">10090</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1083</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;cluster_crosslink_routers($crosslink_routers);&nbsp;&nbsp;#TODO: place somewhere else?</td></tr>
<tr><td class="h">10091</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1014</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $has_inclusive_borders = prepare_area_borders();</td></tr>
<tr><td class="h">10092</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1049</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;set_areas();</td></tr>
<tr><td class="h">10093</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>926</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;find_area_subset_relations();</td></tr>
<tr><td class="h">10094</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1265</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_routers_in_nested_areas($has_inclusive_borders);</td></tr>
<tr><td class="h">10095</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>936</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;clean_areas();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# delete unused attributes</td></tr>
<tr><td class="h">10096</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_aggregates();</td></tr>
<tr><td class="h">10097</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>921</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;inherit_attributes();</td></tr>
<tr><td class="h">10098</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10099</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10100</td><td colspan="7"></td></tr><tr><td class="h">10101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Virtual interfaces</td></tr>
<tr><td class="h">10103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Assure interfaces with identical virtual IP are located inside</td></tr>
<tr><td class="h">10105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the same loop.</td></tr>
<tr><td class="h">10106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_virtual_interfaces {</td></tr>
<tr><td class="h">10107</td><td><div class="c3">726</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10107">726</a></div></td><td><div class="c0">0</div></td><td><div>604</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">10108</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>864</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@virtual_interfaces) {</td></tr>
<tr><td class="h">10109</td><td><div class="c3">144</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10109">50</a></div></td><td></td><td></td><td></td><td><div>242</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $related = $interface-&gt;{redundancy_interfaces} or next;</td></tr>
<tr><td class="h">10110</td><td colspan="7"></td></tr><tr><td class="h">10111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Loops inside a security zone are not known and can not be checked</td></tr>
<tr><td class="h">10112</td><td><div class="c3">144</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">10113</td><td><div class="c3">144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10113">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10113">100</a></div></td><td></td><td></td><td><div>316</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not($router-&gt;{managed} or $router-&gt;{semi_managed});</td></tr>
<tr><td class="h">10114</td><td colspan="7"></td></tr><tr><td class="h">10115</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10115">100</a></div></td><td></td><td></td><td></td><td><div>230</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$related} and next;</td></tr>
<tr><td class="h">10116</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$related} = 1;</td></tr>
<tr><td class="h">10117</td><td colspan="7"></td></tr><tr><td class="h">10118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check whether all virtual interfaces are part of a loop.</td></tr>
<tr><td class="h">10119</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $err;</td></tr>
<tr><td class="h">10120</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $v (@$related) {</td></tr>
<tr><td class="h">10121</td><td><div class="c3">118</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10121">50</a></div></td><td></td><td></td><td></td><td><div>237</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $v-&gt;{router}-&gt;{loop}) {</td></tr>
<tr><td class="h">10122</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Virtual IP of $v-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">10123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must be located inside cyclic sub-graph&quot;);</td></tr>
<tr><td class="h">10124</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$err = 1;</td></tr>
<tr><td class="h">10125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10127</td><td><div class="c3">56</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10127">50</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $err;</td></tr>
<tr><td class="h">10128</td><td colspan="7"></td></tr><tr><td class="h">10129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check whether all virtual interfaces are part of the same loop.</td></tr>
<tr><td class="h">10130</td><td><div class="c3">8</div><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal(map { $_-&gt;{loop} } @$related)</td></tr>
<tr><td class="h">10131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">10132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Virtual interfaces\n &quot;,</td></tr>
<tr><td class="h">10133</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10133">100</a></div></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;, &#39;, map({ $_-&gt;{name} } @$related)),</td></tr>
<tr><td class="h">10134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n must all be part of the same cyclic sub-graph&quot;</td></tr>
<tr><td class="h">10135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">10136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10137</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>770</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10139</td><td colspan="7"></td></tr><tr><td class="h">10140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check pathrestrictions</td></tr>
<tr><td class="h">10142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Collect proper &amp; effective pathrestrictions in a global array.</td></tr>
<tr><td class="h">10144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pathrestrictions have to fulfill following requirements:</td></tr>
<tr><td class="h">10145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Located inside or at the border of cycles.</td></tr>
<tr><td class="h">10146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- At least 2 interfaces per pathrestriction.</td></tr>
<tr><td class="h">10147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Have an effect on ACL generation.</td></tr>
<tr><td class="h">10148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_pathrestrictions {</td></tr>
<tr><td class="h">10149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;RESTRICT:</td></tr>
<tr><td class="h">10150</td><td colspan="7"></td></tr><tr><td class="h">10151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process every pathrestriction.</td></tr>
<tr><td class="h">10152</td><td><div class="c3">726</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10152">726</a></div></td><td><div class="c0">0</div></td><td><div>1283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (values %pathrestrictions) {</td></tr>
<tr><td class="h">10153</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $elements = $restrict-&gt;{elements};&nbsp;&nbsp;&nbsp;&nbsp;# Extract interfaces.</td></tr>
<tr><td class="h">10154</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10154">50</a></div></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !@$elements;</td></tr>
<tr><td class="h">10155</td><td colspan="7"></td></tr><tr><td class="h">10156</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deleted; # Flags whether interfaces have been deleted.</td></tr>
<tr><td class="h">10157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $invalid; # Flags whether pathrestriction is invalid. </td></tr>
<tr><td class="h">10158</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prev_interface;</td></tr>
<tr><td class="h">10159</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prev_cluster;</td></tr>
<tr><td class="h">10160</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$elements) {</td></tr>
<tr><td class="h">10161</td><td><div class="c3">132</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10161">50</a></div></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{disabled};</td></tr>
<tr><td class="h">10162</td><td><div class="c3">132</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10162">100</a></div></td><td></td><td></td><td><div>296</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop =</td></tr>
<tr><td class="h">10163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{loop}</td></tr>
<tr><td class="h">10164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $interface-&gt;{router}-&gt;{loop}</td></tr>
<tr><td class="h">10165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $interface-&gt;{zone}-&gt;{loop};</td></tr>
<tr><td class="h">10166</td><td colspan="7"></td></tr><tr><td class="h">10167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Interfaces with pathrestriction need to be located</td></tr>
<tr><td class="h">10168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# inside or at the border of cyclic graphs.</td></tr>
<tr><td class="h">10169</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10169">100</a></div></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $loop) {</td></tr>
<tr><td class="h">10170</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{path_restrict};</td></tr>
<tr><td class="h">10171</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring $restrict-&gt;{name} at $interface-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">10172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; because it isn&#39;t located inside cyclic graph&quot;);</td></tr>
<tr><td class="h">10173</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface = undef; # No longer reference this interface.</td></tr>
<tr><td class="h">10174</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deleted = 1;</td></tr>
<tr><td class="h">10175</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">10176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10177</td><td colspan="7"></td></tr><tr><td class="h">10178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Interfaces must belong to same loop cluster.</td></tr>
<tr><td class="h">10179</td><td><div class="c3">130</div></td><td></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = $loop-&gt;{cluster_exit};</td></tr>
<tr><td class="h">10180</td><td><div class="c3">130</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10180">100</a></div></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($prev_cluster) {</td></tr>
<tr><td class="h">10181</td><td><div class="c3">66</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10181">100</a></div></td><td></td><td></td><td></td><td><div>203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $cluster eq $prev_cluster) {</td></tr>
<tr><td class="h">10182</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;$restrict-&gt;{name} must not have elements&quot;,</td></tr>
<tr><td class="h">10183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from different loops:\n&quot;,</td></tr>
<tr><td class="h">10184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $prev_interface-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">10185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10186</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$invalid = 1;</td></tr>
<tr><td class="h">10187</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">10188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10191</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prev_cluster&nbsp;&nbsp;&nbsp;= $cluster;</td></tr>
<tr><td class="h">10192</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prev_interface = $interface;</td></tr>
<tr><td class="h">10193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10195</td><td colspan="7"></td></tr><tr><td class="h">10196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check whether pathrestriction is still valid. </td></tr>
<tr><td class="h">10197</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10197">100</a></div></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($deleted) {</td></tr>
<tr><td class="h">10198</td><td><div class="c3">2</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$elements = $restrict-&gt;{elements} = [ grep { $_ } @$elements ];</td></tr>
<tr><td class="h">10199</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10199">50</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (1 == @$elements) { # Min. 2 interfaces/path restriction needed! </td></tr>
<tr><td class="h">10200</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$invalid = 1;</td></tr>
<tr><td class="h">10201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10203</td><td colspan="7"></td></tr><tr><td class="h">10204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove invalid pathrestrictions. </td></tr>
<tr><td class="h">10205</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10205">100</a></div></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($invalid) {</td></tr>
<tr><td class="h">10206</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$elements = $restrict-&gt;{elements} = [];</td></tr>
<tr><td class="h">10207</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">10208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10209</td><td colspan="7"></td></tr><tr><td class="h">10210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for useless pathrestrictions that do not affect any ACLs...</td></tr>
<tr><td class="h">10211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Pathrestrictions at managed routers do most probably have an effect.</td></tr>
<tr><td class="h">10212</td><td><div class="c3">60</div><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10212">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10212">100</a></div></td><td></td><td></td><td></td><td><div>71</div><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $_-&gt;{router}-&gt;{managed} || $_-&gt;{router}-&gt;{routing_only} }</td></tr>
<tr><td class="h">10213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$elements)</td></tr>
<tr><td class="h">10214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and next;</td></tr>
<tr><td class="h">10215</td><td colspan="7"></td></tr><tr><td class="h">10216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Pathrestrictions spanning different zone clusters have an effect.</td></tr>
<tr><td class="h">10217</td><td><div class="c3">12</div><div class="c3">26</div><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10217">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10217">50</a></div></td><td></td><td></td><td></td><td><div>15</div><div>59</div><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal(map { $_-&gt;{zone_cluster} || $_ } map { $_-&gt;{zone} } @$elements)</td></tr>
<tr><td class="h">10218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">10219</td><td colspan="7"></td></tr><tr><td class="h">10220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Pathrestrictions in loops with &gt; 1 zone cluster have an effect.</td></tr>
<tr><td class="h">10221</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $element&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $elements-&gt;[0];</td></tr>
<tr><td class="h">10222</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $element-&gt;{loop};</td></tr>
<tr><td class="h">10223</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $element-&gt;{zone};</td></tr>
<tr><td class="h">10224</td><td><div class="c3">12</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10224">50</a></div></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone_cluster = $zone-&gt;{zone_cluster} || [$zone];</td></tr>
<tr><td class="h">10225</td><td colspan="7"></td></tr><tr><td class="h">10226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Process every zone in zone cluster...</td></tr>
<tr><td class="h">10227</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone1 (@$zone_cluster) {</td></tr>
<tr><td class="h">10228</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>11</div><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">10229</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">10230</td><td colspan="7"></td></tr><tr><td class="h">10231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ...examine its neighbour zones:</td></tr>
<tr><td class="h">10232</td><td><div class="c3">24</div><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>19</div><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface2 (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">10233</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone2 = $interface2-&gt;{zone};</td></tr>
<tr><td class="h">10234</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10234">100</a></div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone2 eq $zone;</td></tr>
<tr><td class="h">10235</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10235">100</a></div></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cluster2 = $zone2-&gt;{zone_cluster}) {</td></tr>
<tr><td class="h">10236</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10236">100</a></div></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $cluster2 eq $zone_cluster;</td></tr>
<tr><td class="h">10237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10238</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10238">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $loop2 = $zone2-&gt;{loop}) {</td></tr>
<tr><td class="h">10239</td><td><div class="c3">10</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10239">50</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($loop eq $loop2) {</td></tr>
<tr><td class="h">10240</td><td colspan="7"></td></tr><tr><td class="h">10241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found other zone cluster in same loop.</td></tr>
<tr><td class="h">10242</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next RESTRICT;</td></tr>
<tr><td class="h">10243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10248</td><td colspan="7"></td></tr><tr><td class="h">10249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Empty interface array of useless pathrestrictions</td></tr>
<tr><td class="h">10250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">10251</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Useless $restrict-&gt;{name}.\n&quot;,</td></tr>
<tr><td class="h">10252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; All interfaces are unmanaged and&quot;,</td></tr>
<tr><td class="h">10253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; located inside the same security zone&quot;</td></tr>
<tr><td class="h">10254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">10255</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{elements} = [];</td></tr>
<tr><td class="h">10256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10257</td><td colspan="7"></td></tr><tr><td class="h">10258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect all effective pathrestrictions.</td></tr>
<tr><td class="h">10259</td><td><div class="c3">726</div><div class="c3">64</div><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>890</div><div>51</div><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @pathrestrictions, grep({ @{ $_-&gt;{elements} } } </td></tr>
<tr><td class="h">10260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %pathrestrictions);</td></tr>
<tr><td class="h">10261</td><td colspan="7"></td></tr><tr><td class="h">10262</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>599</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10264</td><td colspan="7"></td></tr><tr><td class="h">10265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Optimize a class of pathrestrictions.</td></tr>
<tr><td class="h">10267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find partitions of cyclic graphs that are separated</td></tr>
<tr><td class="h">10268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># by pathrestrictions.</td></tr>
<tr><td class="h">10269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This allows faster graph traversal.</td></tr>
<tr><td class="h">10270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># When entering a partition, we can already decide,</td></tr>
<tr><td class="h">10271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># if end of path is reachable or not.</td></tr>
<tr><td class="h">10272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">10274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Mark every element of a loop partition with the partitions</td></tr>
<tr><td class="h">10275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identity number.</td></tr>
<tr><td class="h">10276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter: $obj - current node on loop path (zone/router)</td></tr>
<tr><td class="h">10277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_interface - interface we come from</td></tr>
<tr><td class="h">10278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark - unique identity number of the loop partition</td></tr>
<tr><td class="h">10279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lookup - hash stores interfaces of the processed pathrestriction</td></tr>
<tr><td class="h">10280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub traverse_loop_part {</td></tr>
<tr><td class="h">10281</td><td><div class="c3">672</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10281">672</a></div></td><td><div class="c0">0</div></td><td><div>714</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $in_interface, $mark, $lookup) = @_;</td></tr>
<tr><td class="h">10282</td><td colspan="7"></td></tr><tr><td class="h">10283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return if current node has been processed before.</td></tr>
<tr><td class="h">10284</td><td><div class="c3">672</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10284">100</a></div></td><td></td><td></td><td></td><td><div>1206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $obj-&gt;{reachable_part}-&gt;{$mark};</td></tr>
<tr><td class="h">10285</td><td><div class="c3">572</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10285">50</a></div></td><td></td><td></td><td></td><td><div>788</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $obj-&gt;{active_path};</td></tr>
<tr><td class="h">10286</td><td colspan="7"></td></tr><tr><td class="h">10287</td><td><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>710</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $obj-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">10288</td><td><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>643</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $is_zone = is_zone($obj);</td></tr>
<tr><td class="h">10289</td><td colspan="7"></td></tr><tr><td class="h">10290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mark current node ($obj) as member of partition.</td></tr>
<tr><td class="h">10291</td><td><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{reachable_part}-&gt;{$mark} = 1;</td></tr>
<tr><td class="h">10292</td><td colspan="7"></td></tr><tr><td class="h">10293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$obj-&gt;{name} in loop part $mark&quot;;</td></tr>
<tr><td class="h">10294</td><td colspan="7"></td></tr><tr><td class="h">10295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Proceed pathwalk with adjacent objects.</td></tr>
<tr><td class="h">10296</td><td><div class="c3">572</div><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>449</div><div>709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $obj-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">10297</td><td colspan="7"></td></tr><tr><td class="h">10298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip unessential interfaces.</td></tr>
<tr><td class="h">10299</td><td><div class="c3">1888</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10299">100</a></div></td><td></td><td></td><td></td><td><div>3356</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_interface;</td></tr>
<tr><td class="h">10300</td><td><div class="c3">1316</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10300">100</a></div></td><td></td><td></td><td></td><td><div>2055</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">10301</td><td colspan="7"></td></tr><tr><td class="h">10302</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Stop at other interfaces of the processed pathrestriction.</td></tr>
<tr><td class="h">10303</td><td><div class="c3">812</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10303">100</a></div></td><td></td><td></td><td></td><td><div>1276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $reached = $lookup-&gt;{$interface}) {</td></tr>
<tr><td class="h">10304</td><td><div class="c3">242</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10304">100</a></div></td><td></td><td></td><td></td><td><div>307</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $current = $is_zone ? &#39;zone&#39; : &#39;router&#39;;</td></tr>
<tr><td class="h">10305</td><td><div class="c3">242</div></td><td></td><td></td><td></td><td></td><td><div>470</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reached-&gt;{$current} = $mark;&nbsp;&nbsp;&nbsp;&nbsp;# store partition in lookup hash</td></tr>
<tr><td class="h">10306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10307</td><td colspan="7"></td></tr><tr><td class="h">10308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Continue path walk on loop path otherwise.</td></tr>
<tr><td class="h">10309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10310</td><td><div class="c3">570</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10310">100</a></div></td><td></td><td></td><td></td><td><div>870</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$interface-&gt;{loop};</td></tr>
<tr><td class="h">10311</td><td><div class="c3">458</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10311">100</a></div></td><td></td><td></td><td></td><td><div>619</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = $interface-&gt;{ $is_zone ? &#39;router&#39; : &#39;zone&#39; };</td></tr>
<tr><td class="h">10312</td><td><div class="c3">458</div></td><td></td><td></td><td></td><td></td><td><div>622</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traverse_loop_part($next, $interface, $mark, $lookup);</td></tr>
<tr><td class="h">10313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10315</td><td><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>947</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10317</td><td colspan="7"></td></tr><tr><td class="h">10318</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">10319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Analyze found partitions and optimize pathrestrictions.</td></tr>
<tr><td class="h">10320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $restrict - pathrestriction to optimize (hash reference)</td></tr>
<tr><td class="h">10321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$elements - interfaces of the pathrestriction (array reference)</td></tr>
<tr><td class="h">10322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lookup - stores adjacent partitions for every IF in elements.</td></tr>
<tr><td class="h">10323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub apply_pathrestriction_optimization {</td></tr>
<tr><td class="h">10324</td><td><div class="c3">96</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10324">96</a></div></td><td><div class="c0">0</div></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($restrict, $elements, $lookup) = @_;</td></tr>
<tr><td class="h">10325</td><td colspan="7"></td></tr><tr><td class="h">10326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No outgoing restriction needed for a pathrestriction surrounding a</td></tr>
<tr><td class="h">10327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# single zone. A rule from zone to zone would be unenforceable anyway.</td></tr>
<tr><td class="h">10328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">10329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# But this restriction is needed for one special case:</td></tr>
<tr><td class="h">10330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# src=zone, dst=interface:r.zone</td></tr>
<tr><td class="h">10331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# We must not enter router:r from outside the zone.</td></tr>
<tr><td class="h">10332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (equal(map { $_-&gt;{zone} } @$elements)) {</td></tr>
<tr><td class="h">10333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lookup-&gt;{$_}-&gt;{router} = &#39;none&#39; for @$elements;</td></tr>
<tr><td class="h">10334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10335</td><td colspan="7"></td></tr><tr><td class="h">10336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Examine interfaces in or between found partitions.</td></tr>
<tr><td class="h">10337</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $has_interior;&nbsp;&nbsp;&nbsp;&nbsp;# To count number of interfaces inside a partition.</td></tr>
<tr><td class="h">10338</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$elements) {</td></tr>
<tr><td class="h">10339</td><td><div class="c3">200</div></td><td></td><td></td><td></td><td></td><td><div>241</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $reached = $lookup-&gt;{$interface};</td></tr>
<tr><td class="h">10340</td><td colspan="7"></td></tr><tr><td class="h">10341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Count pathrestriction interfaces inside a partition.</td></tr>
<tr><td class="h">10342</td><td><div class="c3">200</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10342">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10342">33</a></div></td><td></td><td></td><td><div>516</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$reached-&gt;{zone} eq $reached-&gt;{router}</td></tr>
<tr><td class="h">10343</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $reached-&gt;{zone} ne &#39;none&#39;)</td></tr>
<tr><td class="h">10344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">10345</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_interior++;</td></tr>
<tr><td class="h">10346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10347</td><td colspan="7"></td></tr><tr><td class="h">10348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store reachable partitions in the interfaces {reachable_at} hash</td></tr>
<tr><td class="h">10349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10350</td><td><div class="c3">200</div></td><td></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $direction (qw(zone router)) {</td></tr>
<tr><td class="h">10351</td><td><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mark = $reached-&gt;{$direction};</td></tr>
<tr><td class="h">10352</td><td><div class="c3">400</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10352">50</a></div></td><td></td><td></td><td></td><td><div>558</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $mark eq &#39;none&#39;;</td></tr>
<tr><td class="h">10353</td><td><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $interface-&gt;{$direction};</td></tr>
<tr><td class="h">10354</td><td><div class="c3">400</div><div class="c3">400</div></td><td></td><td></td><td></td><td></td><td><div>277</div><div>1220</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $interface-&gt;{reachable_at}-&gt;{$obj} }, $mark;</td></tr>
<tr><td class="h">10355</td><td colspan="7"></td></tr><tr><td class="h">10356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#debug &quot;$interface-&gt;{name}: $direction $mark&quot;;</td></tr>
<tr><td class="h">10357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10360</td><td colspan="7"></td></tr><tr><td class="h">10361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Delete pathrestriction objects, if {reachable_at} holds entire info.</td></tr>
<tr><td class="h">10362</td><td><div class="c3">96</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10362">50</a></div></td><td></td><td></td><td></td><td><div>150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$has_interior) {&nbsp;&nbsp;&nbsp;# Interfaces must not be located inside a partition.</td></tr>
<tr><td class="h">10363</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$elements) {</td></tr>
<tr><td class="h">10364</td><td colspan="7"></td></tr><tr><td class="h">10365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#debug &quot;remove $restrict-&gt;{name} from $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">10366</td><td><div class="c3">200</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10366">50</a></div></td><td></td><td></td><td></td><td><div>274</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aref_delete($interface-&gt;{path_restrict}, $restrict)</td></tr>
<tr><td class="h">10367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Can&#39;t remove $restrict-&gt;{name}&quot;,</td></tr>
<tr><td class="h">10368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10369</td><td colspan="7"></td></tr><tr><td class="h">10370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Delete empty array to speed up checks in cluster_path_mark.</td></tr>
<tr><td class="h">10371</td><td><div class="c3">200</div><div class="c3">200</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10371">100</a></div></td><td></td><td></td><td></td><td><div>167</div><div>341</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!@{ $interface-&gt;{path_restrict} }) {</td></tr>
<tr><td class="h">10372</td><td><div class="c3">194</div></td><td></td><td></td><td></td><td></td><td><div>344</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{path_restrict};</td></tr>
<tr><td class="h">10373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Can&#39;t opt. $restrict-&gt;{name}, has $has_interior interior&quot;;</td></tr>
<tr><td class="h">10378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10379</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>284</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10381</td><td colspan="7"></td></tr><tr><td class="h">10382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">10383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Find partitions of loops that are separated by pathrestrictions.</td></tr>
<tr><td class="h">10384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mark every node of a partition with a unique number that is</td></tr>
<tr><td class="h">10385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attached to the partitions routers and zones, and every</td></tr>
<tr><td class="h">10386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathrestriction with a list of partitions that ca be reached.</td></tr>
<tr><td class="h">10387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub optimize_pathrestrictions {</td></tr>
<tr><td class="h">10388</td><td><div class="c3">726</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10388">726</a></div></td><td><div class="c0">0</div></td><td><div>644</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mark = 1;</td></tr>
<tr><td class="h">10389</td><td colspan="7"></td></tr><tr><td class="h">10390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process every pathrestriction.</td></tr>
<tr><td class="h">10391</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>887</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@pathrestrictions) {</td></tr>
<tr><td class="h">10392</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $elements = $restrict-&gt;{elements};</td></tr>
<tr><td class="h">10393</td><td colspan="7"></td></tr><tr><td class="h">10394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create lookup hash with the pathrestrictions interfaces as keys to</td></tr>
<tr><td class="h">10395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# store the partitions every interface adjoins in zone/router direction.</td></tr>
<tr><td class="h">10396</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>119</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $lookup = {};</td></tr>
<tr><td class="h">10397</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$elements) {</td></tr>
<tr><td class="h">10398</td><td><div class="c3">238</div></td><td></td><td></td><td></td><td></td><td><div>492</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lookup-&gt;{$interface} = {};&nbsp;&nbsp;&nbsp;&nbsp;# Initial values are empty hashes.</td></tr>
<tr><td class="h">10399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10400</td><td colspan="7"></td></tr><tr><td class="h">10401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# From every interface, traverse loop in both directions.</td></tr>
<tr><td class="h">10402</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $start_mark = $mark;</td></tr>
<tr><td class="h">10403</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$elements) {</td></tr>
<tr><td class="h">10404</td><td><div class="c3">238</div></td><td></td><td></td><td></td><td></td><td><div>297</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $reached = $lookup-&gt;{$interface};</td></tr>
<tr><td class="h">10405</td><td><div class="c3">238</div></td><td></td><td></td><td></td><td></td><td><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $direction (qw(zone router)) {</td></tr>
<tr><td class="h">10406</td><td colspan="7"></td></tr><tr><td class="h">10407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip direction where interface was already reached from.</td></tr>
<tr><td class="h">10408</td><td><div class="c3">476</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10408">100</a></div></td><td></td><td></td><td></td><td><div>883</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $reached-&gt;{$direction};&nbsp;&nbsp;&nbsp;&nbsp;# Already a partition stored.</td></tr>
<tr><td class="h">10409</td><td colspan="7"></td></tr><tr><td class="h">10410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For interfaces at loop border, skip direction leaving the loop</td></tr>
<tr><td class="h">10411</td><td><div class="c3">234</div></td><td></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $interface-&gt;{$direction};</td></tr>
<tr><td class="h">10412</td><td><div class="c3">234</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10412">100</a></div></td><td></td><td></td><td></td><td><div>381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$obj-&gt;{loop}) {</td></tr>
<tr><td class="h">10413</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reached-&gt;{$direction} = &#39;none&#39;;</td></tr>
<tr><td class="h">10414</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">10415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10416</td><td colspan="7"></td></tr><tr><td class="h">10417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store adjoining partition of the interface.</td></tr>
<tr><td class="h">10418</td><td><div class="c3">214</div></td><td></td><td></td><td></td><td></td><td><div>244</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reached-&gt;{$direction} = $mark;</td></tr>
<tr><td class="h">10419</td><td colspan="7"></td></tr><tr><td class="h">10420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Traverse loop path and mark loop partition.</td></tr>
<tr><td class="h">10421</td><td><div class="c3">214</div></td><td></td><td></td><td></td><td></td><td><div>275</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traverse_loop_part($obj, $interface, $mark, $lookup);</td></tr>
<tr><td class="h">10422</td><td><div class="c3">214</div></td><td></td><td></td><td></td><td></td><td><div>293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mark++;</td></tr>
<tr><td class="h">10423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10425</td><td colspan="7"></td></tr><tr><td class="h">10426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Optimize pathrestriction.</td></tr>
<tr><td class="h">10427</td><td><div class="c3">114</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10427">100</a></div></td><td></td><td></td><td></td><td><div>240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($mark &gt; $start_mark + 1) {&nbsp;&nbsp;&nbsp;&nbsp;# Optimization needs 2 partitions min.</td></tr>
<tr><td class="h">10428</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply_pathrestriction_optimization($restrict, $elements, $lookup);</td></tr>
<tr><td class="h">10429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10431</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10433</td><td colspan="7"></td></tr><tr><td class="h">10434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Set paths for efficient topology traversal</td></tr>
<tr><td class="h">10436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Find a path from every zone and router to zone1; store the</td></tr>
<tr><td class="h">10438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance to zone1 in every object visited; identify loops and</td></tr>
<tr><td class="h">10439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add loop marker references to loop nodes.</td></tr>
<tr><td class="h">10440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter: $obj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: zone or managed or semi-managed router</td></tr>
<tr><td class="h">10441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_zone1: interface of $obj; denotes the direction to reach zone1</td></tr>
<tr><td class="h">10442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$distance: distance to zone1</td></tr>
<tr><td class="h">10443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;: 1. maximal value of $distance used in current subtree.</td></tr>
<tr><td class="h">10444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. undef, if found path is not part of a loop or loop-marker</td></tr>
<tr><td class="h">10445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise.</td></tr>
<tr><td class="h">10446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments : Loop markers store following information:</td></tr>
<tr><td class="h">10447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- exit: node of the loop where zone1 is reached</td></tr>
<tr><td class="h">10448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- distance: distance of loop exit node + 1. It is needed, as the</td></tr>
<tr><td class="h">10449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodes own distance values are later reset zo the value of the</td></tr>
<tr><td class="h">10450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster exit object. The intermediate value is required by</td></tr>
<tr><td class="h">10451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_navigation to work.</td></tr>
<tr><td class="h">10452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setpath_obj;</td></tr>
<tr><td class="h">10453</td><td colspan="7"></td></tr><tr><td class="h">10454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setpath_obj {</td></tr>
<tr><td class="h">10455</td><td><div class="c3">4131</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10455">4131</a></div></td><td><div class="c0">0</div></td><td><div>3822</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $to_zone1, $distance) = @_;</td></tr>
<tr><td class="h">10456</td><td colspan="7"></td></tr><tr><td class="h">10457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#debug(&quot;--$distance: $obj-&gt;{name} --&gt; &quot;. ($to_zone1 &amp;&amp; $to_zone1-&gt;{name}));</td></tr>
<tr><td class="h">10458</td><td colspan="7"></td></tr><tr><td class="h">10459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return from recursion if loop was found.</td></tr>
<tr><td class="h">10460</td><td><div class="c3">4131</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10460">100</a></div></td><td></td><td></td><td></td><td><div>5942</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{active_path}) {&nbsp;&nbsp;&nbsp;# Loop found, node might be loop exit to zone1.</td></tr>
<tr><td class="h">10461</td><td colspan="7"></td></tr><tr><td class="h">10462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create unique loop marker, which will be added to all loop members.</td></tr>
<tr><td class="h">10463</td><td><div class="c3">446</div></td><td></td><td></td><td></td><td></td><td><div>423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_distance = $obj-&gt;{distance} + 1;</td></tr>
<tr><td class="h">10464</td><td><div class="c3">446</div></td><td></td><td></td><td></td><td></td><td><div>972</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop = $to_zone1-&gt;{loop} = {</td></tr>
<tr><td class="h">10465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $obj,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reference exit node.</td></tr>
<tr><td class="h">10466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance =&gt; $new_distance,&nbsp;&nbsp;&nbsp;&nbsp;# Required for cluster navigation.</td></tr>
<tr><td class="h">10467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">10468</td><td><div class="c3">446</div></td><td></td><td></td><td></td><td></td><td><div>665</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($new_distance, $loop);</td></tr>
<tr><td class="h">10469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10470</td><td colspan="7"></td></tr><tr><td class="h">10471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Continue graph exploration otherwise.</td></tr>
<tr><td class="h">10472</td><td><div class="c3">3685</div></td><td></td><td></td><td></td><td></td><td><div>4412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $obj-&gt;{active_path} = 1;&nbsp;&nbsp;&nbsp;&nbsp;# Mark current path for loop detection.</td></tr>
<tr><td class="h">10473</td><td><div class="c3">3685</div></td><td></td><td></td><td></td><td></td><td><div>3558</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{distance} = $distance;</td></tr>
<tr><td class="h">10474</td><td><div class="c3">3685</div></td><td></td><td></td><td></td><td></td><td><div>2785</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $max_distance = $distance;</td></tr>
<tr><td class="h">10475</td><td colspan="7"></td></tr><tr><td class="h">10476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process all of the objects interfaces.</td></tr>
<tr><td class="h">10477</td><td><div class="c3">3685</div><div class="c3">3685</div></td><td></td><td></td><td></td><td></td><td><div>2706</div><div>4609</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $obj-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">10478</td><td colspan="7"></td></tr><tr><td class="h">10479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip interfaces:</td></tr>
<tr><td class="h">10480</td><td><div class="c3">6744</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10480">100</a></div></td><td></td><td></td><td></td><td><div>13212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $to_zone1;&nbsp;&nbsp;# Interface where we reached this obj.</td></tr>
<tr><td class="h">10481</td><td><div class="c3">3818</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10481">100</a></div></td><td></td><td></td><td></td><td><div>5563</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{loop}; # Interface is entry of already marked loop.</td></tr>
<tr><td class="h">10482</td><td colspan="7"></td></tr><tr><td class="h">10483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get adjacent object/node.</td></tr>
<tr><td class="h">10484</td><td><div class="c3">3372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10484">100</a></div></td><td></td><td></td><td></td><td><div>3943</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $get_next = is_router($obj) ? &#39;zone&#39; : &#39;router&#39;;</td></tr>
<tr><td class="h">10485</td><td><div class="c3">3372</div></td><td></td><td></td><td></td><td></td><td><div>3668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = $interface-&gt;{$get_next};</td></tr>
<tr><td class="h">10486</td><td colspan="7"></td></tr><tr><td class="h">10487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Proceed with next node (distance + 2 to enable intermediate values).</td></tr>
<tr><td class="h">10488</td><td><div class="c3">3372</div></td><td></td><td></td><td></td><td></td><td><div>5318</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $max, my $loop) = setpath_obj($next, $interface, $distance + 2);</td></tr>
<tr><td class="h">10489</td><td><div class="c3">3372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10489">100</a></div></td><td></td><td></td><td></td><td><div>4930</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max_distance = $max if $max &gt; $max_distance;</td></tr>
<tr><td class="h">10490</td><td colspan="7"></td></tr><tr><td class="h">10491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Process recursion stack: Node is on a loop path.</td></tr>
<tr><td class="h">10492</td><td><div class="c3">3372</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10492">100</a></div></td><td></td><td></td><td></td><td><div>4151</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($loop) {</td></tr>
<tr><td class="h">10493</td><td><div class="c3">1464</div></td><td></td><td></td><td></td><td></td><td><div>1422</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{loop} = $loop;</td></tr>
<tr><td class="h">10494</td><td><div class="c3">1464</div></td><td></td><td></td><td></td><td></td><td><div>1229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop_obj = $loop-&gt;{exit};</td></tr>
<tr><td class="h">10495</td><td colspan="7"></td></tr><tr><td class="h">10496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found exit of loop in direction to zone1.</td></tr>
<tr><td class="h">10497</td><td><div class="c3">1464</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10497">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10497">100</a></div></td><td></td><td></td><td></td><td><div>2877</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj eq $loop_obj) {</td></tr>
<tr><td class="h">10498</td><td colspan="7"></td></tr><tr><td class="h">10499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark exit node with a different loop marker linking to itself.</td></tr>
<tr><td class="h">10500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If current loop is part of a cluster,</td></tr>
<tr><td class="h">10501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# this marker will be overwritten later.</td></tr>
<tr><td class="h">10502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise this is the exit of a cluster of loops.</td></tr>
<tr><td class="h">10503</td><td><div class="c3">330</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10503">100</a></div></td><td></td><td></td><td><div>1051</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{loop} ||= { exit =&gt; $obj, distance =&gt; $distance, };</td></tr>
<tr><td class="h">10504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10505</td><td colspan="7"></td></tr><tr><td class="h">10506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found intermediate loop node which was marked as loop before.</td></tr>
<tr><td class="h">10507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $loop2 = $obj-&gt;{loop}) {</td></tr>
<tr><td class="h">10508</td><td><div class="c3">116</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10508">50</a></div></td><td></td><td></td><td></td><td><div>206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($loop ne $loop2) {&nbsp;&nbsp;&nbsp;&nbsp;# Node is also part of another loop.</td></tr>
<tr><td class="h">10509</td><td colspan="7"></td></tr><tr><td class="h">10510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set reference to loop object with exit closer to zone1</td></tr>
<tr><td class="h">10511</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10511">100</a></div></td><td></td><td></td><td></td><td><div>167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($loop-&gt;{distance} &lt; $loop2-&gt;{distance}) {</td></tr>
<tr><td class="h">10512</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop2-&gt;{redirect} = $loop;&nbsp;&nbsp;&nbsp;&nbsp;# keep info in other loop</td></tr>
<tr><td class="h">10513</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{loop}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $loop;</td></tr>
<tr><td class="h">10514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10516</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop-&gt;{redirect} = $loop2;</td></tr>
<tr><td class="h">10517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10520</td><td colspan="7"></td></tr><tr><td class="h">10521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found intermediate loop node.</td></tr>
<tr><td class="h">10522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10523</td><td><div class="c3">1018</div></td><td></td><td></td><td></td><td></td><td><div>1916</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{loop} = $loop;</td></tr>
<tr><td class="h">10524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10525</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10527</td><td colspan="7"></td></tr><tr><td class="h">10528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark loop-less path.</td></tr>
<tr><td class="h">10529</td><td><div class="c3">1908</div></td><td></td><td></td><td></td><td></td><td><div>3539</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{to_zone1} = $obj;</td></tr>
<tr><td class="h">10530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10532</td><td colspan="7"></td></tr><tr><td class="h">10533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return from recursion after all interfaces have been processed.</td></tr>
<tr><td class="h">10534</td><td><div class="c3">3685</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10534">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10534">100</a></div></td><td></td><td></td><td><div>8981</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{loop} and $obj-&gt;{loop}-&gt;{exit} ne $obj) {</td></tr>
<tr><td class="h">10535</td><td><div class="c3">1018</div></td><td></td><td></td><td></td><td></td><td><div>1788</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($max_distance, $obj-&gt;{loop});</td></tr>
<tr><td class="h">10536</td><td colspan="7"></td></tr><tr><td class="h">10537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10539</td><td><div class="c3">2667</div></td><td></td><td></td><td></td><td></td><td><div>2825</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{to_zone1} = $to_zone1;</td></tr>
<tr><td class="h">10540</td><td><div class="c3">2667</div></td><td></td><td></td><td></td><td></td><td><div>4611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $max_distance;</td></tr>
<tr><td class="h">10541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10543</td><td colspan="7"></td></tr><tr><td class="h">10544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">################################################################################</td></tr>
<tr><td class="h">10545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Identify clusters of directly connected loops in cactus graphs.</td></tr>
<tr><td class="h">10546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find exit node of loop cluster or single loop in direction to</td></tr>
<tr><td class="h">10547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone1; add this exit node as marker to all loop objects of the</td></tr>
<tr><td class="h">10548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster.</td></tr>
<tr><td class="h">10549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter: $loop: Top-level loop object (after redirection).</td></tr>
<tr><td class="h">10550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;: A reference to the loop cluster exit node.</td></tr>
<tr><td class="h">10551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_loop_cluster {</td></tr>
<tr><td class="h">10552</td><td><div class="c3">1474</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10552">1474</a></div></td><td><div class="c0">0</div></td><td><div>1091</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($loop) = @_;</td></tr>
<tr><td class="h">10553</td><td colspan="7"></td></tr><tr><td class="h">10554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return loop cluster exit node, if loop has been processed before.</td></tr>
<tr><td class="h">10555</td><td><div class="c3">1474</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10555">100</a></div></td><td></td><td></td><td></td><td><div>1802</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $marker = $loop-&gt;{cluster_exit}) {</td></tr>
<tr><td class="h">10556</td><td><div class="c3">1018</div></td><td></td><td></td><td></td><td></td><td><div>982</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $marker;</td></tr>
<tr><td class="h">10557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10559</td><td colspan="7"></td></tr><tr><td class="h">10560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Examine the loop object referenced in the loops exit node.</td></tr>
<tr><td class="h">10561</td><td><div class="c3">456</div></td><td></td><td></td><td></td><td></td><td><div>392</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $exit = $loop-&gt;{exit};</td></tr>
<tr><td class="h">10562</td><td colspan="7"></td></tr><tr><td class="h">10563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Exit node references itself: loop cluster exit found.</td></tr>
<tr><td class="h">10564</td><td><div class="c3">456</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10564">100</a></div></td><td></td><td></td><td></td><td><div>787</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($exit-&gt;{loop} eq $loop) {&nbsp;&nbsp;&nbsp;&nbsp;# Exit node references itself.</td></tr>
<tr><td class="h">10565</td><td colspan="7"></td></tr><tr><td class="h">10566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Loop $exit-&gt;{name},$loop-&gt;{distance} is in cluster $exit-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10567</td><td><div class="c3">126</div></td><td></td><td></td><td></td><td></td><td><div>219</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $loop-&gt;{cluster_exit} = $exit;</td></tr>
<tr><td class="h">10568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10569</td><td colspan="7"></td></tr><tr><td class="h">10570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Exit node references another loop: proceed with next loop of cluster</td></tr>
<tr><td class="h">10571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10572</td><td><div class="c3">330</div></td><td></td><td></td><td></td><td></td><td><div>458</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = set_loop_cluster($exit-&gt;{loop});</td></tr>
<tr><td class="h">10573</td><td colspan="7"></td></tr><tr><td class="h">10574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Loop $exit-&gt;{name},$loop-&gt;{distance} is in cluster $cluster-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10575</td><td><div class="c3">330</div></td><td></td><td></td><td></td><td></td><td><div>450</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $loop-&gt;{cluster_exit} = $cluster;</td></tr>
<tr><td class="h">10576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10579</td><td colspan="7"></td></tr><tr><td class="h">10580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">10581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Set node distances to a randomly chosen start zone. Identify loops</td></tr>
<tr><td class="h">10582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inside the graph topology, tag nodes of a cycle with a common</td></tr>
<tr><td class="h">10583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loop object and distance.</td></tr>
<tr><td class="h">10584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_dists_and_loops {</td></tr>
<tr><td class="h">10585</td><td><div class="c3">736</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10585">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10585">736</a></div></td><td><div class="c0">0</div></td><td><div>1419</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@zones or fatal_err(&quot;Topology seems to be empty&quot;);</td></tr>
<tr><td class="h">10586</td><td><div class="c3">726</div><div class="c3">1925</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10586">100</a></div></td><td></td><td></td><td></td><td><div>845</div><div>4392</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @path_routers = grep { $_-&gt;{managed} || $_-&gt;{semi_managed} } @routers;</td></tr>
<tr><td class="h">10587</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>687</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $start_distance = 0;</td></tr>
<tr><td class="h">10588</td><td colspan="7"></td></tr><tr><td class="h">10589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find one or more disconnected parts in whole topology.</td></tr>
<tr><td class="h">10590</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>871</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@zones, @path_routers) {</td></tr>
<tr><td class="h">10591</td><td><div class="c3">3645</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10591">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10591">100</a></div></td><td></td><td></td><td><div>9287</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $obj-&gt;{to_zone1} or $obj-&gt;{loop};&nbsp;&nbsp;# Objects have been processed</td></tr>
<tr><td class="h">10592</td><td colspan="7"></td></tr><tr><td class="h">10593</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Chose an arbitrary node to start from.</td></tr>
<tr><td class="h">10594</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>660</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone1 = $obj;</td></tr>
<tr><td class="h">10595</td><td colspan="7"></td></tr><tr><td class="h">10596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Traverse all nodes connected to zone1.</td></tr>
<tr><td class="h">10597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Second parameter stands for not existing starting interface.</td></tr>
<tr><td class="h">10598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Value must be &quot;false&quot; and unequal to any interface.</td></tr>
<tr><td class="h">10599</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>1084</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max = setpath_obj($zone1, &#39;&#39;, $start_distance);</td></tr>
<tr><td class="h">10600</td><td><div class="c3">759</div></td><td></td><td></td><td></td><td></td><td><div>988</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_distance = $max + 1;&nbsp;&nbsp;&nbsp;&nbsp;# TODO: why mark disconnected partitions?</td></tr>
<tr><td class="h">10601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10602</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>934</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10604</td><td colspan="7"></td></tr><tr><td class="h">10605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">10606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Include node objects and interfaces of nested loops in the</td></tr>
<tr><td class="h">10607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containing loop; add loop cluster exits; adjust distances of</td></tr>
<tr><td class="h">10608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loop nodes.</td></tr>
<tr><td class="h">10609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub process_loops {</td></tr>
<tr><td class="h">10610</td><td colspan="7"></td></tr><tr><td class="h">10611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check all nodes located inside a cyclic graph.</td></tr>
<tr><td class="h">10612</td><td><div class="c3">726</div><div class="c3">1925</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10612">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10612">726</a></div></td><td><div class="c0">0</div></td><td><div>836</div><div>4377</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @path_routers = grep { $_-&gt;{managed} || $_-&gt;{semi_managed} } @routers;</td></tr>
<tr><td class="h">10613</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>898</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@zones, @path_routers) {</td></tr>
<tr><td class="h">10614</td><td><div class="c3">3645</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10614">100</a></div></td><td></td><td></td><td></td><td><div>5875</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop = $obj-&gt;{loop} or next;</td></tr>
<tr><td class="h">10615</td><td colspan="7"></td></tr><tr><td class="h">10616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Include sub-loop nodes into containing loop with exit closest to zone1</td></tr>
<tr><td class="h">10617</td><td><div class="c3">1144</div></td><td></td><td></td><td></td><td></td><td><div>1781</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my $next = $loop-&gt;{redirect}) {</td></tr>
<tr><td class="h">10618</td><td colspan="7"></td></tr><tr><td class="h">10619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#debug(&quot;Redirect: $loop-&gt;{exit}-&gt;{name} -&gt; $next-&gt;{exit}-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10620</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop = $next;</td></tr>
<tr><td class="h">10621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10622</td><td><div class="c3">1144</div></td><td></td><td></td><td></td><td></td><td><div>951</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{loop} = $loop;</td></tr>
<tr><td class="h">10623</td><td colspan="7"></td></tr><tr><td class="h">10624</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark loops with cluster exit, needed for cactus graph loop clusters.</td></tr>
<tr><td class="h">10625</td><td><div class="c3">1144</div></td><td></td><td></td><td></td><td></td><td><div>1201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_loop_cluster($loop);</td></tr>
<tr><td class="h">10626</td><td colspan="7"></td></tr><tr><td class="h">10627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set distance of loop node to value of cluster exit.</td></tr>
<tr><td class="h">10628</td><td><div class="c3">1144</div></td><td></td><td></td><td></td><td></td><td><div>1397</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{distance} = $loop-&gt;{cluster_exit}-&gt;{distance};&nbsp;&nbsp;# keeps loop dist</td></tr>
<tr><td class="h">10629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10630</td><td colspan="7"></td></tr><tr><td class="h">10631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Include sub-loop IFs into containing loop with exit closest to zone1.</td></tr>
<tr><td class="h">10632</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>889</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@path_routers) {</td></tr>
<tr><td class="h">10633</td><td><div class="c3">1493</div><div class="c3">1493</div></td><td></td><td></td><td></td><td></td><td><div>1094</div><div>1796</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">10634</td><td><div class="c3">3332</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10634">100</a></div></td><td></td><td></td><td></td><td><div>5985</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $loop = $interface-&gt;{loop}) {</td></tr>
<tr><td class="h">10635</td><td><div class="c3">1464</div></td><td></td><td></td><td></td><td></td><td><div>2049</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my $next = $loop-&gt;{redirect}) {</td></tr>
<tr><td class="h">10636</td><td><div class="c3">304</div></td><td></td><td></td><td></td><td></td><td><div>448</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop = $next;</td></tr>
<tr><td class="h">10637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10638</td><td><div class="c3">1464</div></td><td></td><td></td><td></td><td></td><td><div>2020</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{loop} = $loop;</td></tr>
<tr><td class="h">10639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10642</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>832</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10644</td><td colspan="7"></td></tr><tr><td class="h">10645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h">10646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Add navigation information to the nodes of the graph to</td></tr>
<tr><td class="h">10647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enable fast traversal; identify loops and perform further</td></tr>
<tr><td class="h">10648</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consistency checks.</td></tr>
<tr><td class="h">10649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setpath {</td></tr>
<tr><td class="h">10650</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10650">736</a></div></td><td><div class="c0">0</div></td><td><div>1423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Preparing fast path traversal&#39;);</td></tr>
<tr><td class="h">10651</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>960</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;find_dists_and_loops();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add navigation info.</td></tr>
<tr><td class="h">10652</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>986</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;process_loops();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Refine navigation info at loop nodes.</td></tr>
<tr><td class="h">10653</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_pathrestrictions();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Consistency checks, need {loop} attribute.</td></tr>
<tr><td class="h">10654</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_virtual_interfaces();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Consistency check, needs {loop} attribute.</td></tr>
<tr><td class="h">10655</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>892</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;optimize_pathrestrictions();&nbsp;&nbsp;&nbsp;&nbsp;# Add navigation info to pathrestricted IFs.</td></tr>
<tr><td class="h">10656</td><td><div class="c3">726</div></td><td></td><td></td><td></td><td></td><td><div>619</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">10657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10658</td><td colspan="7"></td></tr><tr><td class="h">10659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Efficient path traversal.</td></tr>
<tr><td class="h">10661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">####################################################################</td></tr>
<tr><td class="h">10662</td><td colspan="7"></td></tr><tr><td class="h">10663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %obj2path; # lookup hash, keys: source/destination objects, </td></tr>
<tr><td class="h">10664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values: corresponding path node objects</td></tr>
<tr><td class="h">10665</td><td colspan="7"></td></tr><tr><td class="h">10666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">10667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;: Provide path node objects for objects specified as src or dst.</td></tr>
<tr><td class="h">10668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter : Source or destination object from an elementary rule.</td></tr>
<tr><td class="h">10669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;: Reference to zone or router of the given object or reference </td></tr>
<tr><td class="h">10670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to object itself, if it is a pathrestricted interface. </td></tr>
<tr><td class="h">10671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;: Return value for given object is stored in %obj2path lookup hash.</td></tr>
<tr><td class="h">10672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_path {</td></tr>
<tr><td class="h">10673</td><td><div class="c3">1668</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10673">1668</a></div></td><td><div class="c0">0</div></td><td><div>1475</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">10674</td><td><div class="c3">1668</div></td><td></td><td></td><td></td><td></td><td><div>1616</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">10675</td><td><div class="c3">1668</div></td><td></td><td></td><td></td><td></td><td><div>1225</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result;</td></tr>
<tr><td class="h">10676</td><td colspan="7"></td></tr><tr><td class="h">10677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check whether path node of object is a zone or router.</td></tr>
<tr><td class="h">10678</td><td><div class="c3">1668</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10678">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10678">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10678">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10678">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10678">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10678">50</a></div></td><td></td><td></td><td></td><td><div>2780</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">10679</td><td><div class="c3">1150</div></td><td></td><td></td><td></td><td></td><td><div>1162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{zone};</td></tr>
<tr><td class="h">10680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39;) {</td></tr>
<tr><td class="h">10682</td><td><div class="c3">170</div></td><td></td><td></td><td></td><td></td><td><div>219</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">10683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">10685</td><td><div class="c3">302</div></td><td></td><td></td><td></td><td></td><td><div>305</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $obj-&gt;{router};</td></tr>
<tr><td class="h">10686</td><td><div class="c3">302</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10686">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10686">100</a></div></td><td></td><td></td><td><div>762</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed} || $router-&gt;{semi_managed}) {</td></tr>
<tr><td class="h">10687</td><td colspan="7"></td></tr><tr><td class="h">10688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If this is a secondary interface, we can&#39;t use it to enter</td></tr>
<tr><td class="h">10689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the router, because it has an active pathrestriction attached.</td></tr>
<tr><td class="h">10690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# But it doesn&#39;t matter if we use the main interface instead.</td></tr>
<tr><td class="h">10691</td><td><div class="c3">182</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10691">67</a></div></td><td></td><td></td><td><div>485</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $main = $obj-&gt;{main_interface} || $obj;</td></tr>
<tr><td class="h">10692</td><td colspan="7"></td></tr><tr><td class="h">10693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Special handling needed if $src or $dst is interface</td></tr>
<tr><td class="h">10694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# which has pathrestriction attached.</td></tr>
<tr><td class="h">10695</td><td><div class="c3">182</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10695">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10695">100</a></div></td><td></td><td></td><td><div>594</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($main-&gt;{path_restrict} || $main-&gt;{reachable_at}) {</td></tr>
<tr><td class="h">10696</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $main;</td></tr>
<tr><td class="h">10697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10699</td><td><div class="c3">142</div></td><td></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $main-&gt;{router};</td></tr>
<tr><td class="h">10700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else { # Unmanaged routers are part of zone objects.</td></tr>
<tr><td class="h">10703</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{network}-&gt;{zone}; </td></tr>
<tr><td class="h">10704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10706</td><td colspan="7"></td></tr><tr><td class="h">10707</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This is used, if called from path_auto_interfaces.</td></tr>
<tr><td class="h">10708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Router&#39;) {</td></tr>
<tr><td class="h">10709</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10709">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10709">100</a></div></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{managed} || $obj-&gt;{semi_managed}) {</td></tr>
<tr><td class="h">10710</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj;</td></tr>
<tr><td class="h">10711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10713</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{interfaces}-&gt;[0]-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">10714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10716</td><td colspan="7"></td></tr><tr><td class="h">10717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This is used, if path_walk is called from find_active_routes.</td></tr>
<tr><td class="h">10718</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Zone&#39;) {</td></tr>
<tr><td class="h">10719</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj;</td></tr>
<tr><td class="h">10720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10721</td><td colspan="7"></td></tr><tr><td class="h">10722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This is used, if expand_services without convert_hosts.</td></tr>
<tr><td class="h">10723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Host&#39;) {</td></tr>
<tr><td class="h">10724</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">10725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10727</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10729</td><td colspan="7"></td></tr><tr><td class="h">10730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#debug(&quot;get_path: $obj-&gt;{name} -&gt; $result-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10731</td><td><div class="c3">1668</div></td><td></td><td></td><td></td><td></td><td><div>4901</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ($obj2path{$obj} = $result);</td></tr>
<tr><td class="h">10732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10733</td><td colspan="7"></td></tr><tr><td class="h">10734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># When used as hash keys, Perl converts references to address strings - </td></tr>
<tr><td class="h">10735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># this&nbsp;&nbsp;hash is used to convert them back to references. </td></tr>
<tr><td class="h">10736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %key2obj;</td></tr>
<tr><td class="h">10737</td><td colspan="7"></td></tr><tr><td class="h">10738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">10739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Recursively find path through a loop or loop cluster for a </td></tr>
<tr><td class="h">10740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;given pair (start, end) of loop nodes, collect path information. </td></tr>
<tr><td class="h">10741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $obj - current (or start) loop node (zone or router).</td></tr>
<tr><td class="h">10742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_intf - interface current loop node was entered from. </td></tr>
<tr><td class="h">10743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end - loop node that is to be reached.</td></tr>
<tr><td class="h">10744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_intf - dst interface, if it is a pathrestricted interface</td></tr>
<tr><td class="h">10745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in or at border of current loop, undef otherwise.</td></tr>
<tr><td class="h">10746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path_tuples - hash to collect in and out interfaces of nodes on</td></tr>
<tr><td class="h">10747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detected path.</td></tr>
<tr><td class="h">10748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_leave - hash to collect last interfaces of loop path.</td></tr>
<tr><td class="h">10749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$navi - lookup hash to reduce search space, holds loops to enter.</td></tr>
<tr><td class="h">10750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;1, if path is found, 0 otherwise.</td></tr>
<tr><td class="h">10751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cluster_path_mark1 {</td></tr>
<tr><td class="h">10752</td><td><div class="c3">1892</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10752">1892</a></div></td><td><div class="c0">0</div></td><td><div>1918</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $in_intf, $end, $end_intf, $path_tuples, $loop_leave, $navi) = @_;</td></tr>
<tr><td class="h">10753</td><td colspan="7"></td></tr><tr><td class="h">10754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check if IF current node was entered at ($in_interface) is pathrestricted.</td></tr>
<tr><td class="h">10755</td><td><div class="c3">1892</div></td><td></td><td></td><td></td><td></td><td><div>1657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pathrestriction = $in_intf-&gt;{path_restrict};</td></tr>
<tr><td class="h">10756</td><td><div class="c3">1892</div></td><td></td><td></td><td></td><td></td><td><div>1538</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $reachable_at&nbsp;&nbsp;&nbsp;&nbsp;= $in_intf-&gt;{reachable_at};</td></tr>
<tr><td class="h">10757</td><td colspan="7"></td></tr><tr><td class="h">10758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;cluster_path_mark1: obj: $obj-&gt;{name},</td></tr>
<tr><td class="h">10759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_intf: $in_intf-&gt;{name} to: $end-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10760</td><td colspan="7"></td></tr><tr><td class="h">10761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Stop path exploration when activated PR (2nd occurrence) was passed.</td></tr>
<tr><td class="h">10762</td><td><div class="c3">1892</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10762">100</a></div></td><td></td><td></td><td></td><td><div>2469</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($pathrestriction) {</td></tr>
<tr><td class="h">10763</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$pathrestriction) {</td></tr>
<tr><td class="h">10764</td><td><div class="c3">84</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10764">100</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($restrict-&gt;{active_path}) {</td></tr>
<tr><td class="h">10765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; effective $restrict-&gt;{name} at $in_intf-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10766</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">10767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10770</td><td colspan="7"></td></tr><tr><td class="h">10771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check optimized pathrestriction: is $end_intf reachable?</td></tr>
<tr><td class="h">10772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# To achieve equal routes for every IP of a network, zone of </td></tr>
<tr><td class="h">10773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $end_intf (instead of its router) must be reached to find a valid path.</td></tr>
<tr><td class="h">10774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# As the interfaces zone can be located behind its router, which is the </td></tr>
<tr><td class="h">10775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# end node of the loop path, this test must be performed before checking</td></tr>
<tr><td class="h">10776</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# whether end node was reached and a path was found.&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">10777</td><td><div class="c3">1854</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10777">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10777">100</a></div></td><td></td><td></td><td><div>3477</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($reachable_at &amp;&amp; $end_intf &amp;&amp; </td></tr>
<tr><td class="h">10778</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_intf ne $in_intf) { # Valid path found otherwise.&nbsp;&nbsp;</td></tr>
<tr><td class="h">10779</td><td><div class="c3">60</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10779">50</a></div></td><td></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $reachable = $reachable_at-&gt;{$obj}) {</td></tr>
<tr><td class="h">10780</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other = $end_intf-&gt;{zone};</td></tr>
<tr><td class="h">10781</td><td colspan="7"></td></tr><tr><td class="h">10782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If zone is located in loop, perform usual reachable check for it.</td></tr>
<tr><td class="h">10783</td><td><div class="c3">60</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10783">100</a></div></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($other-&gt;{loop}) {</td></tr>
<tr><td class="h">10784</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_mark = $other-&gt;{reachable_part};</td></tr>
<tr><td class="h">10785</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $mark (@$reachable) {</td></tr>
<tr><td class="h">10786</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10786">100</a></div></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$has_mark-&gt;{$mark}) {</td></tr>
<tr><td class="h">10787</td><td colspan="7"></td></tr><tr><td class="h">10788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; unreachable: $other-&gt;{name}&quot;,</td></tr>
<tr><td class="h">10789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $in_intf-&gt;{name} to $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10790</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">10791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10794</td><td colspan="7"></td></tr><tr><td class="h">10795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If $end_intf is at border of loop, its zone might be located</td></tr>
<tr><td class="h">10796</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# outside of loop and no {reachable_part} is set at $other.</td></tr>
<tr><td class="h">10797</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If partition starting at $in_intf also starts at $end_intf,</td></tr>
<tr><td class="h">10798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# path to $other includes 2 pathrestrictions and is invalid.</td></tr>
<tr><td class="h">10799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10800</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10800">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $reachable_at2 = $end_intf-&gt;{reachable_at}) {</td></tr>
<tr><td class="h">10801</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10801">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $reachable2 =</td></tr>
<tr><td class="h">10802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reachable_at2-&gt;{ $end_intf-&gt;{router} })</td></tr>
<tr><td class="h">10803</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">10804</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10804">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (intersect($reachable, $reachable2)) {</td></tr>
<tr><td class="h">10805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; unreachable2: $other-&gt;{name}&quot;,</td></tr>
<tr><td class="h">10806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $in_intf-&gt;{name} to $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10807</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">10808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10813</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10814</td><td colspan="7"></td></tr><tr><td class="h">10815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Node has been visited before - return to avoid walking loops.</td></tr>
<tr><td class="h">10816</td><td><div class="c3">1832</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10816">100</a></div></td><td></td><td></td><td></td><td><div>2560</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{active_path}) {</td></tr>
<tr><td class="h">10817</td><td colspan="7"></td></tr><tr><td class="h">10818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; active: $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10819</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">10820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10821</td><td colspan="7"></td></tr><tr><td class="h">10822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Found a path to router or zone.</td></tr>
<tr><td class="h">10823</td><td><div class="c3">1828</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10823">100</a></div></td><td></td><td></td><td></td><td><div>3261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($obj eq $end) {</td></tr>
<tr><td class="h">10824</td><td colspan="7"></td></tr><tr><td class="h">10825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store interface where we leave the loop.</td></tr>
<tr><td class="h">10826</td><td><div class="c3">656</div></td><td></td><td></td><td></td><td></td><td><div>649</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$loop_leave, $in_intf;</td></tr>
<tr><td class="h">10827</td><td colspan="7"></td></tr><tr><td class="h">10828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; leave: $in_intf-&gt;{name} -&gt; $end-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10829</td><td><div class="c3">656</div></td><td></td><td></td><td></td><td></td><td><div>1389</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">10830</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10831</td><td colspan="7"></td></tr><tr><td class="h">10832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Stop exploration if optimized pathrestriction inhibits reaching end node.</td></tr>
<tr><td class="h">10833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This is not grouped with other PR checks to avoid unneccessary execution.</td></tr>
<tr><td class="h">10834</td><td><div class="c3">1172</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10834">100</a></div></td><td></td><td></td><td></td><td><div>1551</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($reachable_at) {</td></tr>
<tr><td class="h">10835</td><td><div class="c3">156</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10835">100</a></div></td><td></td><td></td><td></td><td><div>283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $reachable = $reachable_at-&gt;{$obj}) {</td></tr>
<tr><td class="h">10836</td><td><div class="c3">150</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10836">100</a></div></td><td></td><td></td><td></td><td><div>204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $end_node = $end_intf ? $end_intf-&gt;{zone} : $end;#for consistency</td></tr>
<tr><td class="h">10837</td><td><div class="c3">150</div></td><td></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_mark = $end_node-&gt;{reachable_part};</td></tr>
<tr><td class="h">10838</td><td><div class="c3">150</div></td><td></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $mark (@$reachable) {</td></tr>
<tr><td class="h">10839</td><td><div class="c3">150</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10839">100</a></div></td><td></td><td></td><td></td><td><div>324</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$has_mark-&gt;{$mark}) {</td></tr>
<tr><td class="h">10840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; unreachable3: $end_node-&gt;{name}&quot;,</td></tr>
<tr><td class="h">10841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $in_intf-&gt;{name} to $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10842</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">10843</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10847</td><td colspan="7"></td></tr><tr><td class="h">10848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mark current path for loop detection.</td></tr>
<tr><td class="h">10849</td><td><div class="c3">1102</div></td><td></td><td></td><td></td><td></td><td><div>1314</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $obj-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">10850</td><td colspan="7"></td></tr><tr><td class="h">10851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;activated $obj-&gt;{name}&quot;;</td></tr>
<tr><td class="h">10852</td><td colspan="7"></td></tr><tr><td class="h">10853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Activate passed path restrictions.</td></tr>
<tr><td class="h">10854</td><td><div class="c3">1102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10854">100</a></div></td><td></td><td></td><td></td><td><div>1387</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($pathrestriction) {</td></tr>
<tr><td class="h">10855</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$pathrestriction) {</td></tr>
<tr><td class="h">10856</td><td colspan="7"></td></tr><tr><td class="h">10857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; enabled $restrict-&gt;{name} at $in_intf-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10858</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">10859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10861</td><td colspan="7"></td></tr><tr><td class="h">10862</td><td><div class="c3">1102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10862">100</a></div></td><td></td><td></td><td></td><td><div>1238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $get_next = is_router($obj) ? &#39;zone&#39; : &#39;router&#39;;</td></tr>
<tr><td class="h">10863</td><td><div class="c3">1102</div></td><td></td><td></td><td></td><td></td><td><div>978</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $success = 0;</td></tr>
<tr><td class="h">10864</td><td colspan="7"></td></tr><tr><td class="h">10865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Fill hash for restoring references from hash key.</td></tr>
<tr><td class="h">10866</td><td><div class="c3">1102</div></td><td></td><td></td><td></td><td></td><td><div>1501</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$key2obj{$in_intf} = $in_intf;</td></tr>
<tr><td class="h">10867</td><td colspan="7"></td></tr><tr><td class="h">10868</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Extract navigation lookup hash.</td></tr>
<tr><td class="h">10869</td><td><div class="c3">1102</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10869">50</a></div></td><td></td><td></td><td></td><td><div>2522</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $allowed = $navi-&gt;{ $obj-&gt;{loop} }</td></tr>
<tr><td class="h">10870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Loop with empty navigation&quot;);</td></tr>
<tr><td class="h">10871</td><td colspan="7"></td></tr><tr><td class="h">10872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Proceed loop path exploration with every loop interface of current node.</td></tr>
<tr><td class="h">10873</td><td><div class="c3">1102</div><div class="c3">1102</div></td><td></td><td></td><td></td><td></td><td><div>850</div><div>1469</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $obj-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">10874</td><td><div class="c3">42016</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10874">100</a></div></td><td></td><td></td><td></td><td><div>66117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_intf;</td></tr>
<tr><td class="h">10875</td><td><div class="c3">40914</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10875">100</a></div></td><td></td><td></td><td></td><td><div>52515</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">10876</td><td><div class="c3">40798</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10876">100</a></div></td><td></td><td></td><td></td><td><div>53923</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop = $interface-&gt;{loop} or next;</td></tr>
<tr><td class="h">10877</td><td><div class="c3">40766</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10877">100</a></div></td><td></td><td></td><td></td><td><div>69837</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$allowed-&gt;{$loop} or next;</td></tr>
<tr><td class="h">10878</td><td><div class="c3">1366</div></td><td></td><td></td><td></td><td></td><td><div>1267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = $interface-&gt;{$get_next};</td></tr>
<tr><td class="h">10879</td><td colspan="7"></td></tr><tr><td class="h">10880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Try $obj-&gt;{name} -&gt; $next-&gt;{name}&quot;;</td></tr>
<tr><td class="h">10881</td><td colspan="7"></td></tr><tr><td class="h">10882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If a valid path is found from next node to $end...</td></tr>
<tr><td class="h">10883</td><td><div class="c3">1366</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10883">100</a></div></td><td></td><td></td><td></td><td><div>1891</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">10884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_path_mark1(</td></tr>
<tr><td class="h">10885</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$next,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface,&nbsp;&nbsp;$end, $end_intf,</td></tr>
<tr><td class="h">10886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path_tuples, $loop_leave, $navi</td></tr>
<tr><td class="h">10887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">10888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">10889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">10890</td><td colspan="7"></td></tr><tr><td class="h">10891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ...collect path information.</td></tr>
<tr><td class="h">10892</td><td><div class="c3">1258</div></td><td></td><td></td><td></td><td></td><td><div>1538</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key2obj{$interface} = $interface;</td></tr>
<tr><td class="h">10893</td><td><div class="c3">1258</div></td><td></td><td></td><td></td><td></td><td><div>1375</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path_tuples-&gt;{$in_intf}-&gt;{$interface} = is_router($obj);</td></tr>
<tr><td class="h">10894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; loop: $in_intf-&gt;{name} -&gt; $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10895</td><td><div class="c3">1258</div></td><td></td><td></td><td></td><td></td><td><div>2654</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$success = 1;</td></tr>
<tr><td class="h">10896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10898</td><td colspan="7"></td></tr><tr><td class="h">10899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Deactivate pathrestrictions activated on path.</td></tr>
<tr><td class="h">10900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;deactivated $obj-&gt;{name}&quot;;</td></tr>
<tr><td class="h">10901</td><td><div class="c3">1102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10901">100</a></div></td><td></td><td></td><td></td><td><div>1609</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($pathrestriction) {</td></tr>
<tr><td class="h">10902</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$pathrestriction) {</td></tr>
<tr><td class="h">10903</td><td colspan="7"></td></tr><tr><td class="h">10904</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; disabled $restrict-&gt;{name} at $in_intf-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10905</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{active_path} = undef;</td></tr>
<tr><td class="h">10906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10908</td><td><div class="c3">1102</div></td><td></td><td></td><td></td><td></td><td><div>2593</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $success;</td></tr>
<tr><td class="h">10909</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10910</td><td colspan="7"></td></tr><tr><td class="h">10911</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">10912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Optimize navigation inside a cluster of loops: For a pair </td></tr>
<tr><td class="h">10913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($from,$to) of loop nodes, identify order of loops passed </td></tr>
<tr><td class="h">10914</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on the path from $from to $to. Store information as lookup</td></tr>
<tr><td class="h">10915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash at node $from to reduce search space when finding paths</td></tr>
<tr><td class="h">10916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from $from to $to.</td></tr>
<tr><td class="h">10917</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $from, $to - loop nodes pair.</td></tr>
<tr><td class="h">10918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;&nbsp;: Hash with order/navigation information: keys = loops,</td></tr>
<tr><td class="h">10919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values = loops that may be entered next from key loop.</td></tr>
<tr><td class="h">10920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;&nbsp;: $from node holds navigation hash suggesting for every loop</td></tr>
<tr><td class="h">10921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of the cluster those loops, that are allowed to be entered when&nbsp;&nbsp;</td></tr>
<tr><td class="h">10922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traversing the path to $to. </td></tr>
<tr><td class="h">10923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cluster_navigation {</td></tr>
<tr><td class="h">10924</td><td colspan="7"></td></tr><tr><td class="h">10925</td><td><div class="c3">264</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L10925">264</a></div></td><td><div class="c0">0</div></td><td><div>257</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($from, $to) = @_;</td></tr>
<tr><td class="h">10926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# debug(&quot;Navi: $from-&gt;{name}, $to-&gt;{name}&quot;);</td></tr>
<tr><td class="h">10927</td><td colspan="7"></td></tr><tr><td class="h">10928</td><td><div class="c3">264</div></td><td></td><td></td><td></td><td></td><td><div>212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $navi;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">10929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return filled navi hash, if pair ($from, $to) has been processed before.</td></tr>
<tr><td class="h">10930</td><td><div class="c3">264</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10930">50</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L10930">100</a></div></td><td></td><td></td><td><div>597</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (($navi = $from-&gt;{navi}-&gt;{$to}) and scalar keys %$navi) {</td></tr>
<tr><td class="h">10931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; Cached&quot;);</td></tr>
<tr><td class="h">10932</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $navi;</td></tr>
<tr><td class="h">10933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10934</td><td colspan="7"></td></tr><tr><td class="h">10935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Attach navi hash to $from node object.</td></tr>
<tr><td class="h">10936</td><td><div class="c3">254</div></td><td></td><td></td><td></td><td></td><td><div>423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$navi = $from-&gt;{navi}-&gt;{$to} = {};</td></tr>
<tr><td class="h">10937</td><td colspan="7"></td></tr><tr><td class="h">10938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Determine loops that are passed on path from $from to $to. </td></tr>
<tr><td class="h">10939</td><td><div class="c3">254</div></td><td></td><td></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from_loop = $from-&gt;{loop};</td></tr>
<tr><td class="h">10940</td><td><div class="c3">254</div></td><td></td><td></td><td></td><td></td><td><div>230</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to_loop&nbsp;&nbsp;&nbsp;= $to-&gt;{loop};</td></tr>
<tr><td class="h">10941</td><td><div class="c3">254</div></td><td></td><td></td><td></td><td></td><td><div>187</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">10942</td><td colspan="7"></td></tr><tr><td class="h">10943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Loops are equal, order of loops has been detected.</td></tr>
<tr><td class="h">10944</td><td><div class="c3">586</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10944">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10944">100</a></div></td><td></td><td></td><td></td><td><div>1129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($from_loop eq $to_loop) {</td></tr>
<tr><td class="h">10945</td><td><div class="c3">254</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L10945">100</a></div></td><td></td><td></td><td></td><td><div>564</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if $from eq $to; # Same node, no loop path to detect. </td></tr>
<tr><td class="h">10946</td><td colspan="7"></td></tr><tr><td class="h">10947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add loops that may be entered from loop during path traversal.</td></tr>
<tr><td class="h">10948</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$navi-&gt;{$from_loop}-&gt;{$from_loop} = 1; # TODO: Why not include exit?</td></tr>
<tr><td class="h">10949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;- Eq: $from_loop-&gt;{exit}-&gt;{name}$from_loop to itself&quot;);</td></tr>
<tr><td class="h">10950</td><td colspan="7"></td></tr><tr><td class="h">10951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Path $from -&gt; $to traverses $from_loop and $exit_loop.</td></tr>
<tr><td class="h">10952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Inside $exit_loop, enter only $from_loop, but not from other loops</td></tr>
<tr><td class="h">10953</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $exit_loop = $from_loop-&gt;{exit}-&gt;{loop};</td></tr>
<tr><td class="h">10954</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$navi-&gt;{$exit_loop}-&gt;{$from_loop} = 1;</td></tr>
<tr><td class="h">10955</td><td colspan="7"></td></tr><tr><td class="h">10956</td><td colspan="7"></td></tr><tr><td class="h">10957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;- Add $from_loop-&gt;{exit}-&gt;{name}$from_loop to exit $exit_loop-&gt;{exit}-&gt;{name}$exit_loop&quot;);</td></tr>
<tr><td class="h">10958</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">10959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10960</td><td colspan="7"></td></tr><tr><td class="h">10961</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Different loops, take next step from loop with higher distance.</td></tr>
<tr><td class="h">10962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($from_loop-&gt;{distance} &gt;= $to_loop-&gt;{distance}) {</td></tr>
<tr><td class="h">10963</td><td><div class="c3">136</div></td><td></td><td></td><td></td><td></td><td><div>277</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$navi-&gt;{$from_loop}-&gt;{$from_loop} = 1;# TODO: Why not include exit?</td></tr>
<tr><td class="h">10964</td><td colspan="7"></td></tr><tr><td class="h">10965</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;- Fr: $from_loop-&gt;{exit}-&gt;{name}$from_loop to itself&quot;);</td></tr>
<tr><td class="h">10966</td><td><div class="c3">136</div></td><td></td><td></td><td></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $from_loop-&gt;{exit};</td></tr>
<tr><td class="h">10967</td><td><div class="c3">136</div></td><td></td><td></td><td></td><td></td><td><div>169</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_loop = $from-&gt;{loop};</td></tr>
<tr><td class="h">10968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10969</td><td colspan="7"></td></tr><tr><td class="h">10970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take step from to_loop.</td></tr>
<tr><td class="h">10971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">10972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#debug(&quot;- To: $to_loop-&gt;{exit}-&gt;{name}$to_loop to itself&quot;);</td></tr>
<tr><td class="h">10973</td><td><div class="c3">196</div></td><td></td><td></td><td></td><td></td><td><div>376</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$navi-&gt;{$to_loop}-&gt;{$to_loop} = 1;</td></tr>
<tr><td class="h">10974</td><td><div class="c3">196</div></td><td></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to = $to_loop-&gt;{exit};</td></tr>
<tr><td class="h">10975</td><td><div class="c3">196</div></td><td></td><td></td><td></td><td></td><td><div>443</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $entry_loop = $to-&gt;{loop};</td></tr>
<tr><td class="h">10976</td><td><div class="c3">196</div></td><td></td><td></td><td></td><td></td><td><div>335</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$navi-&gt;{$entry_loop}-&gt;{$to_loop} = 1;</td></tr>
<tr><td class="h">10977</td><td colspan="7"></td></tr><tr><td class="h">10978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;- Add $to_loop-&gt;{exit}-&gt;{name}$to_loop to entry $entry_loop-&gt;{exit}-&gt;{name}$entry_loop&quot;);</td></tr>
<tr><td class="h">10979</td><td><div class="c3">196</div></td><td></td><td></td><td></td><td></td><td><div>252</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_loop = $entry_loop;</td></tr>
<tr><td class="h">10980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">10982</td><td><div class="c3">254</div></td><td></td><td></td><td></td><td></td><td><div>564</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $navi;</td></tr>
<tr><td class="h">10983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">10984</td><td colspan="7"></td></tr><tr><td class="h">10985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">10986</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Collect path information through a loop for a pair ($from,$to)</td></tr>
<tr><td class="h">10987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of loop nodes, store it at the object where loop paths begins.</td></tr>
<tr><td class="h">10988</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $from - node (zone or router) loop cluster is entered at</td></tr>
<tr><td class="h">10989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to - node (zone or router) loop cluster is left at.</td></tr>
<tr><td class="h">10990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_in - interface $from is entered at </td></tr>
<tr><td class="h">10991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_out - interface $to is left at. </td></tr>
<tr><td class="h">10992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_store - source node or interface reference, if source is a </td></tr>
<tr><td class="h">10993</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathrestricted interface.&nbsp;&nbsp;</td></tr>
<tr><td class="h">10994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_store - destination node or interface reference, if </td></tr>
<tr><td class="h">10995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destination is a pathrestricted interface.</td></tr>
<tr><td class="h">10996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;&nbsp;: True if a valid path was found, False otherwise.</td></tr>
<tr><td class="h">10997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;&nbsp;: Loop entering interface holds reference to where loop path </td></tr>
<tr><td class="h">10998</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;information is stored (starting at node or pathrestricted IF</td></tr>
<tr><td class="h">10999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may lead to different paths). Referenced object holds loop path </td></tr>
<tr><td class="h">11000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description.</td></tr>
<tr><td class="h">11001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub cluster_path_mark {</td></tr>
<tr><td class="h">11002</td><td><div class="c3">426</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11002">426</a></div></td><td><div class="c0">0</div></td><td><div>452</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($from, $to, $from_in, $to_out, $from_store, $to_store) = @_;</td></tr>
<tr><td class="h">11003</td><td colspan="7"></td></tr><tr><td class="h">11004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# This particular path through this sub-graph is already known.</td></tr>
<tr><td class="h">11005</td><td><div class="c3">426</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11005">50</a></div></td><td></td><td></td><td></td><td><div>765</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $from_in-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11006</td><td colspan="7"></td></tr><tr><td class="h">11007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Allow easy checks for whether source or destination are pathrestricted </td></tr>
<tr><td class="h">11008</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# interfaces in or at border of current loop by setting these, if so.</td></tr>
<tr><td class="h">11009</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>350</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($start_intf, $end_intf);</td></tr>
<tr><td class="h">11010</td><td colspan="7"></td></tr><tr><td class="h">11011</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Define objects to store path information in by setting these. </td></tr>
<tr><td class="h">11012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Path may differ depending on whether loop entering IF is pathrestricted</td></tr>
<tr><td class="h">11013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# or not. Storing path information in different objects respects this.</td></tr>
<tr><td class="h">11014</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($start_store, $end_store);</td></tr>
<tr><td class="h">11015</td><td colspan="7"></td></tr><tr><td class="h">11016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Set declared variables.</td></tr>
<tr><td class="h">11017</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11017">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11017">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11017">25</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11017">25</a></div></td><td></td><td></td><td><div>502</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (is_interface($from_store) # Src is pathrestricted IF of $from loop node.</td></tr>
<tr><td class="h">11018</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and ($from_store-&gt;{router} eq $from or $from_store-&gt;{zone} eq $from))</td></tr>
<tr><td class="h">11019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11020</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_intf&nbsp;&nbsp;= $from_store;</td></tr>
<tr><td class="h">11021</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store = $from_store;</td></tr>
<tr><td class="h">11022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($from_in # Loop is entered from&nbsp;&nbsp;pathrestricted interface.</td></tr>
<tr><td class="h">11024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and ($from_in-&gt;{path_restrict} or $from_in-&gt;{reachable_at}))</td></tr>
<tr><td class="h">11025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11026</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store = $from_in;</td></tr>
<tr><td class="h">11027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11029</td><td><div class="c3">388</div></td><td></td><td></td><td></td><td></td><td><div>359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store = $from;</td></tr>
<tr><td class="h">11030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11031</td><td colspan="7"></td></tr><tr><td class="h">11032</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11032">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11032">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11032">25</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11032">50</a></div></td><td></td><td></td><td><div>565</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (is_interface($to_store) # Dst is pathrestricted IF of $to loop node.</td></tr>
<tr><td class="h">11033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and ($to_store-&gt;{router} eq $to or $to_store-&gt;{zone} eq $to))</td></tr>
<tr><td class="h">11034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11035</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_intf&nbsp;&nbsp;= $to_store;</td></tr>
<tr><td class="h">11036</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_store = $to_store;</td></tr>
<tr><td class="h">11037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($to_out # Loop is left at pathrestricted interface.</td></tr>
<tr><td class="h">11039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and ($to_out-&gt;{path_restrict} or $to_out-&gt;{reachable_at})) {</td></tr>
<tr><td class="h">11040</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_store = $to_out;</td></tr>
<tr><td class="h">11041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11043</td><td><div class="c3">366</div></td><td></td><td></td><td></td><td></td><td><div>323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_store = $to;</td></tr>
<tr><td class="h">11044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11045</td><td colspan="7"></td></tr><tr><td class="h">11046</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>389</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $success&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">11047</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>385</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from_interfaces = $from-&gt;{interfaces};</td></tr>
<tr><td class="h">11048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;cluster_path_mark: $start_store-&gt;{name} -&gt; $end_store-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11049</td><td colspan="7"></td></tr><tr><td class="h">11050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Activate pathrestrictions at interface the loop is entered at.</td></tr>
<tr><td class="h">11051</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11051">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11051">80</a></div></td><td></td><td></td><td><div>1605</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$from_in</td></tr>
<tr><td class="h">11052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $from_in-&gt;{loop} # Loop path is entered from outside loop via</td></tr>
<tr><td class="h">11053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and (my $restrictions = $from_in-&gt;{path_restrict}) # pathrestricted IF</td></tr>
<tr><td class="h">11054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $start_intf) # that is not source of path.</td></tr>
<tr><td class="h">11055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11056</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$restrictions) {# set flag for passed p-restrictions</td></tr>
<tr><td class="h">11057</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">11058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11060</td><td colspan="7"></td></tr><tr><td class="h">11061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Activate pathrestrictions at interface the loop is left at.</td></tr>
<tr><td class="h">11062</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11062">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11062">80</a></div></td><td></td><td></td><td><div>987</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$to_out</td></tr>
<tr><td class="h">11063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $to_out-&gt;{loop} # Loop path is left via</td></tr>
<tr><td class="h">11064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and (my $restrictions = $to_out-&gt;{path_restrict}) # pathrestricted IF</td></tr>
<tr><td class="h">11065</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $end_intf) # that is not destination of path.</td></tr>
<tr><td class="h">11066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11067</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$restrictions) {</td></tr>
<tr><td class="h">11068</td><td colspan="7"></td></tr><tr><td class="h">11069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No path possible, if restriction was activated at in_interface.</td></tr>
<tr><td class="h">11070</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11070">50</a></div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($restrict-&gt;{active_path}) {</td></tr>
<tr><td class="h">11071</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$success = 0;</td></tr>
<tr><td class="h">11072</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11073</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">11074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11076</td><td colspan="7"></td></tr><tr><td class="h">11077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# Check whether valid paths are possible due to optimized pathrestrictions.</td></tr>
<tr><td class="h">11078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;REACHABLE:</td></tr>
<tr><td class="h">11079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If dst is a pathrestricted IF, consider it to be part of its zone. </td></tr>
<tr><td class="h">11081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This guarantees equal routes for all IP addresses of a network. </td></tr>
<tr><td class="h">11082</td><td><div class="c3">426</div><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11082">100</a></div></td><td></td><td></td><td></td><td><div>334</div><div>524</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $end_node = $end_intf ? $end_intf-&gt;{zone} : $to;</td></tr>
<tr><td class="h">11083</td><td colspan="7"></td></tr><tr><td class="h">11084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If start-interface is directly connected to an $end_node zone, use</td></tr>
<tr><td class="h">11085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# this direct path and ignore all other possible paths (=interfaces).</td></tr>
<tr><td class="h">11086</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11086">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11086">100</a></div></td><td></td><td></td><td><div>786</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($start_intf &amp;&amp; $start_intf-&gt;{zone} eq $end_node) {</td></tr>
<tr><td class="h">11087</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_interfaces = [$start_intf];</td></tr>
<tr><td class="h">11088</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last REACHABLE;</td></tr>
<tr><td class="h">11089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11090</td><td colspan="7"></td></tr><tr><td class="h">11091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check, whether enter-/start-interface has optimized pathrestriction. </td></tr>
<tr><td class="h">11092</td><td><div class="c3">420</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11092">67</a></div></td><td></td><td></td><td><div>917</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf = $start_intf || $from_in;</td></tr>
<tr><td class="h">11093</td><td><div class="c3">420</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11093">100</a></div></td><td></td><td></td><td></td><td><div>825</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $reachable_at = $intf-&gt;{reachable_at}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or last REACHABLE;</td></tr>
<tr><td class="h">11094</td><td colspan="7"></td></tr><tr><td class="h">11095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check, whether end node is reachable from enter-/start-interface.</td></tr>
<tr><td class="h">11096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For enter-interfaces, just the direction towards loop is of interest,</td></tr>
<tr><td class="h">11097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# for start-interfaces, pathrestrictions in zone direction do not hold,</td></tr>
<tr><td class="h">11098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# hence check router direction only.</td></tr>
<tr><td class="h">11099</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only one direction needs to be checked in both cases.</td></tr>
<tr><td class="h">11100</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11100">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $start_node = $start_intf ? $start_intf-&gt;{router} : $from;</td></tr>
<tr><td class="h">11101</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11101">50</a></div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $reachable&nbsp;&nbsp;&nbsp;&nbsp;= $reachable_at-&gt;{$start_node} or last REACHABLE;</td></tr>
<tr><td class="h">11102</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $end_node-&gt;{reachable_part};</td></tr>
<tr><td class="h">11103</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $mark (@$reachable) {</td></tr>
<tr><td class="h">11104</td><td colspan="7"></td></tr><tr><td class="h">11105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# End node is not reachable via enter-/start-interface.</td></tr>
<tr><td class="h">11106</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11106">100</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$has_mark-&gt;{$mark}) {</td></tr>
<tr><td class="h">11107</td><td colspan="7"></td></tr><tr><td class="h">11108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For start-interfaces, path in zone direction might exist.</td></tr>
<tr><td class="h">11109</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11109">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($start_intf) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">11110</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_interfaces = [$start_intf];# Ignore all other IFs.</td></tr>
<tr><td class="h">11111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11112</td><td colspan="7"></td></tr><tr><td class="h">11113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For enter-interfaces, no valid path is possible.</td></tr>
<tr><td class="h">11114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11115</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$success = 0;</td></tr>
<tr><td class="h">11116</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11117</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">11118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11120</td><td colspan="7"></td></tr><tr><td class="h">11121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For start-IF, temporarily disable optimized PRs in direction to zone.</td></tr>
<tr><td class="h">11122</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11122">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11122">33</a></div></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($success &amp;&amp; $start_intf) {</td></tr>
<tr><td class="h">11123</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $start_intf-&gt;{zone};</td></tr>
<tr><td class="h">11124</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intf-&gt;{saved_reachable_at_zone} = delete $reachable_at-&gt;{$zone};</td></tr>
<tr><td class="h">11125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} # end reachable</td></tr>
<tr><td class="h">11127</td><td colspan="7"></td></tr><tr><td class="h">11128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If start-/end- interface is part of a group of virtual interfaces </td></tr>
<tr><td class="h">11129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# (VRRP, HSRP), prevent traffic through other interfaces of this group</td></tr>
<tr><td class="h">11130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# by temporarily adding activated pathrestrictions at redundancy interfaces.</td></tr>
<tr><td class="h">11131</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>471</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $intf ($start_intf, $end_intf) {</td></tr>
<tr><td class="h">11132</td><td><div class="c3">852</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11132">100</a></div></td><td></td><td></td><td></td><td><div>1421</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$intf;</td></tr>
<tr><td class="h">11133</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11133">100</a></div></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $interfaces = $intf-&gt;{redundancy_interfaces}) {</td></tr>
<tr><td class="h">11134</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$interfaces) {</td></tr>
<tr><td class="h">11135</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11135">100</a></div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $intf;</td></tr>
<tr><td class="h">11136</td><td><div class="c3">22</div><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>20</div><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $interface-&gt;{path_restrict} },</td></tr>
<tr><td class="h">11137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$global_active_pathrestriction;</td></tr>
<tr><td class="h">11138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11141</td><td colspan="7"></td></tr><tr><td class="h">11142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# For start-/end interfaces (path starts or ends at an interface</td></tr>
<tr><td class="h">11143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# with pathrestriction), pathrestrictions are required to be activated </td></tr>
<tr><td class="h">11144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# in router, not in zone direction. The basic algorithm starts path </td></tr>
<tr><td class="h">11145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# exploration at the router of such an interface though. Per default, </td></tr>
<tr><td class="h">11146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# path restriction activation is therefore contrary to the requirements.</td></tr>
<tr><td class="h">11147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# To fix this, pathrestrictions are temporarily moved from the start-/end </td></tr>
<tr><td class="h">11148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# interface to the other interfaces of the router. </td></tr>
<tr><td class="h">11149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# TODO: How about activating the pathrestrictions and temporarily </td></tr>
<tr><td class="h">11150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# deleting it from the interface? Or let exploration start at the </td></tr>
<tr><td class="h">11151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# interfaces zone in this case (would lead to a gap within the marked path)?</td></tr>
<tr><td class="h">11152</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $intf ($start_intf, $end_intf) {</td></tr>
<tr><td class="h">11153</td><td><div class="c3">852</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11153">100</a></div></td><td></td><td></td><td></td><td><div>1365</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$intf;</td></tr>
<tr><td class="h">11154</td><td colspan="7"></td></tr><tr><td class="h">11155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check whether from/to node is router of start-/and-interface</td></tr>
<tr><td class="h">11156</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $intf-&gt;{router};</td></tr>
<tr><td class="h">11157</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11157">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11157">100</a></div></td><td></td><td></td><td><div>306</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !($router eq $from || $router eq $to);</td></tr>
<tr><td class="h">11158</td><td colspan="7"></td></tr><tr><td class="h">11159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Delete pathrestriction from start/end interface </td></tr>
<tr><td class="h">11160</td><td><div class="c3">76</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11160">100</a></div></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $removed = delete $intf-&gt;{path_restrict} or next;</td></tr>
<tr><td class="h">11161</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intf-&gt;{saved_path_restrict} = $removed;</td></tr>
<tr><td class="h">11162</td><td colspan="7"></td></tr><tr><td class="h">11163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Move pathrestriction to other interfaces of router.</td></tr>
<tr><td class="h">11164</td><td><div class="c3">36</div><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>32</div><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">11165</td><td><div class="c3">134</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11165">100</a></div></td><td></td><td></td><td></td><td><div>271</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $intf;</td></tr>
<tr><td class="h">11166</td><td colspan="7"></td></tr><tr><td class="h">11167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check whether pathrestrictions are defined for these IFs. </td></tr>
<tr><td class="h">11168</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $orig = $interface-&gt;{saved_path_restrict} =</td></tr>
<tr><td class="h">11169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{path_restrict};</td></tr>
<tr><td class="h">11170</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11170">100</a></div></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($orig) {</td></tr>
<tr><td class="h">11171</td><td colspan="7"></td></tr><tr><td class="h">11172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If pathrestrictions exist in both IF and start-/end-interface,</td></tr>
<tr><td class="h">11173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prohibit path by adding activated global pathrestriction.</td></tr>
<tr><td class="h">11174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# TODO: what about just excluding IF from from-IFs?</td></tr>
<tr><td class="h">11175</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11175">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (intersect($orig, $removed)) {</td></tr>
<tr><td class="h">11176</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{path_restrict} =</td></tr>
<tr><td class="h">11177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[$global_active_pathrestriction];</td></tr>
<tr><td class="h">11178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11179</td><td colspan="7"></td></tr><tr><td class="h">11180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise, add pathrestrictions to interface.</td></tr>
<tr><td class="h">11181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11182</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{path_restrict} = [ @$orig, @$removed ];</td></tr>
<tr><td class="h">11183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11186</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{path_restrict} = $removed;</td></tr>
<tr><td class="h">11187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11190</td><td colspan="7"></td></tr><tr><td class="h">11191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# Find loop paths via DFS.</td></tr>
<tr><td class="h">11192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;BLOCK:</td></tr>
<tr><td class="h">11193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11194</td><td><div class="c3">426</div><div class="c3">426</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11194">50</a></div></td><td></td><td></td><td></td><td><div>355</div><div>598</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last BLOCK if not $success; # No valid path due to pathrestrictions.</td></tr>
<tr><td class="h">11195</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>360</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$success = 0;</td></tr>
<tr><td class="h">11196</td><td colspan="7"></td></tr><tr><td class="h">11197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect path information at beginning of loop path ($start_store).</td></tr>
<tr><td class="h">11198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Loop paths beginning at loop node can differ depending on the way</td></tr>
<tr><td class="h">11199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the node is entered (interface with/without pathrestriction,</td></tr>
<tr><td class="h">11200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pathrestricted src/dst interface), requirings storing path </td></tr>
<tr><td class="h">11201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#information at different objects.</td></tr>
<tr><td class="h">11202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# {loop_entry} attribute shows, where path information can be found.</td></tr>
<tr><td class="h">11203</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>793</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_in-&gt;{loop_entry}-&gt;{$to_store}&nbsp;&nbsp;&nbsp;&nbsp;= $start_store;# node or IF w. PR</td></tr>
<tr><td class="h">11204</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store-&gt;{loop_exit}-&gt;{$to_store} = $end_store;</td></tr>
<tr><td class="h">11205</td><td colspan="7"></td></tr><tr><td class="h">11206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Path from $start_store to $end_store has been marked already.</td></tr>
<tr><td class="h">11207</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11207">100</a></div></td><td></td><td></td><td></td><td><div>857</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($start_store-&gt;{loop_enter}-&gt;{$end_store}) {</td></tr>
<tr><td class="h">11208</td><td><div class="c3">162</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$success = 1;</td></tr>
<tr><td class="h">11209</td><td><div class="c3">162</div></td><td></td><td></td><td></td><td></td><td><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last BLOCK;</td></tr>
<tr><td class="h">11210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11211</td><td colspan="7"></td></tr><tr><td class="h">11212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create variables to store the loop path. </td></tr>
<tr><td class="h">11213</td><td><div class="c3">264</div></td><td></td><td></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop_enter&nbsp;&nbsp;= [];# Interfaces of $from, where path enters cluster.</td></tr>
<tr><td class="h">11214</td><td><div class="c3">264</div></td><td></td><td></td><td></td><td></td><td><div>268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path_tuples = {};# Tuples of interfaces, describing all valid paths.</td></tr>
<tr><td class="h">11215</td><td><div class="c3">264</div></td><td></td><td></td><td></td><td></td><td><div>249</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop_leave&nbsp;&nbsp;= [];# Interfaces of $to, where cluster is left.</td></tr>
<tr><td class="h">11216</td><td colspan="7"></td></tr><tr><td class="h">11217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create navigation look up hash to reduce search space in loop cluster.</td></tr>
<tr><td class="h">11218</td><td><div class="c3">264</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11218">50</a></div></td><td></td><td></td><td></td><td><div>343</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $navi = cluster_navigation($from, $to)</td></tr>
<tr><td class="h">11219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Empty navi&quot;);</td></tr>
<tr><td class="h">11220</td><td colspan="7"></td></tr><tr><td class="h">11221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark current path for loop detection.</td></tr>
<tr><td class="h">11222</td><td><div class="c3">264</div></td><td></td><td></td><td></td><td></td><td><div>500</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $from-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">11223</td><td><div class="c3">264</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11223">100</a></div></td><td></td><td></td><td></td><td><div>332</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $get_next = is_router($from) ? &#39;zone&#39; : &#39;router&#39;;</td></tr>
<tr><td class="h">11224</td><td><div class="c3">264</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11224">50</a></div></td><td></td><td></td><td></td><td><div>587</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $allowed = $navi-&gt;{ $from-&gt;{loop} }</td></tr>
<tr><td class="h">11225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Loop $from-&gt;{loop}-&gt;{exit}-&gt;{name}$from-&gt;{loop}&quot;,</td></tr>
<tr><td class="h">11226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; with empty navi&quot;);</td></tr>
<tr><td class="h">11227</td><td colspan="7"></td></tr><tr><td class="h">11228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# To find paths, process every loop interface of $from node.</td></tr>
<tr><td class="h">11229</td><td><div class="c3">264</div></td><td></td><td></td><td></td><td></td><td><div>321</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$from_interfaces) {</td></tr>
<tr><td class="h">11230</td><td><div class="c3">670</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11230">100</a></div></td><td></td><td></td><td></td><td><div>1037</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">11231</td><td><div class="c3">598</div></td><td></td><td></td><td></td><td></td><td><div>541</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop = $interface-&gt;{loop};</td></tr>
<tr><td class="h">11232</td><td><div class="c3">598</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11232">100</a></div></td><td></td><td></td><td></td><td><div>819</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $loop;</td></tr>
<tr><td class="h">11233</td><td colspan="7"></td></tr><tr><td class="h">11234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip interfaces that will not lead to a path....</td></tr>
<tr><td class="h">11235</td><td><div class="c3">530</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11235">100</a></div></td><td></td><td></td><td></td><td><div>936</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $allowed-&gt;{$loop}) { #&nbsp;&nbsp;...nodes not included in navi.</td></tr>
<tr><td class="h">11236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;No: $loop-&gt;{exit}-&gt;{name}$loop&quot;);</td></tr>
<tr><td class="h">11237</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">11238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11239</td><td><div class="c3">526</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11239">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11239">33</a></div></td><td></td><td></td><td><div>894</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if ($interface-&gt;{loopback} # ...networks connecting virtual </td></tr>
<tr><td class="h">11240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $get_next eq &#39;zone&#39;);# loopback interfaces.</td></tr>
<tr><td class="h">11241</td><td colspan="7"></td></tr><tr><td class="h">11242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Extract adjacent node (= next node on path).</td></tr>
<tr><td class="h">11243</td><td><div class="c3">526</div></td><td></td><td></td><td></td><td></td><td><div>523</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next = $interface-&gt;{$get_next};</td></tr>
<tr><td class="h">11244</td><td colspan="7"></td></tr><tr><td class="h">11245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Search path from next node to $to, store it in provided variables.</td></tr>
<tr><td class="h">11246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; try: $from-&gt;{name} -&gt; $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11247</td><td><div class="c3">526</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11247">100</a></div></td><td></td><td></td><td></td><td><div>647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">11248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_path_mark1(</td></tr>
<tr><td class="h">11249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$next,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface,&nbsp;&nbsp;$to, $end_intf,</td></tr>
<tr><td class="h">11250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path_tuples, $loop_leave, $navi</td></tr>
<tr><td class="h">11251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">11252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">11253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11254</td><td><div class="c3">452</div></td><td></td><td></td><td></td><td></td><td><div>369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$success = 1;</td></tr>
<tr><td class="h">11255</td><td><div class="c3">452</div></td><td></td><td></td><td></td><td></td><td><div>720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$loop_enter, $interface;</td></tr>
<tr><td class="h">11256</td><td colspan="7"></td></tr><tr><td class="h">11257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; enter: $from-&gt;{name} -&gt; $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11260</td><td colspan="7"></td></tr><tr><td class="h">11261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t store incomplete result.</td></tr>
<tr><td class="h">11262</td><td><div class="c3">264</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11262">100</a></div></td><td></td><td></td><td></td><td><div>408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last BLOCK if not $success;</td></tr>
<tr><td class="h">11263</td><td colspan="7"></td></tr><tr><td class="h">11264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert $path_tuples: {intf-&gt;intf-&gt;node_type} to [intf,intf,node_type]</td></tr>
<tr><td class="h">11265</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>271</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tuples_aref = [];</td></tr>
<tr><td class="h">11266</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>577</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $in_intf_ref (keys %$path_tuples) {</td></tr>
<tr><td class="h">11267</td><td><div class="c3">850</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11267">50</a></div></td><td></td><td></td><td></td><td><div>1332</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_intf = $key2obj{$in_intf_ref} </td></tr>
<tr><td class="h">11268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Unknown in_intf at tuple&quot;);</td></tr>
<tr><td class="h">11269</td><td><div class="c3">850</div></td><td></td><td></td><td></td><td></td><td><div>707</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $path_tuples-&gt;{$in_intf_ref};</td></tr>
<tr><td class="h">11270</td><td><div class="c3">850</div></td><td></td><td></td><td></td><td></td><td><div>1195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf_ref (keys %$hash) {</td></tr>
<tr><td class="h">11271</td><td><div class="c3">1058</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11271">50</a></div></td><td></td><td></td><td></td><td><div>1499</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_intf = $key2obj{$out_intf_ref}</td></tr>
<tr><td class="h">11272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Unknown out_intf at tuple&quot;);</td></tr>
<tr><td class="h">11273</td><td><div class="c3">1058</div></td><td></td><td></td><td></td><td></td><td><div>936</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $at_router = $hash-&gt;{$out_intf_ref};</td></tr>
<tr><td class="h">11274</td><td><div class="c3">1058</div></td><td></td><td></td><td></td><td></td><td><div>2696</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$tuples_aref, [ $in_intf, $out_intf, $at_router ];</td></tr>
<tr><td class="h">11275</td><td colspan="7"></td></tr><tr><td class="h">11276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Tuple: $in_intf-&gt;{name}, $out_intf-&gt;{name} $at_router&quot;);</td></tr>
<tr><td class="h">11277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11279</td><td colspan="7"></td></tr><tr><td class="h">11280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove duplicates, which occur from nested loops.</td></tr>
<tr><td class="h">11281</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_leave = [ unique(@$loop_leave) ];</td></tr>
<tr><td class="h">11282</td><td colspan="7"></td></tr><tr><td class="h">11283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add loop path information to start node or interface.</td></tr>
<tr><td class="h">11284</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>503</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store-&gt;{loop_enter}-&gt;{$end_store}&nbsp;&nbsp;= $loop_enter;</td></tr>
<tr><td class="h">11285</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store-&gt;{loop_leave}-&gt;{$end_store}&nbsp;&nbsp;= $loop_leave;</td></tr>
<tr><td class="h">11286</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_store-&gt;{path_tuples}-&gt;{$end_store} = $tuples_aref;</td></tr>
<tr><td class="h">11287</td><td colspan="7"></td></tr><tr><td class="h">11288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add data for reverse path.</td></tr>
<tr><td class="h">11289</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>398</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_store-&gt;{loop_enter}-&gt;{$start_store} = $loop_leave;</td></tr>
<tr><td class="h">11290</td><td><div class="c3">260</div></td><td></td><td></td><td></td><td></td><td><div>387</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_store-&gt;{loop_leave}-&gt;{$start_store} = $loop_enter;</td></tr>
<tr><td class="h">11291</td><td><div class="c3">1058</div></td><td></td><td></td><td></td><td></td><td><div>2928</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end_store-&gt;{path_tuples}-&gt;{$start_store} =</td></tr>
<tr><td class="h">11292</td><td><div class="c3">260</div><div class="c3">1058</div></td><td></td><td></td><td></td><td></td><td><div>401</div><div>790</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ map { [ @{$_}[ 1, 0, 2 ] ] } @$tuples_aref ];</td></tr>
<tr><td class="h">11293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11294</td><td colspan="7"></td></tr><tr><td class="h">11295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Restore temporarily moved path restrictions.</td></tr>
<tr><td class="h">11296</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $intf ($start_intf, $end_intf) {</td></tr>
<tr><td class="h">11297</td><td><div class="c3">852</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11297">100</a></div></td><td></td><td></td><td></td><td><div>1455</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$intf;</td></tr>
<tr><td class="h">11298</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11298">100</a></div></td><td></td><td></td><td></td><td><div>161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$intf-&gt;{saved_path_restrict};</td></tr>
<tr><td class="h">11299</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $intf-&gt;{router};</td></tr>
<tr><td class="h">11300</td><td><div class="c3">36</div><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>33</div><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">11301</td><td><div class="c3">134</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11301">100</a></div></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig = delete $interface-&gt;{saved_path_restrict}) {</td></tr>
<tr><td class="h">11302</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{path_restrict} = $orig;</td></tr>
<tr><td class="h">11303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11305</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{path_restrict};</td></tr>
<tr><td class="h">11306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11309</td><td colspan="7"></td></tr><tr><td class="h">11310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Restore temporarily deleted optimized pathrestrictions.</td></tr>
<tr><td class="h">11311</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11311">100</a></div></td><td></td><td></td><td></td><td><div>628</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($start_intf) {</td></tr>
<tr><td class="h">11312</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11312">100</a></div></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig = delete $start_intf-&gt;{saved_reachable_at_zone}) {</td></tr>
<tr><td class="h">11313</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $start_intf-&gt;{zone};</td></tr>
<tr><td class="h">11314</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$start_intf-&gt;{reachable_at}-&gt;{$zone} = $orig;</td></tr>
<tr><td class="h">11315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11317</td><td colspan="7"></td></tr><tr><td class="h">11318</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remove temporarily added activated pathrestrictions at redundancy IFs. </td></tr>
<tr><td class="h">11319</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $intf ($start_intf, $end_intf) {</td></tr>
<tr><td class="h">11320</td><td><div class="c3">852</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11320">100</a></div></td><td></td><td></td><td></td><td><div>1364</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if !$intf;</td></tr>
<tr><td class="h">11321</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11321">100</a></div></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $interfaces = $intf-&gt;{redundancy_interfaces}) {</td></tr>
<tr><td class="h">11322</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$interfaces) {</td></tr>
<tr><td class="h">11323</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11323">100</a></div></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $intf;</td></tr>
<tr><td class="h">11324</td><td><div class="c3">22</div><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>16</div><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop @{ $interface-&gt;{path_restrict} };</td></tr>
<tr><td class="h">11325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11328</td><td colspan="7"></td></tr><tr><td class="h">11329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Disable pathrestriction at border of loop.</td></tr>
<tr><td class="h">11330</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>440</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $intf ($from_in, $to_out) {</td></tr>
<tr><td class="h">11331</td><td><div class="c3">852</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11331">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11331">100</a></div></td><td></td><td></td><td><div>2692</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$intf</td></tr>
<tr><td class="h">11332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $intf-&gt;{loop}</td></tr>
<tr><td class="h">11333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and (my $restrictions = $intf-&gt;{path_restrict}))</td></tr>
<tr><td class="h">11334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11335</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $restrict (@$restrictions) {</td></tr>
<tr><td class="h">11336</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$restrict-&gt;{active_path} = 0;</td></tr>
<tr><td class="h">11337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11340</td><td colspan="7"></td></tr><tr><td class="h">11341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If loop path was found, set path information at $from_in and $to_out IFs.</td></tr>
<tr><td class="h">11342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# TODO: Needed only if paths meet in loop, otherwise path_mark sets these.</td></tr>
<tr><td class="h">11343</td><td><div class="c3">426</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11343">100</a></div></td><td></td><td></td><td></td><td><div>640</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($success) {</td></tr>
<tr><td class="h">11344</td><td><div class="c3">422</div></td><td></td><td></td><td></td><td></td><td><div>736</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_in-&gt;{path}-&gt;{$to_store} = $to_out; </td></tr>
<tr><td class="h">11345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11346</td><td><div class="c3">426</div></td><td></td><td></td><td></td><td></td><td><div>1284</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $success;</td></tr>
<tr><td class="h">11347</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11348</td><td colspan="7"></td></tr><tr><td class="h">11349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">11350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;: Find and mark path from an elementary rules source to its </td></tr>
<tr><td class="h">11351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destination.&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">11352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter : $from - zone or router corresponding to elementary rules source</td></tr>
<tr><td class="h">11353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to - zone or router corresponding to the rules destination</td></tr>
<tr><td class="h">11354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_store - $from or interface reference, if source is a </td></tr>
<tr><td class="h">11355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathrestricted interface&nbsp;&nbsp;</td></tr>
<tr><td class="h">11356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_store - $to or interface reference, if destination is a </td></tr>
<tr><td class="h">11357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathrestricted interface </td></tr>
<tr><td class="h">11358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;: True if valid path is found, False otherwise.</td></tr>
<tr><td class="h">11359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;: A reference to the next interface towards destination is stored</td></tr>
<tr><td class="h">11360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in the {path} hash attribute of the source or its corresponding </td></tr>
<tr><td class="h">11361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone/router and every interface object on path.</td></tr>
<tr><td class="h">11362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub path_mark {</td></tr>
<tr><td class="h">11363</td><td><div class="c3">1170</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11363">1170</a></div></td><td><div class="c0">0</div></td><td><div>1207</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($from, $to, $from_store, $to_store) = @_;</td></tr>
<tr><td class="h">11364</td><td colspan="7"></td></tr><tr><td class="h">11365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;path_mark $froma_store-&gt;{name} --&gt; $to_store-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11366</td><td colspan="7"></td></tr><tr><td class="h">11367</td><td><div class="c3">1170</div></td><td></td><td></td><td></td><td></td><td><div>1065</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from_loop = $from-&gt;{loop};</td></tr>
<tr><td class="h">11368</td><td><div class="c3">1170</div></td><td></td><td></td><td></td><td></td><td><div>1027</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to_loop = $to-&gt;{loop};</td></tr>
<tr><td class="h">11369</td><td colspan="7"></td></tr><tr><td class="h">11370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Identify first and last object on path to hold path information.</td></tr>
<tr><td class="h">11371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Outside a loop, path marks are always stored in the corresponding router </td></tr>
<tr><td class="h">11372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# object. Paths beginning at pathrestricted interfaces in loops can be </td></tr>
<tr><td class="h">11373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# different though from the paths that are found for the associated router, </td></tr>
<tr><td class="h">11374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# as in such cases, the interface is considered to be part of the zone </td></tr>
<tr><td class="h">11375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# to achieve equal routing for all interfaces of a network. </td></tr>
<tr><td class="h">11376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# To distinguish the different paths, path information is stored within</td></tr>
<tr><td class="h">11377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the interface in such cases (otherwise it is stored within router).</td></tr>
<tr><td class="h">11378</td><td><div class="c3">1170</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11378">100</a></div></td><td></td><td></td><td></td><td><div>1846</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from_in = $from_store-&gt;{loop} ? $from_store : $from; # Src obj. to mark</td></tr>
<tr><td class="h">11379</td><td><div class="c3">1170</div></td><td></td><td></td><td></td><td></td><td><div>1329</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to_out = undef; # No subsequent interface for last interface on path.</td></tr>
<tr><td class="h">11380</td><td colspan="7"></td></tr><tr><td class="h">11381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Follow paths from source and destination towards zone1 until they meet.</td></tr>
<tr><td class="h">11382</td><td><div class="c3">1170</div></td><td></td><td></td><td></td><td></td><td><div>934</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">11383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># debug(&quot;Dist: $from-&gt;{distance} $from-&gt;{name} -&gt;Dist: $to-&gt;{distance} $to-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11384</td><td colspan="7"></td></tr><tr><td class="h">11385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Paths meet outside a loop or at the edge of a loop.</td></tr>
<tr><td class="h">11386</td><td><div class="c3">3184</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11386">100</a></div></td><td></td><td></td><td></td><td><div>6174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($from eq $to) {</td></tr>
<tr><td class="h">11387</td><td colspan="7"></td></tr><tr><td class="h">11388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; $from_in-&gt;{name} -&gt; &quot;.($to_out ? $to_out-&gt;{name}:&#39;&#39;));</td></tr>
<tr><td class="h">11389</td><td><div class="c3">742</div></td><td></td><td></td><td></td><td></td><td><div>1045</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_in-&gt;{path}-&gt;{$to_store} = $to_out;</td></tr>
<tr><td class="h">11390</td><td><div class="c3">742</div></td><td></td><td></td><td></td><td></td><td><div>1794</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">11391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11392</td><td colspan="7"></td></tr><tr><td class="h">11393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Paths meet inside a loop.</td></tr>
<tr><td class="h">11394</td><td><div class="c3">2442</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11394">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11394">100</a></div></td><td></td><td></td><td><div>5374</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$from_loop</td></tr>
<tr><td class="h">11395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $to_loop</td></tr>
<tr><td class="h">11396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $from_loop-&gt;{cluster_exit} eq $to_loop-&gt;{cluster_exit})</td></tr>
<tr><td class="h">11397</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11398</td><td><div class="c3">398</div></td><td></td><td></td><td></td><td></td><td><div>548</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return cluster_path_mark($from, $to, $from_in, $to_out,</td></tr>
<tr><td class="h">11399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_store, $to_store);</td></tr>
<tr><td class="h">11400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11401</td><td colspan="7"></td></tr><tr><td class="h">11402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise, take a step towards zone1 from the more distant node.</td></tr>
<tr><td class="h">11403</td><td><div class="c3">2044</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11403">100</a></div></td><td></td><td></td><td></td><td><div>3160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($from-&gt;{distance} &gt;= $to-&gt;{distance}) { # Take step from node $from.</td></tr>
<tr><td class="h">11404</td><td colspan="7"></td></tr><tr><td class="h">11405</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Return, if mark has already been set for a sub-path.</td></tr>
<tr><td class="h">11406</td><td><div class="c3">860</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11406">100</a></div></td><td></td><td></td><td></td><td><div>1644</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $from_in-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11407</td><td colspan="7"></td></tr><tr><td class="h">11408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get interface towards zone1.</td></tr>
<tr><td class="h">11409</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>724</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $from_out = $from-&gt;{to_zone1};</td></tr>
<tr><td class="h">11410</td><td colspan="7"></td></tr><tr><td class="h">11411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If from is a loop node, mark whole loop path within this step. </td></tr>
<tr><td class="h">11412</td><td><div class="c3">834</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11412">100</a></div></td><td></td><td></td><td></td><td><div>1171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($from_out) {</td></tr>
<tr><td class="h">11413</td><td colspan="7"></td></tr><tr><td class="h">11414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reached border of graph partition.</td></tr>
<tr><td class="h">11415</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11415">50</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if !$from_loop;</td></tr>
<tr><td class="h">11416</td><td colspan="7"></td></tr><tr><td class="h">11417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get next interface behind loop from loop cluster exit.</td></tr>
<tr><td class="h">11418</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $exit = $from_loop-&gt;{cluster_exit};</td></tr>
<tr><td class="h">11419</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_out = $exit-&gt;{to_zone1};</td></tr>
<tr><td class="h">11420</td><td colspan="7"></td></tr><tr><td class="h">11421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reached border of graph partition.</td></tr>
<tr><td class="h">11422</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11422">50</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if !$from_out;</td></tr>
<tr><td class="h">11423</td><td colspan="7"></td></tr><tr><td class="h">11424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark loop path towards next interface.</td></tr>
<tr><td class="h">11425</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11425">50</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_path_mark($from, $exit, $from_in, $from_out,</td></tr>
<tr><td class="h">11426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_store, $to_store)</td></tr>
<tr><td class="h">11427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or return 0;</td></tr>
<tr><td class="h">11428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11429</td><td colspan="7"></td></tr><tr><td class="h">11430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; $from_in-&gt;{name} -&gt; &quot;.($from_out ? $from_out-&gt;{name}:&#39;&#39;));</td></tr>
<tr><td class="h">11431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark path at the interface we came from (step in path direction)</td></tr>
<tr><td class="h">11432</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>1168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_in-&gt;{path}-&gt;{$to_store} = $from_out; #ref to next path IF</td></tr>
<tr><td class="h">11433</td><td colspan="7"></td></tr><tr><td class="h">11434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Go to next node towards zone1.</td></tr>
<tr><td class="h">11435</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $from_out;</td></tr>
<tr><td class="h">11436</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>732</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $from_out-&gt;{to_zone1};</td></tr>
<tr><td class="h">11437</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>1311</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from_loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $from-&gt;{loop};</td></tr>
<tr><td class="h">11438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11439</td><td colspan="7"></td></tr><tr><td class="h">11440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take step towards zone1 from node $to (backwards on path).</td></tr>
<tr><td class="h">11441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get interface towards zone1.</td></tr>
<tr><td class="h">11443</td><td><div class="c3">1184</div></td><td></td><td></td><td></td><td></td><td><div>1052</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $to_in = $to-&gt;{to_zone1};</td></tr>
<tr><td class="h">11444</td><td colspan="7"></td></tr><tr><td class="h">11445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If to is a loop node, mark whole loop path within this step.</td></tr>
<tr><td class="h">11446</td><td><div class="c3">1184</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11446">100</a></div></td><td></td><td></td><td></td><td><div>1635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($to_in) {</td></tr>
<tr><td class="h">11447</td><td colspan="7"></td></tr><tr><td class="h">11448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reached border of graph partition.</td></tr>
<tr><td class="h">11449</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11449">100</a></div></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if !$to_loop;</td></tr>
<tr><td class="h">11450</td><td colspan="7"></td></tr><tr><td class="h">11451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get next interface behind loop from loop cluster exit.</td></tr>
<tr><td class="h">11452</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $entry = $to_loop-&gt;{cluster_exit};</td></tr>
<tr><td class="h">11453</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_in = $entry-&gt;{to_zone1};</td></tr>
<tr><td class="h">11454</td><td colspan="7"></td></tr><tr><td class="h">11455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reached border of graph partition.</td></tr>
<tr><td class="h">11456</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11456">50</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if !$to_in;</td></tr>
<tr><td class="h">11457</td><td colspan="7"></td></tr><tr><td class="h">11458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark loop path towards next interface.</td></tr>
<tr><td class="h">11459</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11459">50</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cluster_path_mark($entry, $to, $to_in, $to_out, $from_store,</td></tr>
<tr><td class="h">11460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_store)</td></tr>
<tr><td class="h">11461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or return 0;</td></tr>
<tr><td class="h">11462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11463</td><td colspan="7"></td></tr><tr><td class="h">11464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; $to_in-&gt;{name} -&gt; &quot;.($to_out ? $to_out-&gt;{name}:&#39;&#39;));</td></tr>
<tr><td class="h">11465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Mark path at interface we go to (step in opposite path direction).</td></tr>
<tr><td class="h">11466</td><td><div class="c3">1180</div></td><td></td><td></td><td></td><td></td><td><div>1844</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_in-&gt;{path}-&gt;{$to_store} = $to_out;</td></tr>
<tr><td class="h">11467</td><td colspan="7"></td></tr><tr><td class="h">11468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Go to next node towards zone1.</td></tr>
<tr><td class="h">11469</td><td><div class="c3">1180</div></td><td></td><td></td><td></td><td></td><td><div>880</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $to_in;</td></tr>
<tr><td class="h">11470</td><td><div class="c3">1180</div></td><td></td><td></td><td></td><td></td><td><div>1047</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $to_in-&gt;{to_zone1};</td></tr>
<tr><td class="h">11471</td><td><div class="c3">1180</div></td><td></td><td></td><td></td><td></td><td><div>1336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to_loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $to-&gt;{loop};</td></tr>
<tr><td class="h">11472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11474</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0;&nbsp;&nbsp;&nbsp;&nbsp;# unused; only for perlcritic</td></tr>
<tr><td class="h">11475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11476</td><td colspan="7"></td></tr><tr><td class="h">11477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">11478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose :&nbsp;&nbsp;&nbsp;&nbsp;Walk loop section of a path from a rules source to its </td></tr>
<tr><td class="h">11479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destination. Apply given function to every zone or router </td></tr>
<tr><td class="h">11480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on loop path.</td></tr>
<tr><td class="h">11481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $in - interface the loop is entered at.</td></tr>
<tr><td class="h">11482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out - interface loop is left at.</td></tr>
<tr><td class="h">11483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_entry - entry object, holding path information.</td></tr>
<tr><td class="h">11484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_exit - loop exit node.</td></tr>
<tr><td class="h">11485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$call_at_zone - flag for node function is to be called at </td></tr>
<tr><td class="h">11486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 - zone. 0 - router)</td></tr>
<tr><td class="h">11487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule - elementary rule providing source and destination.</td></tr>
<tr><td class="h">11488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun - Function to be applied.</td></tr>
<tr><td class="h">11489</td><td colspan="7"></td></tr><tr><td class="h">11490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub loop_path_walk {</td></tr>
<tr><td class="h">11491</td><td><div class="c3">1232</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11491">1232</a></div></td><td><div class="c0">0</div></td><td><div>1436</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($in, $out, $loop_entry, $loop_exit, $call_at_zone, $rule, $fun) = @_;</td></tr>
<tr><td class="h">11492</td><td colspan="7"></td></tr><tr><td class="h">11493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;my $info = &quot;loop_path_walk: &quot;;</td></tr>
<tr><td class="h">11494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$info .= &quot;$in-&gt;{name}-&gt;&quot; if $in;</td></tr>
<tr><td class="h">11495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$info .= &quot;$loop_entry-&gt;{name}=&gt;$loop_exit-&gt;{name}&quot;;</td></tr>
<tr><td class="h">11496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$info .= &quot;-&gt;$out-&gt;{name}&quot; if $out;</td></tr>
<tr><td class="h">11497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug($info);</td></tr>
<tr><td class="h">11498</td><td colspan="7"></td></tr><tr><td class="h">11499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process entry of cyclic graph.</td></tr>
<tr><td class="h">11500</td><td><div class="c3">1232</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11500">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11500">75</a></div></td><td></td><td></td><td><div>1331</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">11501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</td></tr>
<tr><td class="h">11502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_router($loop_entry)</td></tr>
<tr><td class="h">11503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or</td></tr>
<tr><td class="h">11504</td><td colspan="7"></td></tr><tr><td class="h">11505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $loop_entry is interface with pathrestriction of original</td></tr>
<tr><td class="h">11506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# loop_entry.</td></tr>
<tr><td class="h">11507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_interface($loop_entry)</td></tr>
<tr><td class="h">11508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</td></tr>
<tr><td class="h">11509</td><td colspan="7"></td></tr><tr><td class="h">11510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take only interface which originally was a router.</td></tr>
<tr><td class="h">11511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_entry-&gt;{router} eq</td></tr>
<tr><td class="h">11512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_entry-&gt;{loop_enter}-&gt;{$loop_exit}-&gt;[0]-&gt;{router}</td></tr>
<tr><td class="h">11513</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) xor $call_at_zone</td></tr>
<tr><td class="h">11514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">11515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11516</td><td colspan="7"></td></tr><tr><td class="h">11517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; loop_enter&quot;);</td></tr>
<tr><td class="h">11518</td><td><div class="c3">304</div><div class="c3">304</div></td><td></td><td></td><td></td><td></td><td><div>268</div><div>558</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $loop_entry-&gt;{loop_enter}-&gt;{$loop_exit} }) {</td></tr>
<tr><td class="h">11519</td><td><div class="c3">502</div></td><td></td><td></td><td></td><td></td><td><div>620</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun-&gt;($rule, $in, $out_intf);</td></tr>
<tr><td class="h">11520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11522</td><td colspan="7"></td></tr><tr><td class="h">11523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process paths inside cyclic graph.</td></tr>
<tr><td class="h">11524</td><td><div class="c3">1232</div></td><td></td><td></td><td></td><td></td><td><div>2014</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $path_tuples = $loop_entry-&gt;{path_tuples}-&gt;{$loop_exit};</td></tr>
<tr><td class="h">11525</td><td colspan="7"></td></tr><tr><td class="h">11526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; loop_tuples&quot;);</td></tr>
<tr><td class="h">11527</td><td><div class="c3">1232</div></td><td></td><td></td><td></td><td></td><td><div>1378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $tuple (@$path_tuples) {</td></tr>
<tr><td class="h">11528</td><td><div class="c3">6360</div></td><td></td><td></td><td></td><td></td><td><div>5974</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_intf, $out_intf, $at_router) = @$tuple;</td></tr>
<tr><td class="h">11529</td><td><div class="c3">6360</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11529">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11529">100</a></div></td><td></td><td></td><td><div>19132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun-&gt;($rule, $in_intf, $out_intf)</td></tr>
<tr><td class="h">11530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $at_router xor $call_at_zone;</td></tr>
<tr><td class="h">11531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11532</td><td colspan="7"></td></tr><tr><td class="h">11533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process paths at exit of cyclic graph.</td></tr>
<tr><td class="h">11534</td><td><div class="c3">1232</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11534">67</a></div></td><td></td><td></td><td><div>1589</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $exit_at_router = is_router($loop_exit)</td></tr>
<tr><td class="h">11535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (is_interface($loop_exit)</td></tr>
<tr><td class="h">11536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $loop_exit-&gt;{router} eq</td></tr>
<tr><td class="h">11537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$loop_entry-&gt;{loop_leave}-&gt;{$loop_exit}-&gt;[0]-&gt;{router});</td></tr>
<tr><td class="h">11538</td><td><div class="c3">1232</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11538">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11538">100</a></div></td><td></td><td></td><td><div>3629</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($exit_at_router xor $call_at_zone) {</td></tr>
<tr><td class="h">11539</td><td colspan="7"></td></tr><tr><td class="h">11540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; loop_leave&quot;);</td></tr>
<tr><td class="h">11541</td><td><div class="c3">444</div><div class="c3">444</div></td><td></td><td></td><td></td><td></td><td><div>320</div><div>825</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $in_intf (@{ $loop_entry-&gt;{loop_leave}-&gt;{$loop_exit} }) {</td></tr>
<tr><td class="h">11542</td><td><div class="c3">706</div></td><td></td><td></td><td></td><td></td><td><div>821</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun-&gt;($rule, $in_intf, $out);</td></tr>
<tr><td class="h">11543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11545</td><td><div class="c3">1232</div></td><td></td><td></td><td></td><td></td><td><div>1962</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $exit_at_router;</td></tr>
<tr><td class="h">11546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11547</td><td colspan="7"></td></tr><tr><td class="h">11548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">11549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: For a given rule, visit every node on path from rules source</td></tr>
<tr><td class="h">11550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to its destination. At every second node (every router or</td></tr>
<tr><td class="h">11551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;every zone node) call given function.</td></tr>
<tr><td class="h">11552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $rule - rule object.</td></tr>
<tr><td class="h">11553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun - function to be called.</td></tr>
<tr><td class="h">11554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$where - &#39;Router&#39; or &#39;Zone&#39;, specifies where the function gets</td></tr>
<tr><td class="h">11555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;called, default is &#39;Router&#39;.</td></tr>
<tr><td class="h">11556</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub path_walk {</td></tr>
<tr><td class="h">11557</td><td><div class="c3">3678</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11557">3678</a></div></td><td><div class="c0">0</div></td><td><div>3584</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $fun, $where) = @_;</td></tr>
<tr><td class="h">11558</td><td colspan="7"></td></tr><tr><td class="h">11559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Extract path node objects (zone/router/pathrestricted interface).</td></tr>
<tr><td class="h">11560</td><td><div class="c3">3678</div></td><td></td><td></td><td></td><td></td><td><div>3353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from_store = $rule-&gt;{src_path};</td></tr>
<tr><td class="h">11561</td><td><div class="c3">3678</div></td><td></td><td></td><td></td><td></td><td><div>3150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to_store&nbsp;&nbsp;&nbsp;= $rule-&gt;{dst_path};</td></tr>
<tr><td class="h">11562</td><td colspan="7"></td></tr><tr><td class="h">11563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If path node is a pathrestricted interface, extract router. </td></tr>
<tr><td class="h">11564</td><td><div class="c3">3678</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11564">67</a></div></td><td></td><td></td><td><div>8945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $from_store-&gt;{router} || $from_store;</td></tr>
<tr><td class="h">11565</td><td><div class="c3">3678</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11565">67</a></div></td><td></td><td></td><td><div>8128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $to_store-&gt;{router}&nbsp;&nbsp;&nbsp;|| $to_store;</td></tr>
<tr><td class="h">11566</td><td colspan="7"></td></tr><tr><td class="h">11567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Get access to stored paths - for pathrestricted IFs, take IF path store</td></tr>
<tr><td class="h">11568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# (allowed paths may differ from those of the associated router).</td></tr>
<tr><td class="h">11569</td><td><div class="c3">3678</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11569">100</a></div></td><td></td><td></td><td></td><td><div>4823</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $path_store = $from_store-&gt;{loop} ? $from_store : $from;</td></tr>
<tr><td class="h">11570</td><td colspan="7"></td></tr><tr><td class="h">11571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(print_rule $rule);</td></tr>
<tr><td class="h">11572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; start: $from-&gt;{name}, $to-&gt;{name}&quot; . ($where?&quot;, at $where&quot;:&#39;&#39;));</td></tr>
<tr><td class="h">11573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;my $fun2 = $fun;</td></tr>
<tr><td class="h">11574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$fun = sub&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my($rule, $in, $out) = @_;</td></tr>
<tr><td class="h">11576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_name = $in?$in-&gt;{name}:&#39;-&#39;;</td></tr>
<tr><td class="h">11577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_name = $out?$out-&gt;{name}:&#39;-&#39;;</td></tr>
<tr><td class="h">11578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot; Walk: $in_name, $out_name&quot;);</td></tr>
<tr><td class="h">11579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun2-&gt;(@_);</td></tr>
<tr><td class="h">11580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">11581</td><td colspan="7"></td></tr><tr><td class="h">11582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Perform consistency checks.</td></tr>
<tr><td class="h">11583</td><td><div class="c3">3678</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11583">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11583">33</a></div></td><td></td><td></td><td><div>10473</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$from and $to or internal_err(print_rule $rule);</td></tr>
<tr><td class="h">11584</td><td><div class="c3">3678</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11584">50</a></div></td><td></td><td></td><td></td><td><div>6983</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$from eq $to and internal_err(&quot;Unenforceable:\n &quot;, print_rule $rule);</td></tr>
<tr><td class="h">11585</td><td colspan="7"></td></tr><tr><td class="h">11586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Identify path from source to destination if not known.</td></tr>
<tr><td class="h">11587</td><td><div class="c3">3678</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11587">100</a></div></td><td></td><td></td><td></td><td><div>7569</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not exists $path_store-&gt;{path}-&gt;{$to_store}) {</td></tr>
<tr><td class="h">11588</td><td><div class="c3">1122</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11588">100</a></div></td><td></td><td></td><td></td><td><div>1509</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!path_mark($from, $to, $from_store, $to_store)) { # Find path.</td></tr>
<tr><td class="h">11589</td><td colspan="7"></td></tr><tr><td class="h">11590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Break, if path does not exist.</td></tr>
<tr><td class="h">11591</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">11592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;No valid path\n&quot;,</td></tr>
<tr><td class="h">11593</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $from_store-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">11594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to $to_store-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">11595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for rule &quot;,</td></tr>
<tr><td class="h">11596</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_rule($rule),</td></tr>
<tr><td class="h">11597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n&quot;,</td></tr>
<tr><td class="h">11598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Check path restrictions and crypto interfaces.&quot;</td></tr>
<tr><td class="h">11599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">11600</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $path_store-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11601</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11604</td><td colspan="7"></td></tr><tr><td class="h">11605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Set switch whether to call function at first node visited (in 1.iteration)</td></tr>
<tr><td class="h">11606</td><td><div class="c3">3670</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11606">100</a></div></td><td></td><td></td><td><div>8001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $at_zone = $where &amp;&amp; $where eq &#39;Zone&#39;; # 1, if func is called at zones. </td></tr>
<tr><td class="h">11607</td><td><div class="c3">3670</div></td><td></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11607">75</a></div></td><td></td><td></td><td><div>4417</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $call_it = (is_router($from) xor $at_zone); # Set switch accordingly. </td></tr>
<tr><td class="h">11608</td><td colspan="7"></td></tr><tr><td class="h">11609</td><td><div class="c3">3670</div></td><td></td><td></td><td></td><td></td><td><div>3378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $in = undef;</td></tr>
<tr><td class="h">11610</td><td><div class="c3">3670</div></td><td></td><td></td><td></td><td></td><td><div>2624</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $out;</td></tr>
<tr><td class="h">11611</td><td colspan="7"></td></tr><tr><td class="h">11612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If Path starts inside cyclic graph or at IF of router inside cyclic graph.</td></tr>
<tr><td class="h">11613</td><td><div class="c3">3670</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11613">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11613">50</a></div></td><td></td><td></td><td><div>11050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$from-&gt;{loop}</td></tr>
<tr><td class="h">11614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $from_store-&gt;{loop_exit} # Path exists for start node, leading to...</td></tr>
<tr><td class="h">11615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and my $loop_exit = $from_store-&gt;{loop_exit}-&gt;{$to_store}) # ...dst.</td></tr>
<tr><td class="h">11616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11617</td><td><div class="c3">1100</div></td><td></td><td></td><td></td><td></td><td><div>1353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop_out = $path_store-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11618</td><td colspan="7"></td></tr><tr><td class="h">11619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ... walk loop path first.</td></tr>
<tr><td class="h">11620</td><td><div class="c3">1100</div></td><td></td><td></td><td></td><td></td><td><div>1408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $exit_at_router =</td></tr>
<tr><td class="h">11621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loop_path_walk($in, $loop_out, $from_store, $loop_exit, $at_zone,</td></tr>
<tr><td class="h">11622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule, $fun);</td></tr>
<tr><td class="h">11623</td><td colspan="7"></td></tr><tr><td class="h">11624</td><td><div class="c3">1100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11624">100</a></div></td><td></td><td></td><td></td><td><div>1628</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $loop_out) {</td></tr>
<tr><td class="h">11625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;exit: path_walk: dst in loop&quot;);</td></tr>
<tr><td class="h">11626</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11628</td><td colspan="7"></td></tr><tr><td class="h">11629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Then prepare to begin with path behind loop.</td></tr>
<tr><td class="h">11630</td><td><div class="c3">120</div></td><td></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11630">75</a></div></td><td></td><td></td><td><div>331</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$call_it = not($exit_at_router xor $at_zone);</td></tr>
<tr><td class="h">11631</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $loop_out;</td></tr>
<tr><td class="h">11632</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $in-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11634</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11635</td><td><div class="c3">2570</div></td><td></td><td></td><td></td><td></td><td><div>3844</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out = $path_store-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11637</td><td colspan="7"></td></tr><tr><td class="h">11638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Start walking path. </td></tr>
<tr><td class="h">11639</td><td><div class="c3">2690</div></td><td></td><td></td><td></td><td></td><td><div>2044</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">11640</td><td colspan="7"></td></tr><tr><td class="h">11641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Path continues with loop: walk whole loop path in this iteration step.</td></tr>
<tr><td class="h">11642</td><td><div class="c3">9506</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11642">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11642">100</a></div></td><td></td><td></td><td><div>27895</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$in</td></tr>
<tr><td class="h">11643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $in-&gt;{loop_entry} # In interface is entry to a loop path...</td></tr>
<tr><td class="h">11644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and my $loop_entry = $in-&gt;{loop_entry}-&gt;{$to_store}) # ...to dest.</td></tr>
<tr><td class="h">11645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11646</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop_exit = $loop_entry-&gt;{loop_exit}-&gt;{$to_store};# exit object.</td></tr>
<tr><td class="h">11647</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $loop_out&nbsp;&nbsp;= $in-&gt;{path}-&gt;{$to_store};# exit interface</td></tr>
<tr><td class="h">11648</td><td colspan="7"></td></tr><tr><td class="h">11649</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $exit_at_router = # last node of loop is a router ? 1 : 0 </td></tr>
<tr><td class="h">11650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loop_path_walk($in, $loop_out, $loop_entry, $loop_exit,</td></tr>
<tr><td class="h">11651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$at_zone, $rule, $fun); # Process whole loop path.</td></tr>
<tr><td class="h">11652</td><td colspan="7"></td></tr><tr><td class="h">11653</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# End of path has been reached.</td></tr>
<tr><td class="h">11654</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11654">100</a></div></td><td></td><td></td><td></td><td><div>203</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $loop_out) {</td></tr>
<tr><td class="h">11655</td><td colspan="7"></td></tr><tr><td class="h">11656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;exit: path_walk: reached dst in loop&quot;);</td></tr>
<tr><td class="h">11657</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11659</td><td colspan="7"></td></tr><tr><td class="h">11660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepare next iteration step.</td></tr>
<tr><td class="h">11661</td><td><div class="c3">36</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11661">50</a></div></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$call_it = not($exit_at_router xor $at_zone);</td></tr>
<tr><td class="h">11662</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $loop_out;</td></tr>
<tr><td class="h">11663</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $in-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11665</td><td colspan="7"></td></tr><tr><td class="h">11666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Non-loop path continues - call function, if switch is set.</td></tr>
<tr><td class="h">11667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11668</td><td><div class="c3">9374</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11668">100</a></div></td><td></td><td></td><td></td><td><div>12291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($call_it) {</td></tr>
<tr><td class="h">11669</td><td><div class="c3">4068</div></td><td></td><td></td><td></td><td></td><td><div>5025</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fun-&gt;($rule, $in, $out);</td></tr>
<tr><td class="h">11670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11671</td><td colspan="7"></td></tr><tr><td class="h">11672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Return, if end of path has been reached.</td></tr>
<tr><td class="h">11673</td><td><div class="c3">9374</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11673">100</a></div></td><td></td><td></td><td></td><td><div>12828</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $out) {</td></tr>
<tr><td class="h">11674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;exit: path_walk: reached dst&quot;);</td></tr>
<tr><td class="h">11675</td><td><div class="c3">2594</div></td><td></td><td></td><td></td><td></td><td><div>5913</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11677</td><td colspan="7"></td></tr><tr><td class="h">11678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepare next iteration otherwise.</td></tr>
<tr><td class="h">11679</td><td><div class="c3">6780</div></td><td></td><td></td><td></td><td></td><td><div>6149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$call_it = !$call_it;</td></tr>
<tr><td class="h">11680</td><td><div class="c3">6780</div></td><td></td><td></td><td></td><td></td><td><div>5140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $out;</td></tr>
<tr><td class="h">11681</td><td><div class="c3">6780</div></td><td></td><td></td><td></td><td></td><td><div>9701</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $in-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11684</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11686</td><td colspan="7"></td></tr><tr><td class="h">11687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub single_path_walk {</td></tr>
<tr><td class="h">11688</td><td><div class="c3">444</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11688">444</a></div></td><td><div class="c0">0</div></td><td><div>1253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $fun, $where) = @_;</td></tr>
<tr><td class="h">11689</td><td><div class="c3">444</div></td><td></td><td></td><td></td><td></td><td><div>435</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src = $rule-&gt;{src};</td></tr>
<tr><td class="h">11690</td><td><div class="c3">444</div></td><td></td><td></td><td></td><td></td><td><div>395</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst = $rule-&gt;{dst};</td></tr>
<tr><td class="h">11691</td><td><div class="c3">444</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11691">67</a></div></td><td></td><td></td><td><div>1146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{src_path} = $obj2path{$src} || get_path($src);</td></tr>
<tr><td class="h">11692</td><td><div class="c3">444</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11692">67</a></div></td><td></td><td></td><td><div>1032</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{dst_path} = $obj2path{$dst} || get_path($dst);</td></tr>
<tr><td class="h">11693</td><td><div class="c3">444</div></td><td></td><td></td><td></td><td></td><td><div>626</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return path_walk($rule, $fun, $where);</td></tr>
<tr><td class="h">11694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11695</td><td colspan="7"></td></tr><tr><td class="h">11696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %border2obj2auto;</td></tr>
<tr><td class="h">11697</td><td colspan="7"></td></tr><tr><td class="h">11698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_auto_intf_from_border {</td></tr>
<tr><td class="h">11699</td><td><div class="c3">20</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11699">20</a></div></td><td><div class="c0">0</div></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($border) = @_;</td></tr>
<tr><td class="h">11700</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %active_path;</td></tr>
<tr><td class="h">11701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $reach_from_border;</td></tr>
<tr><td class="h">11702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$reach_from_border = sub {</td></tr>
<tr><td class="h">11703</td><td><div class="c3">148</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11703">148</a></div></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network, $in_intf, $result) = @_;</td></tr>
<tr><td class="h">11704</td><td><div class="c3">148</div></td><td></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$active_path{$network} = 1;</td></tr>
<tr><td class="h">11705</td><td><div class="c3">148</div></td><td></td><td></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{$network}-&gt;{$in_intf} = $in_intf;</td></tr>
<tr><td class="h">11706</td><td colspan="7"></td></tr><tr><td class="h">11707</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$network-&gt;{name}: $in_intf-&gt;{name}&quot;;</td></tr>
<tr><td class="h">11708</td><td><div class="c3">148</div><div class="c3">148</div></td><td></td><td></td><td></td><td></td><td><div>114</div><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">11709</td><td><div class="c3">306</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11709">100</a></div></td><td></td><td></td><td></td><td><div>584</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_intf;</td></tr>
<tr><td class="h">11710</td><td><div class="c3">158</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11710">100</a></div></td><td></td><td></td><td></td><td><div>225</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{zone};</td></tr>
<tr><td class="h">11711</td><td><div class="c3">146</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11711">100</a></div></td><td></td><td></td><td></td><td><div>207</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{orig_main};</td></tr>
<tr><td class="h">11712</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">11713</td><td><div class="c3">122</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11713">100</a></div></td><td></td><td></td><td></td><td><div>238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $active_path{$router};</td></tr>
<tr><td class="h">11714</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$active_path{$router} = 1;</td></tr>
<tr><td class="h">11715</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{$router}-&gt;{$interface} = $interface;</td></tr>
<tr><td class="h">11716</td><td colspan="7"></td></tr><tr><td class="h">11717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$router-&gt;{name}: $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">11718</td><td colspan="7"></td></tr><tr><td class="h">11719</td><td><div class="c3">78</div><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>47</div><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">11720</td><td><div class="c3">230</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11720">100</a></div></td><td></td><td></td><td></td><td><div>406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $interface;</td></tr>
<tr><td class="h">11721</td><td><div class="c3">152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11721">100</a></div></td><td></td><td></td><td></td><td><div>212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf-&gt;{orig_main};</td></tr>
<tr><td class="h">11722</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_net = $out_intf-&gt;{network};</td></tr>
<tr><td class="h">11723</td><td><div class="c3">128</div></td><td></td><td></td><td></td><td></td><td><div>246</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reach_from_border-&gt;($out_net, $out_intf, $result);</td></tr>
<tr><td class="h">11724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11725</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$active_path{$router} = 0;</td></tr>
<tr><td class="h">11726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11727</td><td><div class="c3">148</div></td><td></td><td></td><td></td><td></td><td><div>290</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$active_path{$network} = 0;</td></tr>
<tr><td class="h">11728</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">11729</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = {};</td></tr>
<tr><td class="h">11730</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$reach_from_border-&gt;($border-&gt;{network}, $border, $result);</td></tr>
<tr><td class="h">11731</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $href (values %$result) {</td></tr>
<tr><td class="h">11732</td><td><div class="c3">84</div></td><td></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$href = [ values %$href ];</td></tr>
<tr><td class="h">11733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11734</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$border2obj2auto{$border} = $result;</td></tr>
<tr><td class="h">11735</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11737</td><td colspan="7"></td></tr><tr><td class="h">11738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $src is an auto_interface, interface or router.</td></tr>
<tr><td class="h">11739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Result is the set of interfaces of $src located at the front side</td></tr>
<tr><td class="h">11740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># of the direction to $dst.</td></tr>
<tr><td class="h">11741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub path_auto_interfaces {</td></tr>
<tr><td class="h">11742</td><td><div class="c3">110</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11742">110</a></div></td><td><div class="c0">0</div></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst) = @_;</td></tr>
<tr><td class="h">11743</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">11744</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src2, $managed) =</td></tr>
<tr><td class="h">11745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_autointerface($src)</td></tr>
<tr><td class="h">11746</td><td><div class="c3">110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11746">100</a></div></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? @{$src}{ &#39;object&#39;, &#39;managed&#39; }</td></tr>
<tr><td class="h">11747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ($src, undef);</td></tr>
<tr><td class="h">11748</td><td><div class="c3">110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11748">100</a></div></td><td></td><td></td><td></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst2 = is_autointerface($dst) ? $dst-&gt;{object} : $dst;</td></tr>
<tr><td class="h">11749</td><td colspan="7"></td></tr><tr><td class="h">11750</td><td><div class="c3">110</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11750">67</a></div></td><td></td><td></td><td><div>276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from_store = $obj2path{$src2}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| get_path $src2;</td></tr>
<tr><td class="h">11751</td><td><div class="c3">110</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11751">67</a></div></td><td></td><td></td><td><div>253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to_store&nbsp;&nbsp;&nbsp;= $obj2path{$dst2}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| get_path $dst2;</td></tr>
<tr><td class="h">11752</td><td><div class="c3">110</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11752">33</a></div></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $from&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $from_store-&gt;{router} || $from_store;</td></tr>
<tr><td class="h">11753</td><td><div class="c3">110</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11753">33</a></div></td><td></td><td></td><td><div>251</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $to_store-&gt;{router}&nbsp;&nbsp;&nbsp;|| $to_store;</td></tr>
<tr><td class="h">11754</td><td colspan="7"></td></tr><tr><td class="h">11755</td><td><div class="c3">110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11755">100</a></div></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$from eq $to and return ();</td></tr>
<tr><td class="h">11756</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11756">100</a></div></td><td></td><td></td><td></td><td><div>215</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$from_store-&gt;{path}-&gt;{$to_store}) {</td></tr>
<tr><td class="h">11757</td><td><div class="c3">48</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11757">50</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!path_mark($from, $to, $from_store, $to_store)) {</td></tr>
<tr><td class="h">11758</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">11759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;No valid path\n&quot;,</td></tr>
<tr><td class="h">11760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; from $from_store-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">11761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to $to_store-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">11762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; while resolving $src-&gt;{name}&quot;,</td></tr>
<tr><td class="h">11763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; (destination is $dst-&gt;{name}).\n&quot;,</td></tr>
<tr><td class="h">11764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Check path restrictions and crypto interfaces.&quot;</td></tr>
<tr><td class="h">11765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">11766</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $from_store-&gt;{path}-&gt;{$to_store};</td></tr>
<tr><td class="h">11767</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11770</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11770">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11770">67</a></div></td><td></td><td></td><td><div>252</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($from_store-&gt;{loop_exit}</td></tr>
<tr><td class="h">11771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and my $exit = $from_store-&gt;{loop_exit}-&gt;{$to_store})</td></tr>
<tr><td class="h">11772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11773</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>15</div><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = @{ $from-&gt;{loop_enter}-&gt;{$exit} };</td></tr>
<tr><td class="h">11774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11776</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = ($from_store-&gt;{path}-&gt;{$to_store});</td></tr>
<tr><td class="h">11777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11778</td><td><div class="c3">106</div><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>116</div><div>264</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@result = grep { $_-&gt;{ip} ne &#39;tunnel&#39; } @result;</td></tr>
<tr><td class="h">11779</td><td colspan="7"></td></tr><tr><td class="h">11780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find auto interface inside zone.</td></tr>
<tr><td class="h">11781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $src is located inside some zone.</td></tr>
<tr><td class="h">11782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $src2 is known to be unmanaged router or network.</td></tr>
<tr><td class="h">11783</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11783">100</a></div></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!is_router($from)) {</td></tr>
<tr><td class="h">11784</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %result;</td></tr>
<tr><td class="h">11785</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $border (@result) {</td></tr>
<tr><td class="h">11786</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11786">100</a></div></td><td></td><td></td><td></td><td><div>157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $border2obj2auto{$border}) {</td></tr>
<tr><td class="h">11787</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_auto_intf_from_border($border);</td></tr>
<tr><td class="h">11788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11789</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $auto_intf = $border2obj2auto{$border}-&gt;{$src2};</td></tr>
<tr><td class="h">11790</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$auto_intf) {</td></tr>
<tr><td class="h">11791</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>263</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result{$interface} = $interface;</td></tr>
<tr><td class="h">11792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11794</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = sort by_name values %result;</td></tr>
<tr><td class="h">11795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11796</td><td colspan="7"></td></tr><tr><td class="h">11797</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $bridged_count = 0;</td></tr>
<tr><td class="h">11798</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@result) {</td></tr>
<tr><td class="h">11799</td><td colspan="7"></td></tr><tr><td class="h">11800</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If device has virtual interface, main and virtual interface</td></tr>
<tr><td class="h">11801</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# are swapped.&nbsp;&nbsp;Swap it back here because we need the</td></tr>
<tr><td class="h">11802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# original main interface if an interface is used in a rule.</td></tr>
<tr><td class="h">11803</td><td><div class="c3">160</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11803">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11803">100</a></div></td><td></td><td></td><td></td><td><div>435</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig = $interface-&gt;{orig_main}) {</td></tr>
<tr><td class="h">11804</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface = $orig;</td></tr>
<tr><td class="h">11805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11806</td><td colspan="7"></td></tr><tr><td class="h">11807</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Change bridge interface to layer3 interface.</td></tr>
<tr><td class="h">11808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent duplicate layer3 interface.</td></tr>
<tr><td class="h">11809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $layer3_intf = $interface-&gt;{layer3_interface}) {</td></tr>
<tr><td class="h">11810</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface = $layer3_intf;</td></tr>
<tr><td class="h">11811</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bridged_count++;</td></tr>
<tr><td class="h">11812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11813</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11814</td><td><div class="c3">106</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11814">50</a></div></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($bridged_count &gt; 1) {</td></tr>
<tr><td class="h">11815</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@result = unique(@result);</td></tr>
<tr><td class="h">11816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11817</td><td colspan="7"></td></tr><tr><td class="h">11818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$src2-&gt;{name}.[auto] = &quot;, join &#39;,&#39;, map {$_-&gt;{name}} @result);</td></tr>
<tr><td class="h">11819</td><td><div class="c3">106</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11819">50</a></div></td><td></td><td></td><td></td><td><div>292</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ($managed ? grep { $_-&gt;{router}-&gt;{managed} } @result : @result);</td></tr>
<tr><td class="h">11820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11821</td><td colspan="7"></td></tr><tr><td class="h">11822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">11823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Handling of crypto tunnels.</td></tr>
<tr><td class="h">11824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">11825</td><td colspan="7"></td></tr><tr><td class="h">11826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_ipsec {</td></tr>
<tr><td class="h">11827</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11827">736</a></div></td><td><div class="c0">0</div></td><td><div>1272</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $ipsec (values %ipsec) {</td></tr>
<tr><td class="h">11828</td><td colspan="7"></td></tr><tr><td class="h">11829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert name of ISAKMP definition to object with ISAKMP definition.</td></tr>
<tr><td class="h">11830</td><td><div class="c3">43</div><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>38</div><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name) = @{ $ipsec-&gt;{key_exchange} };</td></tr>
<tr><td class="h">11831</td><td><div class="c3">43</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11831">50</a></div></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;isakmp&#39;) {</td></tr>
<tr><td class="h">11832</td><td><div class="c3">43</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11832">50</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp = $isakmp{$name}</td></tr>
<tr><td class="h">11833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Can&#39;t resolve reference to $type:$name&quot;,</td></tr>
<tr><td class="h">11834</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for $ipsec-&gt;{name}&quot;;</td></tr>
<tr><td class="h">11835</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ipsec-&gt;{key_exchange} = $isakmp;</td></tr>
<tr><td class="h">11836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11838</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unknown key_exchange type &#39;$type&#39; for $ipsec-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11841</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>685</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11843</td><td colspan="7"></td></tr><tr><td class="h">11844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_crypto {</td></tr>
<tr><td class="h">11845</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11845">736</a></div></td><td><div class="c0">0</div></td><td><div>1120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (values %crypto) {</td></tr>
<tr><td class="h">11846</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name = $crypto-&gt;{name};</td></tr>
<tr><td class="h">11847</td><td colspan="7"></td></tr><tr><td class="h">11848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert name of IPSec definition to object with IPSec definition.</td></tr>
<tr><td class="h">11849</td><td><div class="c3">49</div><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>39</div><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($type, $name2) = @{ $crypto-&gt;{type} };</td></tr>
<tr><td class="h">11850</td><td colspan="7"></td></tr><tr><td class="h">11851</td><td><div class="c3">49</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11851">50</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;ipsec&#39;) {</td></tr>
<tr><td class="h">11852</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11852">50</a></div></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ipsec = $ipsec{$name2}</td></tr>
<tr><td class="h">11853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Can&#39;t resolve reference to $type:$name2&quot;,</td></tr>
<tr><td class="h">11854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for $name&quot;;</td></tr>
<tr><td class="h">11855</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto-&gt;{type} = $ipsec;</td></tr>
<tr><td class="h">11856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">11858</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Unknown type &#39;$type&#39; for $name&quot;);</td></tr>
<tr><td class="h">11859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11861</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">11862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11863</td><td colspan="7"></td></tr><tr><td class="h">11864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Generate rules to permit crypto traffic between tunnel endpoints.</td></tr>
<tr><td class="h">11865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub gen_tunnel_rules {</td></tr>
<tr><td class="h">11866</td><td><div class="c3">54</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11866">54</a></div></td><td><div class="c0">0</div></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($intf1, $intf2, $ipsec) = @_;</td></tr>
<tr><td class="h">11867</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $use_ah = $ipsec-&gt;{ah};</td></tr>
<tr><td class="h">11868</td><td><div class="c3">54</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11868">33</a></div></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $use_esp = $ipsec-&gt;{esp_authentication} || $ipsec-&gt;{esp_encryption};</td></tr>
<tr><td class="h">11869</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nat_traversal = $ipsec-&gt;{key_exchange}-&gt;{nat_traversal};</td></tr>
<tr><td class="h">11870</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @rules;</td></tr>
<tr><td class="h">11871</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $rule = { src =&gt; $intf1, dst =&gt; $intf2 };</td></tr>
<tr><td class="h">11872</td><td><div class="c3">54</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11872">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11872">67</a></div></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $nat_traversal or $nat_traversal ne &#39;on&#39;) {</td></tr>
<tr><td class="h">11873</td><td><div class="c3">54</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11873">50</a></div></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$use_ah</td></tr>
<tr><td class="h">11874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and push @rules, { %$rule, prt =&gt; $prt_ah };</td></tr>
<tr><td class="h">11875</td><td><div class="c3">54</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11875">50</a></div></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$use_esp</td></tr>
<tr><td class="h">11876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and push @rules, { %$rule, prt =&gt; $prt_esp };</td></tr>
<tr><td class="h">11877</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @rules,</td></tr>
<tr><td class="h">11878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%$rule,</td></tr>
<tr><td class="h">11880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_range =&gt; $prt_ike-&gt;{src_range},</td></tr>
<tr><td class="h">11881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $prt_ike-&gt;{dst_range}</td></tr>
<tr><td class="h">11882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">11883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11884</td><td><div class="c3">54</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11884">100</a></div></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_traversal) {</td></tr>
<tr><td class="h">11885</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @rules,</td></tr>
<tr><td class="h">11886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">11887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%$rule,</td></tr>
<tr><td class="h">11888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_range =&gt; $prt_natt-&gt;{src_range},</td></tr>
<tr><td class="h">11889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $prt_natt-&gt;{dst_range}</td></tr>
<tr><td class="h">11890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">11891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11892</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@rules;</td></tr>
<tr><td class="h">11893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">11894</td><td colspan="7"></td></tr><tr><td class="h">11895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Link tunnel networks with tunnel hubs.</td></tr>
<tr><td class="h">11896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># ToDo: Are tunnels between different private contexts allowed?</td></tr>
<tr><td class="h">11897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub link_tunnels {</td></tr>
<tr><td class="h">11898</td><td colspan="7"></td></tr><tr><td class="h">11899</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L11899">736</a></div></td><td><div class="c0">0</div></td><td><div>650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hub_seen;</td></tr>
<tr><td class="h">11900</td><td colspan="7"></td></tr><tr><td class="h">11901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect clear-text interfaces of all tunnels.</td></tr>
<tr><td class="h">11902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @real_interfaces;</td></tr>
<tr><td class="h">11903</td><td colspan="7"></td></tr><tr><td class="h">11904</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1716</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (sort by_name values %crypto) {</td></tr>
<tr><td class="h">11905</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $crypto-&gt;{name};</td></tr>
<tr><td class="h">11906</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $private&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $crypto-&gt;{private};</td></tr>
<tr><td class="h">11907</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_hubs&nbsp;&nbsp;&nbsp;= delete $crypto2hubs{$name};</td></tr>
<tr><td class="h">11908</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_spokes = delete $crypto2spokes{$name};</td></tr>
<tr><td class="h">11909</td><td><div class="c3">49</div><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>68</div><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_hubs&nbsp;&nbsp;&nbsp;= [ grep { !$_-&gt;{disabled} } @$real_hubs ];</td></tr>
<tr><td class="h">11910</td><td><div class="c3">49</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>57</div><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_spokes = [ grep { !$_-&gt;{disabled} } @$real_spokes ];</td></tr>
<tr><td class="h">11911</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11911">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11911">33</a></div></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_hubs and @$real_hubs</td></tr>
<tr><td class="h">11912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;No hubs have been defined for $name&quot;);</td></tr>
<tr><td class="h">11913</td><td colspan="7"></td></tr><tr><td class="h">11914</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11914">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11914">33</a></div></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_spokes and @$real_spokes</td></tr>
<tr><td class="h">11915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or warn_msg(&quot;No spokes have been defined for $name&quot;);</td></tr>
<tr><td class="h">11916</td><td colspan="7"></td></tr><tr><td class="h">11917</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp&nbsp;&nbsp;= $crypto-&gt;{type}-&gt;{key_exchange};</td></tr>
<tr><td class="h">11918</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $need_id = $isakmp-&gt;{authentication} eq &#39;rsasig&#39;;</td></tr>
<tr><td class="h">11919</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $real_hub (@$real_hubs) {</td></tr>
<tr><td class="h">11920</td><td colspan="7"></td></tr><tr><td class="h">11921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Substitute crypto name by crypto object.</td></tr>
<tr><td class="h">11922</td><td><div class="c3">49</div><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>43</div><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto_name (@{ $real_hub-&gt;{hub} }) {</td></tr>
<tr><td class="h">11923</td><td><div class="c3">69</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11923">100</a></div></td><td></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto_name eq $name and $crypto_name = $crypto;</td></tr>
<tr><td class="h">11924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11925</td><td colspan="7"></td></tr><tr><td class="h">11926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect managed routers with crypto hub.</td></tr>
<tr><td class="h">11927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Note: Crypto routers are splitted internally into</td></tr>
<tr><td class="h">11928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# two nodes. Typically we get get a node with only</td></tr>
<tr><td class="h">11929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a single crypto interface.</td></tr>
<tr><td class="h">11930</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $real_hub-&gt;{router};</td></tr>
<tr><td class="h">11931</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11931">50</a></div></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed} or next;</td></tr>
<tr><td class="h">11932</td><td colspan="7"></td></tr><tr><td class="h">11933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Router of type {do_auth} can only check certificates,</td></tr>
<tr><td class="h">11934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# not pre-shared keys.</td></tr>
<tr><td class="h">11935</td><td><div class="c3">49</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11935">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L11935">67</a></div></td><td></td><td></td><td><div>145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{model}-&gt;{do_auth}</td></tr>
<tr><td class="h">11936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $need_id</td></tr>
<tr><td class="h">11937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;$router-&gt;{name} needs authentication=rsasig&quot;,</td></tr>
<tr><td class="h">11938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in $isakmp-&gt;{name}&quot;);</td></tr>
<tr><td class="h">11939</td><td colspan="7"></td></tr><tr><td class="h">11940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take original router with cleartext interface(s).</td></tr>
<tr><td class="h">11941</td><td><div class="c3">49</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11941">100</a></div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig_router = $router-&gt;{orig_router}) {</td></tr>
<tr><td class="h">11942</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router = $orig_router;</td></tr>
<tr><td class="h">11943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11944</td><td><div class="c3">49</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11944">100</a></div></td><td></td><td></td><td></td><td><div>186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @managed_crypto_hubs, $router if not $hub_seen{$router}++;</td></tr>
<tr><td class="h">11945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11946</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @real_interfaces, @$real_hubs;</td></tr>
<tr><td class="h">11947</td><td colspan="7"></td></tr><tr><td class="h">11948</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Generate a single tunnel from each spoke to a single hub.</td></tr>
<tr><td class="h">11949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If there are multiple hubs, they are assumed to form</td></tr>
<tr><td class="h">11950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a high availability cluster. In this case a single tunnel is created</td></tr>
<tr><td class="h">11951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with all hubs as possible endpoints. Traffic between hubs is</td></tr>
<tr><td class="h">11952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prevented by automatically added pathrestrictions.</td></tr>
<tr><td class="h">11953</td><td><div class="c3">49</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $spoke_net (@$real_spokes) {</td></tr>
<tr><td class="h">11954</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $net_name = $spoke_net-&gt;{name}) =~ s/network://;</td></tr>
<tr><td class="h">11955</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>56</div><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $crypto-&gt;{tunnels} }, $spoke_net;</td></tr>
<tr><td class="h">11956</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $spoke = $spoke_net-&gt;{interfaces}-&gt;[0];</td></tr>
<tr><td class="h">11957</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$spoke-&gt;{crypto} = $crypto;</td></tr>
<tr><td class="h">11958</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_spoke = $spoke-&gt;{real_interface};</td></tr>
<tr><td class="h">11959</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_spoke-&gt;{spoke} = $crypto;</td></tr>
<tr><td class="h">11960</td><td colspan="7"></td></tr><tr><td class="h">11961</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Each spoke gets a fresh hub interface.</td></tr>
<tr><td class="h">11962</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @hubs;</td></tr>
<tr><td class="h">11963</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>194</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $real_hub (@$real_hubs) {</td></tr>
<tr><td class="h">11964</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $real_hub-&gt;{router};</td></tr>
<tr><td class="h">11965</td><td><div class="c3">53</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11965">100</a></div></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig_router = $router-&gt;{orig_router}) {</td></tr>
<tr><td class="h">11966</td><td><div class="c3">47</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router = $orig_router;</td></tr>
<tr><td class="h">11967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11968</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hardware = $real_hub-&gt;{hardware};</td></tr>
<tr><td class="h">11969</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>313</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $intf_name = $real_hub-&gt;{name}) =~ s/\..*$/.$net_name/;</td></tr>
<tr><td class="h">11970</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hub = new(</td></tr>
<tr><td class="h">11971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Interface&#39;,</td></tr>
<tr><td class="h">11972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;=&gt; $intf_name,</td></tr>
<tr><td class="h">11973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;tunnel&#39;,</td></tr>
<tr><td class="h">11974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crypto =&gt; $crypto,</td></tr>
<tr><td class="h">11975</td><td colspan="7"></td></tr><tr><td class="h">11976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Attention: shared hardware between router and</td></tr>
<tr><td class="h">11977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# orig_router.</td></tr>
<tr><td class="h">11978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hardware&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $hardware,</td></tr>
<tr><td class="h">11979</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_hub&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">11980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real_interface =&gt; $real_hub,</td></tr>
<tr><td class="h">11981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $router,</td></tr>
<tr><td class="h">11982</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $spoke_net</td></tr>
<tr><td class="h">11983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">11984</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11984">50</a></div></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hub-&gt;{bind_nat} = $real_hub-&gt;{bind_nat}</td></tr>
<tr><td class="h">11985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $real_hub-&gt;{bind_nat};</td></tr>
<tr><td class="h">11986</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>43</div><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{interfaces} },&nbsp;&nbsp;&nbsp;&nbsp;$hub;</td></tr>
<tr><td class="h">11987</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>50</div><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware-&gt;{interfaces} },&nbsp;&nbsp;$hub;</td></tr>
<tr><td class="h">11988</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>41</div><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $spoke_net-&gt;{interfaces} }, $hub;</td></tr>
<tr><td class="h">11989</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>43</div><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hub-&gt;{peers} },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$spoke;</td></tr>
<tr><td class="h">11990</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>39</div><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $spoke-&gt;{peers} },&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hub;</td></tr>
<tr><td class="h">11991</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hubs, $hub;</td></tr>
<tr><td class="h">11992</td><td colspan="7"></td></tr><tr><td class="h">11993</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We need hub also be available in orig_interfaces.</td></tr>
<tr><td class="h">11994</td><td><div class="c3">53</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11994">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $aref = $router-&gt;{orig_interfaces}) {</td></tr>
<tr><td class="h">11995</td><td><div class="c3">47</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$aref, $hub;</td></tr>
<tr><td class="h">11996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">11997</td><td colspan="7"></td></tr><tr><td class="h">11998</td><td><div class="c3">53</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L11998">100</a></div></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($real_spoke-&gt;{ip} =~ /^(?:negotiated|short|unnumbered)$/) {</td></tr>
<tr><td class="h">11999</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">12000</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12000">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12000">67</a></div></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not($model-&gt;{do_auth} or $model-&gt;{can_dyn_crypto})) {</td></tr>
<tr><td class="h">12001</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;$router-&gt;{name} can&#39;t establish crypto&quot;,</td></tr>
<tr><td class="h">12002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; tunnel to $real_spoke-&gt;{name} with unknown IP&quot;;</td></tr>
<tr><td class="h">12003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12005</td><td colspan="7"></td></tr><tr><td class="h">12006</td><td><div class="c3">53</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12006">100</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($private) {</td></tr>
<tr><td class="h">12007</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $s_p = $real_spoke-&gt;{private};</td></tr>
<tr><td class="h">12008</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $h_p = $real_hub-&gt;{private};</td></tr>
<tr><td class="h">12009</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12009">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12009">14</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s_p and $s_p eq $private</td></tr>
<tr><td class="h">12010</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $h_p and $h_p eq $private</td></tr>
<tr><td class="h">12011</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg</td></tr>
<tr><td class="h">12012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Tunnel $real_spoke-&gt;{name} to $real_hub-&gt;{name}&quot;,</td></tr>
<tr><td class="h">12013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $private.private $name&quot;,</td></tr>
<tr><td class="h">12014</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must reference at least one object&quot;,</td></tr>
<tr><td class="h">12015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; out of $private.private&quot;;</td></tr>
<tr><td class="h">12016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12017</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12018</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12018">100</a></div></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_spoke-&gt;{private}</td></tr>
<tr><td class="h">12019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg &quot;Tunnel of public $name must not&quot;,</td></tr>
<tr><td class="h">12020</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; reference $real_spoke-&gt;{name} of&quot;,</td></tr>
<tr><td class="h">12021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $real_spoke-&gt;{private}.private&quot;;</td></tr>
<tr><td class="h">12022</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12022">100</a></div></td><td></td><td></td><td></td><td><div>149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_hub-&gt;{private}</td></tr>
<tr><td class="h">12023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg &quot;Tunnel of public $name must not&quot;,</td></tr>
<tr><td class="h">12024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; reference $real_hub-&gt;{name} of&quot;,</td></tr>
<tr><td class="h">12025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $real_hub-&gt;{private}.private&quot;;</td></tr>
<tr><td class="h">12026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12028</td><td colspan="7"></td></tr><tr><td class="h">12029</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $spoke-&gt;{router};</td></tr>
<tr><td class="h">12030</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @other;</td></tr>
<tr><td class="h">12031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_id_hosts;</td></tr>
<tr><td class="h">12032</td><td><div class="c3">53</div><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>46</div><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">12033</td><td><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">12034</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12034">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12034">100</a></div></td><td></td><td></td><td></td><td><div>258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{has_id_hosts}) {</td></tr>
<tr><td class="h">12035</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_id_hosts = $network;</td></tr>
<tr><td class="h">12036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($interface-&gt;{ip} ne &#39;tunnel&#39;) {</td></tr>
<tr><td class="h">12038</td><td><div class="c3">41</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @other, $interface;</td></tr>
<tr><td class="h">12039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12041</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12041">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12041">67</a></div></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($has_id_hosts and @other) {</td></tr>
<tr><td class="h">12042</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Must not use $has_id_hosts-&gt;{name} with ID hosts&quot;,</td></tr>
<tr><td class="h">12043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; together with networks having no ID host: &quot;,</td></tr>
<tr><td class="h">12044</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;,&#39;, map { $_-&gt;{name} } @other);</td></tr>
<tr><td class="h">12045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12046</td><td><div class="c3">53</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @real_interfaces, $real_spoke;</td></tr>
<tr><td class="h">12047</td><td colspan="7"></td></tr><tr><td class="h">12048</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12048">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12048">67</a></div></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed} &amp;&amp; $crypto-&gt;{detailed_crypto_acl}) {</td></tr>
<tr><td class="h">12049</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">12050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Attribute &#39;detailed_crypto_acl&#39; is not&quot;,</td></tr>
<tr><td class="h">12051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; allowed for managed spoke $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">12052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12054</td><td colspan="7"></td></tr><tr><td class="h">12055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Automatically add pathrestriction between interfaces</td></tr>
<tr><td class="h">12056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of redundant hubs.</td></tr>
<tr><td class="h">12057</td><td><div class="c3">53</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12057">50</a></div></td><td></td><td></td><td></td><td><div>202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@hubs &gt; 1) {</td></tr>
<tr><td class="h">12058</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name2 = &quot;auto-restriction:$crypto-&gt;{name}&quot;;</td></tr>
<tr><td class="h">12059</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_pathrestriction($name2, \@hubs);</td></tr>
<tr><td class="h">12060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12063</td><td colspan="7"></td></tr><tr><td class="h">12064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check for undefined crypto references.</td></tr>
<tr><td class="h">12065</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (keys %crypto2hubs) {</td></tr>
<tr><td class="h">12066</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $crypto2hubs{$crypto} }) {</td></tr>
<tr><td class="h">12067</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$interface-&gt;{name} references unknown $crypto&quot;);</td></tr>
<tr><td class="h">12068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12070</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (keys %crypto2spokes) {</td></tr>
<tr><td class="h">12071</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $crypto2spokes{$crypto} }) {</td></tr>
<tr><td class="h">12072</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;$network-&gt;{interfaces}-&gt;[0]-&gt;{name}&quot;,</td></tr>
<tr><td class="h">12073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; references unknown $crypto&quot;;</td></tr>
<tr><td class="h">12074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12076</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>947</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12078</td><td colspan="7"></td></tr><tr><td class="h">12079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub crypto_behind {</td></tr>
<tr><td class="h">12080</td><td><div class="c3">56</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12080">56</a></div></td><td><div class="c0">0</div></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $managed) = @_;</td></tr>
<tr><td class="h">12081</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12081">100</a></div></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($managed) {</td></tr>
<tr><td class="h">12082</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $interface-&gt;{zone};</td></tr>
<tr><td class="h">12083</td><td><div class="c3">8</div><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12083">50</a></div></td><td></td><td></td><td></td><td><div>7</div><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 == @{ $zone-&gt;{interfaces} }</td></tr>
<tr><td class="h">12084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Exactly one security zone must be located behind&quot;,</td></tr>
<tr><td class="h">12085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; managed crypto $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">12086</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone_networks = $zone-&gt;{networks};</td></tr>
<tr><td class="h">12087</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @$zone_networks;</td></tr>
<tr><td class="h">12088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12090</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">12091</td><td><div class="c3">48</div><div class="c3">48</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12091">50</a></div></td><td></td><td></td><td></td><td><div>35</div><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 == @{ $network-&gt;{interfaces} }</td></tr>
<tr><td class="h">12092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg &quot;Exactly one network must be located behind&quot;,</td></tr>
<tr><td class="h">12093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; unmanaged crypto $interface-&gt;{name}&quot;;</td></tr>
<tr><td class="h">12094</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($network);</td></tr>
<tr><td class="h">12095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12096</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12097</td><td colspan="7"></td></tr><tr><td class="h">12098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Valid group-policy attributes.</td></tr>
<tr><td class="h">12099</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hash describes usage:</td></tr>
<tr><td class="h">12100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - tg_general: attribute is only applicable to &#39;tunnel-group general-attributes&#39;</td></tr>
<tr><td class="h">12101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %asa_vpn_attributes = (</td></tr>
<tr><td class="h">12102</td><td colspan="7"></td></tr><tr><td class="h">12103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# group-policy attributes</td></tr>
<tr><td class="h">12104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;banner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;check-subject-name&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;dns-server&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;default-domain&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;split-dns&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;trust-point&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;wins-server&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;vpn-access-hours&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;vpn-idle-timeout&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;vpn-session-timeout&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;vpn-simultaneous-logins&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;vlan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12116</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;split-tunnel-policy&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">12117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;authentication-server-group&#39; =&gt; { tg_general =&gt; 1 },</td></tr>
<tr><td class="h">12118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;authorization-server-group&#39;&nbsp;&nbsp;=&gt; { tg_general =&gt; 1 },</td></tr>
<tr><td class="h">12119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;authorization-required&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { tg_general =&gt; 1 },</td></tr>
<tr><td class="h">12120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;username-from-certificate&#39;&nbsp;&nbsp;&nbsp;=&gt; { tg_general =&gt; 1 },</td></tr>
<tr><td class="h">12121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">12122</td><td colspan="7"></td></tr><tr><td class="h">12123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub verify_asa_vpn_attributes {</td></tr>
<tr><td class="h">12124</td><td><div class="c3">76</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12124">76</a></div></td><td><div class="c0">0</div></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">12125</td><td><div class="c3">76</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12125">50</a></div></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $attributes = $obj-&gt;{radius_attributes} or return;</td></tr>
<tr><td class="h">12126</td><td><div class="c3">76</div></td><td></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %$attributes) {</td></tr>
<tr><td class="h">12127</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $spec = $asa_vpn_attributes{$key};</td></tr>
<tr><td class="h">12128</td><td><div class="c3">64</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12128">50</a></div></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$spec or err_msg(&quot;Invalid radius_attribute &#39;$key&#39; at $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">12129</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12129">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12129">100</a></div></td><td></td><td></td><td></td><td><div>151</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($key eq &#39;split-tunnel-policy&#39;) {</td></tr>
<tr><td class="h">12130</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = $attributes-&gt;{$key};</td></tr>
<tr><td class="h">12131</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12131">50</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value =~ /^(?:tunnelall|tunnelspecified)$/</td></tr>
<tr><td class="h">12132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">12133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unsupported value in radius_attributes&quot;,</td></tr>
<tr><td class="h">12134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $obj-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">12135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &#39;$key = $value&#39;&quot;</td></tr>
<tr><td class="h">12136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($key eq &#39;trust-point&#39;) {</td></tr>
<tr><td class="h">12139</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12139">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12139">100</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_host($obj)) {</td></tr>
<tr><td class="h">12140</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12140">50</a></div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{range}</td></tr>
<tr><td class="h">12141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Must not use radius_attribute &#39;$key&#39;&quot;,</td></tr>
<tr><td class="h">12142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">12143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_network($obj)) {</td></tr>
<tr><td class="h">12145</td><td><div class="c3">6</div><div class="c3">12</div><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12145">50</a></div></td><td></td><td></td><td></td><td><div>6</div><div>25</div><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{ip} } @{ $obj-&gt;{hosts} }</td></tr>
<tr><td class="h">12146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(&quot;Must not use radius_attribute &#39;$key&#39;&quot;,</td></tr>
<tr><td class="h">12147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">12148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12151</td><td><div class="c3">76</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12153</td><td colspan="7"></td></tr><tr><td class="h">12154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Host with ID that doesn&#39;t contain a &#39;@&#39; must use attribute &#39;verify-subject-name&#39;.</td></tr>
<tr><td class="h">12155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub verify_subject_name {</td></tr>
<tr><td class="h">12156</td><td><div class="c3">36</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12156">36</a></div></td><td><div class="c0">0</div></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($host, $peers) = @_;</td></tr>
<tr><td class="h">12157</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $id = $host-&gt;{id};</td></tr>
<tr><td class="h">12158</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12158">100</a></div></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $id =~ /@/;</td></tr>
<tr><td class="h">12159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $has_attr = sub {</td></tr>
<tr><td class="h">12160</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12160">6</a></div></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">12161</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attributes = $obj-&gt;{radius_attributes};</td></tr>
<tr><td class="h">12162</td><td><div class="c3">6</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12162">33</a></div></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($attributes &amp;&amp; $attributes-&gt;{&#39;check-subject-name&#39;});</td></tr>
<tr><td class="h">12163</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">12164</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12164">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $has_attr-&gt;($host);</td></tr>
<tr><td class="h">12165</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12165">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $has_attr-&gt;($host-&gt;{network});</td></tr>
<tr><td class="h">12166</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $missing;</td></tr>
<tr><td class="h">12167</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@$peers) {</td></tr>
<tr><td class="h">12168</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12168">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $has_attr-&gt;($peer-&gt;{router});</td></tr>
<tr><td class="h">12169</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$missing = 1;</td></tr>
<tr><td class="h">12170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12171</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12171">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($missing) {</td></tr>
<tr><td class="h">12172</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;Missing radius_attribute &#39;check-subject-name&#39;\n&quot;,</td></tr>
<tr><td class="h">12173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for $host-&gt;{name}&quot;);</td></tr>
<tr><td class="h">12174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12175</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12177</td><td colspan="7"></td></tr><tr><td class="h">12178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub verify_asa_trustpoint {</td></tr>
<tr><td class="h">12179</td><td><div class="c3">22</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12179">22</a></div></td><td><div class="c0">0</div></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $crypto) = @_;</td></tr>
<tr><td class="h">12180</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp = $crypto-&gt;{type}-&gt;{key_exchange};</td></tr>
<tr><td class="h">12181</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12181">100</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($isakmp-&gt;{authentication} eq &#39;rsasig&#39;) {</td></tr>
<tr><td class="h">12182</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12182">100</a></div></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$isakmp-&gt;{trust_point}</td></tr>
<tr><td class="h">12183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">12184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Missing attribute &#39;trust_point&#39; in&quot;,</td></tr>
<tr><td class="h">12185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $isakmp-&gt;{name} for $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">12186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12188</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12190</td><td colspan="7"></td></tr><tr><td class="h">12191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expand_crypto {</td></tr>
<tr><td class="h">12192</td><td><div class="c3">514</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12192">514</a></div></td><td><div class="c0">0</div></td><td><div>2584</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Expanding crypto rules&#39;);</td></tr>
<tr><td class="h">12193</td><td colspan="7"></td></tr><tr><td class="h">12194</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>430</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %id2interface;</td></tr>
<tr><td class="h">12195</td><td colspan="7"></td></tr><tr><td class="h">12196</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>970</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $crypto (values %crypto) {</td></tr>
<tr><td class="h">12197</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name&nbsp;&nbsp;&nbsp;&nbsp;= $crypto-&gt;{name};</td></tr>
<tr><td class="h">12198</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp&nbsp;&nbsp;= $crypto-&gt;{type}-&gt;{key_exchange};</td></tr>
<tr><td class="h">12199</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $need_id = $isakmp-&gt;{authentication} eq &#39;rsasig&#39;;</td></tr>
<tr><td class="h">12200</td><td colspan="7"></td></tr><tr><td class="h">12201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do consistency checks and</td></tr>
<tr><td class="h">12202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# add rules which allow encrypted traffic.</td></tr>
<tr><td class="h">12203</td><td><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>32</div><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tunnel (@{ $crypto-&gt;{tunnels} }) {</td></tr>
<tr><td class="h">12204</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12204">50</a></div></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $tunnel-&gt;{disabled};</td></tr>
<tr><td class="h">12205</td><td><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>37</div><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tunnel_intf (@{ $tunnel-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">12206</td><td><div class="c3">88</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12206">100</a></div></td><td></td><td></td><td></td><td><div>224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $tunnel_intf-&gt;{is_hub};</td></tr>
<tr><td class="h">12207</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router&nbsp;&nbsp;= $tunnel_intf-&gt;{router};</td></tr>
<tr><td class="h">12208</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $peers&nbsp;&nbsp;&nbsp;= $tunnel_intf-&gt;{peers};</td></tr>
<tr><td class="h">12209</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $router-&gt;{managed};</td></tr>
<tr><td class="h">12210</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @encrypted;</td></tr>
<tr><td class="h">12211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_id_hosts;</td></tr>
<tr><td class="h">12212</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_other_network;</td></tr>
<tr><td class="h">12213</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @verify_radius_attributes;</td></tr>
<tr><td class="h">12214</td><td colspan="7"></td></tr><tr><td class="h">12215</td><td><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>35</div><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">12216</td><td><div class="c3">100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12216">100</a></div></td><td></td><td></td><td></td><td><div>238</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $tunnel_intf;</td></tr>
<tr><td class="h">12217</td><td><div class="c3">56</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12217">50</a></div></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{ip} eq &#39;tunnel&#39;) {</td></tr>
<tr><td class="h">12218</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12218">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12218">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed &amp;&amp; $router-&gt;{model}-&gt;{crypto} eq &#39;EZVPN&#39;) {</td></tr>
<tr><td class="h">12219</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Exactly 1 crypto tunnel expected&quot;,</td></tr>
<tr><td class="h">12220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for $router-&gt;{name} with EZVPN&quot;;</td></tr>
<tr><td class="h">12221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12222</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">12223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12224</td><td><div class="c3">56</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12224">50</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{spoke}) {</td></tr>
<tr><td class="h">12225</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12225">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $id = $interface-&gt;{id}) {</td></tr>
<tr><td class="h">12226</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12226">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $intf2 = $id2interface{$id}) {</td></tr>
<tr><td class="h">12227</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg &quot;Same ID &#39;$id&#39; is used at&quot;,</td></tr>
<tr><td class="h">12228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface-&gt;{name} and $intf2-&gt;{name}&quot;;</td></tr>
<tr><td class="h">12229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12230</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id2interface{$id} = $interface;</td></tr>
<tr><td class="h">12231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12232</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">12233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12234</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">12235</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @all_networks = crypto_behind($interface, $managed);</td></tr>
<tr><td class="h">12236</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12236">100</a></div></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network-&gt;{has_id_hosts}) {</td></tr>
<tr><td class="h">12237</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_id_hosts = 1;</td></tr>
<tr><td class="h">12238</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12238">50</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$managed</td></tr>
<tr><td class="h">12239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg</td></tr>
<tr><td class="h">12240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$network-&gt;{name} having ID hosts must not&quot;,</td></tr>
<tr><td class="h">12241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; be located behind managed $router-&gt;{name}&quot;;</td></tr>
<tr><td class="h">12242</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @verify_radius_attributes, $network;</td></tr>
<tr><td class="h">12243</td><td colspan="7"></td></tr><tr><td class="h">12244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Must not have multiple networks.</td></tr>
<tr><td class="h">12245</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12245">50</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@all_networks &gt; 1 and internal_err();</td></tr>
<tr><td class="h">12246</td><td colspan="7"></td></tr><tr><td class="h">12247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Rules for single software clients are stored</td></tr>
<tr><td class="h">12248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# individually at crypto hub interface.</td></tr>
<tr><td class="h">12249</td><td><div class="c3">24</div><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>23</div><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{hosts} }) {</td></tr>
<tr><td class="h">12250</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id = $host-&gt;{id};</td></tr>
<tr><td class="h">12251</td><td colspan="7"></td></tr><tr><td class="h">12252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ID host has already been checked to have</td></tr>
<tr><td class="h">12253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# exacly one subnet.</td></tr>
<tr><td class="h">12254</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subnet = $host-&gt;{subnets}-&gt;[0];</td></tr>
<tr><td class="h">12255</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @verify_radius_attributes, $host;</td></tr>
<tr><td class="h">12256</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@$peers) {</td></tr>
<tr><td class="h">12257</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $peer-&gt;{no_nat_set};</td></tr>
<tr><td class="h">12258</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12258">100</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $peer-&gt;{id_rules}-&gt;{$id}) {</td></tr>
<tr><td class="h">12259</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src = $other-&gt;{src};</td></tr>
<tr><td class="h">12260</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">12261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Duplicate ID-host $id from&quot;,</td></tr>
<tr><td class="h">12262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $src-&gt;{network}-&gt;{name} and&quot;,</td></tr>
<tr><td class="h">12263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $subnet-&gt;{network}-&gt;{name}&quot;,</td></tr>
<tr><td class="h">12264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $peer-&gt;{router}-&gt;{name}&quot;</td></tr>
<tr><td class="h">12265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12266</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">12267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12268</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$peer-&gt;{id_rules}-&gt;{$id} = {</td></tr>
<tr><td class="h">12269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &quot;$peer-&gt;{name}.$id&quot;,</td></tr>
<tr><td class="h">12270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;tunnel&#39;,</td></tr>
<tr><td class="h">12271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $subnet,</td></tr>
<tr><td class="h">12272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">12273</td><td colspan="7"></td></tr><tr><td class="h">12274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Needed during local_optimization.</td></tr>
<tr><td class="h">12275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;router =&gt; $peer-&gt;{router},</td></tr>
<tr><td class="h">12276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">12277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12279</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @encrypted, $network;</td></tr>
<tr><td class="h">12280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12282</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_other_network = 1;</td></tr>
<tr><td class="h">12283</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @encrypted, @all_networks;</td></tr>
<tr><td class="h">12284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_id_hosts</td></tr>
<tr><td class="h">12287</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $has_other_network</td></tr>
<tr><td class="h">12288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and err_msg(</td></tr>
<tr><td class="h">12289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not use host with ID and network&quot;,</td></tr>
<tr><td class="h">12290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; together at $tunnel_intf-&gt;{name}: &quot;,</td></tr>
<tr><td class="h">12291</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12291">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12291">67</a></div></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;, &#39;, map { $_-&gt;{name} } @encrypted)</td></tr>
<tr><td class="h">12292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12293</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_id_hosts</td></tr>
<tr><td class="h">12294</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $has_other_network</td></tr>
<tr><td class="h">12295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">12296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must use network or host with ID&quot;,</td></tr>
<tr><td class="h">12297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $tunnel_intf-&gt;{name}: &quot;,</td></tr>
<tr><td class="h">12298</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12298">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12298">67</a></div></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;, &#39;, map { $_-&gt;{name} } @encrypted)</td></tr>
<tr><td class="h">12299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12300</td><td colspan="7"></td></tr><tr><td class="h">12301</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_spoke = $tunnel_intf-&gt;{real_interface};</td></tr>
<tr><td class="h">12302</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@$peers) {</td></tr>
<tr><td class="h">12303</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$peer-&gt;{peer_networks} = \@encrypted;</td></tr>
<tr><td class="h">12304</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router&nbsp;&nbsp;= $peer-&gt;{router};</td></tr>
<tr><td class="h">12305</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $do_auth = $router-&gt;{model}-&gt;{do_auth};</td></tr>
<tr><td class="h">12306</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $unknown_ip =</td></tr>
<tr><td class="h">12307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_spoke-&gt;{ip} =~ /^(?:negotiated|short|unnumbered)$/;</td></tr>
<tr><td class="h">12308</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12308">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12308">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12308">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12308">100</a></div></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($tunnel_intf-&gt;{id}) {</td></tr>
<tr><td class="h">12309</td><td><div class="c3">18</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12309">50</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_id</td></tr>
<tr><td class="h">12310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">12311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Invalid attribute &#39;id&#39; at&quot;,</td></tr>
<tr><td class="h">12312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $tunnel_intf-&gt;{name}.\n&quot;,</td></tr>
<tr><td class="h">12313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Set authentication=rsasig at&quot;,</td></tr>
<tr><td class="h">12314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $isakmp-&gt;{name}&quot;</td></tr>
<tr><td class="h">12315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($encrypted[0]-&gt;{has_id_hosts}) {</td></tr>
<tr><td class="h">12318</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12318">50</a></div></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$do_auth</td></tr>
<tr><td class="h">12319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(</td></tr>
<tr><td class="h">12320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$router-&gt;{name} can&#39;t check IDs&quot;,</td></tr>
<tr><td class="h">12321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $encrypted[0]-&gt;{name}&quot;</td></tr>
<tr><td class="h">12322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($do_auth) {</td></tr>
<tr><td class="h">12325</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">12326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Networks need to have ID hosts because&quot;,</td></tr>
<tr><td class="h">12327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $router-&gt;{name} has attribute &#39;do_auth&#39;:&quot;,</td></tr>
<tr><td class="h">12328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n - &quot;,</td></tr>
<tr><td class="h">12329</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&quot;\n - &quot;, map { $_-&gt;{name} } @encrypted)</td></tr>
<tr><td class="h">12330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($need_id) {</td></tr>
<tr><td class="h">12333</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">12334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$tunnel_intf-&gt;{name}&quot;,</td></tr>
<tr><td class="h">12335</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; needs attribute &#39;id&#39;,&quot;,</td></tr>
<tr><td class="h">12336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; because $isakmp-&gt;{name}&quot;,</td></tr>
<tr><td class="h">12337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; has authentication=rsasig&quot;</td></tr>
<tr><td class="h">12338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12341</td><td colspan="7"></td></tr><tr><td class="h">12342</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12342">100</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">12343</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $_-&gt;{router}-&gt;{model}-&gt;{crypto} eq &#39;ASA_VPN&#39; }</td></tr>
<tr><td class="h">12344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$peers))</td></tr>
<tr><td class="h">12345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12346</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@verify_radius_attributes) {</td></tr>
<tr><td class="h">12347</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify_asa_vpn_attributes($obj);</td></tr>
<tr><td class="h">12348</td><td><div class="c3">60</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12348">100</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_host($obj)) {</td></tr>
<tr><td class="h">12349</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify_subject_name($obj, $peers);</td></tr>
<tr><td class="h">12350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12353</td><td colspan="7"></td></tr><tr><td class="h">12354</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12354">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12354">67</a></div></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed &amp;&amp; $router-&gt;{model}-&gt;{crypto} eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">12355</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify_asa_trustpoint($router, $crypto);</td></tr>
<tr><td class="h">12356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12357</td><td colspan="7"></td></tr><tr><td class="h">12358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add rules to permit crypto traffic between</td></tr>
<tr><td class="h">12359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# tunnel endpoints.</td></tr>
<tr><td class="h">12360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If one tunnel endpoint has no known IP address,</td></tr>
<tr><td class="h">12361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# some rules have to be added manually.</td></tr>
<tr><td class="h">12362</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12362">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12362">67</a></div></td><td></td><td></td><td><div>205</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$real_spoke</td></tr>
<tr><td class="h">12363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $real_spoke-&gt;{ip} !~ /^(?:short|unnumbered)$/)</td></tr>
<tr><td class="h">12364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12365</td><td><div class="c3">30</div><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>27</div><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hub (@{ $tunnel_intf-&gt;{peers} }) {</td></tr>
<tr><td class="h">12366</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_hub = $hub-&gt;{real_interface};</td></tr>
<tr><td class="h">12367</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (</td></tr>
<tr><td class="h">12368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ $real_spoke, $real_hub ],</td></tr>
<tr><td class="h">12369</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ $real_hub,&nbsp;&nbsp;&nbsp;$real_spoke ]</td></tr>
<tr><td class="h">12370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">12371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12372</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($intf1, $intf2) = @$pair;</td></tr>
<tr><td class="h">12373</td><td colspan="7"></td></tr><tr><td class="h">12374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t generate incoming ACL from unknown</td></tr>
<tr><td class="h">12375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# address.</td></tr>
<tr><td class="h">12376</td><td><div class="c3">60</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12376">100</a></div></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf1-&gt;{ip} eq &#39;negotiated&#39;;</td></tr>
<tr><td class="h">12377</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules_ref =</td></tr>
<tr><td class="h">12378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen_tunnel_rules($intf1, $intf2, $crypto-&gt;{type});</td></tr>
<tr><td class="h">12379</td><td><div class="c3">54</div><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>43</div><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $expanded_rules{permit} }, @$rules_ref;</td></tr>
<tr><td class="h">12380</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_rules $rules_ref;</td></tr>
<tr><td class="h">12381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12387</td><td colspan="7"></td></tr><tr><td class="h">12388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check for duplicate IDs of different hosts</td></tr>
<tr><td class="h">12389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# coming into different hardware at current device.</td></tr>
<tr><td class="h">12390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# ASA_VPN can&#39;t distinguish different hosts with same ID</td></tr>
<tr><td class="h">12391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# coming into different hardware interfaces.</td></tr>
<tr><td class="h">12392</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>682</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_crypto_hubs) {</td></tr>
<tr><td class="h">12393</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">12394</td><td><div class="c3">32</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12394">50</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto = $model-&gt;{crypto} or next;</td></tr>
<tr><td class="h">12395</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12395">100</a></div></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto eq &#39;ASA_VPN&#39; or next;</td></tr>
<tr><td class="h">12396</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @id_rules_interfaces =</td></tr>
<tr><td class="h">12397</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>19</div><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{id_rules} } @{ $router-&gt;{interfaces} };</td></tr>
<tr><td class="h">12398</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12398">100</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@id_rules_interfaces &gt;= 2 or next;</td></tr>
<tr><td class="h">12399</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %id2src;</td></tr>
<tr><td class="h">12400</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@id_rules_interfaces) {</td></tr>
<tr><td class="h">12401</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $interface-&gt;{id_rules};</td></tr>
<tr><td class="h">12402</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $id (keys %$hash) {</td></tr>
<tr><td class="h">12403</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src1 = $hash-&gt;{$id}-&gt;{src};</td></tr>
<tr><td class="h">12404</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12404">100</a></div></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $src2 = $id2src{$id}) {</td></tr>
<tr><td class="h">12405</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">12406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Duplicate ID-host $id from&quot;,</td></tr>
<tr><td class="h">12407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $src1-&gt;{network}-&gt;{name} and&quot;,</td></tr>
<tr><td class="h">12408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $src2-&gt;{network}-&gt;{name}&quot;,</td></tr>
<tr><td class="h">12409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $router-&gt;{name}&quot;</td></tr>
<tr><td class="h">12410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12413</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id2src{$id} = $src1;</td></tr>
<tr><td class="h">12414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12418</td><td colspan="7"></td></tr><tr><td class="h">12419</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>612</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_crypto_hubs) {</td></tr>
<tr><td class="h">12420</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_type = $router-&gt;{model}-&gt;{crypto};</td></tr>
<tr><td class="h">12421</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12421">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12421">50</a></div></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;ASA_VPN&#39;) {</td></tr>
<tr><td class="h">12422</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify_asa_vpn_attributes($router);</td></tr>
<tr><td class="h">12423</td><td colspan="7"></td></tr><tr><td class="h">12424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Move &#39;trust-point&#39; from radius_attributes to router attribute.</td></tr>
<tr><td class="h">12425</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12425">50</a></div></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $trust_point =</td></tr>
<tr><td class="h">12426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $router-&gt;{radius_attributes}-&gt;{&#39;trust-point&#39;}</td></tr>
<tr><td class="h">12427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;Missing &#39;trust-point&#39; in radius_attributes&quot;,</td></tr>
<tr><td class="h">12428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $router-&gt;{name}&quot;);</td></tr>
<tr><td class="h">12429</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{trust_point} = $trust_point;</td></tr>
<tr><td class="h">12430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">12432</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>13</div><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">12433</td><td><div class="c3">38</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12433">100</a></div></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto = $interface-&gt;{crypto} or next;</td></tr>
<tr><td class="h">12434</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify_asa_trustpoint($router, $crypto);</td></tr>
<tr><td class="h">12435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12438</td><td colspan="7"></td></tr><tr><td class="h">12439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Hash only needed during expand_group and expand_rules.</td></tr>
<tr><td class="h">12440</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>583</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%auto_interfaces = ();</td></tr>
<tr><td class="h">12441</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>525</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12443</td><td colspan="7"></td></tr><tr><td class="h">12444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hash for converting a reference of an object back to this object.</td></tr>
<tr><td class="h">12445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %ref2obj;</td></tr>
<tr><td class="h">12446</td><td colspan="7"></td></tr><tr><td class="h">12447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setup_ref2obj {</td></tr>
<tr><td class="h">12448</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12448">486</a></div></td><td><div class="c0">0</div></td><td><div>594</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">12449</td><td><div class="c3">2596</div></td><td></td><td></td><td></td><td></td><td><div>3465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2obj{$network} = $network;</td></tr>
<tr><td class="h">12450</td><td><div class="c3">2596</div><div class="c3">2596</div><div class="c3">2596</div></td><td></td><td></td><td></td><td></td><td><div>1913</div><div>2981</div><div>3130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@{ $network-&gt;{subnets} }, @{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">12451</td><td><div class="c3">4010</div></td><td></td><td></td><td></td><td></td><td><div>7496</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2obj{$obj} = $obj;</td></tr>
<tr><td class="h">12452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12454</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>496</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12456</td><td colspan="7"></td></tr><tr><td class="h">12457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">12458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Check if high-level and low-level semantics of rules with an supernet</td></tr>
<tr><td class="h">12459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># as source or destination are equivalent.</td></tr>
<tr><td class="h">12460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># I. Typically, we only use incoming ACLs.</td></tr>
<tr><td class="h">12462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># (A) rule &quot;permit any:X dst&quot;</td></tr>
<tr><td class="h">12463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># high-level: any:X in zone X get access to dst</td></tr>
<tr><td class="h">12464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># low-level: like above, but additionally, the networks matching any:X</td></tr>
<tr><td class="h">12465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in all zones on the path from zone X to dst get access to dst.</td></tr>
<tr><td class="h">12466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># (B) rule permit src any:X</td></tr>
<tr><td class="h">12467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># high-level: src gets access to any:X in zone X</td></tr>
<tr><td class="h">12468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># low-level: like above, but additionally, src gets access to all networks</td></tr>
<tr><td class="h">12469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching any:X in all zones located directly behind</td></tr>
<tr><td class="h">12470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all routers on the path from src to zone X.</td></tr>
<tr><td class="h">12471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># II. Alternatively, we have a single interface Y (with attached zone Y)</td></tr>
<tr><td class="h">12473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;without ACL and all other interfaces having incoming and outgoing ACLs.</td></tr>
<tr><td class="h">12474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># (A) rule &quot;permit any:X dst&quot;</td></tr>
<tr><td class="h">12475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;a)&nbsp;&nbsp;dst behind Y: filtering occurs at incoming ACL of X, good.</td></tr>
<tr><td class="h">12476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;b)&nbsp;&nbsp;dst not behind Y:</td></tr>
<tr><td class="h">12477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;1. zone X == zone Y: filtering occurs at outgoing ACL, good.</td></tr>
<tr><td class="h">12478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;2. zone X != zone Y: outgoing ACL would accidently</td></tr>
<tr><td class="h">12479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permit any:Y-&gt;dst, bad.</td></tr>
<tr><td class="h">12480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Additional rule required: &quot;permit any:Y-&gt;dst&quot;</td></tr>
<tr><td class="h">12481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># (B) rule &quot;permit src any:X&quot;</td></tr>
<tr><td class="h">12482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;a)&nbsp;&nbsp;src behind Y: filtering occurs at ougoing ACL, good</td></tr>
<tr><td class="h">12483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;b)&nbsp;&nbsp;src not behind Y:</td></tr>
<tr><td class="h">12484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;1. zone X == zone Y: filtering occurs at incoming ACL at src and</td></tr>
<tr><td class="h">12485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at outgoing ACls of other non-zone X interfaces, good.</td></tr>
<tr><td class="h">12486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;2. zone X != zone Y: incoming ACL at src would permit</td></tr>
<tr><td class="h">12487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src-&gt;any:Y, bad</td></tr>
<tr><td class="h">12488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Additional rule required: &quot;permit src-&gt;any:Y&quot;.</td></tr>
<tr><td class="h">12489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">12490</td><td colspan="7"></td></tr><tr><td class="h">12491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %supernet_rule_tree;</td></tr>
<tr><td class="h">12492</td><td colspan="7"></td></tr><tr><td class="h">12493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect rules with destination aggregate/supernet</td></tr>
<tr><td class="h">12494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - that are filtered at the same router which is attached</td></tr>
<tr><td class="h">12495</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;to the destination zone</td></tr>
<tr><td class="h">12496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - the destination router is entered by the same interface</td></tr>
<tr><td class="h">12497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - src, src_range, prt, stateless are identical</td></tr>
<tr><td class="h">12498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - dst is supernet or aggregate with identical ip/mask</td></tr>
<tr><td class="h">12499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub collect_supernet_dst_rules {</td></tr>
<tr><td class="h">12500</td><td colspan="7"></td></tr><tr><td class="h">12501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Function is called from path_walk.</td></tr>
<tr><td class="h">12502</td><td><div class="c3">174</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12502">174</a></div></td><td><div class="c0">0</div></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">12503</td><td colspan="7"></td></tr><tr><td class="h">12504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Source is interface of current router.</td></tr>
<tr><td class="h">12505</td><td><div class="c3">174</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12505">100</a></div></td><td></td><td></td><td></td><td><div>268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$in_intf;</td></tr>
<tr><td class="h">12506</td><td colspan="7"></td></tr><tr><td class="h">12507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore semi_managed router.</td></tr>
<tr><td class="h">12508</td><td><div class="c3">160</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_intf-&gt;{router};</td></tr>
<tr><td class="h">12509</td><td><div class="c3">160</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12509">100</a></div></td><td></td><td></td><td></td><td><div>258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$router-&gt;{managed};</td></tr>
<tr><td class="h">12510</td><td colspan="7"></td></tr><tr><td class="h">12511</td><td><div class="c3">154</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst&nbsp;&nbsp;= $rule-&gt;{dst};</td></tr>
<tr><td class="h">12512</td><td><div class="c3">154</div></td><td></td><td></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $dst-&gt;{zone};</td></tr>
<tr><td class="h">12513</td><td><div class="c3">154</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12513">100</a></div></td><td></td><td></td><td></td><td><div>340</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $out_intf-&gt;{zone} ne $zone;</td></tr>
<tr><td class="h">12514</td><td colspan="7"></td></tr><tr><td class="h">12515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Get NAT address of supernet.</td></tr>
<tr><td class="h">12516</td><td><div class="c3">110</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12516">100</a></div></td><td></td><td></td><td></td><td><div>186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$dst-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">12517</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $in_intf-&gt;{no_nat_set};</td></tr>
<tr><td class="h">12518</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst = get_nat_network($dst, $no_nat_set);</td></tr>
<tr><td class="h">12519</td><td><div class="c3">32</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12519">50</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $dst-&gt;{hidden};</td></tr>
<tr><td class="h">12520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12521</td><td colspan="7"></td></tr><tr><td class="h">12522</td><td><div class="c3">110</div><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>102</div><div>243</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ipmask = join(&#39;/&#39;, @{$dst}{qw(ip mask)});</td></tr>
<tr><td class="h">12523</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($stateless, $src, $src_range, $prt) =</td></tr>
<tr><td class="h">12524</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$rule}{qw(stateless src src_range prt)};</td></tr>
<tr><td class="h">12525</td><td><div class="c3">110</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12525">50</a></div></td><td></td><td></td><td><div>287</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$stateless ||= &#39;&#39;;</td></tr>
<tr><td class="h">12526</td><td><div class="c3">110</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12526">33</a></div></td><td></td><td></td><td><div>264</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$src_range ||= $prt_ip;</td></tr>
<tr><td class="h">12527</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>491</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$supernet_rule_tree{$stateless}-&gt;{$src}-&gt;{$src_range}-&gt;{$prt}-&gt;{$in_intf}</td></tr>
<tr><td class="h">12528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$ipmask}-&gt;{$zone} = $rule;</td></tr>
<tr><td class="h">12529</td><td><div class="c3">110</div></td><td></td><td></td><td></td><td></td><td><div>207</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12531</td><td colspan="7"></td></tr><tr><td class="h">12532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_supernet {</td></tr>
<tr><td class="h">12533</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12533">6</a></div></td><td><div class="c0">0</div></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($net1, $net2) = @_;</td></tr>
<tr><td class="h">12534</td><td colspan="7"></td></tr><tr><td class="h">12535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Start with $net1 being the smaller network.</td></tr>
<tr><td class="h">12536</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12536">100</a></div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;($net1, $net2) = ($net2, $net1) if $net1-&gt;{mask} &lt; $net2-&gt;{mask};</td></tr>
<tr><td class="h">12537</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">12538</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($net1-&gt;{mask} &gt; $net2-&gt;{mask}) {</td></tr>
<tr><td class="h">12539</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12539">100</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net1 = $net1-&gt;{up} or return;</td></tr>
<tr><td class="h">12540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12541</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12541">100</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $net1 if $net1 eq $net2;</td></tr>
<tr><td class="h">12542</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12542">100</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2 = $net2-&gt;{up} or return;</td></tr>
<tr><td class="h">12543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12544</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;# unused; only for perlcritic</td></tr>
<tr><td class="h">12545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12546</td><td colspan="7"></td></tr><tr><td class="h">12547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find networks in zone with address</td></tr>
<tr><td class="h">12548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - equal to ip/mask or</td></tr>
<tr><td class="h">12549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - subnet of ip/mask</td></tr>
<tr><td class="h">12550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Leave out small networks which are subnet of a matching network.</td></tr>
<tr><td class="h">12551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Result:</td></tr>
<tr><td class="h">12552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 0: no network found</td></tr>
<tr><td class="h">12553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># network:</td></tr>
<tr><td class="h">12554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;a) exactly one network matches, i.e. is equal or subnet.</td></tr>
<tr><td class="h">12555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;b) a supernet which encloses multiple matching networks</td></tr>
<tr><td class="h">12556</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># String: More than one network found and no supernet exists.</td></tr>
<tr><td class="h">12557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String has the name of first two networks.</td></tr>
<tr><td class="h">12558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_zone_network {</td></tr>
<tr><td class="h">12559</td><td><div class="c3">98</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12559">98</a></div></td><td><div class="c0">0</div></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $zone, $other) = @_;</td></tr>
<tr><td class="h">12560</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">12561</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>120</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nat_other = get_nat_network($other, $no_nat_set);</td></tr>
<tr><td class="h">12562</td><td><div class="c3">98</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12562">50</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0 if $nat_other-&gt;{hidden};</td></tr>
<tr><td class="h">12563</td><td><div class="c3">98</div><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>89</div><div>153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_other}{qw(ip mask)};</td></tr>
<tr><td class="h">12564</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $key = &quot;$ip/$mask&quot;;</td></tr>
<tr><td class="h">12565</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12565">100</a></div></td><td></td><td></td><td></td><td><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $aggregate = $zone-&gt;{ipmask2aggregate}-&gt;{$key}) {</td></tr>
<tr><td class="h">12566</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $aggregate;</td></tr>
<tr><td class="h">12567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12568</td><td><div class="c3">80</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12568">50</a></div></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $result = $zone-&gt;{ipmask2net}-&gt;{$key}) {</td></tr>
<tr><td class="h">12569</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">12570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12571</td><td colspan="7"></td></tr><tr><td class="h">12572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Real networks in zone without aggregates and without subnets.</td></tr>
<tr><td class="h">12573</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $networks = $zone-&gt;{networks};</td></tr>
<tr><td class="h">12574</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result&nbsp;&nbsp;&nbsp;= 0;</td></tr>
<tr><td class="h">12575</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$networks) {</td></tr>
<tr><td class="h">12576</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = get_nat_network($network, $no_nat_set);</td></tr>
<tr><td class="h">12577</td><td><div class="c3">90</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12577">50</a></div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_network-&gt;{hidden};</td></tr>
<tr><td class="h">12578</td><td><div class="c3">90</div><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>77</div><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($i, $m) = @{$nat_network}{qw(ip mask)};</td></tr>
<tr><td class="h">12579</td><td><div class="c3">90</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12579">50</a></div></td><td></td><td></td><td></td><td><div>211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $i =~ /^(?:unnumbered|tunnel)$/;</td></tr>
<tr><td class="h">12580</td><td colspan="7"></td></tr><tr><td class="h">12581</td><td><div class="c3">90</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12581">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12581">71</a></div></td><td></td><td></td><td><div>272</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$m &gt;= $mask &amp;&amp; match_ip($i, $ip, $mask)</td></tr>
<tr><td class="h">12582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $m &lt; $mask &amp;&amp; match_ip($ip, $i, $m))</td></tr>
<tr><td class="h">12583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12584</td><td colspan="7"></td></tr><tr><td class="h">12585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found first matching network.</td></tr>
<tr><td class="h">12586</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12586">100</a></div></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$result) {</td></tr>
<tr><td class="h">12587</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $network;</td></tr>
<tr><td class="h">12588</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">12589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12590</td><td colspan="7"></td></tr><tr><td class="h">12591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Search a common supernet of two networks</td></tr>
<tr><td class="h">12592</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12592">100</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $super = find_supernet($result, $network)) {</td></tr>
<tr><td class="h">12593</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $super;</td></tr>
<tr><td class="h">12594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12596</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = &quot;$result-&gt;{name}, $network-&gt;{name}&quot;;</td></tr>
<tr><td class="h">12597</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">12598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12601</td><td colspan="7"></td></tr><tr><td class="h">12602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;zone_network:&quot;, ref($result) ? $result-&gt;{name} : $result;</td></tr>
<tr><td class="h">12603</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ($zone-&gt;{ipmask2net}-&gt;{$key} = $result);</td></tr>
<tr><td class="h">12604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12605</td><td colspan="7"></td></tr><tr><td class="h">12606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find all networks in zone, which match network from other zone.</td></tr>
<tr><td class="h">12607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Result:</td></tr>
<tr><td class="h">12608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># undef: No network of zone matches $other.</td></tr>
<tr><td class="h">12609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># []&nbsp;&nbsp;&nbsp;: Multiple networks match, but no supernet exists.</td></tr>
<tr><td class="h">12610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># [N, ..]: Array reference to networks which match $other (ascending order).</td></tr>
<tr><td class="h">12611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_matching_supernet {</td></tr>
<tr><td class="h">12612</td><td><div class="c3">98</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12612">98</a></div></td><td><div class="c0">0</div></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $zone, $other) = @_;</td></tr>
<tr><td class="h">12613</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $net_or_count = find_zone_network($interface, $zone, $other);</td></tr>
<tr><td class="h">12614</td><td colspan="7"></td></tr><tr><td class="h">12615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No network or aggregate matches.</td></tr>
<tr><td class="h">12616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $other wont match in current zone.</td></tr>
<tr><td class="h">12617</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12617">100</a></div></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!$net_or_count) {</td></tr>
<tr><td class="h">12618</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12620</td><td colspan="7"></td></tr><tr><td class="h">12621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# More than one network matches and no supernet exists.</td></tr>
<tr><td class="h">12622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return names of that networks.</td></tr>
<tr><td class="h">12623</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12623">100</a></div></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!ref($net_or_count)) {</td></tr>
<tr><td class="h">12624</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $net_or_count;</td></tr>
<tr><td class="h">12625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12626</td><td colspan="7"></td></tr><tr><td class="h">12627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Exactly one network or aggregate matches or supernet exists.</td></tr>
<tr><td class="h">12628</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">12629</td><td colspan="7"></td></tr><tr><td class="h">12630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Add enclosing supernets.</td></tr>
<tr><td class="h">12631</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $up = $net_or_count;</td></tr>
<tr><td class="h">12632</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ($up) {</td></tr>
<tr><td class="h">12633</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $up;</td></tr>
<tr><td class="h">12634</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$up = $up-&gt;{up};</td></tr>
<tr><td class="h">12635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12636</td><td colspan="7"></td></tr><tr><td class="h">12637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;matching:&quot;, join(&#39;,&#39;, map { $_-&gt;{name} } @result);</td></tr>
<tr><td class="h">12638</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@result;</td></tr>
<tr><td class="h">12639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12640</td><td colspan="7"></td></tr><tr><td class="h">12641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Prevent multiple error messages about missing supernet rules;</td></tr>
<tr><td class="h">12642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %missing_supernet;</td></tr>
<tr><td class="h">12643</td><td colspan="7"></td></tr><tr><td class="h">12644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $rule: the rule to be checked</td></tr>
<tr><td class="h">12645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $where: has value &#39;src&#39; or &#39;dst&#39;</td></tr>
<tr><td class="h">12646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $interface: interface, where traffic reaches the device,</td></tr>
<tr><td class="h">12647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this is used to determine no_nat_set</td></tr>
<tr><td class="h">12648</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $zone: The zone to be checked.</td></tr>
<tr><td class="h">12649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If $where is &#39;src&#39;, then $zone is attached to $interface</td></tr>
<tr><td class="h">12650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If $where is &#39;dst&#39;, then $zone is at other side of device.</td></tr>
<tr><td class="h">12651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $reversed: (optional) the check is for reversed rule at stateless device</td></tr>
<tr><td class="h">12652</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_supernet_in_zone {</td></tr>
<tr><td class="h">12653</td><td><div class="c3">116</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12653">116</a></div></td><td><div class="c0">0</div></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $where, $interface, $zone, $reversed) = @_;</td></tr>
<tr><td class="h">12654</td><td colspan="7"></td></tr><tr><td class="h">12655</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($stateless, $deny, $src, $dst, $src_range, $prt) =</td></tr>
<tr><td class="h">12656</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$rule}{qw(stateless deny src dst src_range prt)};</td></tr>
<tr><td class="h">12657</td><td><div class="c3">116</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12657">50</a></div></td><td></td><td></td><td><div>304</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$stateless ||= &#39;&#39;;</td></tr>
<tr><td class="h">12658</td><td><div class="c3">116</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12658">33</a></div></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$src_range ||= $prt_ip;</td></tr>
<tr><td class="h">12659</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12659">100</a></div></td><td></td><td></td><td></td><td><div>167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $other = $where eq &#39;src&#39; ? $src : $dst;</td></tr>
<tr><td class="h">12660</td><td colspan="7"></td></tr><tr><td class="h">12661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Fast check for access to aggregate/supernet with identical</td></tr>
<tr><td class="h">12662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# ip/mask to $zone.</td></tr>
<tr><td class="h">12663</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12663">100</a></div></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($where eq &#39;dst&#39;) {</td></tr>
<tr><td class="h">12664</td><td colspan="7"></td></tr><tr><td class="h">12665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Get NAT address of supernet.</td></tr>
<tr><td class="h">12666</td><td><div class="c3">94</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12666">100</a></div></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$dst-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">12667</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">12668</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst = get_nat_network($dst, $no_nat_set);</td></tr>
<tr><td class="h">12669</td><td><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12669">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $dst-&gt;{hidden};</td></tr>
<tr><td class="h">12670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12671</td><td><div class="c3">94</div><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>80</div><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ipmask = join(&#39;/&#39;, @{$dst}{qw(ip mask)});</td></tr>
<tr><td class="h">12672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</td></tr>
<tr><td class="h">12673</td><td><div class="c3">94</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12673">100</a></div></td><td></td><td></td><td></td><td><div>465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $supernet_rule_tree{$stateless}-&gt;{$src}-&gt;{$src_range}-&gt;{$prt}</td></tr>
<tr><td class="h">12674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$interface}-&gt;{$ipmask}-&gt;{$zone};</td></tr>
<tr><td class="h">12675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12676</td><td colspan="7"></td></tr><tr><td class="h">12677</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $networks = find_matching_supernet($interface, $zone, $other);</td></tr>
<tr><td class="h">12678</td><td><div class="c3">98</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12678">100</a></div></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not $networks;</td></tr>
<tr><td class="h">12679</td><td><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $extra;</td></tr>
<tr><td class="h">12680</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12680">100</a></div></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (!ref($networks)) {</td></tr>
<tr><td class="h">12681</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$extra = &quot;No supernet available for $networks&quot;;</td></tr>
<tr><td class="h">12682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12684</td><td colspan="7"></td></tr><tr><td class="h">12685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $networks holds matching network and all its supernets.</td></tr>
<tr><td class="h">12686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find first matching rule.</td></tr>
<tr><td class="h">12687</td><td><div class="c3">54</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12687">50</a></div></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deny ||= &#39;&#39;;</td></tr>
<tr><td class="h">12688</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$networks) {</td></tr>
<tr><td class="h">12689</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12689">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($where eq &#39;src&#39; ? $src : $dst) = $network;</td></tr>
<tr><td class="h">12690</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12690">100</a></div></td><td></td><td></td><td></td><td><div>237</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($rule_tree{$stateless}-&gt;{$deny}-&gt;{$src_range}-&gt;{$src}-&gt;{$dst}</td></tr>
<tr><td class="h">12691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$prt})</td></tr>
<tr><td class="h">12692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12693</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12696</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>23</div><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$extra = &quot;Tried &quot; . join(&#39;, &#39;, map { $_-&gt;{name} } @$networks);</td></tr>
<tr><td class="h">12697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12698</td><td colspan="7"></td></tr><tr><td class="h">12699</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $service = $rule-&gt;{rule}-&gt;{service};</td></tr>
<tr><td class="h">12700</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12700">100</a></div></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $missing_supernet{$interface}-&gt;{$service};</td></tr>
<tr><td class="h">12701</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$missing_supernet{$interface}-&gt;{$service} = 1;</td></tr>
<tr><td class="h">12702</td><td colspan="7"></td></tr><tr><td class="h">12703</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$rule = print_rule $rule;</td></tr>
<tr><td class="h">12704</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12704">50</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$reversed = $reversed ? &#39;reversed &#39; : &#39;&#39;;</td></tr>
<tr><td class="h">12705</td><td><div class="c3">14</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12705">50</a></div></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print =</td></tr>
<tr><td class="h">12706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config-&gt;{check_supernet_rules} eq &#39;warn&#39; ? \&amp;warn_msg : \&amp;err_msg;</td></tr>
<tr><td class="h">12707</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;(</td></tr>
<tr><td class="h">12708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Missing rule for ${reversed}supernet rule.\n&quot;,</td></tr>
<tr><td class="h">12709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $rule\n&quot;,</td></tr>
<tr><td class="h">12710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; can&#39;t be effective at $interface-&gt;{name}.\n&quot;,</td></tr>
<tr><td class="h">12711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $extra as $where.&quot;</td></tr>
<tr><td class="h">12712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">12713</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12715</td><td colspan="7"></td></tr><tr><td class="h">12716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If such rule is defined</td></tr>
<tr><td class="h">12717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit supernet1 dst</td></tr>
<tr><td class="h">12718</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># and topology is like this:</td></tr>
<tr><td class="h">12720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># supernet1-R1-zone2-R2-zone3-R3-dst</td></tr>
<tr><td class="h">12722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone4-/</td></tr>
<tr><td class="h">12723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># additional rules need to be defined as well:</td></tr>
<tr><td class="h">12725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit supernet(zone2) dst</td></tr>
<tr><td class="h">12726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit supernet(zone3) dst</td></tr>
<tr><td class="h">12727</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If R2 is stateless, we need one more rule to be defined:</td></tr>
<tr><td class="h">12729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit supernet(zone4) dst</td></tr>
<tr><td class="h">12730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This is so, because at R2 we would get an automatically generated</td></tr>
<tr><td class="h">12731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># reverse rule</td></tr>
<tr><td class="h">12732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit dst supernet1</td></tr>
<tr><td class="h">12733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># which would accidentally permit traffic to supernet:[zone4] as well.</td></tr>
<tr><td class="h">12734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_supernet_src_rule {</td></tr>
<tr><td class="h">12735</td><td colspan="7"></td></tr><tr><td class="h">12736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Function is called from path_walk.</td></tr>
<tr><td class="h">12737</td><td><div class="c3">146</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12737">146</a></div></td><td><div class="c0">0</div></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">12738</td><td colspan="7"></td></tr><tr><td class="h">12739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Destination is interface of current router and therefore there is</td></tr>
<tr><td class="h">12740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# nothing to be checked.</td></tr>
<tr><td class="h">12741</td><td><div class="c3">146</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12741">100</a></div></td><td></td><td></td><td></td><td><div>235</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $out_intf;</td></tr>
<tr><td class="h">12742</td><td colspan="7"></td></tr><tr><td class="h">12743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore semi_managed router.</td></tr>
<tr><td class="h">12744</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_intf-&gt;{router};</td></tr>
<tr><td class="h">12745</td><td><div class="c3">108</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12745">100</a></div></td><td></td><td></td><td></td><td><div>212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $router-&gt;{managed} or return;</td></tr>
<tr><td class="h">12746</td><td colspan="7"></td></tr><tr><td class="h">12747</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $out_zone = $out_intf-&gt;{zone};</td></tr>
<tr><td class="h">12748</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{src};</td></tr>
<tr><td class="h">12749</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{dst};</td></tr>
<tr><td class="h">12750</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst_zone = get_zone($dst);</td></tr>
<tr><td class="h">12751</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12751">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12751">67</a></div></td><td></td><td></td><td><div>248</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($dst-&gt;{has_other_subnet} &amp;&amp; $out_zone eq $dst_zone) {</td></tr>
<tr><td class="h">12752</td><td colspan="7"></td></tr><tr><td class="h">12753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Both src and dst are supernets and are directly connected</td></tr>
<tr><td class="h">12754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# at current router. Hence there can&#39;t be any missing rules.</td></tr>
<tr><td class="h">12755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Note: Additional checks will be done for this situation at</td></tr>
<tr><td class="h">12756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# check_supernet_dst_rule</td></tr>
<tr><td class="h">12757</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12759</td><td colspan="7"></td></tr><tr><td class="h">12760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Non matching rule will be ignored at &#39;managed=local&#39; router and</td></tr>
<tr><td class="h">12761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# hence must no be checked.</td></tr>
<tr><td class="h">12762</td><td><div class="c3">84</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12762">100</a></div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $mark = $router-&gt;{local_mark}) {</td></tr>
<tr><td class="h">12763</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_net = $src;&nbsp;&nbsp;&nbsp;&nbsp;# $src is known to be aggregate or supernet.</td></tr>
<tr><td class="h">12764</td><td><div class="c3">12</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12764">33</a></div></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $dst-&gt;{network} || $dst;</td></tr>
<tr><td class="h">12765</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12765">100</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_filter_at = $src_net-&gt;{filter_at} or return;</td></tr>
<tr><td class="h">12766</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12766">100</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_filter_at = $dst_net-&gt;{filter_at} or return;</td></tr>
<tr><td class="h">12767</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12767">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12767">33</a></div></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_filter_at-&gt;{$mark} and $dst_filter_at-&gt;{$mark} or return;</td></tr>
<tr><td class="h">12768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12769</td><td colspan="7"></td></tr><tr><td class="h">12770</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $in_zone = $in_intf-&gt;{zone};</td></tr>
<tr><td class="h">12771</td><td colspan="7"></td></tr><tr><td class="h">12772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check case II, outgoing ACL, (A)</td></tr>
<tr><td class="h">12773</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_acl_intf;</td></tr>
<tr><td class="h">12774</td><td><div class="c3">80</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12774">50</a></div></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($no_acl_intf = $router-&gt;{no_in_acl}) {</td></tr>
<tr><td class="h">12775</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_acl_zone = $no_acl_intf-&gt;{zone};</td></tr>
<tr><td class="h">12776</td><td colspan="7"></td></tr><tr><td class="h">12777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a) dst behind Y</td></tr>
<tr><td class="h">12778</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12778">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12778">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12778">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_acl_zone eq $dst_zone) {</td></tr>
<tr><td class="h">12779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12780</td><td colspan="7"></td></tr><tr><td class="h">12781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# b), 1. zone X == zone Y</td></tr>
<tr><td class="h">12782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($in_zone eq $no_acl_zone) {</td></tr>
<tr><td class="h">12783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12784</td><td colspan="7"></td></tr><tr><td class="h">12785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($no_acl_intf-&gt;{main_interface}) {</td></tr>
<tr><td class="h">12786</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12787</td><td colspan="7"></td></tr><tr><td class="h">12788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# b), 2. zone X != zone Y</td></tr>
<tr><td class="h">12789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12790</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_in_zone($rule, &#39;src&#39;, $no_acl_intf, $no_acl_zone);</td></tr>
<tr><td class="h">12791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12793</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src_zone = $src-&gt;{zone};</td></tr>
<tr><td class="h">12794</td><td colspan="7"></td></tr><tr><td class="h">12795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check if reverse rule would be created and would need additional rules.</td></tr>
<tr><td class="h">12796</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12796">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12796">67</a></div></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{model}-&gt;{stateless} &amp;&amp; !$rule-&gt;{oneway})</td></tr>
<tr><td class="h">12797</td><td colspan="7"></td></tr><tr><td class="h">12798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12799</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $rule-&gt;{prt}-&gt;{proto};</td></tr>
<tr><td class="h">12800</td><td colspan="7"></td></tr><tr><td class="h">12801</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reverse rule wouldn&#39;t allow too much traffic, if a non</td></tr>
<tr><td class="h">12802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# secondary stateful device filters between current device and dst.</td></tr>
<tr><td class="h">12803</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is true if $out_zone and $dst_zone have different</td></tr>
<tr><td class="h">12804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# {stateful_mark}.</td></tr>
<tr><td class="h">12805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If dst is managed interface, {stateful_mark} is undef</td></tr>
<tr><td class="h">12806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - if device is secondary managed, take mark of attached network</td></tr>
<tr><td class="h">12807</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - else take value -1, different from all marks.</td></tr>
<tr><td class="h">12808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $src is supernet (not an interface) by definition</td></tr>
<tr><td class="h">12809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# and hence $m1 is well defined.</td></tr>
<tr><td class="h">12810</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $m1 = $out_zone-&gt;{stateful_mark};</td></tr>
<tr><td class="h">12811</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $m2 = $dst_zone-&gt;{stateful_mark};</td></tr>
<tr><td class="h">12812</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12812">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$m2) {</td></tr>
<tr><td class="h">12813</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $dst-&gt;{router}-&gt;{managed};</td></tr>
<tr><td class="h">12814</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12814">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$m2 =</td></tr>
<tr><td class="h">12815</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$managed =~ /^(?:secondary|local.*)$/</td></tr>
<tr><td class="h">12816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $dst-&gt;{network}-&gt;{zone}-&gt;{stateful_mark}</td></tr>
<tr><td class="h">12817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: -1;</td></tr>
<tr><td class="h">12818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12819</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12819">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12819">40</a></div></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($proto eq &#39;tcp&#39; || $proto eq &#39;udp&#39; || $proto eq &#39;ip&#39;)</td></tr>
<tr><td class="h">12820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $m1 == $m2)</td></tr>
<tr><td class="h">12821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12822</td><td colspan="7"></td></tr><tr><td class="h">12823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check case II, outgoing ACL, (B), interface Y without ACL.</td></tr>
<tr><td class="h">12824</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12824">50</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $no_acl_intf = $router-&gt;{no_in_acl}) {</td></tr>
<tr><td class="h">12825</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_acl_zone = $no_acl_intf-&gt;{zone};</td></tr>
<tr><td class="h">12826</td><td colspan="7"></td></tr><tr><td class="h">12827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a) dst behind Y</td></tr>
<tr><td class="h">12828</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12828">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12828">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12828">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_acl_zone eq $dst_zone) {</td></tr>
<tr><td class="h">12829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12830</td><td colspan="7"></td></tr><tr><td class="h">12831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# b) dst not behind Y</td></tr>
<tr><td class="h">12832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# zone X == zone Y</td></tr>
<tr><td class="h">12833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($no_acl_zone eq $src_zone) {</td></tr>
<tr><td class="h">12834</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12835</td><td colspan="7"></td></tr><tr><td class="h">12836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($no_acl_intf-&gt;{main_interface}) {</td></tr>
<tr><td class="h">12837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12838</td><td colspan="7"></td></tr><tr><td class="h">12839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# zone X != zone Y</td></tr>
<tr><td class="h">12840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12841</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_in_zone($rule, &#39;src&#39;, $no_acl_intf,</td></tr>
<tr><td class="h">12842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_acl_zone, 1);</td></tr>
<tr><td class="h">12843</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12844</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12845</td><td colspan="7"></td></tr><tr><td class="h">12846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Standard incoming ACL at all interfaces.</td></tr>
<tr><td class="h">12847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12848</td><td colspan="7"></td></tr><tr><td class="h">12849</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find security zones at all interfaces except the in_intf.</td></tr>
<tr><td class="h">12850</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">12851</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12851">100</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf eq $in_intf;</td></tr>
<tr><td class="h">12852</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12852">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12852">33</a></div></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf-&gt;{loopback} &amp;&amp; !$intf-&gt;{vip};</td></tr>
<tr><td class="h">12853</td><td colspan="7"></td></tr><tr><td class="h">12854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Nothing to be checked for an interface directly</td></tr>
<tr><td class="h">12855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# connected to src or dst.</td></tr>
<tr><td class="h">12856</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $intf-&gt;{zone};</td></tr>
<tr><td class="h">12857</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12857">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone eq $src_zone;</td></tr>
<tr><td class="h">12858</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12858">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone eq $dst_zone;</td></tr>
<tr><td class="h">12859</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12859">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf-&gt;{main_interface};</td></tr>
<tr><td class="h">12860</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_in_zone($rule, &#39;src&#39;, $intf, $zone, 1);</td></tr>
<tr><td class="h">12861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12865</td><td colspan="7"></td></tr><tr><td class="h">12866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Nothing to do at first router.</td></tr>
<tr><td class="h">12867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# zone2 is checked at R2, because we need the no_nat_set at R2.</td></tr>
<tr><td class="h">12868</td><td><div class="c3">80</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12868">100</a></div></td><td></td><td></td><td></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $src_zone eq $in_zone;</td></tr>
<tr><td class="h">12869</td><td colspan="7"></td></tr><tr><td class="h">12870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check if rule &quot;supernet2 -&gt; dst&quot; is defined.</td></tr>
<tr><td class="h">12871</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_in_zone($rule, &#39;src&#39;, $in_intf, $in_zone);</td></tr>
<tr><td class="h">12872</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12874</td><td colspan="7"></td></tr><tr><td class="h">12875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If such rule is defined</td></tr>
<tr><td class="h">12876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit src supernet5</td></tr>
<tr><td class="h">12877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># and topology is like this:</td></tr>
<tr><td class="h">12879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/-zone4</td></tr>
<tr><td class="h">12881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># src-R1-zone2-R2-zone3-R3-zone5</td></tr>
<tr><td class="h">12882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\-zone1</td></tr>
<tr><td class="h">12883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">12884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># additional rules need to be defined as well:</td></tr>
<tr><td class="h">12885</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit src supernet1</td></tr>
<tr><td class="h">12886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit src supernet2</td></tr>
<tr><td class="h">12887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit src supernet3</td></tr>
<tr><td class="h">12888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;permit src supernet4</td></tr>
<tr><td class="h">12889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_supernet_dst_rule {</td></tr>
<tr><td class="h">12890</td><td colspan="7"></td></tr><tr><td class="h">12891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Function is called from path_walk.</td></tr>
<tr><td class="h">12892</td><td><div class="c3">136</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12892">136</a></div></td><td><div class="c0">0</div></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">12893</td><td colspan="7"></td></tr><tr><td class="h">12894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Source is interface of current router.</td></tr>
<tr><td class="h">12895</td><td><div class="c3">136</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12895">100</a></div></td><td></td><td></td><td></td><td><div>207</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $in_intf;</td></tr>
<tr><td class="h">12896</td><td colspan="7"></td></tr><tr><td class="h">12897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ignore semi_managed router.</td></tr>
<tr><td class="h">12898</td><td><div class="c3">134</div></td><td></td><td></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_intf-&gt;{router};</td></tr>
<tr><td class="h">12899</td><td><div class="c3">134</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12899">50</a></div></td><td></td><td></td><td></td><td><div>210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not $router-&gt;{managed};</td></tr>
<tr><td class="h">12900</td><td colspan="7"></td></tr><tr><td class="h">12901</td><td><div class="c3">134</div></td><td></td><td></td><td></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src = $rule-&gt;{src};</td></tr>
<tr><td class="h">12902</td><td><div class="c3">134</div></td><td></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst = $rule-&gt;{dst};</td></tr>
<tr><td class="h">12903</td><td colspan="7"></td></tr><tr><td class="h">12904</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Non matching rule will be ignored at &#39;managed=local&#39; router and</td></tr>
<tr><td class="h">12905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# hence must not be checked.</td></tr>
<tr><td class="h">12906</td><td><div class="c3">134</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12906">100</a></div></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $mark = $router-&gt;{local_mark}) {</td></tr>
<tr><td class="h">12907</td><td><div class="c3">6</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12907">33</a></div></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_net = $src-&gt;{network} || $src;</td></tr>
<tr><td class="h">12908</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_net = $dst;&nbsp;&nbsp;&nbsp;&nbsp;# $dst is known to be aggregate or supernet.</td></tr>
<tr><td class="h">12909</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12909">50</a></div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_filter_at = $src_net-&gt;{filter_at} or return;</td></tr>
<tr><td class="h">12910</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12910">100</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_filter_at = $dst_net-&gt;{filter_at} or return;</td></tr>
<tr><td class="h">12911</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12911">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12911">33</a></div></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_filter_at-&gt;{$mark} and $dst_filter_at-&gt;{$mark} or return;</td></tr>
<tr><td class="h">12912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12913</td><td colspan="7"></td></tr><tr><td class="h">12914</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src_zone = get_zone($src);</td></tr>
<tr><td class="h">12915</td><td><div class="c3">132</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst_zone = $dst-&gt;{zone};</td></tr>
<tr><td class="h">12916</td><td colspan="7"></td></tr><tr><td class="h">12917</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check case II, outgoing ACL, (B), interface Y without ACL.</td></tr>
<tr><td class="h">12918</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12918">100</a></div></td><td></td><td></td><td></td><td><div>229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $no_acl_intf = $router-&gt;{no_in_acl}) {</td></tr>
<tr><td class="h">12919</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_acl_zone = $no_acl_intf-&gt;{zone};</td></tr>
<tr><td class="h">12920</td><td colspan="7"></td></tr><tr><td class="h">12921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a) src behind Y</td></tr>
<tr><td class="h">12922</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12922">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12922">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12922">50</a></div></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_acl_zone eq $src_zone) {</td></tr>
<tr><td class="h">12923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12924</td><td colspan="7"></td></tr><tr><td class="h">12925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# b) src not behind Y</td></tr>
<tr><td class="h">12926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# zone X == zone Y</td></tr>
<tr><td class="h">12927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($no_acl_zone eq $dst_zone) {</td></tr>
<tr><td class="h">12928</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12929</td><td colspan="7"></td></tr><tr><td class="h">12930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($no_acl_intf-&gt;{main_interface}) {</td></tr>
<tr><td class="h">12931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12932</td><td colspan="7"></td></tr><tr><td class="h">12933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# zone X != zone Y</td></tr>
<tr><td class="h">12934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">12935</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_in_zone($rule, &#39;dst&#39;, $in_intf, $no_acl_zone);</td></tr>
<tr><td class="h">12936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12937</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12939</td><td colspan="7"></td></tr><tr><td class="h">12940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check security zones at all interfaces except those connected to dst or src.</td></tr>
<tr><td class="h">12941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# For devices which have rules for each pair of incoming and outgoing</td></tr>
<tr><td class="h">12942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# interfaces we only need to check the direct path to dst.</td></tr>
<tr><td class="h">12943</td><td><div class="c3">118</div><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12943">100</a></div></td><td></td><td></td><td></td><td><div>201</div><div>151</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $intf (</td></tr>
<tr><td class="h">12944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{model}-&gt;{has_io_acl}</td></tr>
<tr><td class="h">12945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? ($out_intf)</td></tr>
<tr><td class="h">12946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: @{ $router-&gt;{interfaces} }</td></tr>
<tr><td class="h">12947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">12948</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12949</td><td colspan="7"></td></tr><tr><td class="h">12950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check each intermediate zone only once at outgoing interface.</td></tr>
<tr><td class="h">12951</td><td><div class="c3">316</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12951">100</a></div></td><td></td><td></td><td></td><td><div>614</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf eq $in_intf;</td></tr>
<tr><td class="h">12952</td><td><div class="c3">210</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12952">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L12952">100</a></div></td><td></td><td></td><td><div>469</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf-&gt;{loopback} &amp;&amp; !$intf-&gt;{vip};</td></tr>
<tr><td class="h">12953</td><td colspan="7"></td></tr><tr><td class="h">12954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t check interface where src or dst is attached.</td></tr>
<tr><td class="h">12955</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>163</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $intf-&gt;{zone};</td></tr>
<tr><td class="h">12956</td><td><div class="c3">178</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12956">100</a></div></td><td></td><td></td><td></td><td><div>307</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone eq $src_zone;</td></tr>
<tr><td class="h">12957</td><td><div class="c3">176</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12957">100</a></div></td><td></td><td></td><td></td><td><div>363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $zone eq $dst_zone;</td></tr>
<tr><td class="h">12958</td><td><div class="c3">89</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12958">50</a></div></td><td></td><td></td><td></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $intf-&gt;{main_interface};</td></tr>
<tr><td class="h">12959</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_in_zone($rule, &#39;dst&#39;, $in_intf, $zone);</td></tr>
<tr><td class="h">12960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12961</td><td><div class="c3">118</div></td><td></td><td></td><td></td><td></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">12963</td><td colspan="7"></td></tr><tr><td class="h">12964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Optimization:</td></tr>
<tr><td class="h">12965</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Call check_supernet_dst_rule not for every rule with aggregate as destination,</td></tr>
<tr><td class="h">12966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># but only once for a set of rules from collect_supernet_dst_rules.</td></tr>
<tr><td class="h">12967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_supernet_dst_collections {</td></tr>
<tr><td class="h">12968</td><td><div class="c3">486</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L12968">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L12968">486</a></div></td><td><div class="c0">0</div></td><td><div>937</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !keys %supernet_rule_tree;</td></tr>
<tr><td class="h">12969</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @check_rules;</td></tr>
<tr><td class="h">12970</td><td colspan="7"></td></tr><tr><td class="h">12971</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $src2href (values %supernet_rule_tree) {</td></tr>
<tr><td class="h">12972</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src_range2href (values %$src2href) {</td></tr>
<tr><td class="h">12973</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $prt2href (values %$src_range2href) {</td></tr>
<tr><td class="h">12974</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $intf2href (values %$prt2href) {</td></tr>
<tr><td class="h">12975</td><td><div class="c3">80</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ipmask2href (values %$intf2href) {</td></tr>
<tr><td class="h">12976</td><td colspan="7"></td></tr><tr><td class="h">12977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check larger aggregates first. To get</td></tr>
<tr><td class="h">12978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# deterministic error messages.</td></tr>
<tr><td class="h">12979</td><td><div class="c3">92</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>167</div><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ipmask (</td></tr>
<tr><td class="h">12980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort { (split &#39;/&#39;, $a)[1] &lt;=&gt; (split &#39;/&#39;, $b)[1] }</td></tr>
<tr><td class="h">12981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys %$ipmask2href</td></tr>
<tr><td class="h">12982</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">12983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">12984</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone2rule = $ipmask2href-&gt;{$ipmask};</td></tr>
<tr><td class="h">12985</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>434</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @check_rules, (values %$zone2rule)[0];</td></tr>
<tr><td class="h">12986</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12988</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12992</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@check_rules) {</td></tr>
<tr><td class="h">12993</td><td><div class="c3">98</div></td><td></td><td></td><td></td><td></td><td><div>167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single_path_walk($rule, \&amp;check_supernet_dst_rule);</td></tr>
<tr><td class="h">12994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">12995</td><td colspan="7"></td></tr><tr><td class="h">12996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Not used any longer.</td></tr>
<tr><td class="h">12997</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>225</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%supernet_rule_tree = ();</td></tr>
<tr><td class="h">12998</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">12999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13000</td><td colspan="7"></td></tr><tr><td class="h">13001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Find smaller protocol of two protocols.</td></tr>
<tr><td class="h">13002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Cache results.</td></tr>
<tr><td class="h">13003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %smaller_prt;</td></tr>
<tr><td class="h">13004</td><td colspan="7"></td></tr><tr><td class="h">13005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_smaller_prt {</td></tr>
<tr><td class="h">13006</td><td><div class="c3">22</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13006">22</a></div></td><td><div class="c0">0</div></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt1, $prt2) = @_;</td></tr>
<tr><td class="h">13007</td><td colspan="7"></td></tr><tr><td class="h">13008</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13008">100</a></div></td><td></td><td></td><td></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($prt1 eq $prt2) {</td></tr>
<tr><td class="h">13009</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $prt1;</td></tr>
<tr><td class="h">13010</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13011</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13011">50</a></div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $prt = $smaller_prt{$prt1}-&gt;{$prt2})) {</td></tr>
<tr><td class="h">13012</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $prt;</td></tr>
<tr><td class="h">13013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13014</td><td colspan="7"></td></tr><tr><td class="h">13015</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prt = $prt1;</td></tr>
<tr><td class="h">13016</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ($prt = $prt-&gt;{up}) {</td></tr>
<tr><td class="h">13017</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13017">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($prt eq $prt2) {</td></tr>
<tr><td class="h">13018</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt{$prt1}-&gt;{$prt2} = $prt1;</td></tr>
<tr><td class="h">13019</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt{$prt2}-&gt;{$prt1} = $prt1;</td></tr>
<tr><td class="h">13020</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $prt1;</td></tr>
<tr><td class="h">13021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13023</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt = $prt2;</td></tr>
<tr><td class="h">13024</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ($prt = $prt-&gt;{up}) {</td></tr>
<tr><td class="h">13025</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13025">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($prt eq $prt1) {</td></tr>
<tr><td class="h">13026</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt{$prt1}-&gt;{$prt2} = $prt2;</td></tr>
<tr><td class="h">13027</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt{$prt2}-&gt;{$prt1} = $prt2;</td></tr>
<tr><td class="h">13028</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $prt2;</td></tr>
<tr><td class="h">13029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13031</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt{$prt1}-&gt;{$prt2} = 0;</td></tr>
<tr><td class="h">13032</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt{$prt2}-&gt;{$prt1} = 0;</td></tr>
<tr><td class="h">13033</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13035</td><td colspan="7"></td></tr><tr><td class="h">13036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Example:</td></tr>
<tr><td class="h">13037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># XX--R1--any:A--R2--R3--R4--YY</td></tr>
<tr><td class="h">13038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If we have rules</td></tr>
<tr><td class="h">13040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;permit XX any:A</td></tr>
<tr><td class="h">13041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;permit any:B YY</td></tr>
<tr><td class="h">13042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># and</td></tr>
<tr><td class="h">13043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;the intersection I of A and B isn&#39;t empty</td></tr>
<tr><td class="h">13044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># and</td></tr>
<tr><td class="h">13045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;XX and YY are subnet of I</td></tr>
<tr><td class="h">13046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># then this traffic is implicitly permitted</td></tr>
<tr><td class="h">13047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;permit XX YY</td></tr>
<tr><td class="h">13048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># which may be undesired.</td></tr>
<tr><td class="h">13049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># In order to avoid this, a warning is generated if the implied rule is not</td></tr>
<tr><td class="h">13050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># explicitly defined.</td></tr>
<tr><td class="h">13051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># ToDo:</td></tr>
<tr><td class="h">13053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Do we need to check for {zone_cluster} equality?</td></tr>
<tr><td class="h">13054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Currently we only check aggregates/supernets with mask = 0.</td></tr>
<tr><td class="h">13056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Checking of other aggregates is too complicate (NAT, intersection).</td></tr>
<tr><td class="h">13057</td><td colspan="7"></td></tr><tr><td class="h">13058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect info about unwanted implied rules.</td></tr>
<tr><td class="h">13059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_for_transient_supernet_rule {</td></tr>
<tr><td class="h">13060</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13060">486</a></div></td><td><div class="c0">0</div></td><td><div>456</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rules) = @_;</td></tr>
<tr><td class="h">13061</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %missing_rule_tree;</td></tr>
<tr><td class="h">13062</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>429</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $missing_count = 0;</td></tr>
<tr><td class="h">13063</td><td colspan="7"></td></tr><tr><td class="h">13064</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>608</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$rules) {</td></tr>
<tr><td class="h">13065</td><td><div class="c3">206</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13065">50</a></div></td><td></td><td></td><td></td><td><div>339</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{deleted};</td></tr>
<tr><td class="h">13066</td><td><div class="c3">206</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13066">50</a></div></td><td></td><td></td><td></td><td><div>310</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{deny};</td></tr>
<tr><td class="h">13067</td><td><div class="c3">206</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13067">50</a></div></td><td></td><td></td><td></td><td><div>307</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{no_check_supernet_rules};</td></tr>
<tr><td class="h">13068</td><td><div class="c3">206</div></td><td></td><td></td><td></td><td></td><td><div>202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst = $rule-&gt;{dst};</td></tr>
<tr><td class="h">13069</td><td><div class="c3">206</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13069">100</a></div></td><td></td><td></td><td></td><td><div>370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $dst-&gt;{has_other_subnet};</td></tr>
<tr><td class="h">13070</td><td colspan="7"></td></tr><tr><td class="h">13071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check only 0/0 aggregates.</td></tr>
<tr><td class="h">13072</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13072">100</a></div></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $dst-&gt;{mask} != 0;</td></tr>
<tr><td class="h">13073</td><td colspan="7"></td></tr><tr><td class="h">13074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# A leaf security zone has only one interface.</td></tr>
<tr><td class="h">13075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It can&#39;t lead to unwanted rule chains.</td></tr>
<tr><td class="h">13076</td><td><div class="c3">62</div><div class="c3">62</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13076">100</a></div></td><td></td><td></td><td></td><td><div>52</div><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if @{ $dst-&gt;{zone}-&gt;{interfaces} } &lt;= 1;</td></tr>
<tr><td class="h">13077</td><td colspan="7"></td></tr><tr><td class="h">13078</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($stateless1, $src1, $dst1, $src_range1, $prt1) =</td></tr>
<tr><td class="h">13079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$rule{qw(stateless src dst src_range prt)};</td></tr>
<tr><td class="h">13080</td><td><div class="c3">20</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13080">50</a></div></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$stateless1 ||= &#39;&#39;;</td></tr>
<tr><td class="h">13081</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deny = &#39;&#39;;</td></tr>
<tr><td class="h">13082</td><td><div class="c3">20</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13082">33</a></div></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_range1 ||= $prt_ip;</td></tr>
<tr><td class="h">13083</td><td colspan="7"></td></tr><tr><td class="h">13084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find all rules with supernet as source, which intersect with $dst1.</td></tr>
<tr><td class="h">13085</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src2 = $dst1;</td></tr>
<tr><td class="h">13086</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $stateless2 (1, &#39;&#39;) {</td></tr>
<tr><td class="h">13087</td><td><div class="c3">40</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13087">100</a></div></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $rule_tree{$stateless2} or next;</td></tr>
<tr><td class="h">13088</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13088">50</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hash = $hash-&gt;{$deny} or next;</td></tr>
<tr><td class="h">13089</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($src_range2_str, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13090</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range2 = $ref2prt{$src_range2_str};</td></tr>
<tr><td class="h">13091</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13091">50</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $smaller_src_range =</td></tr>
<tr><td class="h">13092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_smaller_prt($src_range1, $src_range2)</td></tr>
<tr><td class="h">13093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">13094</td><td colspan="7"></td></tr><tr><td class="h">13095</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13095">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hash = $hash-&gt;{$src2} or next;</td></tr>
<tr><td class="h">13096</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($dst2_str, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13097</td><td colspan="7"></td></tr><tr><td class="h">13098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip reverse rules.</td></tr>
<tr><td class="h">13099</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13099">100</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $src1 eq $dst2_str;</td></tr>
<tr><td class="h">13100</td><td colspan="7"></td></tr><tr><td class="h">13101</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst2 = $ref2obj{$dst2_str};</td></tr>
<tr><td class="h">13102</td><td colspan="7"></td></tr><tr><td class="h">13103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip rules with src and dst inside a single zone.</td></tr>
<tr><td class="h">13104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</td></tr>
<tr><td class="h">13105</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13105">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13105">33</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13105">33</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (($obj2zone{$src1} || get_zone $src1) eq</td></tr>
<tr><td class="h">13106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($obj2zone{$dst2} || get_zone $dst2));</td></tr>
<tr><td class="h">13107</td><td colspan="7"></td></tr><tr><td class="h">13108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RULE2:</td></tr>
<tr><td class="h">13109</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($prt2_str, $rule2) = each %$hash) {</td></tr>
<tr><td class="h">13110</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13110">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule2-&gt;{no_check_supernet_rules};</td></tr>
<tr><td class="h">13111</td><td colspan="7"></td></tr><tr><td class="h">13112</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt2 = $rule2-&gt;{prt};</td></tr>
<tr><td class="h">13113</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13113">33</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range2 = $rule2-&gt;{src_range} || $prt_ip;</td></tr>
<tr><td class="h">13114</td><td colspan="7"></td></tr><tr><td class="h">13115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find smaller protocol of two rules found.</td></tr>
<tr><td class="h">13116</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $smaller_prt = find_smaller_prt($prt1, $prt2);</td></tr>
<tr><td class="h">13117</td><td colspan="7"></td></tr><tr><td class="h">13118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If protocols are disjoint, we do not have</td></tr>
<tr><td class="h">13119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# transient-supernet-problem for $rule and $rule2.</td></tr>
<tr><td class="h">13120</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13120">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $smaller_prt;</td></tr>
<tr><td class="h">13121</td><td colspan="7"></td></tr><tr><td class="h">13122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Stateless rule &lt; stateful rule, hence use ||.</td></tr>
<tr><td class="h">13123</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13123">33</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $stateless = $stateless1 || $stateless2;</td></tr>
<tr><td class="h">13124</td><td colspan="7"></td></tr><tr><td class="h">13125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for a rule with $src1 and $dst2 and</td></tr>
<tr><td class="h">13126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with $smaller_prt.</td></tr>
<tr><td class="h">13127</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13128</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deny = &#39;&#39;;</td></tr>
<tr><td class="h">13129</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13129">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $rule_tree{$stateless}) {</td></tr>
<tr><td class="h">13130</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13131</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range = $smaller_src_range;</td></tr>
<tr><td class="h">13132</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13132">100</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $hash-&gt;{$deny}) {</td></tr>
<tr><td class="h">13133</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13134</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src = $src1;</td></tr>
<tr><td class="h">13135</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13135">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $hash-&gt;{$src_range})</td></tr>
<tr><td class="h">13136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13137</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13138</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst = $dst2;</td></tr>
<tr><td class="h">13139</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13139">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash =</td></tr>
<tr><td class="h">13140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hash-&gt;{$src})</td></tr>
<tr><td class="h">13141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13142</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13143</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt =</td></tr>
<tr><td class="h">13144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$smaller_prt;</td></tr>
<tr><td class="h">13145</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13145">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash =</td></tr>
<tr><td class="h">13146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hash-&gt;{$dst})</td></tr>
<tr><td class="h">13147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13148</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13149</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13149">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">13150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other_rule</td></tr>
<tr><td class="h">13151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $hash</td></tr>
<tr><td class="h">13152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$prt}</td></tr>
<tr><td class="h">13153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">13154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13155</td><td colspan="7"></td></tr><tr><td class="h">13156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(print_rule $r_rule);</td></tr>
<tr><td class="h">13157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</td></tr>
<tr><td class="h">13158</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RULE2;</td></tr>
<tr><td class="h">13159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt =</td></tr>
<tr><td class="h">13161</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13161">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt-&gt;{up}</td></tr>
<tr><td class="h">13162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or last;</td></tr>
<tr><td class="h">13163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13165</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13165">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst = $dst-&gt;{up}</td></tr>
<tr><td class="h">13166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or last;</td></tr>
<tr><td class="h">13167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13169</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13169">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src = $src-&gt;{up} or last;</td></tr>
<tr><td class="h">13170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13172</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13172">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_range = $src_range-&gt;{up}</td></tr>
<tr><td class="h">13173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or last;</td></tr>
<tr><td class="h">13174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13176</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13176">100</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if $deny;</td></tr>
<tr><td class="h">13177</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deny = 1;</td></tr>
<tr><td class="h">13178</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13180</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13180">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if !$stateless;</td></tr>
<tr><td class="h">13181</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$stateless = &#39;&#39;;</td></tr>
<tr><td class="h">13182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13183</td><td colspan="7"></td></tr><tr><td class="h">13184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Src: &quot;, print_rule $rule);</td></tr>
<tr><td class="h">13185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Dst: &quot;, print_rule $rule2);</td></tr>
<tr><td class="h">13186</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_service = $rule-&gt;{rule}-&gt;{service}-&gt;{name};</td></tr>
<tr><td class="h">13187</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_service = $rule2-&gt;{rule}-&gt;{service}-&gt;{name};</td></tr>
<tr><td class="h">13188</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt_name&nbsp;&nbsp;&nbsp;&nbsp;= $smaller_prt-&gt;{name};</td></tr>
<tr><td class="h">13189</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_name =~ s/^.part_/[part]/;</td></tr>
<tr><td class="h">13190</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13190">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($smaller_src_range ne $prt_ip) {</td></tr>
<tr><td class="h">13191</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($p1, $p2) = @{ $smaller_src_range-&gt;{range} };</td></tr>
<tr><td class="h">13192</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt_name = &quot;[src:$p1-$p2]$prt_name&quot;;</td></tr>
<tr><td class="h">13193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13194</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new =</td></tr>
<tr><td class="h">13195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not $missing_rule_tree{$src_service}-&gt;{$dst_service}</td></tr>
<tr><td class="h">13196</td><td colspan="7"></td></tr><tr><td class="h">13197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The matching supernet object.</td></tr>
<tr><td class="h">13198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{ $dst1-&gt;{name} }</td></tr>
<tr><td class="h">13199</td><td colspan="7"></td></tr><tr><td class="h">13200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The missing rule</td></tr>
<tr><td class="h">13201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{ $src1-&gt;{name} }-&gt;{ $dst2-&gt;{name} }-&gt;{$prt_name}++;</td></tr>
<tr><td class="h">13202</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13202">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$missing_count++ if $new;</td></tr>
<tr><td class="h">13203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13208</td><td colspan="7"></td></tr><tr><td class="h">13209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No longer needed; free some memory.</td></tr>
<tr><td class="h">13210</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>528</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%smaller_prt = ();</td></tr>
<tr><td class="h">13211</td><td colspan="7"></td></tr><tr><td class="h">13212</td><td><div class="c3">486</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13212">100</a></div></td><td></td><td></td><td></td><td><div>785</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($missing_count) {</td></tr>
<tr><td class="h">13213</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @msg = (&quot;Missing transient rules: $missing_count&quot;);</td></tr>
<tr><td class="h">13214</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($src_service, $hash) = each %missing_rule_tree) {</td></tr>
<tr><td class="h">13215</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($dst_service, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13216</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($supernet, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13217</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@msg, &quot;Rules of $src_service and $dst_service&quot; .</td></tr>
<tr><td class="h">13218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; match at $supernet&quot;);</td></tr>
<tr><td class="h">13219</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@msg, &quot;Missing transient rules:&quot;);</td></tr>
<tr><td class="h">13220</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($src, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13221</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($dst, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13222</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($prt, $hash) = each %$hash) {</td></tr>
<tr><td class="h">13223</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@msg, </td></tr>
<tr><td class="h">13224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; permit src=$src; dst=$dst; prt=$prt;&quot;);</td></tr>
<tr><td class="h">13225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13227</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13231</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13231">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $print =</td></tr>
<tr><td class="h">13232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config-&gt;{check_transient_supernet_rules} eq &#39;warn&#39;</td></tr>
<tr><td class="h">13233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? \&amp;warn_msg</td></tr>
<tr><td class="h">13234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \&amp;err_msg;</td></tr>
<tr><td class="h">13235</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print-&gt;(join &quot;\n&quot;, @msg);</td></tr>
<tr><td class="h">13236</td><td colspan="7"></td></tr><tr><td class="h">13237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13238</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>555</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13240</td><td colspan="7"></td></tr><tr><td class="h">13241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Handling of supernet rules created by gen_reverse_rules.</td></tr>
<tr><td class="h">13242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This is not needed if a stateful and not secondary packet filter is</td></tr>
<tr><td class="h">13243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># located on the path between src and dst.</td></tr>
<tr><td class="h">13244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 1. dst is supernet</td></tr>
<tr><td class="h">13246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># src--r1:stateful--dst1=supernet1--r2:stateless--dst2=supernet2</td></tr>
<tr><td class="h">13248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># gen_reverse_rule will create one additional rule</td></tr>
<tr><td class="h">13250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># supernet2--&gt;src, but not a rule supernet1--&gt;src, because r1 is stateful.</td></tr>
<tr><td class="h">13251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># check_supernet_src_rule would complain, that supernet1--&gt;src is missing.</td></tr>
<tr><td class="h">13252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># But that doesn&#39;t matter, because r1 would permit answer packets</td></tr>
<tr><td class="h">13253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># from supernet2 anyway, because it&#39;s stateful.</td></tr>
<tr><td class="h">13254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hence we can skip check_supernet_src_rule for this situation.</td></tr>
<tr><td class="h">13255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 2. src is supernet</td></tr>
<tr><td class="h">13257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># a) no stateful router on the path between stateless routers and dst.</td></tr>
<tr><td class="h">13259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone2---\</td></tr>
<tr><td class="h">13261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># src=supernet1--r1:stateless--dst</td></tr>
<tr><td class="h">13262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># gen_reverse_rules will create one additional rule dst--&gt;supernet1.</td></tr>
<tr><td class="h">13264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># check_supernet_dst_rule would complain about a missing rule</td></tr>
<tr><td class="h">13265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># dst--&gt;zone2.</td></tr>
<tr><td class="h">13266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># To prevent this situation, check_supernet_src_rule checks for a rule</td></tr>
<tr><td class="h">13267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># zone2 --&gt; dst</td></tr>
<tr><td class="h">13268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># b) at least one stateful router on the path between</td></tr>
<tr><td class="h">13270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;stateless router and dst.</td></tr>
<tr><td class="h">13271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone3---\</td></tr>
<tr><td class="h">13273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># src1=supernet1--r1:stateless--src2=supernet2--r2:stateful--dst</td></tr>
<tr><td class="h">13274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># gen_reverse_rules will create one additional rule</td></tr>
<tr><td class="h">13276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># dst--&gt;supernet1, but not dst--&gt;supernet2 because second router is stateful.</td></tr>
<tr><td class="h">13277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># check_supernet_dst_rule would complain about missing rules</td></tr>
<tr><td class="h">13278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># dst--&gt;supernet2 and dst--&gt;supernet3.</td></tr>
<tr><td class="h">13279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># But answer packets back from dst have been filtered by r2 already,</td></tr>
<tr><td class="h">13280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># hence it doesn&#39;t hurt if the rules at r1 are a bit too relaxed,</td></tr>
<tr><td class="h">13281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># i.e. r1 would permit dst to zone1 and zone3, but should only</td></tr>
<tr><td class="h">13282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># permit dst to zone1.</td></tr>
<tr><td class="h">13283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Hence we can skip check_supernet_dst_rule for this situation.</td></tr>
<tr><td class="h">13284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13285</td><td colspan="7"></td></tr><tr><td class="h">13286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark zones connected by stateless or secondary packet filters or by</td></tr>
<tr><td class="h">13287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># semi_managed devices.</td></tr>
<tr><td class="h">13288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_stateful {</td></tr>
<tr><td class="h">13289</td><td><div class="c3">1624</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13289">1624</a></div></td><td><div class="c0">0</div></td><td><div>1424</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $mark) = @_;</td></tr>
<tr><td class="h">13290</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1623</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{stateful_mark} = $mark;</td></tr>
<tr><td class="h">13291</td><td><div class="c3">1624</div><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1195</div><div>2029</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13292</td><td><div class="c3">2712</div></td><td></td><td></td><td></td><td></td><td><div>2325</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_interface-&gt;{router};</td></tr>
<tr><td class="h">13293</td><td><div class="c3">2712</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13293">100</a></div></td><td></td><td></td><td></td><td><div>3766</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed}) {</td></tr>
<tr><td class="h">13294</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</td></tr>
<tr><td class="h">13295</td><td><div class="c3">2630</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13295">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13295">67</a></div></td><td></td><td></td><td><div>8536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if !$router-&gt;{model}-&gt;{stateless}</td></tr>
<tr><td class="h">13296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; $router-&gt;{managed} !~ /^(?:secondary|local.*)$/;</td></tr>
<tr><td class="h">13297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13298</td><td><div class="c3">612</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13298">100</a></div></td><td></td><td></td><td></td><td><div>1135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{active_path};</td></tr>
<tr><td class="h">13299</td><td><div class="c3">300</div></td><td></td><td></td><td></td><td></td><td><div>408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $router-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">13300</td><td><div class="c3">300</div><div class="c3">300</div></td><td></td><td></td><td></td><td></td><td><div>253</div><div>400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13301</td><td><div class="c3">674</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13301">100</a></div></td><td></td><td></td><td></td><td><div>1515</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $in_interface;</td></tr>
<tr><td class="h">13302</td><td><div class="c3">374</div></td><td></td><td></td><td></td><td></td><td><div>339</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_zone = $out_interface-&gt;{zone};</td></tr>
<tr><td class="h">13303</td><td><div class="c3">374</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13303">100</a></div></td><td></td><td></td><td></td><td><div>618</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $next_zone-&gt;{stateful_mark};</td></tr>
<tr><td class="h">13304</td><td><div class="c3">298</div></td><td></td><td></td><td></td><td></td><td><div>526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_stateful($next_zone, $mark);</td></tr>
<tr><td class="h">13305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13307</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>2565</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13309</td><td colspan="7"></td></tr><tr><td class="h">13310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_supernet_rules {</td></tr>
<tr><td class="h">13311</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13311">486</a></div></td><td><div class="c0">0</div></td><td><div>414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @supernet_rules;</td></tr>
<tr><td class="h">13312</td><td><div class="c3">486</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13312">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13312">33</a></div></td><td></td><td></td><td><div>1111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$config-&gt;{check_supernet_rules}</td></tr>
<tr><td class="h">13313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $config-&gt;{check_transient_supernet_rules})</td></tr>
<tr><td class="h">13314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13315</td><td><div class="c3">1364</div><div class="c3">486</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13315">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13315">100</a></div></td><td></td><td></td><td><div>5533</div><div>757</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@supernet_rules = grep({ not $_-&gt;{deleted} and </td></tr>
<tr><td class="h">13316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($_-&gt;{src}-&gt;{has_other_subnet}</td></tr>
<tr><td class="h">13317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $_-&gt;{dst}-&gt;{has_other_subnet}) }</td></tr>
<tr><td class="h">13318</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>400</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $expanded_rules{permit} });</td></tr>
<tr><td class="h">13319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13320</td><td><div class="c3">486</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13320">50</a></div></td><td></td><td></td><td></td><td><div>869</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($config-&gt;{check_supernet_rules}) {</td></tr>
<tr><td class="h">13321</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>452</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $count = @supernet_rules;</td></tr>
<tr><td class="h">13322</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1312</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;progress(&quot;Checking $count rules with supernet objects&quot;);</td></tr>
<tr><td class="h">13323</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>444</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $stateful_mark = 1;</td></tr>
<tr><td class="h">13324</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>568</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">13325</td><td><div class="c3">1624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13325">100</a></div></td><td></td><td></td><td></td><td><div>2593</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $zone-&gt;{stateful_mark}) {</td></tr>
<tr><td class="h">13326</td><td><div class="c3">1326</div></td><td></td><td></td><td></td><td></td><td><div>1815</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_stateful($zone, $stateful_mark++);</td></tr>
<tr><td class="h">13327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13329</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@supernet_rules) {</td></tr>
<tr><td class="h">13330</td><td><div class="c3">206</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13330">50</a></div></td><td></td><td></td><td></td><td><div>351</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{deleted};</td></tr>
<tr><td class="h">13331</td><td><div class="c3">206</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13331">50</a></div></td><td></td><td></td><td></td><td><div>322</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{no_check_supernet_rules};</td></tr>
<tr><td class="h">13332</td><td><div class="c3">206</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13332">100</a></div></td><td></td><td></td><td></td><td><div>345</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($rule-&gt;{src}-&gt;{has_other_subnet}) {</td></tr>
<tr><td class="h">13333</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>186</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single_path_walk($rule, \&amp;check_supernet_src_rule);</td></tr>
<tr><td class="h">13334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13335</td><td><div class="c3">206</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13335">100</a></div></td><td></td><td></td><td></td><td><div>442</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($rule-&gt;{dst}-&gt;{has_other_subnet}) {</td></tr>
<tr><td class="h">13336</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single_path_walk($rule, \&amp;collect_supernet_dst_rules);</td></tr>
<tr><td class="h">13337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13339</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1059</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_supernet_dst_collections();</td></tr>
<tr><td class="h">13340</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>628</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%missing_supernet = ();</td></tr>
<tr><td class="h">13341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13342</td><td><div class="c3">486</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13342">50</a></div></td><td></td><td></td><td></td><td><div>843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($config-&gt;{check_transient_supernet_rules}) {</td></tr>
<tr><td class="h">13343</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>745</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_for_transient_supernet_rule(\@supernet_rules);</td></tr>
<tr><td class="h">13344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13345</td><td colspan="7"></td></tr><tr><td class="h">13346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No longer needed; free some memory.</td></tr>
<tr><td class="h">13347</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1396</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%rule_tree = ();</td></tr>
<tr><td class="h">13348</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>613</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%obj2zone = ();</td></tr>
<tr><td class="h">13349</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>463</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13351</td><td colspan="7"></td></tr><tr><td class="h">13352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Generate reverse rules for stateless packet filters:</td></tr>
<tr><td class="h">13354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># For each rule with protocol tcp, udp or ip we need a reverse rule</td></tr>
<tr><td class="h">13355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># with swapped src, dst and src-port, dst-port.</td></tr>
<tr><td class="h">13356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># For rules with a tcp protocol, the reverse rule gets a tcp protocol</td></tr>
<tr><td class="h">13357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># without range checking but with checking for &#39;established` flag.</td></tr>
<tr><td class="h">13358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13359</td><td colspan="7"></td></tr><tr><td class="h">13360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub gen_reverse_rules1 {</td></tr>
<tr><td class="h">13361</td><td><div class="c3">972</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13361">972</a></div></td><td><div class="c0">0</div></td><td><div>1147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule_aref) = @_;</td></tr>
<tr><td class="h">13362</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>715</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @extra_rules;</td></tr>
<tr><td class="h">13363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %cache;</td></tr>
<tr><td class="h">13364</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$rule_aref) {</td></tr>
<tr><td class="h">13365</td><td><div class="c3">1028</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13365">50</a></div></td><td></td><td></td><td></td><td><div>1697</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{oneway};</td></tr>
<tr><td class="h">13366</td><td><div class="c3">1028</div></td><td></td><td></td><td></td><td></td><td><div>945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deny = $rule-&gt;{deny};</td></tr>
<tr><td class="h">13367</td><td colspan="7"></td></tr><tr><td class="h">13368</td><td><div class="c3">1028</div></td><td></td><td></td><td></td><td></td><td><div>911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt_group = $rule-&gt;{prt};</td></tr>
<tr><td class="h">13369</td><td><div class="c3">1028</div></td><td></td><td></td><td></td><td></td><td><div>788</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @new_prt_group;</td></tr>
<tr><td class="h">13370</td><td><div class="c3">1028</div></td><td></td><td></td><td></td><td></td><td><div>1082</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (@$prt_group) {</td></tr>
<tr><td class="h">13371</td><td><div class="c3">1116</div></td><td></td><td></td><td></td><td></td><td><div>1168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $prt-&gt;{proto};</td></tr>
<tr><td class="h">13372</td><td><div class="c3">1116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13372">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13372">100</a></div></td><td></td><td></td><td><div>3031</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless $proto eq &#39;tcp&#39; or $proto eq &#39;udp&#39; or $proto eq &#39;ip&#39;;</td></tr>
<tr><td class="h">13373</td><td colspan="7"></td></tr><tr><td class="h">13374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No reverse rules will be generated for denied TCP packets, </td></tr>
<tr><td class="h">13375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because</td></tr>
<tr><td class="h">13376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - there can&#39;t be an answer if the request is already denied and</td></tr>
<tr><td class="h">13377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - the &#39;established&#39; optimization for TCP below would produce</td></tr>
<tr><td class="h">13378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;wrong results.</td></tr>
<tr><td class="h">13379</td><td><div class="c3">978</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13379">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13379">100</a></div></td><td></td><td></td><td><div>2713</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $proto eq &#39;tcp&#39; and $deny;</td></tr>
<tr><td class="h">13380</td><td><div class="c3">976</div></td><td></td><td></td><td></td><td></td><td><div>1503</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @new_prt_group, $prt;</td></tr>
<tr><td class="h">13381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13382</td><td><div class="c3">1028</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13382">100</a></div></td><td></td><td></td><td></td><td><div>1828</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@new_prt_group or next;</td></tr>
<tr><td class="h">13383</td><td colspan="7"></td></tr><tr><td class="h">13384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check path for existence of stateless router.</td></tr>
<tr><td class="h">13385</td><td><div class="c3">914</div></td><td></td><td></td><td></td><td></td><td><div>876</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $from_store&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{src_path};</td></tr>
<tr><td class="h">13386</td><td><div class="c3">914</div></td><td></td><td></td><td></td><td></td><td><div>826</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $to_store&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{dst_path};</td></tr>
<tr><td class="h">13387</td><td><div class="c3">914</div></td><td></td><td></td><td></td><td></td><td><div>1638</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_stateless_router = $cache{$from_store}-&gt;{$to_store};</td></tr>
<tr><td class="h">13388</td><td><div class="c3">914</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13388">100</a></div></td><td></td><td></td><td></td><td><div>1392</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!defined $has_stateless_router) {</td></tr>
<tr><td class="h">13389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PATH_WALK:</td></tr>
<tr><td class="h">13390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13391</td><td colspan="7"></td></tr><tr><td class="h">13392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Local function called by path_walk.</td></tr>
<tr><td class="h">13393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It uses free variable $has_stateless_router.</td></tr>
<tr><td class="h">13394</td><td><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>636</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mark_reverse_rule = sub {</td></tr>
<tr><td class="h">13395</td><td><div class="c3">1744</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13395">1744</a></div></td><td></td><td><div>1555</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">13396</td><td colspan="7"></td></tr><tr><td class="h">13397</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Destination of current rule is current router.</td></tr>
<tr><td class="h">13398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Outgoing packets from a router itself are never filtered.</td></tr>
<tr><td class="h">13399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Hence we don&#39;t need a reverse rule for current router.</td></tr>
<tr><td class="h">13400</td><td><div class="c3">1744</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13400">100</a></div></td><td></td><td></td><td></td><td><div>2482</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if not $out_intf;</td></tr>
<tr><td class="h">13401</td><td><div class="c3">1630</div></td><td></td><td></td><td></td><td></td><td><div>1477</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $out_intf-&gt;{router};</td></tr>
<tr><td class="h">13402</td><td colspan="7"></td></tr><tr><td class="h">13403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It doesn&#39;t matter if a semi_managed device is stateless</td></tr>
<tr><td class="h">13404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because no code is generated.</td></tr>
<tr><td class="h">13405</td><td><div class="c3">1630</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13405">100</a></div></td><td></td><td></td><td></td><td><div>2429</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if not $router-&gt;{managed};</td></tr>
<tr><td class="h">13406</td><td><div class="c3">1602</div></td><td></td><td></td><td></td><td></td><td><div>1447</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">13407</td><td colspan="7"></td></tr><tr><td class="h">13408</td><td><div class="c3">1602</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13408">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13408">75</a></div></td><td></td><td></td><td><div>4896</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">13409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$model-&gt;{stateless}</td></tr>
<tr><td class="h">13410</td><td colspan="7"></td></tr><tr><td class="h">13411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Source of current rule is current router.</td></tr>
<tr><td class="h">13412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or not $in_intf and $model-&gt;{stateless_self}</td></tr>
<tr><td class="h">13413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">13414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13415</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_stateless_router = 1;</td></tr>
<tr><td class="h">13416</td><td colspan="7"></td></tr><tr><td class="h">13417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Jump out of path_walk.</td></tr>
<tr><td class="h">13418</td><td><div class="c3">144</div><div class="c3">144</div><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13418">144</a></div></td><td></td><td><div>7317871</div><div>224</div><div>3752084</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no warnings &quot;exiting&quot;;&nbsp;&nbsp;&nbsp;&nbsp;## no critic (ProhibitNoWarn)</td></tr>
<tr><td class="h">13419</td><td><div class="c3">178</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13419">50</a></div></td><td></td><td></td><td></td><td><div>382</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last PATH_WALK if $use_nonlocal_exit;</td></tr>
<tr><td class="h">13420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13421</td><td><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>2274</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">13422</td><td colspan="7"></td></tr><tr><td class="h">13423</td><td><div class="c3">808</div></td><td></td><td></td><td></td><td></td><td><div>1152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path_walk($rule, $mark_reverse_rule);</td></tr>
<tr><td class="h">13424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13425</td><td><div class="c3">808</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13425">100</a></div></td><td></td><td></td><td><div>2902</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cache{$from_store}-&gt;{$to_store} = $has_stateless_router || 0;</td></tr>
<tr><td class="h">13426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13427</td><td><div class="c3">914</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13427">100</a></div></td><td></td><td></td><td></td><td><div>1956</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_stateless_router or next;</td></tr>
<tr><td class="h">13428</td><td colspan="7"></td></tr><tr><td class="h">13429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create reverse rule.</td></tr>
<tr><td class="h">13430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create new rule for different values of src_range.</td></tr>
<tr><td class="h">13431</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %key2prt_group;</td></tr>
<tr><td class="h">13432</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $index = 1;</td></tr>
<tr><td class="h">13433</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %src_range2index;</td></tr>
<tr><td class="h">13434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %index2src_range;</td></tr>
<tr><td class="h">13435</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tcp_seen;</td></tr>
<tr><td class="h">13436</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $prt (@new_prt_group) {</td></tr>
<tr><td class="h">13437</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $prt-&gt;{proto};</td></tr>
<tr><td class="h">13438</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_src_range = $prt_ip;</td></tr>
<tr><td class="h">13439</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_prt;</td></tr>
<tr><td class="h">13440</td><td><div class="c3">180</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13440">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13440">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13440">50</a></div></td><td></td><td></td><td></td><td><div>318</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($proto eq &#39;tcp&#39;) {</td></tr>
<tr><td class="h">13441</td><td colspan="7"></td></tr><tr><td class="h">13442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create tcp established only once.</td></tr>
<tr><td class="h">13443</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13443">100</a></div></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $tcp_seen;</td></tr>
<tr><td class="h">13444</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_prt = $range_tcp_established;</td></tr>
<tr><td class="h">13445</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp_seen = 1;</td></tr>
<tr><td class="h">13446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;udp&#39;) {</td></tr>
<tr><td class="h">13448</td><td colspan="7"></td></tr><tr><td class="h">13449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Swap src and dst range.</td></tr>
<tr><td class="h">13450</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_src_range = $prt;</td></tr>
<tr><td class="h">13451</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13451">100</a></div></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($new_src_range-&gt;{range} eq $aref_tcp_any) {</td></tr>
<tr><td class="h">13452</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_src_range = $prt_ip;</td></tr>
<tr><td class="h">13453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13454</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_prt = $rule-&gt;{src_range};</td></tr>
<tr><td class="h">13455</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13455">100</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $new_prt) {</td></tr>
<tr><td class="h">13456</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_prt = $prt_udp-&gt;{dst_range};</td></tr>
<tr><td class="h">13457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;ip&#39;) {</td></tr>
<tr><td class="h">13460</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_prt = $prt;</td></tr>
<tr><td class="h">13461</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">13463</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err();</td></tr>
<tr><td class="h">13464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13465</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>219</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$index2src_range{$index} = $new_src_range;</td></tr>
<tr><td class="h">13466</td><td><div class="c3">178</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13466">33</a></div></td><td></td><td></td><td><div>669</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = $src_range2index{$new_src_range} ||= $index++;</td></tr>
<tr><td class="h">13467</td><td><div class="c3">178</div><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>165</div><div>448</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $key2prt_group{$key} }, $new_prt;</td></tr>
<tr><td class="h">13468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13469</td><td colspan="7"></td></tr><tr><td class="h">13470</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>417</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort numerically keys %key2prt_group) {</td></tr>
<tr><td class="h">13471</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt_group = $key2prt_group{$key};</td></tr>
<tr><td class="h">13472</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range = $index2src_range{$key};</td></tr>
<tr><td class="h">13473</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>542</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_rule = {</td></tr>
<tr><td class="h">13474</td><td colspan="7"></td></tr><tr><td class="h">13475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This rule must only be applied to stateless routers.</td></tr>
<tr><td class="h">13476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateless =&gt; 1,</td></tr>
<tr><td class="h">13477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $rule-&gt;{dst},</td></tr>
<tr><td class="h">13478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $rule-&gt;{src},</td></tr>
<tr><td class="h">13479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_path&nbsp;&nbsp;=&gt; $rule-&gt;{dst_path},</td></tr>
<tr><td class="h">13480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_path&nbsp;&nbsp;=&gt; $rule-&gt;{src_path},</td></tr>
<tr><td class="h">13481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $prt_group,</td></tr>
<tr><td class="h">13482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">13483</td><td><div class="c3">178</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13483">100</a></div></td><td></td><td></td><td></td><td><div>395</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{src_range} = $src_range if $src_range ne $prt_ip;</td></tr>
<tr><td class="h">13484</td><td><div class="c3">178</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13484">50</a></div></td><td></td><td></td><td></td><td><div>258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{deny} = 1 if $deny;</td></tr>
<tr><td class="h">13485</td><td colspan="7"></td></tr><tr><td class="h">13486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t push to @$rule_aref while we are iterating over it.</td></tr>
<tr><td class="h">13487</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>638</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @extra_rules, $new_rule;</td></tr>
<tr><td class="h">13488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13490</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>987</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @$rule_aref, @extra_rules;</td></tr>
<tr><td class="h">13491</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1985</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13493</td><td colspan="7"></td></tr><tr><td class="h">13494</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub gen_reverse_rules {</td></tr>
<tr><td class="h">13495</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13495">486</a></div></td><td><div class="c0">0</div></td><td><div>854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Generating reverse rules for stateless routers&#39;);</td></tr>
<tr><td class="h">13496</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>591</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $type (&#39;deny&#39;, &#39;permit&#39;) {</td></tr>
<tr><td class="h">13497</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1781</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen_reverse_rules1($grouped_rules{$type});</td></tr>
<tr><td class="h">13498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13499</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>488</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13501</td><td colspan="7"></td></tr><tr><td class="h">13502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark rules for secondary filtering.</td></tr>
<tr><td class="h">13504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A rule is implemented at a device</td></tr>
<tr><td class="h">13505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># either as a &#39;typical&#39; or as a &#39;secondary&#39; filter.</td></tr>
<tr><td class="h">13506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A filter is called to be &#39;secondary&#39; if it only checks</td></tr>
<tr><td class="h">13507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># for the source and destination network and not for the protocol.</td></tr>
<tr><td class="h">13508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A typical filter checks for full source and destination IP and</td></tr>
<tr><td class="h">13509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># for the protocol of the rule.</td></tr>
<tr><td class="h">13510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">13511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># There are four types of packet filters: secondary, standard, full, primary.</td></tr>
<tr><td class="h">13512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A rule is marked by two attributes which are determined by the type of</td></tr>
<tr><td class="h">13513</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># devices located on the path from source to destination.</td></tr>
<tr><td class="h">13514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - &#39;some_primary&#39;: at least one device is primary packet filter,</td></tr>
<tr><td class="h">13515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - &#39;some_non_secondary&#39;: at least one device is not secondary packet filter.</td></tr>
<tr><td class="h">13516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># A rule is implemented as a secondary filter at a device if</td></tr>
<tr><td class="h">13517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - the device is secondary and the rule has attribute &#39;some_non_secondary&#39; or</td></tr>
<tr><td class="h">13518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - the device is standard and the rule has attribute &#39;some_primary&#39;.</td></tr>
<tr><td class="h">13519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Otherwise a rules is implemented typical.</td></tr>
<tr><td class="h">13520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13521</td><td colspan="7"></td></tr><tr><td class="h">13522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Identify the zone an object belongs to.</td></tr>
<tr><td class="h">13524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $obj - a network, subnet or interface object.</td></tr>
<tr><td class="h">13525</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns&nbsp;&nbsp;&nbsp;&nbsp;: The identified zone.</td></tr>
<tr><td class="h">13526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_zone2 {</td></tr>
<tr><td class="h">13527</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13527">0</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">13528</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">13529</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13529">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13529">0</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13529">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">13530</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $obj-&gt;{zone};</td></tr>
<tr><td class="h">13531</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39;) {</td></tr>
<tr><td class="h">13533</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">13534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">13536</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $obj-&gt;{network}-&gt;{zone};</td></tr>
<tr><td class="h">13537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13539</td><td colspan="7"></td></tr><tr><td class="h">13540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark security zone $zone with $mark and</td></tr>
<tr><td class="h">13541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># additionally mark all security zones</td></tr>
<tr><td class="h">13542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># which are connected with $zone by secondary packet filters.</td></tr>
<tr><td class="h">13543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_secondary;</td></tr>
<tr><td class="h">13544</td><td colspan="7"></td></tr><tr><td class="h">13545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_secondary {</td></tr>
<tr><td class="h">13546</td><td><div class="c3">1624</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13546">1624</a></div></td><td><div class="c0">0</div></td><td><div>1390</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $mark) = @_;</td></tr>
<tr><td class="h">13547</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1664</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{secondary_mark} = $mark;</td></tr>
<tr><td class="h">13548</td><td colspan="7"></td></tr><tr><td class="h">13549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$zone-&gt;{name} $mark&quot;);</td></tr>
<tr><td class="h">13550</td><td><div class="c3">1624</div><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1225</div><div>2006</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13551</td><td><div class="c3">2712</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13551">100</a></div></td><td></td><td></td><td></td><td><div>3899</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">13552</td><td><div class="c3">2628</div></td><td></td><td></td><td></td><td></td><td><div>2180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_interface-&gt;{router};</td></tr>
<tr><td class="h">13553</td><td><div class="c3">2628</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13553">100</a></div></td><td></td><td></td><td></td><td><div>3921</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed = $router-&gt;{managed}) {</td></tr>
<tr><td class="h">13554</td><td><div class="c3">2548</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13554">100</a></div></td><td></td><td></td><td></td><td><div>6425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $managed !~ /^(?:secondary|local.*)$/;</td></tr>
<tr><td class="h">13555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13556</td><td><div class="c3">304</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13556">100</a></div></td><td></td><td></td><td></td><td><div>576</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{secondary_mark};</td></tr>
<tr><td class="h">13557</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{secondary_mark} = $mark;</td></tr>
<tr><td class="h">13558</td><td><div class="c3">140</div><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>128</div><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13559</td><td><div class="c3">310</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13559">100</a></div></td><td></td><td></td><td></td><td><div>707</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $in_interface;</td></tr>
<tr><td class="h">13560</td><td><div class="c3">170</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13560">100</a></div></td><td></td><td></td><td></td><td><div>272</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">13561</td><td><div class="c3">164</div></td><td></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_zone = $out_interface-&gt;{zone};</td></tr>
<tr><td class="h">13562</td><td><div class="c3">164</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13562">100</a></div></td><td></td><td></td><td></td><td><div>267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $next_zone-&gt;{secondary_mark};</td></tr>
<tr><td class="h">13563</td><td><div class="c3">162</div></td><td></td><td></td><td></td><td></td><td><div>267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_secondary $next_zone, $mark;</td></tr>
<tr><td class="h">13564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13566</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1980</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13568</td><td colspan="7"></td></tr><tr><td class="h">13569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Mark security zone $zone with $mark and</td></tr>
<tr><td class="h">13570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># additionally mark all security zones</td></tr>
<tr><td class="h">13571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># which are connected with $zone by non-primary packet filters.</td></tr>
<tr><td class="h">13572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Test for {active_path} has been added to prevent deep recursion.</td></tr>
<tr><td class="h">13573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_primary;</td></tr>
<tr><td class="h">13574</td><td colspan="7"></td></tr><tr><td class="h">13575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_primary {</td></tr>
<tr><td class="h">13576</td><td><div class="c3">1624</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13576">1624</a></div></td><td><div class="c0">0</div></td><td><div>1393</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $mark) = @_;</td></tr>
<tr><td class="h">13577</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1573</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{primary_mark} = $mark;</td></tr>
<tr><td class="h">13578</td><td><div class="c3">1624</div><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1224</div><div>1945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13579</td><td><div class="c3">2712</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13579">100</a></div></td><td></td><td></td><td></td><td><div>3792</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">13580</td><td><div class="c3">2628</div></td><td></td><td></td><td></td><td></td><td><div>2190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_interface-&gt;{router};</td></tr>
<tr><td class="h">13581</td><td><div class="c3">2628</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13581">100</a></div></td><td></td><td></td><td></td><td><div>3862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed = $router-&gt;{managed}) {</td></tr>
<tr><td class="h">13582</td><td><div class="c3">2548</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13582">100</a></div></td><td></td><td></td><td></td><td><div>3551</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $managed eq &#39;primary&#39;;</td></tr>
<tr><td class="h">13583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13584</td><td><div class="c3">2620</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13584">100</a></div></td><td></td><td></td><td></td><td><div>4375</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{primary_mark};</td></tr>
<tr><td class="h">13585</td><td><div class="c3">1210</div></td><td></td><td></td><td></td><td></td><td><div>1135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{primary_mark} = $mark;</td></tr>
<tr><td class="h">13586</td><td><div class="c3">1210</div><div class="c3">1210</div></td><td></td><td></td><td></td><td></td><td><div>906</div><div>1422</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13587</td><td><div class="c3">2704</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13587">100</a></div></td><td></td><td></td><td></td><td><div>5410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $in_interface;</td></tr>
<tr><td class="h">13588</td><td><div class="c3">1494</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13588">100</a></div></td><td></td><td></td><td></td><td><div>2166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">13589</td><td><div class="c3">1410</div></td><td></td><td></td><td></td><td></td><td><div>1239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_zone = $out_interface-&gt;{zone};</td></tr>
<tr><td class="h">13590</td><td><div class="c3">1410</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13590">100</a></div></td><td></td><td></td><td></td><td><div>2301</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $next_zone-&gt;{primary_mark};</td></tr>
<tr><td class="h">13591</td><td><div class="c3">1110</div></td><td></td><td></td><td></td><td></td><td><div>1461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_primary $next_zone, $mark;</td></tr>
<tr><td class="h">13592</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13593</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13594</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>2439</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13596</td><td colspan="7"></td></tr><tr><td class="h">13597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Set &#39;local_secondary_mark&#39; for secondary optimization inside one cluster.</td></tr>
<tr><td class="h">13598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Two zones get the same mark if they are connected by local_secondary router.</td></tr>
<tr><td class="h">13599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_local_secondary;</td></tr>
<tr><td class="h">13600</td><td colspan="7"></td></tr><tr><td class="h">13601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_local_secondary {</td></tr>
<tr><td class="h">13602</td><td><div class="c3">1624</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13602">1624</a></div></td><td><div class="c0">0</div></td><td><div>1349</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone, $mark) = @_;</td></tr>
<tr><td class="h">13603</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1655</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{local_secondary_mark} = $mark;</td></tr>
<tr><td class="h">13604</td><td colspan="7"></td></tr><tr><td class="h">13605</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;local_secondary $zone-&gt;{name} : $mark&quot;;</td></tr>
<tr><td class="h">13606</td><td><div class="c3">1624</div><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1223</div><div>1980</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13607</td><td><div class="c3">2712</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13607">100</a></div></td><td></td><td></td><td></td><td><div>3762</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">13608</td><td><div class="c3">2628</div></td><td></td><td></td><td></td><td></td><td><div>2185</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $in_interface-&gt;{router};</td></tr>
<tr><td class="h">13609</td><td><div class="c3">2628</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13609">100</a></div></td><td></td><td></td><td></td><td><div>3818</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $managed = $router-&gt;{managed}) {</td></tr>
<tr><td class="h">13610</td><td><div class="c3">2548</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13610">100</a></div></td><td></td><td></td><td></td><td><div>4815</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $managed ne &#39;local_secondary&#39;;</td></tr>
<tr><td class="h">13611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13612</td><td><div class="c3">100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13612">100</a></div></td><td></td><td></td><td></td><td><div>202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{local_secondary_mark};</td></tr>
<tr><td class="h">13613</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{local_secondary_mark} = $mark;</td></tr>
<tr><td class="h">13614</td><td><div class="c3">46</div><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>44</div><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13615</td><td><div class="c3">102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13615">100</a></div></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface eq $in_interface;</td></tr>
<tr><td class="h">13616</td><td><div class="c3">56</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13616">100</a></div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">13617</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $next_zone = $out_interface-&gt;{zone};</td></tr>
<tr><td class="h">13618</td><td><div class="c3">54</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13618">50</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $next_zone-&gt;{local_secondary_mark};</td></tr>
<tr><td class="h">13619</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_local_secondary($next_zone, $mark);</td></tr>
<tr><td class="h">13620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13622</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>2246</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13623</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13624</td><td colspan="7"></td></tr><tr><td class="h">13625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_zones {</td></tr>
<tr><td class="h">13626</td><td><div class="c3">2408</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13626">2408</a></div></td><td><div class="c0">0</div></td><td><div>1963</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($path, $group) = @_;</td></tr>
<tr><td class="h">13627</td><td><div class="c3">2408</div></td><td></td><td></td><td></td><td></td><td><div>2218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $path;</td></tr>
<tr><td class="h">13628</td><td><div class="c3">2408</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13628">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13628">100</a></div></td><td></td><td></td><td></td><td><div>3093</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Zone&#39;) {</td></tr>
<tr><td class="h">13629</td><td><div class="c3">2034</div></td><td></td><td></td><td></td><td></td><td><div>2862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $path ];</td></tr>
<tr><td class="h">13630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">13632</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $path-&gt;{zone} ];</td></tr>
<tr><td class="h">13633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13634</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">13635</td><td><div class="c3">286</div><div class="c3">300</div></td><td></td><td></td><td></td><td></td><td><div>336</div><div>560</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ unique map { $_-&gt;{zone} } @$group ];</td></tr>
<tr><td class="h">13636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13638</td><td colspan="7"></td></tr><tr><td class="h">13639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub have_different_marks {</td></tr>
<tr><td class="h">13640</td><td><div class="c3">2434</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13640">2434</a></div></td><td><div class="c0">0</div></td><td><div>2213</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src_zones, $dst_zones, $mark) = @_;</td></tr>
<tr><td class="h">13641</td><td><div class="c3">2434</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13641">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13641">100</a></div></td><td></td><td></td><td><div>7268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (1 == @$src_zones and 1 == @$dst_zones) {</td></tr>
<tr><td class="h">13642</td><td><div class="c3">2410</div></td><td></td><td></td><td></td><td></td><td><div>7789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $src_zones-&gt;[0]-&gt;{$mark} ne $dst_zones-&gt;[0]-&gt;{$mark};</td></tr>
<tr><td class="h">13643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13644</td><td><div class="c3">24</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>28</div><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src_marks = [ map { $_-&gt;{$mark} } @$src_zones ];</td></tr>
<tr><td class="h">13645</td><td><div class="c3">24</div><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>27</div><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst_marks = [ map { $_-&gt;{$mark} } @$dst_zones ];</td></tr>
<tr><td class="h">13646</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return not intersect($src_marks, $dst_marks);&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">13647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13648</td><td colspan="7"></td></tr><tr><td class="h">13649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub have_set_and_equal_marks {</td></tr>
<tr><td class="h">13650</td><td><div class="c3">264</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13650">264</a></div></td><td><div class="c0">0</div></td><td><div>263</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src_zones, $dst_zones, $mark) = @_;</td></tr>
<tr><td class="h">13651</td><td><div class="c3">264</div><div class="c3">264</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13651">100</a></div></td><td></td><td></td><td></td><td><div>291</div><div>972</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src_marks = [ map { $_-&gt;{$mark} or return; } @$src_zones ];</td></tr>
<tr><td class="h">13652</td><td><div class="c3">32</div><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13652">100</a></div></td><td></td><td></td><td></td><td><div>37</div><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst_marks = [ map { $_-&gt;{$mark} or return; } @$dst_zones ];</td></tr>
<tr><td class="h">13653</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return equal(@$src_marks, @$dst_marks);</td></tr>
<tr><td class="h">13654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13655</td><td colspan="7"></td></tr><tr><td class="h">13656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_secondary_rules {</td></tr>
<tr><td class="h">13657</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13657">486</a></div></td><td><div class="c0">0</div></td><td><div>820</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Marking rules for secondary optimization&#39;);</td></tr>
<tr><td class="h">13658</td><td colspan="7"></td></tr><tr><td class="h">13659</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>427</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $secondary_mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">13660</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>413</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $primary_mark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">13661</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>405</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $local_secondary_mark&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">13662</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>563</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">13663</td><td><div class="c3">1624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13663">100</a></div></td><td></td><td></td><td></td><td><div>2459</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $zone-&gt;{secondary_mark}) {</td></tr>
<tr><td class="h">13664</td><td><div class="c3">1462</div></td><td></td><td></td><td></td><td></td><td><div>1976</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_secondary $zone, $secondary_mark++;</td></tr>
<tr><td class="h">13665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13666</td><td><div class="c3">1624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13666">100</a></div></td><td></td><td></td><td></td><td><div>2500</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $zone-&gt;{primary_mark}) {</td></tr>
<tr><td class="h">13667</td><td><div class="c3">514</div></td><td></td><td></td><td></td><td></td><td><div>765</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_primary $zone, $primary_mark++;</td></tr>
<tr><td class="h">13668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13669</td><td><div class="c3">1624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13669">100</a></div></td><td></td><td></td><td></td><td><div>2477</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $zone-&gt;{local_secondary_mark}) {</td></tr>
<tr><td class="h">13670</td><td><div class="c3">1570</div></td><td></td><td></td><td></td><td></td><td><div>2055</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark_local_secondary($zone, $local_secondary_mark++);</td></tr>
<tr><td class="h">13671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13673</td><td colspan="7"></td></tr><tr><td class="h">13674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Mark only permit rules for secondary optimization.</td></tr>
<tr><td class="h">13675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t modify a deny rule from e.g. tcp to ip.</td></tr>
<tr><td class="h">13676</td><td><div class="c3">486</div><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>467</div><div>651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $grouped_rules{permit} }) {</td></tr>
<tr><td class="h">13677</td><td><div class="c3">1204</div></td><td></td><td></td><td></td><td></td><td><div>1759</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst, $src_path, $dst_path) = </td></tr>
<tr><td class="h">13678</td><td><div class="c3">1204</div></td><td></td><td></td><td></td><td></td><td><div>1021</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$rule}{qw(src dst src_path dst_path)};</td></tr>
<tr><td class="h">13679</td><td colspan="7"></td></tr><tr><td class="h">13680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Type of $src_path / $dst_path is zone, interface or router.</td></tr>
<tr><td class="h">13681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If type is router, then src/dst may contain interfaces of</td></tr>
<tr><td class="h">13682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# different zones with different values of secondary_mark/primary_mark.</td></tr>
<tr><td class="h">13683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only do optimization, if all interfaces would allow optimization.</td></tr>
<tr><td class="h">13684</td><td><div class="c3">1204</div></td><td></td><td></td><td></td><td></td><td><div>1507</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_zones = get_zones($src_path, $src);</td></tr>
<tr><td class="h">13685</td><td><div class="c3">1204</div></td><td></td><td></td><td></td><td></td><td><div>1371</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_zones = get_zones($dst_path, $dst);</td></tr>
<tr><td class="h">13686</td><td><div class="c3">1204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13686">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13686">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13686">100</a></div></td><td></td><td></td><td><div>1520</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (have_different_marks($src_zones, $dst_zones, &#39;secondary_mark&#39;)) {</td></tr>
<tr><td class="h">13687</td><td><div class="c3">940</div></td><td></td><td></td><td></td><td></td><td><div>1423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{some_non_secondary} = 1;</td></tr>
<tr><td class="h">13688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (have_set_and_equal_marks($src_zones, $dst_zones, &#39;local_mark&#39;) and</td></tr>
<tr><td class="h">13690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;have_different_marks($src_zones, $dst_zones, </td></tr>
<tr><td class="h">13691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;local_secondary_mark&#39;)) </td></tr>
<tr><td class="h">13692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13693</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{some_non_secondary} = 1;</td></tr>
<tr><td class="h">13694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13695</td><td><div class="c3">1204</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13695">100</a></div></td><td></td><td></td><td></td><td><div>1562</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (have_different_marks($src_zones, $dst_zones, &#39;primary_mark&#39;)) {</td></tr>
<tr><td class="h">13696</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{some_primary} = 1;</td></tr>
<tr><td class="h">13697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13699</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>539</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13701</td><td colspan="7"></td></tr><tr><td class="h">13702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_zone_cluster_borders {</td></tr>
<tr><td class="h">13703</td><td><div class="c3">65</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13703">65</a></div></td><td><div class="c0">0</div></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone) = @_;</td></tr>
<tr><td class="h">13704</td><td><div class="c3">65</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13704">50</a></div></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $zone_cluster = $zone-&gt;{zone_cluster} || [$zone];</td></tr>
<tr><td class="h">13705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return (</td></tr>
<tr><td class="h">13706</td><td><div class="c3">86</div><div class="c3">65</div></td><td></td><td></td><td></td><td></td><td><div>198</div><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{router}-&gt;{managed} }</td></tr>
<tr><td class="h">13707</td><td><div class="c3">65</div><div class="c3">65</div></td><td></td><td></td><td></td><td></td><td><div>80</div><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { @{ $_-&gt;{interfaces} } }</td></tr>
<tr><td class="h">13708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$zone_cluster);</td></tr>
<tr><td class="h">13709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13710</td><td colspan="7"></td></tr><tr><td class="h">13711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Analyze networks having host or interface with dynamic NAT.</td></tr>
<tr><td class="h">13712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># In this case secondary optimization must be disabled</td></tr>
<tr><td class="h">13713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># at border routers of zone cluster of these networks,</td></tr>
<tr><td class="h">13714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># because we could accidently permit traffic for the whole network</td></tr>
<tr><td class="h">13715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># where only a single host should be permitted.</td></tr>
<tr><td class="h">13716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark_dynamic_host_nets {</td></tr>
<tr><td class="h">13717</td><td colspan="7"></td></tr><tr><td class="h">13718</td><td><div class="c3">660</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13718">660</a></div></td><td><div class="c0">0</div></td><td><div>539</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %zone2dynamic;</td></tr>
<tr><td class="h">13719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;NETWORK:</td></tr>
<tr><td class="h">13720</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>762</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">13721</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13721">100</a></div></td><td></td><td></td><td></td><td><div>5047</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">13722</td><td><div class="c3">212</div></td><td></td><td></td><td></td><td></td><td><div>354</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$href) {</td></tr>
<tr><td class="h">13723</td><td><div class="c3">245</div></td><td></td><td></td><td></td><td></td><td><div>274</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $href-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13724</td><td><div class="c3">245</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13724">100</a></div></td><td></td><td></td><td></td><td><div>461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_network-&gt;{dynamic} or next;</td></tr>
<tr><td class="h">13725</td><td><div class="c3">148</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13725">100</a></div></td><td></td><td></td><td></td><td><div>278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_network-&gt;{hidden};</td></tr>
<tr><td class="h">13726</td><td><div class="c3">71</div><div class="c3">71</div><div class="c3">71</div></td><td></td><td></td><td></td><td></td><td><div>69</div><div>89</div><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@{ $network-&gt;{hosts} }, @{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">13727</td><td><div class="c3">75</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13727">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13727">67</a></div></td><td></td><td></td><td><div>168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;{nat} and $obj-&gt;{nat}-&gt;{$nat_tag} and next;</td></tr>
<tr><td class="h">13728</td><td><div class="c3">71</div></td><td></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{has_dynamic_host} = 1;</td></tr>
<tr><td class="h">13729</td><td><div class="c3">71</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $network-&gt;{zone};</td></tr>
<tr><td class="h">13730</td><td><div class="c3">71</div><div class="c3">71</div></td><td></td><td></td><td></td><td></td><td><div>54</div><div>150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $zone2dynamic{$zone} }, $network;</td></tr>
<tr><td class="h">13731</td><td><div class="c3">71</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NETWORK;</td></tr>
<tr><td class="h">13732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13735</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>771</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">13736</td><td><div class="c3">1958</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13736">100</a></div></td><td></td><td></td><td></td><td><div>4050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dynamic_nets = $zone2dynamic{$zone} or next;</td></tr>
<tr><td class="h">13737</td><td><div class="c3">65</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (get_zone_cluster_borders($zone)) {</td></tr>
<tr><td class="h">13738</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">13739</td><td><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $router-&gt;{managed};</td></tr>
<tr><td class="h">13740</td><td><div class="c3">86</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13740">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13740">33</a></div></td><td></td><td></td><td><div>294</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if ($managed eq &#39;primary&#39; or $managed eq &#39;full&#39;);</td></tr>
<tr><td class="h">13741</td><td colspan="7"></td></tr><tr><td class="h">13742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Secondary optimization will or may be applicable</td></tr>
<tr><td class="h">13743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# and must be disabled for $dynamic_nets.</td></tr>
<tr><td class="h">13744</td><td><div class="c3">86</div><div class="c3">86</div></td><td></td><td></td><td></td><td></td><td><div>88</div><div>331</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $router-&gt;{no_secondary_opt} }{@$dynamic_nets} = @$dynamic_nets;</td></tr>
<tr><td class="h">13745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13748</td><td colspan="7"></td></tr><tr><td class="h">13749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 1. Check for invalid rules accessing hidden objects.</td></tr>
<tr><td class="h">13750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 2. Check host rule with dynamic NAT.</td></tr>
<tr><td class="h">13751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># 3. Check for partially applied hidden or dynamic NAT on path.</td></tr>
<tr><td class="h">13752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_dynamic_nat_rules {</td></tr>
<tr><td class="h">13753</td><td><div class="c3">660</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13753">660</a></div></td><td><div class="c0">0</div></td><td><div>1002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Checking rules with hidden or dynamic NAT&#39;);</td></tr>
<tr><td class="h">13754</td><td colspan="7"></td></tr><tr><td class="h">13755</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>829</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;mark_dynamic_host_nets();</td></tr>
<tr><td class="h">13756</td><td colspan="7"></td></tr><tr><td class="h">13757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect hidden or dynamic NAT tags.</td></tr>
<tr><td class="h">13758</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>569</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %is_dynamic_nat_tag;</td></tr>
<tr><td class="h">13759</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>695</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">13760</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13760">100</a></div></td><td></td><td></td><td></td><td><div>4833</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">13761</td><td><div class="c3">212</div></td><td></td><td></td><td></td><td></td><td><div>311</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$href) {</td></tr>
<tr><td class="h">13762</td><td><div class="c3">248</div></td><td></td><td></td><td></td><td></td><td><div>248</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $href-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13763</td><td><div class="c3">248</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13763">100</a></div></td><td></td><td></td><td></td><td><div>646</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_network-&gt;{dynamic} and $is_dynamic_nat_tag{$nat_tag} = 1;</td></tr>
<tr><td class="h">13764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13766</td><td colspan="7"></td></tr><tr><td class="h">13767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect no_nat_sets appliable in zone</td></tr>
<tr><td class="h">13768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# and combine them into {multi_no_nat_set}.</td></tr>
<tr><td class="h">13769</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>586</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %zone2no_nat_set;</td></tr>
<tr><td class="h">13770</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">13771</td><td><div class="c3">3036</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13771">100</a></div></td><td></td><td></td><td></td><td><div>4665</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_domain = $network-&gt;{nat_domain} or next;</td></tr>
<tr><td class="h">13772</td><td><div class="c3">2788</div></td><td></td><td></td><td></td><td></td><td><div>2281</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $nat_domain-&gt;{no_nat_set};</td></tr>
<tr><td class="h">13773</td><td><div class="c3">2788</div></td><td></td><td></td><td></td><td></td><td><div>2204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $network-&gt;{zone};</td></tr>
<tr><td class="h">13774</td><td><div class="c3">2788</div></td><td></td><td></td><td></td><td></td><td><div>6043</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone2no_nat_set{$zone}-&gt;{$no_nat_set} = $no_nat_set;</td></tr>
<tr><td class="h">13775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13776</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>774</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">13777</td><td><div class="c3">1958</div><div class="c3">1958</div></td><td></td><td></td><td></td><td></td><td><div>1463</div><div>4024</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @no_nat_set_list = values %{ $zone2no_nat_set{$zone} };</td></tr>
<tr><td class="h">13778</td><td><div class="c3">1958</div></td><td></td><td></td><td></td><td></td><td><div>1794</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $result = pop @no_nat_set_list;</td></tr>
<tr><td class="h">13779</td><td><div class="c3">1958</div></td><td></td><td></td><td></td><td></td><td><div>2143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $no_nat_set (@no_nat_set_list) {</td></tr>
<tr><td class="h">13780</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intersection = {};</td></tr>
<tr><td class="h">13781</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (%$no_nat_set) {</td></tr>
<tr><td class="h">13782</td><td><div class="c3">132</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13782">100</a></div></td><td></td><td></td><td></td><td><div>264</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intersection-&gt;{$key} = 1 if $result-&gt;{$key};</td></tr>
<tr><td class="h">13783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13784</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $intersection</td></tr>
<tr><td class="h">13785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13786</td><td><div class="c3">1958</div></td><td></td><td></td><td></td><td></td><td><div>2719</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{multi_no_nat_set} = $result;</td></tr>
<tr><td class="h">13787</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">13788</td><td colspan="7"></td></tr><tr><td class="h">13789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check path for inversed hidden or dynamic NAT.</td></tr>
<tr><td class="h">13790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $check_dyn_nat = sub {</td></tr>
<tr><td class="h">13791</td><td><div class="c3">116</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13791">116</a></div></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">13792</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13792">100</a></div></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set1 = $in_intf&nbsp;&nbsp;? $in_intf-&gt;{no_nat_set}&nbsp;&nbsp;: undef;</td></tr>
<tr><td class="h">13793</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13793">100</a></div></td><td></td><td></td><td></td><td><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set2 = $out_intf ? $out_intf-&gt;{no_nat_set} : undef;</td></tr>
<tr><td class="h">13794</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %is_dynamic_nat_tag) {</td></tr>
<tr><td class="h">13795</td><td><div class="c3">120</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13795">100</a></div></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_nat_set1) {</td></tr>
<tr><td class="h">13796</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_nat_set1-&gt;{$nat_tag}</td></tr>
<tr><td class="h">13797</td><td><div class="c3">118</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13797">100</a></div></td><td></td><td></td><td></td><td><div>210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or push @{ $rule-&gt;{active_nat_at}-&gt;{$nat_tag} }, $in_intf;</td></tr>
<tr><td class="h">13798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13799</td><td><div class="c3">120</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13799">100</a></div></td><td></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_nat_set2) {</td></tr>
<tr><td class="h">13800</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_nat_set2-&gt;{$nat_tag}</td></tr>
<tr><td class="h">13801</td><td><div class="c3">114</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13801">100</a></div></td><td></td><td></td><td></td><td><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or push @{ $rule-&gt;{active_nat_at}-&gt;{$nat_tag} }, $out_intf;</td></tr>
<tr><td class="h">13802</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13803</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13804</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>2197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">13805</td><td colspan="7"></td></tr><tr><td class="h">13806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remember, if pair of src object and destination no_nat_set</td></tr>
<tr><td class="h">13807</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# already has been processed.</td></tr>
<tr><td class="h">13808</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>610</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">13809</td><td colspan="7"></td></tr><tr><td class="h">13810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remember, if path has already been checked for inversed dynamic NAT.</td></tr>
<tr><td class="h">13811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %cache;</td></tr>
<tr><td class="h">13812</td><td colspan="7"></td></tr><tr><td class="h">13813</td><td><div class="c3">660</div><div class="c3">660</div><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>563</div><div>817</div><div>954</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $expanded_rules{permit} }, @{ $expanded_rules{deny} }) {</td></tr>
<tr><td class="h">13814</td><td><div class="c3">1274</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13814">100</a></div></td><td></td><td></td><td></td><td><div>1953</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{deleted};</td></tr>
<tr><td class="h">13815</td><td><div class="c3">1272</div></td><td></td><td></td><td></td><td></td><td><div>1195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $where (&#39;src&#39;, &#39;dst&#39;) {</td></tr>
<tr><td class="h">13816</td><td><div class="c3">2544</div></td><td></td><td></td><td></td><td></td><td><div>2290</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{$where};</td></tr>
<tr><td class="h">13817</td><td><div class="c3">2544</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13817">67</a></div></td><td></td><td></td><td><div>5343</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network&nbsp;&nbsp;&nbsp;&nbsp;= $obj-&gt;{network} || $obj;</td></tr>
<tr><td class="h">13818</td><td><div class="c3">2544</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13818">100</a></div></td><td></td><td></td><td></td><td><div>5055</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_hash&nbsp;&nbsp;&nbsp;= $network-&gt;{nat} or next;</td></tr>
<tr><td class="h">13819</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13819">100</a></div></td><td></td><td></td><td></td><td><div>220</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $where eq &#39;src&#39; ? $rule-&gt;{dst} : $rule-&gt;{src};</td></tr>
<tr><td class="h">13820</td><td><div class="c3">124</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13820">67</a></div></td><td></td><td></td><td><div>285</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $other_net&nbsp;&nbsp;= $other-&gt;{network} || $other;</td></tr>
<tr><td class="h">13821</td><td><div class="c3">124</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_domain = $other_net-&gt;{nat_domain}; # Is undef for aggregate.</td></tr>
<tr><td class="h">13822</td><td colspan="7"></td></tr><tr><td class="h">13823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find $nat_tag which is effective at $other.</td></tr>
<tr><td class="h">13824</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - single: $other is host or network, $nat_domain is known.</td></tr>
<tr><td class="h">13825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - multiple: $other is aggregate.</td></tr>
<tr><td class="h">13826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Use intersection of all no_nat_sets active in zone.</td></tr>
<tr><td class="h">13827</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13827">100</a></div></td><td></td><td></td><td></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $nat_domain </td></tr>
<tr><td class="h">13828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $nat_domain-&gt;{no_nat_set} </td></tr>
<tr><td class="h">13829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $other-&gt;{zone}-&gt;{multi_no_nat_set};</td></tr>
<tr><td class="h">13830</td><td colspan="7"></td></tr><tr><td class="h">13831</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13831">100</a></div></td><td></td><td></td><td></td><td><div>171</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cache_obj = $network-&gt;{has_dynamic_host} ? $obj : $network;</td></tr>
<tr><td class="h">13832</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13832">100</a></div></td><td></td><td></td><td></td><td><div>379</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$cache_obj}-&gt;{$no_nat_set}++;</td></tr>
<tr><td class="h">13833</td><td colspan="7"></td></tr><tr><td class="h">13834</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_seen;</td></tr>
<tr><td class="h">13835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hidden_seen;</td></tr>
<tr><td class="h">13836</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $static_seen;</td></tr>
<tr><td class="h">13837</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>226</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$nat_hash) {</td></tr>
<tr><td class="h">13838</td><td><div class="c3">108</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13838">100</a></div></td><td></td><td></td><td></td><td><div>200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $no_nat_set-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13839</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_seen = 1;</td></tr>
<tr><td class="h">13840</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $nat_hash-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13841</td><td colspan="7"></td></tr><tr><td class="h">13842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Network is hidden by NAT.</td></tr>
<tr><td class="h">13843</td><td><div class="c3">90</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13843">100</a></div></td><td></td><td></td><td></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_network-&gt;{hidden}) {</td></tr>
<tr><td class="h">13844</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13844">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hidden_seen++</td></tr>
<tr><td class="h">13845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or err_msg(&quot;$obj-&gt;{name} is hidden by nat:$nat_tag&quot;,</td></tr>
<tr><td class="h">13846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; in rule\n &quot;, print_rule $rule);</td></tr>
<tr><td class="h">13847</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">13848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13849</td><td><div class="c3">82</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13849">100</a></div></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $nat_network-&gt;{dynamic}) {</td></tr>
<tr><td class="h">13850</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$static_seen = 1;</td></tr>
<tr><td class="h">13851</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">13852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13853</td><td colspan="7"></td></tr><tr><td class="h">13854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Detailed check for host / interface with dynamic NAT.</td></tr>
<tr><td class="h">13855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 1. Dynamic NAT address of host / interface object is</td></tr>
<tr><td class="h">13856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# used in ACL at managed router at the border of zone</td></tr>
<tr><td class="h">13857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of that object. Hence the whole network would</td></tr>
<tr><td class="h">13858</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# accidentally be permitted.</td></tr>
<tr><td class="h">13859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 2. Check later to be added reverse rule as well.</td></tr>
<tr><td class="h">13860</td><td colspan="7"></td></tr><tr><td class="h">13861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore network.</td></tr>
<tr><td class="h">13862</td><td><div class="c3">62</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13862">100</a></div></td><td></td><td></td><td></td><td><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $obj eq $network;</td></tr>
<tr><td class="h">13863</td><td colspan="7"></td></tr><tr><td class="h">13864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore host / interface with static NAT.</td></tr>
<tr><td class="h">13865</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13865">100</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $obj-&gt;{nat}-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13866</td><td colspan="7"></td></tr><tr><td class="h">13867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $check = sub {</td></tr>
<tr><td class="h">13868</td><td><div class="c3">34</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13868">34</a></div></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">13869</td><td><div class="c3">34</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13869">33</a></div></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = ($in_intf || $out_intf)-&gt;{router};</td></tr>
<tr><td class="h">13870</td><td colspan="7"></td></tr><tr><td class="h">13871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $check_common = sub {</td></tr>
<tr><td class="h">13872</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($nat_intf, $reversed) = @_;</td></tr>
<tr><td class="h">13873</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $nat_intf-&gt;{no_nat_set};</td></tr>
<tr><td class="h">13874</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network =</td></tr>
<tr><td class="h">13875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get_nat_network($network, $no_nat_set);</td></tr>
<tr><td class="h">13876</td><td><div class="c3">36</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_tag = $nat_network-&gt;{dynamic};</td></tr>
<tr><td class="h">13877</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13877">100</a></div></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if not $nat_tag;</td></tr>
<tr><td class="h">13878</td><td><div class="c3">24</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13878">50</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $obj-&gt;{nat}-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13879</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13879">100</a></div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf = $where eq &#39;src&#39; ? $in_intf : $out_intf;</td></tr>
<tr><td class="h">13880</td><td colspan="7"></td></tr><tr><td class="h">13881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $intf could have value &#39;undef&#39; if $obj is</td></tr>
<tr><td class="h">13882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# interface of current router and src/dst of rule.</td></tr>
<tr><td class="h">13883</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13883">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13883">100</a></div></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$intf || zone_eq($network-&gt;{zone}, $intf-&gt;{zone}))</td></tr>
<tr><td class="h">13884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13885</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13885">100</a></div></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(&quot;$obj-&gt;{name} needs static translation&quot;,</td></tr>
<tr><td class="h">13886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; for nat:$nat_tag at $router-&gt;{name}&quot;,</td></tr>
<tr><td class="h">13887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to be valid in&quot;,</td></tr>
<tr><td class="h">13888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reversed ? &#39; reversed rule for&#39; : &#39; rule&#39;,</td></tr>
<tr><td class="h">13889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n &quot;,</td></tr>
<tr><td class="h">13890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_rule $rule);</td></tr>
<tr><td class="h">13891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13892</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">13893</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check_common-&gt;($in_intf);</td></tr>
<tr><td class="h">13894</td><td><div class="c3">34</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13894">100</a></div></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{model}-&gt;{stateless}) {</td></tr>
<tr><td class="h">13895</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $rule-&gt;{prt}-&gt;{proto};</td></tr>
<tr><td class="h">13896</td><td colspan="7"></td></tr><tr><td class="h">13897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reversed tcp rule would check for</td></tr>
<tr><td class="h">13898</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# &#39;established&#39; flag and hence is harmless</td></tr>
<tr><td class="h">13899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# even if it can reach whole network, because</td></tr>
<tr><td class="h">13900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# it only sends answer back for correctly</td></tr>
<tr><td class="h">13901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# established connection.</td></tr>
<tr><td class="h">13902</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13902">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13902">67</a></div></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($proto eq &#39;udp&#39; or $proto eq &#39;ip&#39;) { </td></tr>
<tr><td class="h">13903</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$check_common-&gt;($out_intf, 1);</td></tr>
<tr><td class="h">13904</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13906</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">13907</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single_path_walk($rule, $check);</td></tr>
<tr><td class="h">13908</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13909</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13909">100</a></div></td><td></td><td></td><td></td><td><div>200</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_seen or $static_seen = 1;</td></tr>
<tr><td class="h">13910</td><td colspan="7"></td></tr><tr><td class="h">13911</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13911">100</a></div></td><td></td><td></td><td></td><td><div>189</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hidden_seen and next;</td></tr>
<tr><td class="h">13912</td><td colspan="7"></td></tr><tr><td class="h">13913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check error conditition:</td></tr>
<tr><td class="h">13914</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find sub-path where dynamic / hidden NAT is inversed,</td></tr>
<tr><td class="h">13915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# i.e. dynamic / hidden NAT is enabled first and disabled later.</td></tr>
<tr><td class="h">13916</td><td colspan="7"></td></tr><tr><td class="h">13917</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find dynamic and hidden NAT definitions of $obj.</td></tr>
<tr><td class="h">13918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Key: NAT tag,</td></tr>
<tr><td class="h">13919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# value: boolean, true=hidden, false=dynamic</td></tr>
<tr><td class="h">13920</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dyn_nat_hash;</td></tr>
<tr><td class="h">13921</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (keys %$nat_hash) {</td></tr>
<tr><td class="h">13922</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = $nat_hash-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13923</td><td><div class="c3">100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13923">100</a></div></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat_network-&gt;{dynamic} or next;</td></tr>
<tr><td class="h">13924</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dyn_nat_hash-&gt;{$nat_tag} = $nat_network-&gt;{hidden};</td></tr>
<tr><td class="h">13925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13926</td><td><div class="c3">108</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13926">100</a></div></td><td></td><td></td><td></td><td><div>212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dyn_nat_hash or next;</td></tr>
<tr><td class="h">13927</td><td colspan="7"></td></tr><tr><td class="h">13928</td><td><div class="c3">74</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13928">67</a></div></td><td></td><td></td><td><div>193</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $from_store = $obj2path{$obj}&nbsp;&nbsp;&nbsp;|| get_path $obj;</td></tr>
<tr><td class="h">13929</td><td><div class="c3">74</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13929">67</a></div></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $to_store&nbsp;&nbsp;&nbsp;= $obj2path{$other} || get_path $other;</td></tr>
<tr><td class="h">13930</td><td><div class="c3">74</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13930">67</a></div></td><td></td><td></td><td><div>292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $active_nat_at = $cache{$from_store}-&gt;{$to_store}</td></tr>
<tr><td class="h">13931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $cache{$to_store}-&gt;{$from_store};</td></tr>
<tr><td class="h">13932</td><td colspan="7"></td></tr><tr><td class="h">13933</td><td><div class="c3">74</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13933">100</a></div></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$active_nat_at) {</td></tr>
<tr><td class="h">13934</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cache{$from_store}-&gt;{$to_store} =</td></tr>
<tr><td class="h">13935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$active_nat_at = $rule-&gt;{active_nat_at} = {};</td></tr>
<tr><td class="h">13936</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single_path_walk($rule, $check_dyn_nat);</td></tr>
<tr><td class="h">13937</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $rule-&gt;{active_nat_at};</td></tr>
<tr><td class="h">13938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13939</td><td colspan="7"></td></tr><tr><td class="h">13940</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $nat_tag (sort keys %$dyn_nat_hash) {</td></tr>
<tr><td class="h">13941</td><td><div class="c3">78</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13941">100</a></div></td><td></td><td></td><td></td><td><div>164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $interfaces = $active_nat_at-&gt;{$nat_tag} or next;</td></tr>
<tr><td class="h">13942</td><td><div class="c3">72</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $is_hidden = $dyn_nat_hash-&gt;{$nat_tag};</td></tr>
<tr><td class="h">13943</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13943">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L13943">100</a></div></td><td></td><td></td><td><div>394</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($is_hidden || $static_seen) or next;</td></tr>
<tr><td class="h">13944</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $names =</td></tr>
<tr><td class="h">13945</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&quot;\n - &quot;, map({ $_-&gt;{name} } sort(by_name @$interfaces)));</td></tr>
<tr><td class="h">13946</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13946">100</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = $is_hidden ? &#39;hidden&#39; : &#39;dynamic&#39;;</td></tr>
<tr><td class="h">13947</td><td><div class="c3">10</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13947">50</a></div></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">13948</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Must not apply $type NAT &#39;$nat_tag&#39; on path\n&quot;,</td></tr>
<tr><td class="h">13949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of&quot;,</td></tr>
<tr><td class="h">13950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$where eq &#39;dst&#39; ? &#39; reversed&#39; : &#39;&#39;,</td></tr>
<tr><td class="h">13951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; rule\n&quot;,</td></tr>
<tr><td class="h">13952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; &quot;,</td></tr>
<tr><td class="h">13953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_rule($rule),</td></tr>
<tr><td class="h">13954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n&quot;,</td></tr>
<tr><td class="h">13955</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; NAT &#39;$nat_tag&#39; is active at\n&quot;,</td></tr>
<tr><td class="h">13956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; - $names\n&quot;,</td></tr>
<tr><td class="h">13957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Add pathrestriction&quot;,</td></tr>
<tr><td class="h">13958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; to exclude this path&quot;</td></tr>
<tr><td class="h">13959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">13960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13961</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">13963</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>4038</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">13964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13965</td><td colspan="7"></td></tr><tr><td class="h">13966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Optimize expanded rules by deleting identical rules and</td></tr>
<tr><td class="h">13968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># rules which are overlapped by a more general rule</td></tr>
<tr><td class="h">13969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">13970</td><td colspan="7"></td></tr><tr><td class="h">13971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub optimize_rules {</td></tr>
<tr><td class="h">13972</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L13972">486</a></div></td><td><div class="c0">0</div></td><td><div>493</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($cmp_hash, $chg_hash) = @_;</td></tr>
<tr><td class="h">13973</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1214</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (my ($stateless, $chg_hash) = each %$chg_hash) {</td></tr>
<tr><td class="h">13974</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13975</td><td><div class="c3">410</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13975">50</a></div></td><td></td><td></td><td></td><td><div>741</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cmp_hash = $cmp_hash-&gt;{$stateless}) {</td></tr>
<tr><td class="h">13976</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>986</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($deny, $chg_hash) = each %$chg_hash) {</td></tr>
<tr><td class="h">13977</td><td><div class="c3">412</div></td><td></td><td></td><td></td><td></td><td><div>323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13978</td><td><div class="c3">822</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13978">100</a></div></td><td></td><td></td><td></td><td><div>1379</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cmp_hash = $cmp_hash-&gt;{$deny}) {</td></tr>
<tr><td class="h">13979</td><td><div class="c3">414</div></td><td></td><td></td><td></td><td></td><td><div>879</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($src_range_ref, $chg_hash) =</td></tr>
<tr><td class="h">13980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each %$chg_hash)</td></tr>
<tr><td class="h">13981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13982</td><td><div class="c3">456</div></td><td></td><td></td><td></td><td></td><td><div>464</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range = $ref2prt{$src_range_ref};</td></tr>
<tr><td class="h">13983</td><td><div class="c3">456</div></td><td></td><td></td><td></td><td></td><td><div>365</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13984</td><td><div class="c3">552</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13984">100</a></div></td><td></td><td></td><td></td><td><div>1060</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cmp_hash = $cmp_hash-&gt;{$src_range})</td></tr>
<tr><td class="h">13985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13986</td><td><div class="c3">498</div></td><td></td><td></td><td></td><td></td><td><div>1044</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (my ($src_ref, $chg_hash) =</td></tr>
<tr><td class="h">13987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each %$chg_hash)</td></tr>
<tr><td class="h">13988</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13989</td><td><div class="c3">1084</div></td><td></td><td></td><td></td><td></td><td><div>970</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src = $ref2obj{$src_ref};</td></tr>
<tr><td class="h">13990</td><td><div class="c3">1084</div></td><td></td><td></td><td></td><td></td><td><div>789</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">13991</td><td><div class="c3">1400</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L13991">100</a></div></td><td></td><td></td><td></td><td><div>2608</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cmp_hash =</td></tr>
<tr><td class="h">13992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cmp_hash-&gt;{$src})</td></tr>
<tr><td class="h">13993</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13994</td><td><div class="c3">1150</div></td><td></td><td></td><td></td><td></td><td><div>2277</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (</td></tr>
<tr><td class="h">13995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($dst_ref, $chg_hash)</td></tr>
<tr><td class="h">13996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= each %$chg_hash)</td></tr>
<tr><td class="h">13997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">13998</td><td><div class="c3">1426</div></td><td></td><td></td><td></td><td></td><td><div>1211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst =</td></tr>
<tr><td class="h">13999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ref2obj{$dst_ref};</td></tr>
<tr><td class="h">14000</td><td><div class="c3">1426</div></td><td></td><td></td><td></td><td></td><td><div>1054</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">14001</td><td><div class="c3">1748</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14001">100</a></div></td><td></td><td></td><td></td><td><div>3218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $cmp_hash =</td></tr>
<tr><td class="h">14002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cmp_hash</td></tr>
<tr><td class="h">14003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$dst})</td></tr>
<tr><td class="h">14004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14005</td><td><div class="c3">1430</div></td><td></td><td></td><td></td><td></td><td><div>1938</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for</td></tr>
<tr><td class="h">14006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $chg_rule (</td></tr>
<tr><td class="h">14007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values</td></tr>
<tr><td class="h">14008</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%$chg_hash)</td></tr>
<tr><td class="h">14009</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14010</td><td colspan="7"></td></tr><tr><td class="h">14011</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Even if $change_rule already is marked as deleted,</td></tr>
<tr><td class="h">14012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# don&#39;t stop here, but go on and find all redundant</td></tr>
<tr><td class="h">14013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pairs of ($change_rule, $cmp_rule).</td></tr>
<tr><td class="h">14014</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is needed, because some instances of $cmp_rule</td></tr>
<tr><td class="h">14015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# may have an {overlaps} attribute, which prevents</td></tr>
<tr><td class="h">14016</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a warning message to be printed.</td></tr>
<tr><td class="h">14017</td><td><div class="c3">1542</div></td><td></td><td></td><td></td><td></td><td><div>1373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt =</td></tr>
<tr><td class="h">14018</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$chg_rule</td></tr>
<tr><td class="h">14019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{prt};</td></tr>
<tr><td class="h">14020</td><td><div class="c3">1542</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14020">100</a></div></td><td></td><td></td><td><div>3705</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $chg_log</td></tr>
<tr><td class="h">14021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $chg_rule</td></tr>
<tr><td class="h">14022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{log}</td></tr>
<tr><td class="h">14023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| &#39;&#39;;</td></tr>
<tr><td class="h">14024</td><td><div class="c3">1542</div></td><td></td><td></td><td></td><td></td><td><div>1132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">14025</td><td><div class="c3">4328</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14025">100</a></div></td><td></td><td></td><td></td><td><div>7087</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">14026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cmp_rule</td></tr>
<tr><td class="h">14027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $cmp_hash</td></tr>
<tr><td class="h">14028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{</td></tr>
<tr><td class="h">14029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt</td></tr>
<tr><td class="h">14030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">14032</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14033</td><td><div class="c3">1412</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14033">100</a></div></td><td></td><td></td><td><div>3163</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cmp_log</td></tr>
<tr><td class="h">14034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $cmp_rule</td></tr>
<tr><td class="h">14035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</td></tr>
<tr><td class="h">14036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{log}</td></tr>
<tr><td class="h">14037</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</td></tr>
<tr><td class="h">14038</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&#39;;</td></tr>
<tr><td class="h">14039</td><td><div class="c3">1412</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14039">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14039">100</a></div></td><td></td><td></td><td><div>3313</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">14040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cmp_rule</td></tr>
<tr><td class="h">14041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ne</td></tr>
<tr><td class="h">14042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$chg_rule</td></tr>
<tr><td class="h">14043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</td></tr>
<tr><td class="h">14044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cmp_log</td></tr>
<tr><td class="h">14045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eq</td></tr>
<tr><td class="h">14046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$chg_log</td></tr>
<tr><td class="h">14047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">14048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Del:&quot;, print_rule $chg_rule);</td></tr>
<tr><td class="h">14050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Oth:&quot;, print_rule $cmp_rule);</td></tr>
<tr><td class="h">14051</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$chg_rule</td></tr>
<tr><td class="h">14052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</td></tr>
<tr><td class="h">14053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{deleted}</td></tr>
<tr><td class="h">14054</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</td></tr>
<tr><td class="h">14055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cmp_rule;</td></tr>
<tr><td class="h">14056</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collect_redundant_rules(</td></tr>
<tr><td class="h">14057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$chg_rule,</td></tr>
<tr><td class="h">14058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cmp_rule</td></tr>
<tr><td class="h">14059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">14060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;</td></tr>
<tr><td class="h">14061</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">14062</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14064</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt =</td></tr>
<tr><td class="h">14065</td><td><div class="c3">4282</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14065">100</a></div></td><td></td><td></td><td></td><td><div>7807</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt</td></tr>
<tr><td class="h">14066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{up}</td></tr>
<tr><td class="h">14067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or</td></tr>
<tr><td class="h">14068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">14069</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14072</td><td><div class="c3">1748</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14072">100</a></div></td><td></td><td></td><td></td><td><div>4847</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst = $dst-&gt;{up}</td></tr>
<tr><td class="h">14073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or last;</td></tr>
<tr><td class="h">14074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14077</td><td><div class="c3">1400</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14077">100</a></div></td><td></td><td></td><td></td><td><div>3835</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src = $src-&gt;{up} or last;</td></tr>
<tr><td class="h">14078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14081</td><td><div class="c3">552</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14081">100</a></div></td><td></td><td></td><td></td><td><div>1427</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src_range = $src_range-&gt;{up} or last;</td></tr>
<tr><td class="h">14082</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14083</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14085</td><td><div class="c3">822</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14085">100</a></div></td><td></td><td></td><td></td><td><div>1646</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if $deny;</td></tr>
<tr><td class="h">14086</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>404</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$deny = 1;</td></tr>
<tr><td class="h">14087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14089</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14090</td><td><div class="c3">410</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14090">50</a></div></td><td></td><td></td><td></td><td><div>1092</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if !$stateless;</td></tr>
<tr><td class="h">14091</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$stateless = &#39;&#39;;</td></tr>
<tr><td class="h">14092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14094</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14096</td><td colspan="7"></td></tr><tr><td class="h">14097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub optimize_and_warn_deleted {</td></tr>
<tr><td class="h">14098</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14098">486</a></div></td><td><div class="c0">0</div></td><td><div>839</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Optimizing globally&#39;);</td></tr>
<tr><td class="h">14099</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;setup_ref2obj();</td></tr>
<tr><td class="h">14100</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>838</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;optimize_rules(\%rule_tree, \%rule_tree);</td></tr>
<tr><td class="h">14101</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>666</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_rulecount();</td></tr>
<tr><td class="h">14102</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>655</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;show_deleted_rules2();</td></tr>
<tr><td class="h">14103</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;warn_unused_overlaps();</td></tr>
<tr><td class="h">14104</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>414</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14106</td><td colspan="7"></td></tr><tr><td class="h">14107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">14108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Convert expanded rules to grouped rules.</td></tr>
<tr><td class="h">14109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">14110</td><td colspan="7"></td></tr><tr><td class="h">14111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %other_rule_attr = ( src =&gt; [qw(dst prt)],</td></tr>
<tr><td class="h">14112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [qw(src prt)],</td></tr>
<tr><td class="h">14113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [qw(src dst)], );</td></tr>
<tr><td class="h">14114</td><td colspan="7"></td></tr><tr><td class="h">14115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub group_rules {</td></tr>
<tr><td class="h">14116</td><td><div class="c3">472</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14116">472</a></div></td><td><div class="c0">0</div></td><td><div>447</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rules) = @_;</td></tr>
<tr><td class="h">14117</td><td colspan="7"></td></tr><tr><td class="h">14118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Reuse identical groups from different grouped rules.</td></tr>
<tr><td class="h">14119</td><td><div class="c3">472</div></td><td></td><td></td><td></td><td></td><td><div>373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $size2first2group;</td></tr>
<tr><td class="h">14120</td><td colspan="7"></td></tr><tr><td class="h">14121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find groups in attribute $where of rules.</td></tr>
<tr><td class="h">14122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Group first by prt, because we later split src and dst again.</td></tr>
<tr><td class="h">14123</td><td><div class="c3">472</div></td><td></td><td></td><td></td><td></td><td><div>510</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $where (&#39;prt&#39;, &#39;dst&#39;, &#39;src&#39;) {</td></tr>
<tr><td class="h">14124</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1423</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attr = $other_rule_attr{$where};</td></tr>
<tr><td class="h">14125</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1039</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %group_rule_tree;</td></tr>
<tr><td class="h">14126</td><td colspan="7"></td></tr><tr><td class="h">14127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use numerical index as hash key to preserve original order</td></tr>
<tr><td class="h">14128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of expanded_rules.</td></tr>
<tr><td class="h">14129</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $index1 = 1;</td></tr>
<tr><td class="h">14130</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1022</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %key2index;</td></tr>
<tr><td class="h">14131</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1040</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $index2 = 1;</td></tr>
<tr><td class="h">14132</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1030</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %this2index;</td></tr>
<tr><td class="h">14133</td><td colspan="7"></td></tr><tr><td class="h">14134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find groups of rules with identical @$attr.</td></tr>
<tr><td class="h">14135</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1451</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$rules) {</td></tr>
<tr><td class="h">14136</td><td><div class="c3">3574</div><div class="c3">3574</div></td><td></td><td></td><td></td><td></td><td><div>3319</div><div>7602</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= join &#39;,&#39;, @{$rule}{@$attr};</td></tr>
<tr><td class="h">14137</td><td><div class="c3">3574</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14137">67</a></div></td><td></td><td></td><td><div>10233</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key_index&nbsp;&nbsp;= $key2index{$key} ||= $index1++;</td></tr>
<tr><td class="h">14138</td><td><div class="c3">3574</div></td><td></td><td></td><td></td><td></td><td><div>3233</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $this&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{$where};</td></tr>
<tr><td class="h">14139</td><td><div class="c3">3574</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14139">67</a></div></td><td></td><td></td><td><div>8638</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $this_index = $this2index{$this} ||= $index2++;</td></tr>
<tr><td class="h">14140</td><td><div class="c3">3574</div></td><td></td><td></td><td></td><td></td><td><div>7467</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$group_rule_tree{$key_index}-&gt;{$this_index} = $rule;</td></tr>
<tr><td class="h">14141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14142</td><td colspan="7"></td></tr><tr><td class="h">14143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect new rules with group in attribute $where.</td></tr>
<tr><td class="h">14144</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>1283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @new_rules;</td></tr>
<tr><td class="h">14145</td><td colspan="7"></td></tr><tr><td class="h">14146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $href is {src/dst/prt =&gt; rule, ...}</td></tr>
<tr><td class="h">14147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# All rules are identical in all attributes except in $where.</td></tr>
<tr><td class="h">14148</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>3328</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort numerically keys %group_rule_tree) {</td></tr>
<tr><td class="h">14149</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>2747</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $href = $group_rule_tree{$key};</td></tr>
<tr><td class="h">14150</td><td><div class="c3">3574</div><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>6299</div><div>3831</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group = [ map { $_-&gt;{$where} }</td></tr>
<tr><td class="h">14151</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>5739</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$href}{sort numerically keys %$href} ];</td></tr>
<tr><td class="h">14152</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>3068</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $is_new = 1;</td></tr>
<tr><td class="h">14153</td><td colspan="7"></td></tr><tr><td class="h">14154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find group with identical elements or define a new one.</td></tr>
<tr><td class="h">14155</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>2537</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $size&nbsp;&nbsp;= @$group;</td></tr>
<tr><td class="h">14156</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>2669</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $first = $group-&gt;[0];</td></tr>
<tr><td class="h">14157</td><td colspan="7"></td></tr><tr><td class="h">14158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Search previously found group with identical elements.</td></tr>
<tr><td class="h">14159</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>6809</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HASH:</td></tr>
<tr><td class="h">14160</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>2324</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $group_hash (@{ $size2first2group-&gt;{$size}-&gt;{$first}}) {</td></tr>
<tr><td class="h">14161</td><td><div class="c3">1226</div></td><td></td><td></td><td></td><td></td><td><div>1100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $group_hash-&gt;{hash};</td></tr>
<tr><td class="h">14162</td><td colspan="7"></td></tr><tr><td class="h">14163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check elements for equality.</td></tr>
<tr><td class="h">14164</td><td><div class="c3">1226</div></td><td></td><td></td><td></td><td></td><td><div>1496</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (keys %$hash) {</td></tr>
<tr><td class="h">14165</td><td><div class="c3">1304</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14165">100</a></div></td><td></td><td></td><td></td><td><div>2965</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$href-&gt;{$key} or next HASH;</td></tr>
<tr><td class="h">14166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14167</td><td colspan="7"></td></tr><tr><td class="h">14168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found group with matching elements.</td></tr>
<tr><td class="h">14169</td><td><div class="c3">852</div></td><td></td><td></td><td></td><td></td><td><div>1167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$group = $group_hash-&gt;{group};</td></tr>
<tr><td class="h">14170</td><td><div class="c3">852</div></td><td></td><td></td><td></td><td></td><td><div>1319</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_new = 0;</td></tr>
<tr><td class="h">14171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14172</td><td colspan="7"></td></tr><tr><td class="h">14173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store group for later reuse.</td></tr>
<tr><td class="h">14174</td><td><div class="c3">3116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14174">100</a></div></td><td></td><td></td><td></td><td><div>4676</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($is_new) {</td></tr>
<tr><td class="h">14175</td><td><div class="c3">2264</div></td><td></td><td></td><td></td><td></td><td><div>3349</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group_hash = { group =&gt; $group, hash =&gt; $href };</td></tr>
<tr><td class="h">14176</td><td><div class="c3">2264</div><div class="c3">2264</div></td><td></td><td></td><td></td><td></td><td><div>1794</div><div>4152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $size2first2group-&gt;{$size}-&gt;{$first} }, $group_hash);</td></tr>
<tr><td class="h">14177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14178</td><td colspan="7"></td></tr><tr><td class="h">14179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Build grouped rules with found group as attribute.</td></tr>
<tr><td class="h">14180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Other attributes like {stateless} are taken from original rule.</td></tr>
<tr><td class="h">14181</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>4728</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $expanded_rule = $href-&gt;{$this2index{$first}};</td></tr>
<tr><td class="h">14182</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>8884</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $grouped_rule = { %$expanded_rule };</td></tr>
<tr><td class="h">14183</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>3809</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouped_rule-&gt;{$where} = $group;</td></tr>
<tr><td class="h">14184</td><td colspan="7"></td></tr><tr><td class="h">14185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember one expanded_rule for error messages.</td></tr>
<tr><td class="h">14186</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>2892</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouped_rule-&gt;{orig_rule} = $expanded_rule;</td></tr>
<tr><td class="h">14187</td><td><div class="c3">3116</div></td><td></td><td></td><td></td><td></td><td><div>5031</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @new_rules, $grouped_rule;</td></tr>
<tr><td class="h">14188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug print_rule $grouped_rule;</td></tr>
<tr><td class="h">14189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14190</td><td><div class="c3">1416</div></td><td></td><td></td><td></td><td></td><td><div>4402</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rules = \@new_rules;</td></tr>
<tr><td class="h">14191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14192</td><td><div class="c3">472</div></td><td></td><td></td><td></td><td></td><td><div>2737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $rules;</td></tr>
<tr><td class="h">14193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14194</td><td colspan="7"></td></tr><tr><td class="h">14195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub group_path_rules {</td></tr>
<tr><td class="h">14196</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14196">486</a></div></td><td><div class="c0">0</div></td><td><div>828</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;progress(&quot;Grouping rules&quot;);</td></tr>
<tr><td class="h">14197</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>416</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $count = 0;</td></tr>
<tr><td class="h">14198</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>878</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $action (qw(permit deny)) {</td></tr>
<tr><td class="h">14199</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules = delete $expanded_rules{$action};</td></tr>
<tr><td class="h">14200</td><td><div class="c3">972</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14200">100</a></div></td><td></td><td></td><td></td><td><div>2315</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$rules or next;</td></tr>
<tr><td class="h">14201</td><td colspan="7"></td></tr><tr><td class="h">14202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect rules that use identical modifiers.</td></tr>
<tr><td class="h">14203</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>316</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %attr2rules;</td></tr>
<tr><td class="h">14204</td><td colspan="7"></td></tr><tr><td class="h">14205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use numerical index as hash key to preserve original order</td></tr>
<tr><td class="h">14206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of expanded_rules.</td></tr>
<tr><td class="h">14207</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $index = 1;</td></tr>
<tr><td class="h">14208</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %attr2index;</td></tr>
<tr><td class="h">14209</td><td colspan="7"></td></tr><tr><td class="h">14210</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>472</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$rules) {</td></tr>
<tr><td class="h">14211</td><td><div class="c3">1366</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14211">100</a></div></td><td></td><td></td><td></td><td><div>2007</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{deleted};</td></tr>
<tr><td class="h">14212</td><td><div class="c3">1326</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14212">100</a></div></td><td></td><td></td><td><div>3064</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_range = $rule-&gt;{src_range} || &#39;&#39;;</td></tr>
<tr><td class="h">14213</td><td><div class="c3">1326</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14213">100</a></div></td><td></td><td></td><td><div>2901</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{log} || &#39;&#39;;</td></tr>
<tr><td class="h">14214</td><td><div class="c3">1326</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14214">50</a></div></td><td></td><td></td><td><div>2873</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $oneway&nbsp;&nbsp;&nbsp;&nbsp;= $rule-&gt;{oneway} || &#39;&#39;;</td></tr>
<tr><td class="h">14215</td><td><div class="c3">1326</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14215">50</a></div></td><td></td><td></td><td><div>2834</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $stateless = $rule-&gt;{stateless} || &#39;&#39;;</td></tr>
<tr><td class="h">14216</td><td><div class="c3">1326</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14216">50</a></div></td><td></td><td></td><td><div>2864</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $stateless_icmp = $rule-&gt;{stateless_icmp} || &#39;&#39;;</td></tr>
<tr><td class="h">14217</td><td><div class="c3">1326</div></td><td></td><td></td><td></td><td></td><td><div>2230</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attr = &quot;$src_range,$log,$oneway,$stateless,$stateless_icmp&quot;;</td></tr>
<tr><td class="h">14218</td><td><div class="c3">1326</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14218">67</a></div></td><td></td><td></td><td><div>2708</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = $attr2index{$attr} ||= $index++;</td></tr>
<tr><td class="h">14219</td><td><div class="c3">1326</div><div class="c3">1326</div></td><td></td><td></td><td></td><td></td><td><div>965</div><div>2670</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $attr2rules{$key} }, $rule;</td></tr>
<tr><td class="h">14220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14221</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>450</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rules = undef;</td></tr>
<tr><td class="h">14222</td><td colspan="7"></td></tr><tr><td class="h">14223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect grouped rules.</td></tr>
<tr><td class="h">14224</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>567</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $grouped_rules = [];</td></tr>
<tr><td class="h">14225</td><td colspan="7"></td></tr><tr><td class="h">14226</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>1021</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $attr_key (sort numerically keys %attr2rules) {</td></tr>
<tr><td class="h">14227</td><td><div class="c3">472</div></td><td></td><td></td><td></td><td></td><td><div>449</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attr_rules = $attr2rules{$attr_key};</td></tr>
<tr><td class="h">14228</td><td><div class="c3">472</div><div class="c3">472</div></td><td></td><td></td><td></td><td></td><td><div>422</div><div>627</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$grouped_rules, @{ group_rules($attr_rules) };</td></tr>
<tr><td class="h">14229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14230</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>995</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%attr2rules = %attr2index = ();</td></tr>
<tr><td class="h">14231</td><td colspan="7"></td></tr><tr><td class="h">14232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Split grouped rules such, that all elements of src and dst</td></tr>
<tr><td class="h">14233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# have identical src_path/dst_path.</td></tr>
<tr><td class="h">14234</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>491</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $where (&#39;src&#39;, &#39;dst&#39;) {</td></tr>
<tr><td class="h">14235</td><td><div class="c3">820</div></td><td></td><td></td><td></td><td></td><td><div>1042</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $where_path = &quot;${where}_path&quot;;</td></tr>
<tr><td class="h">14236</td><td><div class="c3">820</div></td><td></td><td></td><td></td><td></td><td><div>657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @new_rules;</td></tr>
<tr><td class="h">14237</td><td><div class="c3">820</div></td><td></td><td></td><td></td><td></td><td><div>900</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$grouped_rules) {</td></tr>
<tr><td class="h">14238</td><td><div class="c3">1790</div></td><td></td><td></td><td></td><td></td><td><div>1681</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group = $rule-&gt;{$where};</td></tr>
<tr><td class="h">14239</td><td><div class="c3">1790</div></td><td></td><td></td><td></td><td></td><td><div>1536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $element0 = $group-&gt;[0];</td></tr>
<tr><td class="h">14240</td><td><div class="c3">1790</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14240">67</a></div></td><td></td><td></td><td><div>3850</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path0 = $obj2path{$element0} || get_path($element0);</td></tr>
<tr><td class="h">14241</td><td colspan="7"></td></tr><tr><td class="h">14242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Group has elements from different zones and must be split.</td></tr>
<tr><td class="h">14243</td><td><div class="c3">1790</div><div class="c3">2128</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14243">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14243">67</a></div></td><td></td><td></td><td><div>1825</div><div>6951</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $path0 ne ($obj2path{$_} || get_path($_)) } @$group)</td></tr>
<tr><td class="h">14244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14245</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $index = 1;</td></tr>
<tr><td class="h">14246</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %path2index;</td></tr>
<tr><td class="h">14247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %key2group;</td></tr>
<tr><td class="h">14248</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $element (@$group) {</td></tr>
<tr><td class="h">14249</td><td><div class="c3">298</div></td><td></td><td></td><td></td><td></td><td><div>370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path = $obj2path{$element};</td></tr>
<tr><td class="h">14250</td><td><div class="c3">298</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14250">67</a></div></td><td></td><td></td><td><div>848</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key&nbsp;&nbsp;= $path2index{$path} ||= $index++;</td></tr>
<tr><td class="h">14251</td><td><div class="c3">298</div><div class="c3">298</div></td><td></td><td></td><td></td><td></td><td><div>245</div><div>635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $key2group{$key}}, $element;</td></tr>
<tr><td class="h">14252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14253</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>397</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort numerically keys %key2group) {</td></tr>
<tr><td class="h">14254</td><td><div class="c3">282</div></td><td></td><td></td><td></td><td></td><td><div>268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path_group = $key2group{$key};</td></tr>
<tr><td class="h">14255</td><td><div class="c3">282</div></td><td></td><td></td><td></td><td></td><td><div>389</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path = $obj2path{$path_group-&gt;[0]};</td></tr>
<tr><td class="h">14256</td><td><div class="c3">282</div></td><td></td><td></td><td></td><td></td><td><div>993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_rule = { %$rule,</td></tr>
<tr><td class="h">14257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$where&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $path_group,</td></tr>
<tr><td class="h">14258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$where_path =&gt; $path };</td></tr>
<tr><td class="h">14259</td><td><div class="c3">282</div></td><td></td><td></td><td></td><td></td><td><div>709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @new_rules, $new_rule;</td></tr>
<tr><td class="h">14260</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14262</td><td colspan="7"></td></tr><tr><td class="h">14263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use unchanged group, add path info.</td></tr>
<tr><td class="h">14264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14265</td><td><div class="c3">1668</div></td><td></td><td></td><td></td><td></td><td><div>1815</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{$where_path} = $path0;</td></tr>
<tr><td class="h">14266</td><td><div class="c3">1668</div></td><td></td><td></td><td></td><td></td><td><div>2833</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @new_rules, $rule;</td></tr>
<tr><td class="h">14267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14269</td><td><div class="c3">820</div></td><td></td><td></td><td></td><td></td><td><div>1513</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouped_rules = \@new_rules;</td></tr>
<tr><td class="h">14270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14271</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>545</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$grouped_rules{$action} = $grouped_rules;</td></tr>
<tr><td class="h">14272</td><td><div class="c3">410</div></td><td></td><td></td><td></td><td></td><td><div>712</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count += @$grouped_rules;</td></tr>
<tr><td class="h">14273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14274</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>1291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info(&quot;Grouped rule count: $count&quot;);</td></tr>
<tr><td class="h">14275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14276</td><td colspan="7"></td></tr><tr><td class="h">14277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">14278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Prepare NAT commands</td></tr>
<tr><td class="h">14279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">14280</td><td colspan="7"></td></tr><tr><td class="h">14281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect devices which need NAT commands.</td></tr>
<tr><td class="h">14282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub collect_nat_path {</td></tr>
<tr><td class="h">14283</td><td><div class="c3">1710</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14283">1710</a></div></td><td><div class="c0">0</div></td><td><div>1512</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">14284</td><td colspan="7"></td></tr><tr><td class="h">14285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No NAT needed for directly attached interface.</td></tr>
<tr><td class="h">14286</td><td><div class="c3">1710</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14286">100</a></div></td><td></td><td></td><td></td><td><div>2434</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $out_intf;</td></tr>
<tr><td class="h">14287</td><td colspan="7"></td></tr><tr><td class="h">14288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No NAT needed for traffic originating from the device itself.</td></tr>
<tr><td class="h">14289</td><td><div class="c3">1576</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14289">100</a></div></td><td></td><td></td><td></td><td><div>2100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $in_intf;</td></tr>
<tr><td class="h">14290</td><td colspan="7"></td></tr><tr><td class="h">14291</td><td><div class="c3">1518</div></td><td></td><td></td><td></td><td></td><td><div>1314</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $out_intf-&gt;{router};</td></tr>
<tr><td class="h">14292</td><td><div class="c3">1518</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14292">100</a></div></td><td></td><td></td><td></td><td><div>2223</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $router-&gt;{managed};</td></tr>
<tr><td class="h">14293</td><td><div class="c3">1482</div></td><td></td><td></td><td></td><td></td><td><div>1558</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">14294</td><td><div class="c3">1482</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14294">100</a></div></td><td></td><td></td><td></td><td><div>2931</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $model-&gt;{has_interface_level};</td></tr>
<tr><td class="h">14295</td><td colspan="7"></td></tr><tr><td class="h">14296</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>13</div><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $rule-&gt;{nat_path} }, [ $in_intf, $out_intf ];</td></tr>
<tr><td class="h">14297</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14299</td><td colspan="7"></td></tr><tr><td class="h">14300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Distribute networks needing NAT commands to device.</td></tr>
<tr><td class="h">14301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub distribute_nat_to_device {</td></tr>
<tr><td class="h">14302</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14302">16</a></div></td><td><div class="c0">0</div></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($pair, $src_net, $dst_net) = @_;</td></tr>
<tr><td class="h">14303</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($in_intf, $out_intf) = @$pair;</td></tr>
<tr><td class="h">14304</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $out_intf-&gt;{router};</td></tr>
<tr><td class="h">14305</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">14306</td><td colspan="7"></td></tr><tr><td class="h">14307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# We need in_hw and out_hw for</td></tr>
<tr><td class="h">14308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - attaching attribute src_nat and</td></tr>
<tr><td class="h">14309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - getting the NAT tag.</td></tr>
<tr><td class="h">14310</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $in_hw&nbsp;&nbsp;= $in_intf-&gt;{hardware};</td></tr>
<tr><td class="h">14311</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $out_hw = $out_intf-&gt;{hardware};</td></tr>
<tr><td class="h">14312</td><td colspan="7"></td></tr><tr><td class="h">14313</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $identity_nat = $model-&gt;{need_identity_nat};</td></tr>
<tr><td class="h">14314</td><td><div class="c3">16</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14314">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14314">0</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($identity_nat) {</td></tr>
<tr><td class="h">14315</td><td colspan="7"></td></tr><tr><td class="h">14316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Static dst NAT is equivalent to reversed src NAT.</td></tr>
<tr><td class="h">14317</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst (@$dst_net) {</td></tr>
<tr><td class="h">14318</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_hw-&gt;{src_nat}-&gt;{$in_hw}-&gt;{$dst} = $dst;</td></tr>
<tr><td class="h">14319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14320</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14320">100</a></div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($in_hw-&gt;{level} &gt; $out_hw-&gt;{level}) {</td></tr>
<tr><td class="h">14321</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_hw-&gt;{need_nat_0} = 1;</td></tr>
<tr><td class="h">14322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14324</td><td colspan="7"></td></tr><tr><td class="h">14325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Not identity NAT, handle real dst NAT.</td></tr>
<tr><td class="h">14326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $nat_tags = $in_hw-&gt;{bind_nat}) {</td></tr>
<tr><td class="h">14327</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst (@$dst_net) {</td></tr>
<tr><td class="h">14328</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14328">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_info = $dst-&gt;{nat} or next;</td></tr>
<tr><td class="h">14329</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14329">0</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $nat_info-&gt;{$_} } @$nat_tags) or next;</td></tr>
<tr><td class="h">14330</td><td colspan="7"></td></tr><tr><td class="h">14331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store reversed dst NAT for real translation.</td></tr>
<tr><td class="h">14332</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_hw-&gt;{src_nat}-&gt;{$in_hw}-&gt;{$dst} = $dst;</td></tr>
<tr><td class="h">14333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14335</td><td colspan="7"></td></tr><tr><td class="h">14336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle real src NAT.</td></tr>
<tr><td class="h">14337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remember:</td></tr>
<tr><td class="h">14338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# NAT tag for network located behind in_hw is attached to out_hw.</td></tr>
<tr><td class="h">14339</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14339">100</a></div></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nat_tags = $out_hw-&gt;{bind_nat} or return;</td></tr>
<tr><td class="h">14340</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $src (@$src_net) {</td></tr>
<tr><td class="h">14341</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14341">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_info = $src-&gt;{nat} or next;</td></tr>
<tr><td class="h">14342</td><td colspan="7"></td></tr><tr><td class="h">14343</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We can be sure to get a single result.</td></tr>
<tr><td class="h">14344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Binding for different NAT of a single network has been</td></tr>
<tr><td class="h">14345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# rejected in distribute_nat_info.</td></tr>
<tr><td class="h">14346</td><td><div class="c3">2</div><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14346">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14346">50</a></div></td><td></td><td></td><td></td><td><div>3</div><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($nat_net) = map({ $nat_info-&gt;{$_} || () } @$nat_tags) or next;</td></tr>
<tr><td class="h">14347</td><td colspan="7"></td></tr><tr><td class="h">14348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store src NAT for real translation.</td></tr>
<tr><td class="h">14349</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_hw-&gt;{src_nat}-&gt;{$out_hw}-&gt;{$src} = $src;</td></tr>
<tr><td class="h">14350</td><td colspan="7"></td></tr><tr><td class="h">14351</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14351">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($identity_nat) {</td></tr>
<tr><td class="h">14352</td><td colspan="7"></td></tr><tr><td class="h">14353</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check if there is a dynamic NAT of src address from lower</td></tr>
<tr><td class="h">14354</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to higher security level. We need this info to decide,</td></tr>
<tr><td class="h">14355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# if static commands with &quot;identity mapping&quot; and a &quot;nat 0&quot; command</td></tr>
<tr><td class="h">14356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# need to be generated.</td></tr>
<tr><td class="h">14357</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14357">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14357">33</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($nat_net-&gt;{dynamic} and $in_hw-&gt;{level} &lt; $out_hw-&gt;{level}) {</td></tr>
<tr><td class="h">14358</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_hw-&gt;{need_identity_nat} = 1;</td></tr>
<tr><td class="h">14359</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_hw-&gt;{need_nat_0}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">14360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14361</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14363</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14365</td><td colspan="7"></td></tr><tr><td class="h">14366</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_networks {</td></tr>
<tr><td class="h">14367</td><td><div class="c3">32</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14367">32</a></div></td><td><div class="c0">0</div></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($group, $result) = @_;</td></tr>
<tr><td class="h">14368</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$group) {</td></tr>
<tr><td class="h">14369</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">14370</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14370">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14370">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14370">33</a></div></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">14371</td><td><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14371">50</a></div></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">14372</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $networks = $obj-&gt;{networks};</td></tr>
<tr><td class="h">14373</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$result}{@$networks} = @$networks;</td></tr>
<tr><td class="h">14374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14376</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{$obj} = $obj;</td></tr>
<tr><td class="h">14377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39; or $type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">14380</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $obj-&gt;{network};</td></tr>
<tr><td class="h">14381</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{$network} = $network;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">14382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14384</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">14385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14387</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14389</td><td colspan="7"></td></tr><tr><td class="h">14390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub prepare_nat_commands {</td></tr>
<tr><td class="h">14391</td><td><div class="c3">486</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14391">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14391">486</a></div></td><td><div class="c0">0</div></td><td><div>629</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if fast_mode();</td></tr>
<tr><td class="h">14392</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Preparing NAT commands&#39;);</td></tr>
<tr><td class="h">14393</td><td colspan="7"></td></tr><tr><td class="h">14394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Traverse the topology once for each pair of</td></tr>
<tr><td class="h">14395</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# src-(zone/router), dst-(zone/router)</td></tr>
<tr><td class="h">14396</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %zone2zone2info;</td></tr>
<tr><td class="h">14397</td><td><div class="c3">358</div><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>320</div><div>566</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $grouped_rules{permit} }) {</td></tr>
<tr><td class="h">14398</td><td><div class="c3">874</div><div class="c3">874</div></td><td></td><td></td><td></td><td></td><td><div>727</div><div>1166</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src_path, $dst_path) = @{$rule}{qw(src_path dst_path)};</td></tr>
<tr><td class="h">14399</td><td><div class="c3">874</div></td><td></td><td></td><td></td><td></td><td><div>1556</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $info = $zone2zone2info{$src_path}-&gt;{$dst_path};</td></tr>
<tr><td class="h">14400</td><td><div class="c3">874</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14400">100</a></div></td><td></td><td></td><td></td><td><div>1550</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$info) {</td></tr>
<tr><td class="h">14401</td><td><div class="c3">760</div></td><td></td><td></td><td></td><td></td><td><div>1258</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path_walk($rule, \&amp;collect_nat_path, &#39;Router&#39;);</td></tr>
<tr><td class="h">14402</td><td><div class="c3">760</div></td><td></td><td></td><td></td><td></td><td><div>1222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info-&gt;{nat_path} = delete $rule-&gt;{nat_path};</td></tr>
<tr><td class="h">14403</td><td><div class="c3">760</div></td><td></td><td></td><td></td><td></td><td><div>1548</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone2zone2info{$src_path}-&gt;{$dst_path} = $info;</td></tr>
<tr><td class="h">14404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14405</td><td colspan="7"></td></tr><tr><td class="h">14406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect networks only if path has some NAT device.</td></tr>
<tr><td class="h">14407</td><td><div class="c3">874</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14407">100</a></div></td><td></td><td></td><td></td><td><div>1913</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($info-&gt;{nat_path}) {</td></tr>
<tr><td class="h">14408</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst) = @{$rule}{qw(src dst)};</td></tr>
<tr><td class="h">14409</td><td><div class="c3">16</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14409">100</a></div></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_net = $info-&gt;{src_net} ||= {};</td></tr>
<tr><td class="h">14410</td><td><div class="c3">16</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14410">100</a></div></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_net = $info-&gt;{dst_net} ||= {};</td></tr>
<tr><td class="h">14411</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_networks($src, $src_net);</td></tr>
<tr><td class="h">14412</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_networks($dst, $dst_net);</td></tr>
<tr><td class="h">14413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14415</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>624</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hash (values %zone2zone2info) {</td></tr>
<tr><td class="h">14416</td><td><div class="c3">652</div></td><td></td><td></td><td></td><td></td><td><div>932</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $info (values %$hash) {</td></tr>
<tr><td class="h">14417</td><td><div class="c3">760</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14417">100</a></div></td><td></td><td></td><td></td><td><div>1845</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_path = $info-&gt;{nat_path} or next;</td></tr>
<tr><td class="h">14418</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>9</div><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_net&nbsp;&nbsp;= [ values %{ $info-&gt;{src_net} } ];</td></tr>
<tr><td class="h">14419</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_net&nbsp;&nbsp;= [ values %{ $info-&gt;{dst_net} } ];</td></tr>
<tr><td class="h">14420</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (@$nat_path) {</td></tr>
<tr><td class="h">14421</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribute_nat_to_device($pair, $src_net, $dst_net);</td></tr>
<tr><td class="h">14422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14425</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>888</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14427</td><td colspan="7"></td></tr><tr><td class="h">14428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">14429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Routing</td></tr>
<tr><td class="h">14430</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">########################################################################</td></tr>
<tr><td class="h">14431</td><td colspan="7"></td></tr><tr><td class="h">14432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">14433</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># TODO: Add standard function comment.</td></tr>
<tr><td class="h">14434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Get networks for routing.</td></tr>
<tr><td class="h">14435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Add largest supernet inside the zone, if available.</td></tr>
<tr><td class="h">14436</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This is needed, because we use the supernet in</td></tr>
<tr><td class="h">14437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># secondary optimization too.</td></tr>
<tr><td class="h">14438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Moreover this reduces the number of routing entries.</td></tr>
<tr><td class="h">14439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># It isn&#39;t sufficient to solely use the supernet because network and supernet</td></tr>
<tr><td class="h">14440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># can have different next hops at end of path.</td></tr>
<tr><td class="h">14441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># For an aggregate, take all matching networks inside the zone.</td></tr>
<tr><td class="h">14442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># These are supernets by design.</td></tr>
<tr><td class="h">14443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_route_networks {</td></tr>
<tr><td class="h">14444</td><td><div class="c3">1932</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14444">1932</a></div></td><td><div class="c0">0</div></td><td><div>1610</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($list) = @_;</td></tr>
<tr><td class="h">14445</td><td><div class="c3">1932</div></td><td></td><td></td><td></td><td></td><td><div>1425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">14446</td><td><div class="c3">1932</div></td><td></td><td></td><td></td><td></td><td><div>2296</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$list) {</td></tr>
<tr><td class="h">14447</td><td><div class="c3">2102</div></td><td></td><td></td><td></td><td></td><td><div>1979</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">14448</td><td><div class="c3">2102</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14448">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14448">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14448">67</a></div></td><td></td><td></td><td><div>3581</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">14449</td><td><div class="c3">1546</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14449">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14449">100</a></div></td><td></td><td></td><td></td><td><div>2689</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{is_aggregate}) {</td></tr>
<tr><td class="h">14450</td><td><div class="c3">196</div><div class="c3">196</div></td><td></td><td></td><td></td><td></td><td><div>168</div><div>440</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, @{ $obj-&gt;{networks} };</td></tr>
<tr><td class="h">14451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $max = $obj-&gt;{max_routing_net}) {</td></tr>
<tr><td class="h">14453</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $max, $obj;</td></tr>
<tr><td class="h">14454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14456</td><td><div class="c3">1326</div></td><td></td><td></td><td></td><td></td><td><div>2315</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $obj;</td></tr>
<tr><td class="h">14457</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39; or $type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">14460</td><td><div class="c3">556</div></td><td></td><td></td><td></td><td></td><td><div>523</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net = $obj-&gt;{network};</td></tr>
<tr><td class="h">14461</td><td><div class="c3">556</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14461">100</a></div></td><td></td><td></td><td></td><td><div>748</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $max = $net-&gt;{max_routing_net}) {</td></tr>
<tr><td class="h">14462</td><td><div class="c3">56</div></td><td></td><td></td><td></td><td></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $max, $net;</td></tr>
<tr><td class="h">14463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14465</td><td><div class="c3">500</div></td><td></td><td></td><td></td><td></td><td><div>896</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $net;</td></tr>
<tr><td class="h">14466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14469</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">14470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14472</td><td><div class="c3">1932</div></td><td></td><td></td><td></td><td></td><td><div>2546</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \@result;</td></tr>
<tr><td class="h">14473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14474</td><td colspan="7"></td></tr><tr><td class="h">14475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">14476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Provide routing information inside a security zone.</td></tr>
<tr><td class="h">14477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $zone - a zone object.</td></tr>
<tr><td class="h">14478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;&nbsp;: Every zone border interface I contains a hash attribute</td></tr>
<tr><td class="h">14479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{route_in_zone}, keeping the zones networks N reachable from I as</td></tr>
<tr><td class="h">14480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys and the next hop interface H towards N as values.</td></tr>
<tr><td class="h">14481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comments&nbsp;&nbsp;&nbsp;: A cluster is a maximal set of connected networks of the security</td></tr>
<tr><td class="h">14482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone surrounded by hop interfaces. Clusters can be empty.</td></tr>
<tr><td class="h">14483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optimization: a default route I-&gt;{route_in_zone}-&gt;{default} = [H]</td></tr>
<tr><td class="h">14484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is stored for those border interfaces, that reach networks in </td></tr>
<tr><td class="h">14485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zone via a single hop.</td></tr>
<tr><td class="h">14486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_routes_in_zone {</td></tr>
<tr><td class="h">14487</td><td><div class="c3">1624</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14487">1624</a></div></td><td><div class="c0">0</div></td><td><div>1675</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($zone) = @_;</td></tr>
<tr><td class="h">14488</td><td colspan="7"></td></tr><tr><td class="h">14489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect networks at zone border and next hop interfaces in lookup hashes.</td></tr>
<tr><td class="h">14490</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %border_networks;</td></tr>
<tr><td class="h">14491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hop_interfaces;</td></tr>
<tr><td class="h">14492</td><td colspan="7"></td></tr><tr><td class="h">14493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect networks at the zones interfaces as border networks.</td></tr>
<tr><td class="h">14494</td><td><div class="c3">1624</div><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1203</div><div>2107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_interface (@{ $zone-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">14495</td><td><div class="c3">2712</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14495">100</a></div></td><td></td><td></td><td></td><td><div>3936</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">14496</td><td><div class="c3">2628</div></td><td></td><td></td><td></td><td></td><td><div>2261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $in_interface-&gt;{network};</td></tr>
<tr><td class="h">14497</td><td><div class="c3">2628</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14497">100</a></div></td><td></td><td></td><td></td><td><div>4904</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $border_networks{$network};</td></tr>
<tr><td class="h">14498</td><td><div class="c3">2034</div></td><td></td><td></td><td></td><td></td><td><div>2618</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$border_networks{$network} = $network;</td></tr>
<tr><td class="h">14499</td><td colspan="7"></td></tr><tr><td class="h">14500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect non border interfaces of the networks as next hop interfaces.</td></tr>
<tr><td class="h">14501</td><td><div class="c3">2034</div><div class="c3">2034</div></td><td></td><td></td><td></td><td></td><td><div>1504</div><div>2408</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_interface (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">14502</td><td><div class="c3">3330</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14502">100</a></div></td><td></td><td></td><td></td><td><div>7174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{zone};</td></tr>
<tr><td class="h">14503</td><td><div class="c3">618</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14503">100</a></div></td><td></td><td></td><td></td><td><div>863</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_interface-&gt;{main_interface};</td></tr>
<tr><td class="h">14504</td><td><div class="c3">614</div></td><td></td><td></td><td></td><td></td><td><div>1046</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop_interfaces{$out_interface} = $out_interface;</td></tr>
<tr><td class="h">14505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14507</td><td><div class="c3">1624</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14507">100</a></div></td><td></td><td></td><td></td><td><div>3887</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not keys %hop_interfaces;</td></tr>
<tr><td class="h">14508</td><td colspan="7"></td></tr><tr><td class="h">14509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Zone preprocessing: define set of networks surrounded by hop IFs (cluster)</td></tr>
<tr><td class="h">14510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# via depth first search to accelerate later DFS runs starting at hop IFs.</td></tr>
<tr><td class="h">14511</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hop2cluster; # Store hop IFs as key and reached clusters as values.</td></tr>
<tr><td class="h">14512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %cluster2borders; # Store directly linked border networks for clusters.</td></tr>
<tr><td class="h">14513</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $set_cluster;</td></tr>
<tr><td class="h">14514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$set_cluster = sub {</td></tr>
<tr><td class="h">14515</td><td><div class="c3">256</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14515">256</a></div></td><td></td><td><div>264</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $in_intf, $cluster) = @_;</td></tr>
<tr><td class="h">14516</td><td><div class="c3">256</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14516">100</a></div></td><td></td><td></td><td></td><td><div>458</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $router-&gt;{active_path};</td></tr>
<tr><td class="h">14517</td><td><div class="c3">242</div></td><td></td><td></td><td></td><td></td><td><div>333</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $router-&gt;{active_path} = 1;</td></tr>
<tr><td class="h">14518</td><td colspan="7"></td></tr><tr><td class="h">14519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Process every interface.</td></tr>
<tr><td class="h">14520</td><td><div class="c3">242</div><div class="c3">242</div></td><td></td><td></td><td></td><td></td><td><div>205</div><div>322</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">14521</td><td><div class="c3">1004</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14521">100</a></div></td><td></td><td></td><td></td><td><div>1369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">14522</td><td colspan="7"></td></tr><tr><td class="h">14523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Found hop interface. Add its entries on the fly and skip.</td></tr>
<tr><td class="h">14524</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14524">100</a></div></td><td></td><td></td><td></td><td><div>1655</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hop_interfaces{$interface}) {</td></tr>
<tr><td class="h">14525</td><td><div class="c3">614</div></td><td></td><td></td><td></td><td></td><td><div>750</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop2cluster{$interface} = $cluster; </td></tr>
<tr><td class="h">14526</td><td><div class="c3">614</div></td><td></td><td></td><td></td><td></td><td><div>539</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">14527</td><td><div class="c3">614</div></td><td></td><td></td><td></td><td></td><td><div>1068</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cluster2borders{$cluster}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14528</td><td><div class="c3">614</div></td><td></td><td></td><td></td><td></td><td><div>927</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">14529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14530</td><td><div class="c3">366</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14530">100</a></div></td><td></td><td></td><td></td><td><div>764</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $in_intf;</td></tr>
<tr><td class="h">14531</td><td colspan="7"></td></tr><tr><td class="h">14532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add network behind interface to cluster.</td></tr>
<tr><td class="h">14533</td><td><div class="c3">310</div></td><td></td><td></td><td></td><td></td><td><div>328</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">14534</td><td><div class="c3">310</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14534">100</a></div></td><td></td><td></td><td></td><td><div>525</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $cluster-&gt;{$network};</td></tr>
<tr><td class="h">14535</td><td><div class="c3">296</div></td><td></td><td></td><td></td><td></td><td><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cluster-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14536</td><td colspan="7"></td></tr><tr><td class="h">14537</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Recursively proceed with adjacent routers. </td></tr>
<tr><td class="h">14538</td><td><div class="c3">296</div><div class="c3">296</div></td><td></td><td></td><td></td><td></td><td><div>239</div><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $network-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">14539</td><td><div class="c3">386</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14539">100</a></div></td><td></td><td></td><td></td><td><div>1109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $interface;</td></tr>
<tr><td class="h">14540</td><td><div class="c3">90</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14540">100</a></div></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf-&gt;{main_interface};</td></tr>
<tr><td class="h">14541</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$set_cluster-&gt;($out_intf-&gt;{router}, $out_intf, $cluster);</td></tr>
<tr><td class="h">14542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14544</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>645</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">14545</td><td colspan="7"></td></tr><tr><td class="h">14546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Identify network cluster for every hop interface.</td></tr>
<tr><td class="h">14547</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>278</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (values %hop_interfaces) {</td></tr>
<tr><td class="h">14548</td><td><div class="c3">614</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14548">100</a></div></td><td></td><td></td><td></td><td><div>1126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hop2cluster{$interface}; # Hop interface was processed before. </td></tr>
<tr><td class="h">14549</td><td><div class="c3">186</div></td><td></td><td></td><td></td><td></td><td><div>195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = {};</td></tr>
<tr><td class="h">14550</td><td><div class="c3">186</div></td><td></td><td></td><td></td><td></td><td><div>310</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$set_cluster-&gt;($interface-&gt;{router}, $interface, $cluster);</td></tr>
<tr><td class="h">14551</td><td colspan="7"></td></tr><tr><td class="h">14552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Cluster: $interface-&gt;{name} &quot;,</td></tr>
<tr><td class="h">14553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join &#39;,&#39;, map {$_-&gt;{name}} values %$cluster);</td></tr>
<tr><td class="h">14554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14555</td><td colspan="7"></td></tr><tr><td class="h">14556</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Perform depth first search to collect all networks behind a hop interface.</td></tr>
<tr><td class="h">14557</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hop2networks; # Hash to store the collected sets. </td></tr>
<tr><td class="h">14558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $set_networks_behind;</td></tr>
<tr><td class="h">14559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$set_networks_behind = sub {</td></tr>
<tr><td class="h">14560</td><td><div class="c3">30</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14560">30</a></div></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($hop, $in_border) = @_;</td></tr>
<tr><td class="h">14561</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14561">100</a></div></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $hop2networks{$hop}; # Hop IF network set is known already.&nbsp;&nbsp;</td></tr>
<tr><td class="h">14562</td><td colspan="7"></td></tr><tr><td class="h">14563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Optimization: add networks of directly attached cluster.</td></tr>
<tr><td class="h">14564</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cluster = $hop2cluster{$hop};</td></tr>
<tr><td class="h">14565</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @result = values %$cluster; # Spare multiple processing of branches.</td></tr>
<tr><td class="h">14566</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop2networks{$hop} = \@result;</td></tr>
<tr><td class="h">14567</td><td colspan="7"></td></tr><tr><td class="h">14568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Proceed depth first search with adjacent border networks.</td></tr>
<tr><td class="h">14569</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>18</div><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $border (values %{ $cluster2borders{$cluster} }) {</td></tr>
<tr><td class="h">14570</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14570">100</a></div></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $border eq $in_border;</td></tr>
<tr><td class="h">14571</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $border; # Add reachable border networks to set.</td></tr>
<tr><td class="h">14572</td><td colspan="7"></td></tr><tr><td class="h">14573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add cluster members of clusters reachable via border networks:</td></tr>
<tr><td class="h">14574</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_hop (@{ $border-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">14575</td><td><div class="c3">32</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14575">100</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $hop_interfaces{$out_hop};</td></tr>
<tr><td class="h">14576</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14576">100</a></div></td><td></td><td></td><td></td><td><div>60</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hop2cluster{$out_hop} eq $cluster;</td></tr>
<tr><td class="h">14577</td><td colspan="7"></td></tr><tr><td class="h">14578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create hop2networks entry for reachable hops and add networks</td></tr>
<tr><td class="h">14579</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$set_networks_behind-&gt;($out_hop, $border);</td></tr>
<tr><td class="h">14580</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>10</div><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, @{ $hop2networks{$out_hop} };</td></tr>
<tr><td class="h">14581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Keep every found network only once per result set.</td></tr>
<tr><td class="h">14584</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop2networks{$hop} = [ unique @result ];</td></tr>
<tr><td class="h">14585</td><td colspan="7"></td></tr><tr><td class="h">14586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;Hop: $hop-&gt;{name} &quot;, join &#39;,&#39;, map {$_-&gt;{name}} @result);</td></tr>
<tr><td class="h">14587</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>605</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">14588</td><td colspan="7"></td></tr><tr><td class="h">14589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# In every border IF, store reachable networks and corresponding hop IF.</td></tr>
<tr><td class="h">14590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process every border network.</td></tr>
<tr><td class="h">14591</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $border (values %border_networks) {</td></tr>
<tr><td class="h">14592</td><td><div class="c3">602</div></td><td></td><td></td><td></td><td></td><td><div>713</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @border_intf;</td></tr>
<tr><td class="h">14593</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @hop_intf;</td></tr>
<tr><td class="h">14594</td><td colspan="7"></td></tr><tr><td class="h">14595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect border and hop interfaces of the current border network.</td></tr>
<tr><td class="h">14596</td><td><div class="c3">602</div><div class="c3">602</div></td><td></td><td></td><td></td><td></td><td><div>461</div><div>1030</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $border-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">14597</td><td><div class="c3">1226</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14597">100</a></div></td><td></td><td></td><td></td><td><div>1732</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{main_interface};</td></tr>
<tr><td class="h">14598</td><td><div class="c3">1222</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14598">100</a></div></td><td></td><td></td><td></td><td><div>1447</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{zone}) {</td></tr>
<tr><td class="h">14599</td><td><div class="c3">608</div></td><td></td><td></td><td></td><td></td><td><div>826</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @border_intf, $interface;</td></tr>
<tr><td class="h">14600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14602</td><td><div class="c3">614</div></td><td></td><td></td><td></td><td></td><td><div>747</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hop_intf, $interface;</td></tr>
<tr><td class="h">14603</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14605</td><td colspan="7"></td></tr><tr><td class="h">14606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Optimization: All networks in zone are located behind single hop:</td></tr>
<tr><td class="h">14607</td><td><div class="c3">602</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14607">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14607">100</a></div></td><td></td><td></td><td><div>1167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (1 == @hop_intf or is_redundany_group(\@hop_intf)) {</td></tr>
<tr><td class="h">14608</td><td><div class="c3">594</div></td><td></td><td></td><td></td><td></td><td><div>551</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@border_intf) {</td></tr>
<tr><td class="h">14609</td><td colspan="7"></td></tr><tr><td class="h">14610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Spare reachable network specification.</td></tr>
<tr><td class="h">14611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# debug(&quot;Default hop $interface-&gt;{name} &quot;,</td></tr>
<tr><td class="h">14612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39;,&#39;, map {$_-&gt;{name}} @hop_intf));</td></tr>
<tr><td class="h">14613</td><td><div class="c3">600</div></td><td></td><td></td><td></td><td></td><td><div>1213</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{route_in_zone}-&gt;{default} = \@hop_intf;</td></tr>
<tr><td class="h">14614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14615</td><td><div class="c3">594</div></td><td></td><td></td><td></td><td></td><td><div>783</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next; # Proceed with next border network.</td></tr>
<tr><td class="h">14616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14617</td><td colspan="7"></td></tr><tr><td class="h">14618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For every hop IF of current network, gather reachable network set.</td></tr>
<tr><td class="h">14619</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@hop_intf) {</td></tr>
<tr><td class="h">14620</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$set_networks_behind-&gt;($hop, $border);</td></tr>
<tr><td class="h">14621</td><td colspan="7"></td></tr><tr><td class="h">14622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# In border IF of current network, store reachable networks and hops</td></tr>
<tr><td class="h">14623</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@border_intf) {</td></tr>
<tr><td class="h">14624</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>13</div><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@{ $hop2networks{$hop} }) {</td></tr>
<tr><td class="h">14625</td><td colspan="7"></td></tr><tr><td class="h">14626</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $border will be found accidently, if clusters</td></tr>
<tr><td class="h">14627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# form a loop inside zone.</td></tr>
<tr><td class="h">14628</td><td><div class="c3">46</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14628">100</a></div></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network eq $border;</td></tr>
<tr><td class="h">14629</td><td><div class="c3">38</div><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>31</div><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $interface-&gt;{route_in_zone}-&gt;{$network} }, $hop;</td></tr>
<tr><td class="h">14630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14632</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14634</td><td><div class="c3">180</div></td><td></td><td></td><td></td><td></td><td><div>461</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14636</td><td colspan="7"></td></tr><tr><td class="h">14637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">14638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Gather rule specific routing information at zone border </td></tr>
<tr><td class="h">14639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interfaces: For a pair ($in_intf,$out_intf) of zone border</td></tr>
<tr><td class="h">14640</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interfaces that lies on a path from src to dst, the next hop</td></tr>
<tr><td class="h">14641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interfaces H to reach $out_intf from $in_intf are determined</td></tr>
<tr><td class="h">14642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and stored.</td></tr>
<tr><td class="h">14643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $in_intf - interface zone is entered from.</td></tr>
<tr><td class="h">14644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_intf - interface zone is left at.</td></tr>
<tr><td class="h">14645</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst_networks - destination networks of associated pseudo rule.</td></tr>
<tr><td class="h">14646</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;&nbsp;: $in_intf holds routing information that $dst_networks are</td></tr>
<tr><td class="h">14647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reachable via next hop interface H.</td></tr>
<tr><td class="h">14648</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_path_routes {</td></tr>
<tr><td class="h">14649</td><td><div class="c3">1368</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14649">1368</a></div></td><td><div class="c0">0</div></td><td><div>1137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($in_intf, $out_intf, $dst_networks) = @_;</td></tr>
<tr><td class="h">14650</td><td><div class="c3">1368</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14650">100</a></div></td><td></td><td></td><td></td><td><div>2197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $in_intf-&gt;{routing}; # Interface with manual routing.</td></tr>
<tr><td class="h">14651</td><td colspan="7"></td></tr><tr><td class="h">14652</td><td><div class="c3">1176</div></td><td></td><td></td><td></td><td></td><td><div>1011</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $in_net&nbsp;&nbsp;= $in_intf-&gt;{network};</td></tr>
<tr><td class="h">14653</td><td><div class="c3">1176</div></td><td></td><td></td><td></td><td></td><td><div>948</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $out_net = $out_intf-&gt;{network};</td></tr>
<tr><td class="h">14654</td><td><div class="c3">1176</div></td><td></td><td></td><td></td><td></td><td><div>857</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hops;</td></tr>
<tr><td class="h">14655</td><td colspan="7"></td></tr><tr><td class="h">14656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Identify hop interface(s).</td></tr>
<tr><td class="h">14657</td><td><div class="c3">1176</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14657">100</a></div></td><td></td><td></td><td></td><td><div>1922</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($in_net eq $out_net) {</td></tr>
<tr><td class="h">14658</td><td><div class="c3">360</div></td><td></td><td></td><td></td><td></td><td><div>447</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hops = [$out_intf];</td></tr>
<tr><td class="h">14659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14661</td><td><div class="c3">816</div></td><td></td><td></td><td></td><td></td><td><div>670</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $route_in_zone = $in_intf-&gt;{route_in_zone};</td></tr>
<tr><td class="h">14662</td><td><div class="c3">816</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14662">67</a></div></td><td></td><td></td><td><div>1306</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hops = $route_in_zone-&gt;{default} || $route_in_zone-&gt;{$out_net};</td></tr>
<tr><td class="h">14663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14664</td><td colspan="7"></td></tr><tr><td class="h">14665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Store hop interfaces and routing information within in_intf.</td></tr>
<tr><td class="h">14666</td><td><div class="c3">1176</div></td><td></td><td></td><td></td><td></td><td><div>1202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@$hops) {</td></tr>
<tr><td class="h">14667</td><td><div class="c3">1180</div></td><td></td><td></td><td></td><td></td><td><div>1874</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_intf-&gt;{hopref2obj}-&gt;{$hop} = $hop;</td></tr>
<tr><td class="h">14668</td><td><div class="c3">1180</div></td><td></td><td></td><td></td><td></td><td><div>1115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$dst_networks) {</td></tr>
<tr><td class="h">14669</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$in_intf-&gt;{name} -&gt; $hop-&gt;{name}: $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">14670</td><td><div class="c3">1192</div></td><td></td><td></td><td></td><td></td><td><div>3829</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_intf-&gt;{routes}-&gt;{$hop}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14673</td><td><div class="c3">1176</div></td><td></td><td></td><td></td><td></td><td><div>1677</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14675</td><td colspan="7"></td></tr><tr><td class="h">14676</td><td colspan="7"></td></tr><tr><td class="h">14677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">14678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Generate routing information for a single interface at zone</td></tr>
<tr><td class="h">14679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border. Store next hop interface to every destination network</td></tr>
<tr><td class="h">14680</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inside zone within the given interface object.</td></tr>
<tr><td class="h">14681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $interface - border interface of a zone.</td></tr>
<tr><td class="h">14682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst_networks - destination networks inside the same zone.</td></tr>
<tr><td class="h">14683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;&nbsp;: $interface holds routing entries about which hops to use to </td></tr>
<tr><td class="h">14684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reach the networks specified in $dst_networks. </td></tr>
<tr><td class="h">14685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_end_routes {</td></tr>
<tr><td class="h">14686</td><td><div class="c3">1746</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14686">1746</a></div></td><td><div class="c0">0</div></td><td><div>1518</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $dst_networks) = @_;</td></tr>
<tr><td class="h">14687</td><td><div class="c3">1746</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14687">100</a></div></td><td></td><td></td><td></td><td><div>3009</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $interface-&gt;{routing}; # Interface with manual routing.</td></tr>
<tr><td class="h">14688</td><td><div class="c3">1438</div></td><td></td><td></td><td></td><td></td><td><div>1282</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $intf_net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{network};</td></tr>
<tr><td class="h">14689</td><td><div class="c3">1438</div></td><td></td><td></td><td></td><td></td><td><div>1224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $route_in_zone = $interface-&gt;{route_in_zone};</td></tr>
<tr><td class="h">14690</td><td colspan="7"></td></tr><tr><td class="h">14691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# For every dst network, check the hops that can be used to get there.</td></tr>
<tr><td class="h">14692</td><td><div class="c3">1438</div></td><td></td><td></td><td></td><td></td><td><div>1403</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$dst_networks) {</td></tr>
<tr><td class="h">14693</td><td><div class="c3">1584</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14693">100</a></div></td><td></td><td></td><td></td><td><div>3713</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $network eq $intf_net;</td></tr>
<tr><td class="h">14694</td><td><div class="c3">382</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14694">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14694">67</a></div></td><td></td><td></td><td><div>876</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hops = $route_in_zone-&gt;{default} || $route_in_zone-&gt;{$network}</td></tr>
<tr><td class="h">14695</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Missing route for $network-&gt;{name}&quot;,</td></tr>
<tr><td class="h">14696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $interface-&gt;{name}&quot;);</td></tr>
<tr><td class="h">14697</td><td colspan="7"></td></tr><tr><td class="h">14698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Store the used hops and routes within the interface object. </td></tr>
<tr><td class="h">14699</td><td><div class="c3">382</div></td><td></td><td></td><td></td><td></td><td><div>386</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@$hops) {</td></tr>
<tr><td class="h">14700</td><td><div class="c3">394</div></td><td></td><td></td><td></td><td></td><td><div>589</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hopref2obj}-&gt;{$hop} = $hop;</td></tr>
<tr><td class="h">14701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;$interface-&gt;{name} -&gt; $hop-&gt;{name}: $network-&gt;{name}&quot;);</td></tr>
<tr><td class="h">14702</td><td><div class="c3">394</div></td><td></td><td></td><td></td><td></td><td><div>1188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{routes}-&gt;{$hop}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14705</td><td><div class="c3">1438</div></td><td></td><td></td><td></td><td></td><td><div>2907</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14707</td><td colspan="7"></td></tr><tr><td class="h">14708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">14709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Transfer routing information from interfaces passed on the </td></tr>
<tr><td class="h">14710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;route for a given pseudo rule into the rule object.</td></tr>
<tr><td class="h">14711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $rule - reference of a pseudo rule from routing tree.</td></tr>
<tr><td class="h">14712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_intf - interface the zone is entered from.</td></tr>
<tr><td class="h">14713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_intf -interface the zone is left at.</td></tr>
<tr><td class="h">14714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Comment&nbsp;&nbsp;&nbsp;&nbsp;: path_walk calls this function for each zone on path from src</td></tr>
<tr><td class="h">14715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to dst to create complete route documentation for the path from </td></tr>
<tr><td class="h">14716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src to dst within the rule object.</td></tr>
<tr><td class="h">14717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_route_path {</td></tr>
<tr><td class="h">14718</td><td><div class="c3">2192</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14718">2192</a></div></td><td><div class="c0">0</div></td><td><div>1941</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">14719</td><td colspan="7"></td></tr><tr><td class="h">14720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug(&quot;collect: $rule-&gt;{src}-&gt;{name} -&gt; $rule-&gt;{dst}-&gt;{name}&quot;);</td></tr>
<tr><td class="h">14721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;my $info = &#39;&#39;;</td></tr>
<tr><td class="h">14722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$info .= $in_intf-&gt;{name} if $in_intf;</td></tr>
<tr><td class="h">14723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$info .= &#39; -&gt; &#39;;</td></tr>
<tr><td class="h">14724</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;$info .= $out_intf-&gt;{name} if $out_intf;</td></tr>
<tr><td class="h">14725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;debug($info);</td></tr>
<tr><td class="h">14726</td><td colspan="7"></td></tr><tr><td class="h">14727</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Packets traverse the zone.</td></tr>
<tr><td class="h">14728</td><td><div class="c3">2192</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14728">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14728">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14728">100</a></div></td><td></td><td></td><td><div>5760</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($in_intf and $out_intf) {</td></tr>
<tr><td class="h">14729</td><td><div class="c3">658</div><div class="c3">658</div></td><td></td><td></td><td></td><td></td><td><div>491</div><div>1172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $rule-&gt;{path} }, [ $in_intf, $out_intf ];</td></tr>
<tr><td class="h">14730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14731</td><td colspan="7"></td></tr><tr><td class="h">14732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Zone contains rule source.</td></tr>
<tr><td class="h">14733</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif (not $in_intf) {</td></tr>
<tr><td class="h">14734</td><td><div class="c3">766</div><div class="c3">766</div></td><td></td><td></td><td></td><td></td><td><div>592</div><div>1560</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $rule-&gt;{path_entries} }, $out_intf;</td></tr>
<tr><td class="h">14735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14736</td><td colspan="7"></td></tr><tr><td class="h">14737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Zone contains rule destination.</td></tr>
<tr><td class="h">14738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14739</td><td><div class="c3">768</div><div class="c3">768</div></td><td></td><td></td><td></td><td></td><td><div>595</div><div>1161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $rule-&gt;{path_exits} }, $in_intf;</td></tr>
<tr><td class="h">14740</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14741</td><td><div class="c3">2192</div></td><td></td><td></td><td></td><td></td><td><div>2686</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14743</td><td colspan="7"></td></tr><tr><td class="h">14744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">14745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Add information from single grouped rule to routing tree.</td></tr>
<tr><td class="h">14746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $rule - to be added grouped rule.</td></tr>
<tr><td class="h">14747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_intf - marker: which of src and/or dst is an interface.</td></tr>
<tr><td class="h">14748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$routing_tree - the routing tree.</td></tr>
<tr><td class="h">14749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub generate_routing_tree1 {</td></tr>
<tr><td class="h">14750</td><td><div class="c3">1038</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14750">1038</a></div></td><td><div class="c0">0</div></td><td><div>1027</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $is_intf, $routing_tree) = @_;</td></tr>
<tr><td class="h">14751</td><td colspan="7"></td></tr><tr><td class="h">14752</td><td><div class="c3">1038</div></td><td></td><td></td><td></td><td></td><td><div>1370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst, $src_zone, $dst_zone) =</td></tr>
<tr><td class="h">14753</td><td><div class="c3">1038</div></td><td></td><td></td><td></td><td></td><td><div>880</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$rule}{qw(src dst src_path dst_path)};</td></tr>
<tr><td class="h">14754</td><td colspan="7"></td></tr><tr><td class="h">14755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check, whether</td></tr>
<tr><td class="h">14756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - source interface is located in security zone of destination or</td></tr>
<tr><td class="h">14757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - destination interface is located in security zone of source.</td></tr>
<tr><td class="h">14758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# In this case, path_walk will do nothing.</td></tr>
<tr><td class="h">14759</td><td><div class="c3">1038</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14759">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14759">67</a></div></td><td></td><td></td><td><div>2911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($src_zone eq $dst_zone and $is_intf) {</td></tr>
<tr><td class="h">14760</td><td colspan="7"></td></tr><tr><td class="h">14761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Detect next hop interfaces if src/dst are zone border interfaces.</td></tr>
<tr><td class="h">14762</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>316</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $what (split &#39;,&#39;, $is_intf) {</td></tr>
<tr><td class="h">14763</td><td><div class="c3">212</div></td><td></td><td></td><td></td><td></td><td><div>253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $from = $rule-&gt;{$what}-&gt;[0];</td></tr>
<tr><td class="h">14764</td><td><div class="c3">212</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14764">100</a></div></td><td></td><td></td><td></td><td><div>293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $to = $what eq &#39;src&#39; ? $dst : $src;</td></tr>
<tr><td class="h">14765</td><td><div class="c3">212</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14765">67</a></div></td><td></td><td></td><td><div>529</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from = $from-&gt;{main_interface} || $from;</td></tr>
<tr><td class="h">14766</td><td><div class="c3">212</div></td><td></td><td></td><td></td><td></td><td><div>270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $networks = get_route_networks($to);</td></tr>
<tr><td class="h">14767</td><td><div class="c3">212</div></td><td></td><td></td><td></td><td></td><td><div>263</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_end_routes($from, $networks);</td></tr>
<tr><td class="h">14768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14769</td><td><div class="c3">178</div></td><td></td><td></td><td></td><td></td><td><div>592</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14770</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14771</td><td colspan="7"></td></tr><tr><td class="h">14772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Construct a pseudo rule with zones as src and dst and store it.</td></tr>
<tr><td class="h">14773</td><td><div class="c3">860</div></td><td></td><td></td><td></td><td></td><td><div>633</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pseudo_rule;</td></tr>
<tr><td class="h">14774</td><td colspan="7"></td></tr><tr><td class="h">14775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Check whether pseudo rule for src and dst pair is stored already.</td></tr>
<tr><td class="h">14776</td><td><div class="c3">860</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14776">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14776">100</a></div></td><td></td><td></td><td></td><td><div>2854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($pseudo_rule = $routing_tree-&gt;{$src_zone}-&gt;{$dst_zone}) {</td></tr>
<tr><td class="h">14777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14778</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($pseudo_rule = $routing_tree-&gt;{$dst_zone}-&gt;{$src_zone}) {</td></tr>
<tr><td class="h">14779</td><td><div class="c3">142</div></td><td></td><td></td><td></td><td></td><td><div>164</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($src,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dst)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ($dst,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src);</td></tr>
<tr><td class="h">14780</td><td><div class="c3">142</div></td><td></td><td></td><td></td><td></td><td><div>152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($src_zone, $dst_zone) = ($dst_zone, $src_zone);</td></tr>
<tr><td class="h">14781</td><td colspan="7"></td></tr><tr><td class="h">14782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Change only if set:</td></tr>
<tr><td class="h">14783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# &#39;src&#39; -&gt; &#39;dst, &#39;dst&#39; -&gt; &#39;src&#39;, &#39;src,dst&#39; unchanged.</td></tr>
<tr><td class="h">14784</td><td><div class="c3">142</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14784">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14784">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14784">67</a></div></td><td></td><td></td><td><div>253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_intf &amp;&amp;=</td></tr>
<tr><td class="h">14785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_intf eq &#39;src&#39; ? &#39;dst&#39; : $is_intf eq &#39;dst&#39; ? &#39;src&#39; : $is_intf;</td></tr>
<tr><td class="h">14786</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14787</td><td colspan="7"></td></tr><tr><td class="h">14788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Generate new pseudo rule otherwise.</td></tr>
<tr><td class="h">14789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14790</td><td><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>1490</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pseudo_rule = {</td></tr>
<tr><td class="h">14791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $src_zone,</td></tr>
<tr><td class="h">14792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $dst_zone,</td></tr>
<tr><td class="h">14793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_path =&gt; $src_zone,</td></tr>
<tr><td class="h">14794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_path =&gt; $dst_zone,</td></tr>
<tr><td class="h">14795</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orig_rule =&gt; $rule,</td></tr>
<tr><td class="h">14796</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">14797</td><td><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>1199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$routing_tree-&gt;{$src_zone}-&gt;{$dst_zone} = $pseudo_rule;</td></tr>
<tr><td class="h">14798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14799</td><td colspan="7"></td></tr><tr><td class="h">14800</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Store src and dest networks of grouped rule within pseudo rule.</td></tr>
<tr><td class="h">14801</td><td><div class="c3">860</div></td><td></td><td></td><td></td><td></td><td><div>1076</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $src_networks = get_route_networks($src);</td></tr>
<tr><td class="h">14802</td><td><div class="c3">860</div></td><td></td><td></td><td></td><td></td><td><div>975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$src_networks) {</td></tr>
<tr><td class="h">14803</td><td><div class="c3">982</div></td><td></td><td></td><td></td><td></td><td><div>2449</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pseudo_rule-&gt;{src_networks}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14805</td><td><div class="c3">860</div></td><td></td><td></td><td></td><td></td><td><div>1077</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst_networks = get_route_networks($dst);</td></tr>
<tr><td class="h">14806</td><td><div class="c3">860</div></td><td></td><td></td><td></td><td></td><td><div>937</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@$dst_networks) {</td></tr>
<tr><td class="h">14807</td><td><div class="c3">928</div></td><td></td><td></td><td></td><td></td><td><div>2046</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pseudo_rule-&gt;{dst_networks}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14809</td><td colspan="7"></td></tr><tr><td class="h">14810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If src/dst is interface of managed routers, add this info to</td></tr>
<tr><td class="h">14811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# pseudo rule.</td></tr>
<tr><td class="h">14812</td><td><div class="c3">860</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14812">100</a></div></td><td></td><td></td><td></td><td><div>1386</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($is_intf) {</td></tr>
<tr><td class="h">14813</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>213</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $what (split &#39;,&#39;, $is_intf) {</td></tr>
<tr><td class="h">14814</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14814">100</a></div></td><td></td><td></td><td></td><td><div>229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf = ($what eq &#39;src&#39; ? $src : $dst)-&gt;[0];</td></tr>
<tr><td class="h">14815</td><td colspan="7"></td></tr><tr><td class="h">14816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;${what}_intf: $intf-&gt;{name}&quot;;</td></tr>
<tr><td class="h">14817</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $router = $intf-&gt;{router};</td></tr>
<tr><td class="h">14818</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14818">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14818">100</a></div></td><td></td><td></td><td><div>261</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{managed} or $router-&gt;{routing_only} or next;</td></tr>
<tr><td class="h">14819</td><td><div class="c3">114</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L14819">67</a></div></td><td></td><td></td><td><div>320</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intf = $intf-&gt;{main_interface} || $intf;</td></tr>
<tr><td class="h">14820</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>334</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pseudo_rule-&gt;{&quot;${what}_interfaces&quot;}-&gt;{$intf} = $intf;</td></tr>
<tr><td class="h">14821</td><td><div class="c3">114</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14821">100</a></div></td><td></td><td></td><td></td><td><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network ($what eq &#39;src&#39; ? @$dst_networks : @$src_networks) {</td></tr>
<tr><td class="h">14822</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>496</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pseudo_rule-&gt;{&quot;${what}_intf2nets&quot;}</td></tr>
<tr><td class="h">14823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;{$intf}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">14824</td><td colspan="7"></td></tr><tr><td class="h">14825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;${what}_intf_net: $network-&gt;{name}&quot;;</td></tr>
<tr><td class="h">14826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14827</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14829</td><td><div class="c3">860</div></td><td></td><td></td><td></td><td></td><td><div>2205</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14830</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14831</td><td colspan="7"></td></tr><tr><td class="h">14832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">14833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose : Generate the routing tree, holding pseudo rules that represent </td></tr>
<tr><td class="h">14834</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the whole grouped rule set. As the pseudo rules are</td></tr>
<tr><td class="h">14835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generated to determine routes, ports are omitted, and rules</td></tr>
<tr><td class="h">14836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refering to the same src and dst zones are summarized.</td></tr>
<tr><td class="h">14837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns : A reference to the generated routing tree.</td></tr>
<tr><td class="h">14838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub generate_routing_tree {</td></tr>
<tr><td class="h">14839</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14839">486</a></div></td><td><div class="c0">0</div></td><td><div>548</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $routing_tree = {};</td></tr>
<tr><td class="h">14840</td><td colspan="7"></td></tr><tr><td class="h">14841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Special handling needed for rules grouped not at zone pairs but</td></tr>
<tr><td class="h">14842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# grouped at routers.</td></tr>
<tr><td class="h">14843</td><td><div class="c3">486</div><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>426</div><div>721</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $grouped_rules{permit} }) {</td></tr>
<tr><td class="h">14844</td><td colspan="7"></td></tr><tr><td class="h">14845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug print_rule $rule;</td></tr>
<tr><td class="h">14846</td><td><div class="c3">1026</div></td><td></td><td></td><td></td><td></td><td><div>1514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($src, $dst, $src_path, $dst_path) =</td></tr>
<tr><td class="h">14847</td><td><div class="c3">1026</div></td><td></td><td></td><td></td><td></td><td><div>868</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$rule}{qw(src dst src_path dst_path)};</td></tr>
<tr><td class="h">14848</td><td><div class="c3">1026</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14848">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14848">100</a></div></td><td></td><td></td><td></td><td><div>1338</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_zone($src_path)) {</td></tr>
<tr><td class="h">14849</td><td colspan="7"></td></tr><tr><td class="h">14850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Common case, process directly.</td></tr>
<tr><td class="h">14851</td><td><div class="c3">900</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14851">100</a></div></td><td></td><td></td><td></td><td><div>989</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_zone($dst_path)) {</td></tr>
<tr><td class="h">14852</td><td><div class="c3">744</div></td><td></td><td></td><td></td><td></td><td><div>952</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generate_routing_tree1($rule, &#39;&#39;, $routing_tree);</td></tr>
<tr><td class="h">14853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14854</td><td colspan="7"></td></tr><tr><td class="h">14855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Split group of destination interfaces, one for each zone.</td></tr>
<tr><td class="h">14856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14857</td><td><div class="c3">156</div></td><td></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$dst) {</td></tr>
<tr><td class="h">14858</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>453</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $split_rule = { src =&gt; $src,</td></tr>
<tr><td class="h">14859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $interface ],</td></tr>
<tr><td class="h">14860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_path =&gt; $src_path,</td></tr>
<tr><td class="h">14861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_path =&gt; $interface-&gt;{zone}, };</td></tr>
<tr><td class="h">14862</td><td><div class="c3">166</div></td><td></td><td></td><td></td><td></td><td><div>243</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generate_routing_tree1($split_rule, &#39;dst&#39;,$routing_tree);</td></tr>
<tr><td class="h">14863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_zone($dst_path)) {</td></tr>
<tr><td class="h">14867</td><td><div class="c3">92</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@$src) {</td></tr>
<tr><td class="h">14868</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>256</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $split_rule = { src =&gt; [ $interface ],</td></tr>
<tr><td class="h">14869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; $dst,</td></tr>
<tr><td class="h">14870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_path =&gt; $interface-&gt;{zone},</td></tr>
<tr><td class="h">14871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_path =&gt; $dst_path, };</td></tr>
<tr><td class="h">14872</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generate_routing_tree1($split_rule, &#39;src&#39;, $routing_tree);</td></tr>
<tr><td class="h">14873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">14876</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src_intf (@$src) {</td></tr>
<tr><td class="h">14877</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst_intf (@$dst) {</td></tr>
<tr><td class="h">14878</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $split_rule = { src =&gt; [ $src_intf ],</td></tr>
<tr><td class="h">14879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $dst_intf ],</td></tr>
<tr><td class="h">14880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_path =&gt; $src_intf-&gt;{zone},</td></tr>
<tr><td class="h">14881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_path =&gt; $dst_intf-&gt;{zone}, };</td></tr>
<tr><td class="h">14882</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generate_routing_tree1($split_rule, &#39;src,dst&#39;,$routing_tree);</td></tr>
<tr><td class="h">14883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14885</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14887</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>604</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $routing_tree;</td></tr>
<tr><td class="h">14888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14889</td><td colspan="7"></td></tr><tr><td class="h">14890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">14891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;&nbsp;&nbsp;: Generate routing information for every (source,destination)</td></tr>
<tr><td class="h">14892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pair of the ruleset and store it in the affected interfaces.</td></tr>
<tr><td class="h">14893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters : $routing_tree - a pseudo rule set.</td></tr>
<tr><td class="h">14894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Results&nbsp;&nbsp;&nbsp;&nbsp;: Every interface object holds next hop routing information</td></tr>
<tr><td class="h">14895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for the rules of original ruleset requiring a path passing the </td></tr>
<tr><td class="h">14896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface.&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">14897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub generate_routing_info {</td></tr>
<tr><td class="h">14898</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14898">486</a></div></td><td><div class="c0">0</div></td><td><div>465</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($routing_tree) = @_;</td></tr>
<tr><td class="h">14899</td><td colspan="7"></td></tr><tr><td class="h">14900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Process every pseudo rule. Within its {path} atrribute....</td></tr>
<tr><td class="h">14901</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>884</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $href (values %$routing_tree) {</td></tr>
<tr><td class="h">14902</td><td><div class="c3">1108</div></td><td></td><td></td><td></td><td></td><td><div>1887</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $pseudo_rule (values %$href) {</td></tr>
<tr><td class="h">14903</td><td colspan="7"></td></tr><tr><td class="h">14904</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# store a pair (in_interface, exit_interface) for every passed zone.</td></tr>
<tr><td class="h">14905</td><td><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>1014</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path_walk($pseudo_rule, \&amp;get_route_path, &#39;Zone&#39;);</td></tr>
<tr><td class="h">14906</td><td colspan="7"></td></tr><tr><td class="h">14907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Extract sources and destinations from pseudo rule.</td></tr>
<tr><td class="h">14908</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>494</div><div>1304</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_networks&nbsp;&nbsp;&nbsp;= [ values %{ $pseudo_rule-&gt;{src_networks} } ];</td></tr>
<tr><td class="h">14909</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>548</div><div>1045</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_networks&nbsp;&nbsp;&nbsp;= [ values %{ $pseudo_rule-&gt;{dst_networks} } ];</td></tr>
<tr><td class="h">14910</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>542</div><div>1083</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @src_interfaces = values %{ $pseudo_rule-&gt;{src_interfaces} };</td></tr>
<tr><td class="h">14911</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>520</div><div>931</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @dst_interfaces = values %{ $pseudo_rule-&gt;{dst_interfaces} };</td></tr>
<tr><td class="h">14912</td><td colspan="7"></td></tr><tr><td class="h">14913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Determine routing information for every interface pair.</td></tr>
<tr><td class="h">14914</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>526</div><div>908</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tuple (@{ $pseudo_rule-&gt;{path} }) {</td></tr>
<tr><td class="h">14915</td><td><div class="c3">658</div></td><td></td><td></td><td></td><td></td><td><div>626</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_intf, $out_intf) = @$tuple;</td></tr>
<tr><td class="h">14916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;$in_intf-&gt;{name} =&gt; $out_intf-&gt;{name}&quot;;</td></tr>
<tr><td class="h">14917</td><td><div class="c3">658</div></td><td></td><td></td><td></td><td></td><td><div>833</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_path_routes($in_intf,&nbsp;&nbsp;$out_intf, $dst_networks); # IFs incl</td></tr>
<tr><td class="h">14918</td><td><div class="c3">658</div></td><td></td><td></td><td></td><td></td><td><div>761</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_path_routes($out_intf, $in_intf,&nbsp;&nbsp;$src_networks); # IFs incl</td></tr>
<tr><td class="h">14919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14920</td><td colspan="7"></td></tr><tr><td class="h">14921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Determine routing information for IF of first zone on path.</td></tr>
<tr><td class="h">14922</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>587</div><div>801</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $entry (@{ $pseudo_rule-&gt;{path_entries} }) {</td></tr>
<tr><td class="h">14923</td><td colspan="7"></td></tr><tr><td class="h">14924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For src IFs at managed routers, generate routes in both IFs. </td></tr>
<tr><td class="h">14925</td><td><div class="c3">766</div></td><td></td><td></td><td></td><td></td><td><div>854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src_intf (@src_interfaces) {</td></tr>
<tr><td class="h">14926</td><td colspan="7"></td></tr><tr><td class="h">14927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do not generate routes for src IFs at path entry routers. </td></tr>
<tr><td class="h">14928</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14928">100</a></div></td><td></td><td></td><td></td><td><div>150</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $src_intf-&gt;{router} eq $entry-&gt;{router};</td></tr>
<tr><td class="h">14929</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14929">50</a></div></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $redun_intf = $src_intf-&gt;{redundancy_interfaces}) {</td></tr>
<tr><td class="h">14930</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14930">0</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_-&gt;{router} eq $entry-&gt;{router} }</td></tr>
<tr><td class="h">14931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$redun_intf)</td></tr>
<tr><td class="h">14932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14933</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">14934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14936</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf_nets = [</td></tr>
<tr><td class="h">14937</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %{ $pseudo_rule-&gt;{src_intf2nets}-&gt;{$src_intf} }</td></tr>
<tr><td class="h">14938</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">14939</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_path_routes($src_intf, $entry, $intf_nets);</td></tr>
<tr><td class="h">14940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14941</td><td colspan="7"></td></tr><tr><td class="h">14942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For src networks, generate routes for zone IF only. </td></tr>
<tr><td class="h">14943</td><td><div class="c3">766</div></td><td></td><td></td><td></td><td></td><td><div>975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_end_routes($entry, $src_networks);</td></tr>
<tr><td class="h">14944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14945</td><td colspan="7"></td></tr><tr><td class="h">14946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Determine routing information for IF of last zone on path.</td></tr>
<tr><td class="h">14947</td><td><div class="c3">630</div><div class="c3">630</div></td><td></td><td></td><td></td><td></td><td><div>584</div><div>834</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $exit (@{ $pseudo_rule-&gt;{path_exits} }) {</td></tr>
<tr><td class="h">14948</td><td colspan="7"></td></tr><tr><td class="h">14949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For dst IFs at managed routers, generate routes in both IFs.</td></tr>
<tr><td class="h">14950</td><td><div class="c3">768</div></td><td></td><td></td><td></td><td></td><td><div>1079</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst_intf (@dst_interfaces) {</td></tr>
<tr><td class="h">14951</td><td colspan="7"></td></tr><tr><td class="h">14952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do not generate routes for dst IFs at path exit routers.</td></tr>
<tr><td class="h">14953</td><td><div class="c3">100</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14953">100</a></div></td><td></td><td></td><td></td><td><div>292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $dst_intf-&gt;{router} eq $exit-&gt;{router};</td></tr>
<tr><td class="h">14954</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14954">100</a></div></td><td></td><td></td><td></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $redun_intf = $dst_intf-&gt;{redundancy_interfaces}) {</td></tr>
<tr><td class="h">14955</td><td><div class="c3">12</div><div class="c3">24</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L14955">50</a></div></td><td></td><td></td><td></td><td><div>12</div><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (grep { $_-&gt;{router} eq $exit-&gt;{router} }</td></tr>
<tr><td class="h">14956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$redun_intf)</td></tr>
<tr><td class="h">14957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">14958</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">14959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14961</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf_nets = [</td></tr>
<tr><td class="h">14962</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %{ $pseudo_rule-&gt;{dst_intf2nets}-&gt;{$dst_intf} }</td></tr>
<tr><td class="h">14963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">14964</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_path_routes($dst_intf, $exit, $intf_nets);</td></tr>
<tr><td class="h">14965</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14966</td><td colspan="7"></td></tr><tr><td class="h">14967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For dst networks, generate routes for zone IF only.</td></tr>
<tr><td class="h">14968</td><td><div class="c3">768</div></td><td></td><td></td><td></td><td></td><td><div>887</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_end_routes($exit, $dst_networks);</td></tr>
<tr><td class="h">14969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14972</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>489</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14974</td><td colspan="7"></td></tr><tr><td class="h">14975</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_and_convert_routes;</td></tr>
<tr><td class="h">14976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#############################################################################</td></tr>
<tr><td class="h">14977</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Purpose&nbsp;&nbsp;: Generate and store routing information for all managed interfaces.</td></tr>
<tr><td class="h">14978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_active_routes {</td></tr>
<tr><td class="h">14979</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L14979">486</a></div></td><td><div class="c0">0</div></td><td><div>1161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Finding routes&#39;);</td></tr>
<tr><td class="h">14980</td><td colspan="7"></td></tr><tr><td class="h">14981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Generate navigation information for routing inside zones.</td></tr>
<tr><td class="h">14982</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>578</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $zone (@zones) {</td></tr>
<tr><td class="h">14983</td><td><div class="c3">1624</div></td><td></td><td></td><td></td><td></td><td><div>1972</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_routes_in_zone $zone;</td></tr>
<tr><td class="h">14984</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">14985</td><td colspan="7"></td></tr><tr><td class="h">14986</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Generate pseudo rule set with all src dst pairs to determine routes for.</td></tr>
<tr><td class="h">14987</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>740</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $routing_tree = generate_routing_tree;</td></tr>
<tr><td class="h">14988</td><td colspan="7"></td></tr><tr><td class="h">14989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Generate routing info for every pseudo rule and store it in interfaces.</td></tr>
<tr><td class="h">14990</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;generate_routing_info $routing_tree;</td></tr>
<tr><td class="h">14991</td><td colspan="7"></td></tr><tr><td class="h">14992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# TODO</td></tr>
<tr><td class="h">14993</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>680</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_and_convert_routes;</td></tr>
<tr><td class="h">14994</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>2231</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">14995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">14996</td><td colspan="7"></td></tr><tr><td class="h">14997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameters:</td></tr>
<tr><td class="h">14998</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - a bridged interface without an IP address, not usable as hop.</td></tr>
<tr><td class="h">14999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - the network for which the hop was found.</td></tr>
<tr><td class="h">15000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Result:</td></tr>
<tr><td class="h">15001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># - one or more layer 3 interfaces, usable as hop.</td></tr>
<tr><td class="h">15002</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Non optimized version.</td></tr>
<tr><td class="h">15003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Doesn&#39;t matter as long we have only a few bridged networks</td></tr>
<tr><td class="h">15004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># or don&#39;t use static routing at the border of bridged networks.</td></tr>
<tr><td class="h">15005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub fix_bridged_hops;</td></tr>
<tr><td class="h">15006</td><td colspan="7"></td></tr><tr><td class="h">15007</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub fix_bridged_hops {</td></tr>
<tr><td class="h">15008</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15008">4</a></div></td><td><div class="c0">0</div></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($hop, $network) = @_;</td></tr>
<tr><td class="h">15009</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result;</td></tr>
<tr><td class="h">15010</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $hop-&gt;{router};</td></tr>
<tr><td class="h">15011</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">15012</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15012">100</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface eq $hop;</td></tr>
<tr><td class="h">15013</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOP:</td></tr>
<tr><td class="h">15014</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop2 (values %{ $interface-&gt;{hopref2obj} }) {</td></tr>
<tr><td class="h">15015</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network2 (values %{ $interface-&gt;{routes}-&gt;{$hop2} }) {</td></tr>
<tr><td class="h">15016</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15016">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($network eq $network2) {</td></tr>
<tr><td class="h">15017</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15017">50</a></div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hop2-&gt;{ip} eq &#39;bridge&#39;) {</td></tr>
<tr><td class="h">15018</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, fix_bridged_hops($hop2, $network);</td></tr>
<tr><td class="h">15019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15020</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15021</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $hop2;</td></tr>
<tr><td class="h">15022</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15023</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next HOP;</td></tr>
<tr><td class="h">15024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15025</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15028</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @result;</td></tr>
<tr><td class="h">15029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15030</td><td colspan="7"></td></tr><tr><td class="h">15031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_and_convert_routes {</td></tr>
<tr><td class="h">15032</td><td><div class="c3">486</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15032">486</a></div></td><td><div class="c0">0</div></td><td><div>904</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Checking for duplicate routes&#39;);</td></tr>
<tr><td class="h">15033</td><td colspan="7"></td></tr><tr><td class="h">15034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Fix routes to bridged interfaces without IP address.</td></tr>
<tr><td class="h">15035</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>651</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">15036</td><td><div class="c3">1192</div><div class="c3">1192</div></td><td></td><td></td><td></td><td></td><td><div>878</div><div>1462</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">15037</td><td><div class="c3">2658</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15037">100</a></div></td><td></td><td></td><td></td><td><div>5165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $interface-&gt;{network}-&gt;{bridged};</td></tr>
<tr><td class="h">15038</td><td><div class="c3">32</div><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>25</div><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (values %{ $interface-&gt;{hopref2obj} }) {</td></tr>
<tr><td class="h">15039</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15039">100</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hop-&gt;{ip} ne &#39;bridged&#39;;</td></tr>
<tr><td class="h">15040</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %{ $interface-&gt;{routes}-&gt;{$hop} }) {</td></tr>
<tr><td class="h">15041</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @real_hop = fix_bridged_hops($hop, $network);</td></tr>
<tr><td class="h">15042</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rhop (@real_hop) {</td></tr>
<tr><td class="h">15043</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hopref2obj}-&gt;{$rhop} = $rhop;</td></tr>
<tr><td class="h">15044</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{routes}-&gt;{$rhop}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">15045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15046</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15047</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{hopref2obj}-&gt;{$hop};</td></tr>
<tr><td class="h">15048</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{routes}-&gt;{$hop};</td></tr>
<tr><td class="h">15049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15052</td><td colspan="7"></td></tr><tr><td class="h">15053</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>590</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">15054</td><td colspan="7"></td></tr><tr><td class="h">15055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Adjust routes through VPN tunnel to cleartext interface.</td></tr>
<tr><td class="h">15056</td><td><div class="c3">1192</div><div class="c3">1192</div></td><td></td><td></td><td></td><td></td><td><div>940</div><div>1511</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">15057</td><td><div class="c3">2658</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15057">100</a></div></td><td></td><td></td><td></td><td><div>4818</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $interface-&gt;{ip} eq &#39;tunnel&#39;;</td></tr>
<tr><td class="h">15058</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tunnel_routes = $interface-&gt;{routes};</td></tr>
<tr><td class="h">15059</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{routes} = $interface-&gt;{hopref2obj} = {};</td></tr>
<tr><td class="h">15060</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>52</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_intf = $interface-&gt;{real_interface};</td></tr>
<tr><td class="h">15061</td><td><div class="c3">42</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15061">50</a></div></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $real_intf-&gt;{routing};</td></tr>
<tr><td class="h">15062</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_net = $real_intf-&gt;{network};</td></tr>
<tr><td class="h">15063</td><td><div class="c3">42</div><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>36</div><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@{ $interface-&gt;{peers} }) {</td></tr>
<tr><td class="h">15064</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $real_peer = $peer-&gt;{real_interface};</td></tr>
<tr><td class="h">15065</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $peer_net&nbsp;&nbsp;= $real_peer-&gt;{network};</td></tr>
<tr><td class="h">15066</td><td colspan="7"></td></tr><tr><td class="h">15067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find hop to peer network and add tunnel networks to this hop.</td></tr>
<tr><td class="h">15068</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @hops;</td></tr>
<tr><td class="h">15069</td><td colspan="7"></td></tr><tr><td class="h">15070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Peer network is directly connected.</td></tr>
<tr><td class="h">15071</td><td><div class="c3">42</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15071">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15071">50</a></div></td><td></td><td></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($real_net eq $peer_net) {</td></tr>
<tr><td class="h">15072</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15072">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($real_peer-&gt;{ip} !~ /^(?:short|negotiated)$/) {</td></tr>
<tr><td class="h">15073</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hops, $real_peer;</td></tr>
<tr><td class="h">15074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15076</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">15077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$real_peer-&gt;{name} used to reach&quot;,</td></tr>
<tr><td class="h">15078</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; software clients\n&quot;,</td></tr>
<tr><td class="h">15079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; must not be directly connected to&quot;,</td></tr>
<tr><td class="h">15080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $real_intf-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">15081</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Connect it to some network behind next hop&quot;</td></tr>
<tr><td class="h">15082</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15083</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">15084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15086</td><td colspan="7"></td></tr><tr><td class="h">15087</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Peer network is located in directly connected zone.</td></tr>
<tr><td class="h">15088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($real_net-&gt;{zone} eq $peer_net-&gt;{zone}) {</td></tr>
<tr><td class="h">15089</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $route_in_zone = $real_intf-&gt;{route_in_zone};</td></tr>
<tr><td class="h">15090</td><td><div class="c3">42</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15090">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15090">67</a></div></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hops =</td></tr>
<tr><td class="h">15091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($route_in_zone-&gt;{default} || $route_in_zone-&gt;{$peer_net})</td></tr>
<tr><td class="h">15092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Missing route for $peer_net-&gt;{name}&quot;,</td></tr>
<tr><td class="h">15093</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $real_intf-&gt;{name} &quot;);</td></tr>
<tr><td class="h">15094</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hops, @$hops;</td></tr>
<tr><td class="h">15095</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15096</td><td colspan="7"></td></tr><tr><td class="h">15097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find path to peer network to determine available hops.</td></tr>
<tr><td class="h">15098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15099</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pseudo_rule = {</td></tr>
<tr><td class="h">15100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $real_intf,</td></tr>
<tr><td class="h">15101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $peer_net,</td></tr>
<tr><td class="h">15102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action =&gt; &#39;--&#39;,</td></tr>
<tr><td class="h">15103</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { name =&gt; &#39;--&#39; },</td></tr>
<tr><td class="h">15104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15105</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @zone_hops;</td></tr>
<tr><td class="h">15106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $walk = sub {</td></tr>
<tr><td class="h">15107</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15107">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">15108</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15108">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_intf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;No in_intf&quot;);</td></tr>
<tr><td class="h">15109</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15109">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_intf eq $real_intf or return;</td></tr>
<tr><td class="h">15110</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15110">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_intf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;No out_intf&quot;);</td></tr>
<tr><td class="h">15111</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15111">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_intf-&gt;{network}&nbsp;&nbsp;&nbsp;or internal_err &quot;No out net&quot;;</td></tr>
<tr><td class="h">15112</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @zone_hops, $out_intf;</td></tr>
<tr><td class="h">15113</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15114</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single_path_walk($pseudo_rule, $walk, &#39;Zone&#39;);</td></tr>
<tr><td class="h">15115</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $route_in_zone = $real_intf-&gt;{route_in_zone};</td></tr>
<tr><td class="h">15116</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@zone_hops) {</td></tr>
<tr><td class="h">15117</td><td colspan="7"></td></tr><tr><td class="h">15118</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop_net = $hop-&gt;{network};</td></tr>
<tr><td class="h">15119</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15119">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hop_net eq $real_net) {</td></tr>
<tr><td class="h">15120</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hops, $hop;</td></tr>
<tr><td class="h">15121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15123</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15123">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15123">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hops =</td></tr>
<tr><td class="h">15124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$route_in_zone-&gt;{default}</td></tr>
<tr><td class="h">15125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $route_in_zone-&gt;{$hop_net})</td></tr>
<tr><td class="h">15126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or</td></tr>
<tr><td class="h">15127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;Missing route for $hop_net-&gt;{name}&quot;,</td></tr>
<tr><td class="h">15128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $real_intf-&gt;{name}&quot;);</td></tr>
<tr><td class="h">15129</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @hops, @$hops;</td></tr>
<tr><td class="h">15130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15133</td><td colspan="7"></td></tr><tr><td class="h">15134</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop_routes;</td></tr>
<tr><td class="h">15135</td><td><div class="c3">42</div><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15135">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15135">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15135">80</a></div></td><td></td><td></td><td><div>147</div><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@hops &gt; 1</td></tr>
<tr><td class="h">15136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; equal(map({ $_-&gt;{redundancy_interfaces} || $_ } @hops))</td></tr>
<tr><td class="h">15137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| @hops == 1)</td></tr>
<tr><td class="h">15138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15139</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop = shift @hops;</td></tr>
<tr><td class="h">15140</td><td><div class="c3">40</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15140">100</a></div></td><td></td><td></td><td><div>104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop_routes = $real_intf-&gt;{routes}-&gt;{$hop} ||= {};</td></tr>
<tr><td class="h">15141</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$real_intf-&gt;{hopref2obj}-&gt;{$hop} = $hop;</td></tr>
<tr><td class="h">15142</td><td colspan="7"></td></tr><tr><td class="h">15143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Use $hop-&gt;{name} as hop for $real_peer-&gt;{name}&quot;;</td></tr>
<tr><td class="h">15144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15146</td><td colspan="7"></td></tr><tr><td class="h">15147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This can only happen for vpn software clients.</td></tr>
<tr><td class="h">15148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For hardware clients&nbsp;&nbsp;the route is known</td></tr>
<tr><td class="h">15149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# for the encrypted traffic which is allowed</td></tr>
<tr><td class="h">15150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# by gen_tunnel_rules (even for negotiated interface).</td></tr>
<tr><td class="h">15151</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $count = @hops;</td></tr>
<tr><td class="h">15152</td><td><div class="c3">2</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $names = join(&#39;&#39;, map({ &quot;\n - $_-&gt;{name}&quot; } @hops));</td></tr>
<tr><td class="h">15153</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">15154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Can&#39;t determine next hop to reach $peer_net-&gt;{name}&quot;,</td></tr>
<tr><td class="h">15155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; while moving routes\n&quot;,</td></tr>
<tr><td class="h">15156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; of $interface-&gt;{name} to $real_intf-&gt;{name}.\n&quot;,</td></tr>
<tr><td class="h">15157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; Exactly one route is needed,&quot;,</td></tr>
<tr><td class="h">15158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; but $count candidates were found:&quot;,</td></tr>
<tr><td class="h">15159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$names</td></tr>
<tr><td class="h">15160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15162</td><td colspan="7"></td></tr><tr><td class="h">15163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use found hop to reach tunneled networks in $tunnel_routes.</td></tr>
<tr><td class="h">15164</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tunnel_net_hash (values %$tunnel_routes) {</td></tr>
<tr><td class="h">15165</td><td><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tunnel_net (values %$tunnel_net_hash) {</td></tr>
<tr><td class="h">15166</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop_routes-&gt;{$tunnel_net} = $tunnel_net;</td></tr>
<tr><td class="h">15167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15169</td><td colspan="7"></td></tr><tr><td class="h">15170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add route to reach peer interface.</td></tr>
<tr><td class="h">15171</td><td><div class="c3">42</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15171">50</a></div></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($peer_net ne $real_net) {</td></tr>
<tr><td class="h">15172</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hop_routes-&gt;{$peer_net} = $peer_net;</td></tr>
<tr><td class="h">15173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15176</td><td colspan="7"></td></tr><tr><td class="h">15177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember, via which local interface a network is reached.</td></tr>
<tr><td class="h">15178</td><td><div class="c3">1192</div></td><td></td><td></td><td></td><td></td><td><div>1041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %net2intf;</td></tr>
<tr><td class="h">15179</td><td colspan="7"></td></tr><tr><td class="h">15180</td><td><div class="c3">1192</div><div class="c3">1192</div></td><td></td><td></td><td></td><td></td><td><div>929</div><div>1406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">15181</td><td colspan="7"></td></tr><tr><td class="h">15182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember, via which remote interface a network is reached.</td></tr>
<tr><td class="h">15183</td><td><div class="c3">2658</div></td><td></td><td></td><td></td><td></td><td><div>1981</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %net2hop;</td></tr>
<tr><td class="h">15184</td><td colspan="7"></td></tr><tr><td class="h">15185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remember, via which remote redundancy interfaces a network</td></tr>
<tr><td class="h">15186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# is reached. We use this to check, if alle members of a group</td></tr>
<tr><td class="h">15187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of redundancy interfaces are used to reach the network.</td></tr>
<tr><td class="h">15188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise it would be wrong to route to the virtual interface.</td></tr>
<tr><td class="h">15189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %net2group;</td></tr>
<tr><td class="h">15190</td><td colspan="7"></td></tr><tr><td class="h">15191</td><td><div class="c3">2658</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15191">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15191">100</a></div></td><td></td><td></td><td><div>6447</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{loop} and $interface-&gt;{routing};</td></tr>
<tr><td class="h">15192</td><td><div class="c3">2474</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15192">100</a></div></td><td></td><td></td><td></td><td><div>3540</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{ip} eq &#39;bridged&#39;;</td></tr>
<tr><td class="h">15193</td><td><div class="c3">2446</div><div class="c3">2446</div></td><td></td><td></td><td></td><td></td><td><div>1849</div><div>5748</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (sort by_name values %{ $interface-&gt;{hopref2obj} }) {</td></tr>
<tr><td class="h">15194</td><td><div class="c3">758</div><div class="c3">758</div></td><td></td><td></td><td></td><td></td><td><div>627</div><div>1924</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (</td></tr>
<tr><td class="h">15195</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort by_name values %{ $interface-&gt;{routes}-&gt;{$hop} })</td></tr>
<tr><td class="h">15196</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15197</td><td><div class="c3">930</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15197">100</a></div></td><td></td><td></td><td></td><td><div>1559</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $interface2 = $net2intf{$network}) {</td></tr>
<tr><td class="h">15198</td><td><div class="c3">22</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15198">50</a></div></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface2 ne $interface) {</td></tr>
<tr><td class="h">15199</td><td colspan="7"></td></tr><tr><td class="h">15200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Network is reached via two different</td></tr>
<tr><td class="h">15201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# local interfaces.&nbsp;&nbsp;Show warning if static</td></tr>
<tr><td class="h">15202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# routing is enabled for both interfaces.</td></tr>
<tr><td class="h">15203</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15203">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15203">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;not $interface-&gt;{routing}</td></tr>
<tr><td class="h">15204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and not $interface2-&gt;{routing})</td></tr>
<tr><td class="h">15205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15206</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">15207</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Two static routes for $network-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">15208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; via $interface-&gt;{name} and&quot;,</td></tr>
<tr><td class="h">15209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $interface2-&gt;{name}&quot;</td></tr>
<tr><td class="h">15210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15215</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>1262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2intf{$network} = $interface;</td></tr>
<tr><td class="h">15216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15217</td><td><div class="c3">930</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15217">50</a></div></td><td></td><td></td><td></td><td><div>1434</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ($interface-&gt;{routing}) {</td></tr>
<tr><td class="h">15218</td><td><div class="c3">930</div></td><td></td><td></td><td></td><td></td><td><div>823</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group = $hop-&gt;{redundancy_interfaces};</td></tr>
<tr><td class="h">15219</td><td><div class="c3">930</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15219">100</a></div></td><td></td><td></td><td></td><td><div>1248</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($group) {</td></tr>
<tr><td class="h">15220</td><td><div class="c3">32</div><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>25</div><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $net2group{$network} }, $hop;</td></tr>
<tr><td class="h">15221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15222</td><td><div class="c3">930</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15222">100</a></div></td><td></td><td></td><td></td><td><div>1386</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hop2 = $net2hop{$network}) {</td></tr>
<tr><td class="h">15223</td><td colspan="7"></td></tr><tr><td class="h">15224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Network is reached via two different hops.</td></tr>
<tr><td class="h">15225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check if both belong to same group</td></tr>
<tr><td class="h">15226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of redundancy interfaces.</td></tr>
<tr><td class="h">15227</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group2 = $hop2-&gt;{redundancy_interfaces};</td></tr>
<tr><td class="h">15228</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15228">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15228">50</a></div></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($group &amp;&amp; $group2 &amp;&amp; $group eq $group2) {</td></tr>
<tr><td class="h">15229</td><td colspan="7"></td></tr><tr><td class="h">15230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent multiple identical routes to</td></tr>
<tr><td class="h">15231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# different interfaces</td></tr>
<tr><td class="h">15232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with identical virtual IP.</td></tr>
<tr><td class="h">15233</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{routes}-&gt;{$hop}-&gt;{$network};</td></tr>
<tr><td class="h">15234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15236</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(</td></tr>
<tr><td class="h">15237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Two static routes for $network-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">15238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $interface-&gt;{name}&quot;,</td></tr>
<tr><td class="h">15239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; via $hop-&gt;{name} and $hop2-&gt;{name}&quot;</td></tr>
<tr><td class="h">15240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15244</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>2254</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2hop{$network} = $hop;</td></tr>
<tr><td class="h">15245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15249</td><td><div class="c3">2446</div></td><td></td><td></td><td></td><td></td><td><div>3717</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $net_ref (keys %net2group) {</td></tr>
<tr><td class="h">15250</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hops = $net2group{$net_ref};</td></tr>
<tr><td class="h">15251</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop1 = $hops-&gt;[0];</td></tr>
<tr><td class="h">15252</td><td><div class="c3">16</div><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15252">100</a></div></td><td></td><td></td><td></td><td><div>15</div><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if @$hops == @{ $hop1-&gt;{redundancy_interfaces} };</td></tr>
<tr><td class="h">15253</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{routes}-&gt;{$hop1}-&gt;{$net_ref};</td></tr>
<tr><td class="h">15254</td><td colspan="7"></td></tr><tr><td class="h">15255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# A network is routed to a single physical interface.</td></tr>
<tr><td class="h">15256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It is probably a loopback interface of the same device.</td></tr>
<tr><td class="h">15257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Move hop from virtual to physical interface.</td></tr>
<tr><td class="h">15258</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15258">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15258">67</a></div></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$hops == 1 &amp;&amp; (my $phys_hop = $hop1-&gt;{orig_main})) {</td></tr>
<tr><td class="h">15259</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{routes}-&gt;{$hop1}-&gt;{$net_ref};</td></tr>
<tr><td class="h">15260</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>666</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{routes}-&gt;{$phys_hop}-&gt;{$network} = $network;</td></tr>
<tr><td class="h">15261</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hopref2obj}-&gt;{$phys_hop} = $phys_hop;</td></tr>
<tr><td class="h">15262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15264</td><td colspan="7"></td></tr><tr><td class="h">15265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This occurs if different redundancy groups use</td></tr>
<tr><td class="h">15266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# parts of of a group of routers.</td></tr>
<tr><td class="h">15267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# More than 3 virtual interfaces together with</td></tr>
<tr><td class="h">15268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pathrestrictions have already been rejected.</td></tr>
<tr><td class="h">15269</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_msg(</td></tr>
<tr><td class="h">15270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$network-&gt;{name} is reached via $hop1-&gt;{name}\n&quot;,</td></tr>
<tr><td class="h">15271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; but not via all related redundancy interfaces&quot;</td></tr>
<tr><td class="h">15272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15273</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15275</td><td colspan="7"></td></tr><tr><td class="h">15276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Convert to array, because hash isn&#39;t needed any longer.</td></tr>
<tr><td class="h">15277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Array is sorted to get deterministic output.</td></tr>
<tr><td class="h">15278</td><td><div class="c3">2446</div></td><td></td><td></td><td></td><td></td><td><div>7303</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{hopref2obj} =</td></tr>
<tr><td class="h">15279</td><td><div class="c3">2446</div></td><td></td><td></td><td></td><td></td><td><div>2017</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ sort by_name values %{ $interface-&gt;{hopref2obj} } ];</td></tr>
<tr><td class="h">15280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15282</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>539</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15284</td><td colspan="7"></td></tr><tr><td class="h">15285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub ios_route_code;</td></tr>
<tr><td class="h">15286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub prefix_code;</td></tr>
<tr><td class="h">15287</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub full_prefix_code;</td></tr>
<tr><td class="h">15288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub address;</td></tr>
<tr><td class="h">15289</td><td colspan="7"></td></tr><tr><td class="h">15290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_header {</td></tr>
<tr><td class="h">15291</td><td><div class="c3">1844</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15291">1844</a></div></td><td><div class="c0">0</div></td><td><div>1812</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $what) = @_;</td></tr>
<tr><td class="h">15292</td><td><div class="c3">1844</div></td><td></td><td></td><td></td><td></td><td><div>2001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $comment_char = $router-&gt;{model}-&gt;{comment_char};</td></tr>
<tr><td class="h">15293</td><td><div class="c3">1844</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15293">100</a></div></td><td></td><td></td><td></td><td><div>2610</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $where = $router-&gt;{vrf_members} ? &quot; for $router-&gt;{name}&quot; : &#39;&#39;;</td></tr>
<tr><td class="h">15294</td><td><div class="c3">1844</div></td><td></td><td></td><td></td><td></td><td><div>3512</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$comment_char [ $what$where ]\n&quot;;</td></tr>
<tr><td class="h">15295</td><td><div class="c3">1844</div></td><td></td><td></td><td></td><td></td><td><div>2050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15297</td><td colspan="7"></td></tr><tr><td class="h">15298</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_routes {</td></tr>
<tr><td class="h">15299</td><td><div class="c3">988</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15299">988</a></div></td><td><div class="c0">0</div></td><td><div>840</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">15300</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>996</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">15301</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>995</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $model-&gt;{routing};</td></tr>
<tr><td class="h">15302</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>874</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $vrf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{vrf};</td></tr>
<tr><td class="h">15303</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>1111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $do_auto_default_route = $config-&gt;{auto_default_route};</td></tr>
<tr><td class="h">15304</td><td><div class="c3">988</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15304">100</a></div></td><td></td><td></td><td><div>1896</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_type = $model-&gt;{crypto} || &#39;&#39;;</td></tr>
<tr><td class="h">15305</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>822</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %intf2hop2nets;</td></tr>
<tr><td class="h">15306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @interfaces;</td></tr>
<tr><td class="h">15307</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %mask2ip2net;</td></tr>
<tr><td class="h">15308</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %net2hop_info;</td></tr>
<tr><td class="h">15309</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %net2no_opt;</td></tr>
<tr><td class="h">15310</td><td colspan="7"></td></tr><tr><td class="h">15311</td><td><div class="c3">988</div><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>812</div><div>1438</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">15312</td><td><div class="c3">2210</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15312">100</a></div></td><td></td><td></td><td></td><td><div>3574</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $interface-&gt;{ip} eq &#39;bridged&#39;;</td></tr>
<tr><td class="h">15313</td><td><div class="c3">2190</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15313">100</a></div></td><td></td><td></td><td></td><td><div>3079</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{routing}) {</td></tr>
<tr><td class="h">15314</td><td><div class="c3">384</div></td><td></td><td></td><td></td><td></td><td><div>296</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$do_auto_default_route = 0;</td></tr>
<tr><td class="h">15315</td><td><div class="c3">384</div></td><td></td><td></td><td></td><td></td><td><div>491</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">15316</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15317</td><td colspan="7"></td></tr><tr><td class="h">15318</td><td><div class="c3">1806</div></td><td></td><td></td><td></td><td></td><td><div>1879</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @interfaces, $interface;</td></tr>
<tr><td class="h">15319</td><td colspan="7"></td></tr><tr><td class="h">15320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ASA with site-to-site VPN needs individual routes for each peer.</td></tr>
<tr><td class="h">15321</td><td><div class="c3">1806</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15321">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15321">100</a></div></td><td></td><td></td><td><div>3022</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{hub} &amp;&amp; $crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">15322</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$do_auto_default_route = 0;</td></tr>
<tr><td class="h">15323</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15324</td><td><div class="c3">1806</div></td><td></td><td></td><td></td><td></td><td><div>1583</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">15325</td><td colspan="7"></td></tr><tr><td class="h">15326</td><td><div class="c3">1806</div><div class="c3">1806</div></td><td></td><td></td><td></td><td></td><td><div>1300</div><div>2934</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@{ $interface-&gt;{hopref2obj} }) {</td></tr>
<tr><td class="h">15327</td><td><div class="c3">708</div></td><td></td><td></td><td></td><td></td><td><div>957</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop_info = [ $interface, $hop ];</td></tr>
<tr><td class="h">15328</td><td colspan="7"></td></tr><tr><td class="h">15329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# A hash having all networks reachable via current hop</td></tr>
<tr><td class="h">15330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# both as key and as value.</td></tr>
<tr><td class="h">15331</td><td><div class="c3">708</div></td><td></td><td></td><td></td><td></td><td><div>1170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_hash = $interface-&gt;{routes}-&gt;{$hop};</td></tr>
<tr><td class="h">15332</td><td><div class="c3">708</div></td><td></td><td></td><td></td><td></td><td><div>1069</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %$net_hash) {</td></tr>
<tr><td class="h">15333</td><td><div class="c3">844</div></td><td></td><td></td><td></td><td></td><td><div>1103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_network = get_nat_network($network, $no_nat_set);</td></tr>
<tr><td class="h">15334</td><td><div class="c3">844</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15334">50</a></div></td><td></td><td></td><td></td><td><div>1359</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $nat_network-&gt;{hidden};</td></tr>
<tr><td class="h">15335</td><td><div class="c3">844</div><div class="c3">844</div></td><td></td><td></td><td></td><td></td><td><div>691</div><div>1297</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @{$nat_network}{ &#39;ip&#39;, &#39;mask&#39; };</td></tr>
<tr><td class="h">15336</td><td><div class="c3">844</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15336">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15336">67</a></div></td><td></td><td></td><td><div>1537</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip == 0 and $mask == 0) {</td></tr>
<tr><td class="h">15337</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$do_auto_default_route = 0;</td></tr>
<tr><td class="h">15338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15339</td><td colspan="7"></td></tr><tr><td class="h">15340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Implicitly overwrite duplicate networks.</td></tr>
<tr><td class="h">15341</td><td><div class="c3">844</div></td><td></td><td></td><td></td><td></td><td><div>1839</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mask2ip2net{$mask}-&gt;{$ip} = $nat_network;</td></tr>
<tr><td class="h">15342</td><td><div class="c3">844</div></td><td></td><td></td><td></td><td></td><td><div>2849</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2hop_info{$nat_network} = $hop_info;</td></tr>
<tr><td class="h">15343</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15346</td><td><div class="c3">988</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15346">100</a></div></td><td></td><td></td><td></td><td><div>2099</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not @interfaces;</td></tr>
<tr><td class="h">15347</td><td colspan="7"></td></tr><tr><td class="h">15348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Find and remove duplicate networks.</td></tr>
<tr><td class="h">15349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Go from smaller to larger networks.</td></tr>
<tr><td class="h">15350</td><td><div class="c3">836</div></td><td></td><td></td><td></td><td></td><td><div>1641</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $mask (reverse sort keys %mask2ip2net) {</td></tr>
<tr><td class="h">15351</td><td><div class="c3">730</div></td><td></td><td></td><td></td><td></td><td><div>1862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETWORK:</td></tr>
<tr><td class="h">15352</td><td><div class="c3">730</div></td><td></td><td></td><td></td><td></td><td><div>589</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ip (sort numerically keys %{ $mask2ip2net{$mask} }) {</td></tr>
<tr><td class="h">15353</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>868</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $small&nbsp;&nbsp;&nbsp;&nbsp;= $mask2ip2net{$mask}-&gt;{$ip};</td></tr>
<tr><td class="h">15354</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>1060</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop_info = $net2hop_info{$small};</td></tr>
<tr><td class="h">15355</td><td><div class="c3">834</div></td><td></td><td></td><td></td><td></td><td><div>854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $hop) = @$hop_info;</td></tr>
<tr><td class="h">15356</td><td colspan="7"></td></tr><tr><td class="h">15357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ASA with site-to-site VPN needs individual routes for each peer.</td></tr>
<tr><td class="h">15358</td><td><div class="c3">834</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15358">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15358">100</a></div></td><td></td><td></td><td><div>1678</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!($interface-&gt;{hub} &amp;&amp; $crypto_type eq &#39;ASA&#39;)) {</td></tr>
<tr><td class="h">15359</td><td colspan="7"></td></tr><tr><td class="h">15360</td><td><div class="c3">802</div></td><td></td><td></td><td></td><td></td><td><div>742</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $m = $mask;</td></tr>
<tr><td class="h">15361</td><td><div class="c3">802</div></td><td></td><td></td><td></td><td></td><td><div>652</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $i = $ip;</td></tr>
<tr><td class="h">15362</td><td><div class="c3">802</div></td><td></td><td></td><td></td><td></td><td><div>1199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($m) {</td></tr>
<tr><td class="h">15363</td><td colspan="7"></td></tr><tr><td class="h">15364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Clear upper bit, because left shift is undefined</td></tr>
<tr><td class="h">15365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# otherwise.</td></tr>
<tr><td class="h">15366</td><td><div class="c3">19122</div></td><td></td><td></td><td></td><td></td><td><div>14329</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$m = $m &amp; 0x7fffffff;</td></tr>
<tr><td class="h">15367</td><td><div class="c3">19122</div></td><td></td><td></td><td></td><td></td><td><div>13460</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$m &lt;&lt;= 1;</td></tr>
<tr><td class="h">15368</td><td><div class="c3">19122</div></td><td></td><td></td><td></td><td></td><td><div>13748</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i = $i &amp; $m;&nbsp;&nbsp;&nbsp;&nbsp;# Perl bug #108480.</td></tr>
<tr><td class="h">15369</td><td><div class="c3">19122</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15369">100</a></div></td><td></td><td></td><td></td><td><div>38035</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip2net = $mask2ip2net{$m}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or next;</td></tr>
<tr><td class="h">15370</td><td><div class="c3">94</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15370">100</a></div></td><td></td><td></td><td></td><td><div>229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $big&nbsp;&nbsp;&nbsp;&nbsp;= $mask2ip2net{$m}-&gt;{$i} or next;</td></tr>
<tr><td class="h">15371</td><td colspan="7"></td></tr><tr><td class="h">15372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $small is subnet of $big.</td></tr>
<tr><td class="h">15373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If both use the same hop, then $small is redundant.</td></tr>
<tr><td class="h">15374</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15374">100</a></div></td><td></td><td></td><td></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($net2hop_info{$big} eq $hop_info) {</td></tr>
<tr><td class="h">15375</td><td colspan="7"></td></tr><tr><td class="h">15376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;Removed: $small-&gt;{name} -&gt; $hop-&gt;{name}&quot;;</td></tr>
<tr><td class="h">15377</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next NETWORK;</td></tr>
<tr><td class="h">15378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15379</td><td colspan="7"></td></tr><tr><td class="h">15380</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise $small isn&#39;t redundant, even if a bigger network</td></tr>
<tr><td class="h">15381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with same hop exists.</td></tr>
<tr><td class="h">15382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It must not be removed by default route later.</td></tr>
<tr><td class="h">15383</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net2no_opt{$small} = 1;</td></tr>
<tr><td class="h">15384</td><td colspan="7"></td></tr><tr><td class="h">15385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug &quot;No opt: $small-&gt;{name} -&gt; $hop-&gt;{name}&quot;;</td></tr>
<tr><td class="h">15386</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">15387</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">15390</td><td><div class="c3">804</div><div class="c3">804</div></td><td></td><td></td><td></td><td></td><td><div>655</div><div>4121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $intf2hop2nets{$interface}-&gt;{$hop} },</td></tr>
<tr><td class="h">15391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ $ip, $mask, $small ]</td></tr>
<tr><td class="h">15392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15394</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15395</td><td colspan="7"></td></tr><tr><td class="h">15396</td><td><div class="c3">836</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15396">100</a></div></td><td></td><td></td><td></td><td><div>1392</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($do_auto_default_route) {</td></tr>
<tr><td class="h">15397</td><td colspan="7"></td></tr><tr><td class="h">15398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Find interface and hop with largest number of routing entries.</td></tr>
<tr><td class="h">15399</td><td><div class="c3">798</div></td><td></td><td></td><td></td><td></td><td><div>633</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max_intf;</td></tr>
<tr><td class="h">15400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max_hop;</td></tr>
<tr><td class="h">15401</td><td colspan="7"></td></tr><tr><td class="h">15402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Substitute routes to one hop with a default route,</td></tr>
<tr><td class="h">15403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# if there are at least two entries.</td></tr>
<tr><td class="h">15404</td><td><div class="c3">798</div></td><td></td><td></td><td></td><td></td><td><div>697</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max = 1;</td></tr>
<tr><td class="h">15405</td><td><div class="c3">798</div></td><td></td><td></td><td></td><td></td><td><div>827</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@interfaces) {</td></tr>
<tr><td class="h">15406</td><td><div class="c3">1716</div><div class="c3">1716</div></td><td></td><td></td><td></td><td></td><td><div>1240</div><div>2448</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@{ $interface-&gt;{hopref2obj} }) {</td></tr>
<tr><td class="h">15407</td><td><div class="c3">734</div><div class="c3">672</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15407">100</a></div></td><td></td><td></td><td></td><td><div>1630</div><div>2043</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $count = grep({ !$net2no_opt{ $_-&gt;[2] } }</td></tr>
<tr><td class="h">15408</td><td><div class="c3">672</div></td><td></td><td></td><td></td><td></td><td><div>518</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $intf2hop2nets{$interface}-&gt;{$hop} || [] });</td></tr>
<tr><td class="h">15409</td><td><div class="c3">672</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15409">100</a></div></td><td></td><td></td><td></td><td><div>1846</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($count &gt; $max) {</td></tr>
<tr><td class="h">15410</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max_intf = $interface;</td></tr>
<tr><td class="h">15411</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max_hop&nbsp;&nbsp;= $hop;</td></tr>
<tr><td class="h">15412</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$max&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $count;</td></tr>
<tr><td class="h">15413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15416</td><td><div class="c3">798</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15416">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15416">67</a></div></td><td></td><td></td><td><div>1668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($max_intf &amp;&amp; $max_hop) {</td></tr>
<tr><td class="h">15417</td><td colspan="7"></td></tr><tr><td class="h">15418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use default route for this direction.</td></tr>
<tr><td class="h">15419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# But still generate routes for small networks</td></tr>
<tr><td class="h">15420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with supernet behind other hop.</td></tr>
<tr><td class="h">15421</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>205</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intf2hop2nets{$max_intf}-&gt;{$max_hop} = [</td></tr>
<tr><td class="h">15422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0, 0 ],</td></tr>
<tr><td class="h">15423</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $net2no_opt{ $_-&gt;[2] } }</td></tr>
<tr><td class="h">15424</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $intf2hop2nets{$max_intf}-&gt;{$max_hop} })</td></tr>
<tr><td class="h">15425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">15426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15428</td><td><div class="c3">836</div></td><td></td><td></td><td></td><td></td><td><div>1195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_header($router, &#39;Routing&#39;);</td></tr>
<tr><td class="h">15429</td><td colspan="7"></td></tr><tr><td class="h">15430</td><td><div class="c3">836</div></td><td></td><td></td><td></td><td></td><td><div>635</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ios_vrf;</td></tr>
<tr><td class="h">15431</td><td><div class="c3">836</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15431">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15431">100</a></div></td><td></td><td></td><td></td><td><div>1499</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ios_vrf = $vrf ? &quot;vrf $vrf &quot; : &#39;&#39; if $type eq &#39;IOS&#39;;</td></tr>
<tr><td class="h">15432</td><td><div class="c3">836</div></td><td></td><td></td><td></td><td></td><td><div>706</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nxos_prefix = &#39;&#39;;</td></tr>
<tr><td class="h">15433</td><td colspan="7"></td></tr><tr><td class="h">15434</td><td><div class="c3">836</div></td><td></td><td></td><td></td><td></td><td><div>932</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@interfaces) {</td></tr>
<tr><td class="h">15435</td><td><div class="c3">1806</div><div class="c3">1806</div></td><td></td><td></td><td></td><td></td><td><div>1345</div><div>2636</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hop (@{ $interface-&gt;{hopref2obj} }) {</td></tr>
<tr><td class="h">15436</td><td colspan="7"></td></tr><tr><td class="h">15437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For unnumbered and negotiated interfaces use interface name</td></tr>
<tr><td class="h">15438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# as next hop.</td></tr>
<tr><td class="h">15439</td><td><div class="c3">708</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15439">100</a></div></td><td></td><td></td><td></td><td><div>2250</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hop_addr =</td></tr>
<tr><td class="h">15440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{ip} =~ /^(?:unnumbered|negotiated|tunnel)$/</td></tr>
<tr><td class="h">15441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $interface-&gt;{hardware}-&gt;{name}</td></tr>
<tr><td class="h">15442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: print_ip $hop-&gt;{ip};</td></tr>
<tr><td class="h">15443</td><td colspan="7"></td></tr><tr><td class="h">15444</td><td><div class="c3">708</div><div class="c3">708</div></td><td></td><td></td><td></td><td></td><td><div>696</div><div>1659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $netinfo (@{ $intf2hop2nets{$interface}-&gt;{$hop} }) {</td></tr>
<tr><td class="h">15445</td><td><div class="c3">738</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15445">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15445">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15445">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15445">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15445">0</a></div></td><td></td><td></td><td></td><td><div>1647</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;IOS&#39;) {</td></tr>
<tr><td class="h">15446</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $adr = ios_route_code($netinfo);</td></tr>
<tr><td class="h">15447</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>439</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;ip route $ios_vrf$adr $hop_addr\n&quot;;</td></tr>
<tr><td class="h">15448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;NX-OS&#39;) {</td></tr>
<tr><td class="h">15450</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15450">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15450">100</a></div></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($vrf &amp;&amp; !$nxos_prefix) {</td></tr>
<tr><td class="h">15451</td><td colspan="7"></td></tr><tr><td class="h">15452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print &quot;vrf context&quot; only once</td></tr>
<tr><td class="h">15453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# and indent &quot;ip route&quot; commands.</td></tr>
<tr><td class="h">15454</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;vrf context $vrf\n&quot;;</td></tr>
<tr><td class="h">15455</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nxos_prefix = &#39; &#39;;</td></tr>
<tr><td class="h">15456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15457</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $adr = full_prefix_code($netinfo);</td></tr>
<tr><td class="h">15458</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;${nxos_prefix}ip route $adr $hop_addr\n&quot;;</td></tr>
<tr><td class="h">15459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15460</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;PIX&#39;) {</td></tr>
<tr><td class="h">15461</td><td><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>745</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $adr = ios_route_code($netinfo);</td></tr>
<tr><td class="h">15462</td><td><div class="c3">572</div></td><td></td><td></td><td></td><td></td><td><div>3621</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print</td></tr>
<tr><td class="h">15463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;route $interface-&gt;{hardware}-&gt;{name} $adr $hop_addr\n&quot;;</td></tr>
<tr><td class="h">15464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;iproute&#39;) {</td></tr>
<tr><td class="h">15466</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $adr = prefix_code($netinfo);</td></tr>
<tr><td class="h">15467</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;ip route add $adr via $hop_addr\n&quot;;</td></tr>
<tr><td class="h">15468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;none&#39;) {</td></tr>
<tr><td class="h">15470</td><td colspan="7"></td></tr><tr><td class="h">15471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do nothing.</td></tr>
<tr><td class="h">15472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15474</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;unexpected routing type &#39;$type&#39;&quot;);</td></tr>
<tr><td class="h">15475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15479</td><td><div class="c3">836</div></td><td></td><td></td><td></td><td></td><td><div>3783</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15481</td><td colspan="7"></td></tr><tr><td class="h">15482</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">15483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># NAT commands</td></tr>
<tr><td class="h">15484</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">15485</td><td colspan="7"></td></tr><tr><td class="h">15486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_nat1 {</td></tr>
<tr><td class="h">15487</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15487">10</a></div></td><td><div class="c0">0</div></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $print_dynamic, $print_static_host, $print_static) = @_;</td></tr>
<tr><td class="h">15488</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_header($router, &#39;NAT&#39;);</td></tr>
<tr><td class="h">15489</td><td colspan="7"></td></tr><tr><td class="h">15490</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @hardware =</td></tr>
<tr><td class="h">15491</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort { $a-&gt;{level} &lt;=&gt; $b-&gt;{level} } @{ $router-&gt;{hardware} };</td></tr>
<tr><td class="h">15492</td><td colspan="7"></td></tr><tr><td class="h">15493</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_hw (@hardware) {</td></tr>
<tr><td class="h">15494</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15494">100</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_nat = $in_hw-&gt;{src_nat} or next;</td></tr>
<tr><td class="h">15495</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_nat = $in_hw-&gt;{no_nat_set};</td></tr>
<tr><td class="h">15496</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_hw (@hardware) {</td></tr>
<tr><td class="h">15497</td><td colspan="7"></td></tr><tr><td class="h">15498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Value is { net =&gt; net, .. }</td></tr>
<tr><td class="h">15499</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15499">100</a></div></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_hash = $src_nat-&gt;{$out_hw} or next;</td></tr>
<tr><td class="h">15500</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_nat = $out_hw-&gt;{no_nat_set};</td></tr>
<tr><td class="h">15501</td><td colspan="7"></td></tr><tr><td class="h">15502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Sorting is only needed for getting output deterministic.</td></tr>
<tr><td class="h">15503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For equal addresses look at the NAT address.</td></tr>
<tr><td class="h">15504</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15504">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15504">0</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15504">0</a></div><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15504">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @networks =</td></tr>
<tr><td class="h">15505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort {</td></tr>
<tr><td class="h">15506</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;{ip} &lt;=&gt; $b-&gt;{ip}</td></tr>
<tr><td class="h">15507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $a-&gt;{mask} &lt;=&gt; $b-&gt;{mask}</td></tr>
<tr><td class="h">15508</td><td colspan="7"></td></tr><tr><td class="h">15509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use value 0 for hidden network.</td></tr>
<tr><td class="h">15510</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (get_nat_network($a, $out_nat)-&gt;{ip} || 0)</td></tr>
<tr><td class="h">15511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&gt; (get_nat_network($b, $out_nat)-&gt;{ip} || 0)</td></tr>
<tr><td class="h">15512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} values %$net_hash;</td></tr>
<tr><td class="h">15513</td><td colspan="7"></td></tr><tr><td class="h">15514</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@networks) {</td></tr>
<tr><td class="h">15515</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_ip, $in_mask, $in_dynamic, $in_hidden) =</td></tr>
<tr><td class="h">15516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ get_nat_network($network, $in_nat) }{</td></tr>
<tr><td class="h">15517</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qw(ip mask dynamic</td></tr>
<tr><td class="h">15518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hidden)</td></tr>
<tr><td class="h">15519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15520</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($out_ip, $out_mask, $out_dynamic, $out_hidden) =</td></tr>
<tr><td class="h">15521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ get_nat_network($network, $out_nat) }{</td></tr>
<tr><td class="h">15522</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qw(ip mask dynamic</td></tr>
<tr><td class="h">15523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hidden)</td></tr>
<tr><td class="h">15524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15525</td><td colspan="7"></td></tr><tr><td class="h">15526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore hidden network.</td></tr>
<tr><td class="h">15527</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15527">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15527">33</a></div></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_hidden or $out_hidden;</td></tr>
<tr><td class="h">15528</td><td colspan="7"></td></tr><tr><td class="h">15529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore dynamic translation, which doesn&#39;t occur at</td></tr>
<tr><td class="h">15530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# current router</td></tr>
<tr><td class="h">15531</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15531">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15531">50</a></div></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$out_dynamic</td></tr>
<tr><td class="h">15532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $in_dynamic</td></tr>
<tr><td class="h">15533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $out_dynamic eq $in_dynamic)</td></tr>
<tr><td class="h">15534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15535</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_dynamic = $in_dynamic = undef;</td></tr>
<tr><td class="h">15536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15537</td><td colspan="7"></td></tr><tr><td class="h">15538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We are talking about source addresses.</td></tr>
<tr><td class="h">15539</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15539">100</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($out_dynamic) {</td></tr>
<tr><td class="h">15540</td><td colspan="7"></td></tr><tr><td class="h">15541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Check for static NAT entries of hosts and interfaces.</td></tr>
<tr><td class="h">15542</td><td><div class="c3">8</div><div class="c3">8</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>17</div><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $host (@{ $network-&gt;{subnets} },</td></tr>
<tr><td class="h">15543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $network-&gt;{interfaces} })</td></tr>
<tr><td class="h">15544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15545</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15545">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $out_host_ip = $host-&gt;{nat}-&gt;{$out_dynamic}) {</td></tr>
<tr><td class="h">15546</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pair = address($host, $in_nat);</td></tr>
<tr><td class="h">15547</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_host_ip, $in_host_mask) = @$pair;</td></tr>
<tr><td class="h">15548</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print_static_host-&gt;(</td></tr>
<tr><td class="h">15549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_hw, $in_host_ip, $in_host_mask, $out_hw,</td></tr>
<tr><td class="h">15550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_host_ip</td></tr>
<tr><td class="h">15551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15554</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print_dynamic-&gt;(</td></tr>
<tr><td class="h">15555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_hw,&nbsp;&nbsp;$in_ip,&nbsp;&nbsp;$in_mask,</td></tr>
<tr><td class="h">15556</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_hw, $out_ip, $out_mask</td></tr>
<tr><td class="h">15557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">15558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15560</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print_static-&gt;($in_hw, $in_ip, $in_mask, $out_hw, $out_ip);</td></tr>
<tr><td class="h">15561</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15562</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15565</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15567</td><td colspan="7"></td></tr><tr><td class="h">15568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_pix_static {</td></tr>
<tr><td class="h">15569</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15569">10</a></div></td><td><div class="c0">0</div></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">15570</td><td colspan="7"></td></tr><tr><td class="h">15571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Index for linking &quot;global&quot; and &quot;nat&quot; commands.</td></tr>
<tr><td class="h">15572</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dyn_index = 1;</td></tr>
<tr><td class="h">15573</td><td colspan="7"></td></tr><tr><td class="h">15574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Hash of indexes for reusing of NAT pools.</td></tr>
<tr><td class="h">15575</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %global2index;</td></tr>
<tr><td class="h">15576</td><td colspan="7"></td></tr><tr><td class="h">15577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Hash of indexes for creating only a single &quot;nat&quot; command if mapped at</td></tr>
<tr><td class="h">15578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# different interfaces.</td></tr>
<tr><td class="h">15579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %nat2index;</td></tr>
<tr><td class="h">15580</td><td colspan="7"></td></tr><tr><td class="h">15581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print_dynamic = sub {</td></tr>
<tr><td class="h">15582</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15582">8</a></div></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_hw, $in_ip, $in_mask, $out_hw, $out_ip, $out_mask) = @_;</td></tr>
<tr><td class="h">15583</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_name&nbsp;&nbsp;= $in_hw-&gt;{name};</td></tr>
<tr><td class="h">15584</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_name = $out_hw-&gt;{name};</td></tr>
<tr><td class="h">15585</td><td colspan="7"></td></tr><tr><td class="h">15586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use a single &quot;global&quot; command if multiple networks are</td></tr>
<tr><td class="h">15587</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# mapped to a single pool.</td></tr>
<tr><td class="h">15588</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $global_index = $global2index{$out_name}-&gt;{$out_ip}-&gt;{$out_mask};</td></tr>
<tr><td class="h">15589</td><td colspan="7"></td></tr><tr><td class="h">15590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use a single &quot;nat&quot; command if one network is mapped to</td></tr>
<tr><td class="h">15591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# different pools at different interfaces.</td></tr>
<tr><td class="h">15592</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $nat_index = $nat2index{$in_name}-&gt;{$in_ip}-&gt;{$in_mask};</td></tr>
<tr><td class="h">15593</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15593">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15593">33</a></div></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$global_index and $nat_index and internal_err();</td></tr>
<tr><td class="h">15594</td><td colspan="7"></td></tr><tr><td class="h">15595</td><td><div class="c3">8</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15595">67</a></div></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $index = $global_index || $nat_index || $dyn_index++;</td></tr>
<tr><td class="h">15596</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15596">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $global_index) {</td></tr>
<tr><td class="h">15597</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$global2index{$out_name}-&gt;{$out_ip}-&gt;{$out_mask} = $index;</td></tr>
<tr><td class="h">15598</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pool;</td></tr>
<tr><td class="h">15599</td><td colspan="7"></td></tr><tr><td class="h">15600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# global (outside) 1 interface</td></tr>
<tr><td class="h">15601</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_intf_ip = $out_hw-&gt;{interfaces}-&gt;[0]-&gt;{ip};</td></tr>
<tr><td class="h">15602</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15602">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15602">33</a></div></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($out_ip == $out_intf_ip &amp;&amp; $out_mask == 0xffffffff) {</td></tr>
<tr><td class="h">15603</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pool = &#39;interface&#39;;</td></tr>
<tr><td class="h">15604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15605</td><td colspan="7"></td></tr><tr><td class="h">15606</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# global (outside) 1 10.7.6.0-10.7.6.255 netmask 255.255.255.0</td></tr>
<tr><td class="h">15607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# nat (inside) 1 14.4.36.0 255.255.252.0</td></tr>
<tr><td class="h">15608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15609</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max&nbsp;&nbsp;= $out_ip | complement_32bit $out_mask;</td></tr>
<tr><td class="h">15610</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = print_ip $out_mask;</td></tr>
<tr><td class="h">15611</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15611">100</a></div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $range =</td></tr>
<tr><td class="h">15612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($out_ip == $max)</td></tr>
<tr><td class="h">15613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? print_ip($out_ip)</td></tr>
<tr><td class="h">15614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: print_ip($out_ip) . &#39;-&#39; . print_ip($max);</td></tr>
<tr><td class="h">15615</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pool = &quot;$range netmask $mask&quot;;</td></tr>
<tr><td class="h">15616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15617</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;global ($out_name) $index $pool\n&quot;;</td></tr>
<tr><td class="h">15618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15619</td><td colspan="7"></td></tr><tr><td class="h">15620</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15620">100</a></div></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $nat_index) {</td></tr>
<tr><td class="h">15621</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nat2index{$in_name}-&gt;{$in_ip}-&gt;{$in_mask} = $index;</td></tr>
<tr><td class="h">15622</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in&nbsp;&nbsp;&nbsp;= print_ip $in_ip;</td></tr>
<tr><td class="h">15623</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = print_ip $in_mask;</td></tr>
<tr><td class="h">15624</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;nat ($in_name) $index $in $mask&quot;;</td></tr>
<tr><td class="h">15625</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15625">50</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; outside&quot; if $in_hw-&gt;{level} &lt; $out_hw-&gt;{level};</td></tr>
<tr><td class="h">15626</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">15627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15628</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print_static_host = sub {</td></tr>
<tr><td class="h">15630</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15630">2</a></div></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_hw, $in_host_ip, $in_host_mask, $out_hw, $out_host_ip) = @_;</td></tr>
<tr><td class="h">15631</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_name&nbsp;&nbsp;= $in_hw-&gt;{name};</td></tr>
<tr><td class="h">15632</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_name = $out_hw-&gt;{name};</td></tr>
<tr><td class="h">15633</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $in_host_ip;</td></tr>
<tr><td class="h">15634</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $in_host_mask;</td></tr>
<tr><td class="h">15635</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $out_host_ip;</td></tr>
<tr><td class="h">15636</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;static ($in_name,$out_name) $out $in netmask $mask\n&quot;;</td></tr>
<tr><td class="h">15637</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print_static = sub {</td></tr>
<tr><td class="h">15639</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15639">8</a></div></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($in_hw, $in_ip, $in_mask, $out_hw, $out_ip) = @_;</td></tr>
<tr><td class="h">15640</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15640">100</a></div></td><td><div class="c1"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15640">75</a></div></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$in_hw-&gt;{level} &gt; $out_hw-&gt;{level}</td></tr>
<tr><td class="h">15641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $in_hw-&gt;{need_identity_nat}</td></tr>
<tr><td class="h">15642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $in_ip != $out_ip)</td></tr>
<tr><td class="h">15643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15644</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_name&nbsp;&nbsp;= $in_hw-&gt;{name};</td></tr>
<tr><td class="h">15645</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_name = $out_hw-&gt;{name};</td></tr>
<tr><td class="h">15646</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $in_ip;</td></tr>
<tr><td class="h">15647</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $out_ip;</td></tr>
<tr><td class="h">15648</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $in_mask;</td></tr>
<tr><td class="h">15649</td><td colspan="7"></td></tr><tr><td class="h">15650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# static (inside,outside) \</td></tr>
<tr><td class="h">15651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;10.111.0.0 111.0.0.0 netmask 255.255.252.0</td></tr>
<tr><td class="h">15652</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;static ($in_name,$out_name) $out $in netmask $mask\n&quot;;</td></tr>
<tr><td class="h">15653</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15654</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15655</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_nat1($router, $print_dynamic, $print_static_host, $print_static);</td></tr>
<tr><td class="h">15656</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_hw (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">15657</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15657">100</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $in_hw-&gt;{need_nat_0};</td></tr>
<tr><td class="h">15658</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;nat ($in_hw-&gt;{name}) 0 0.0.0.0 0.0.0.0\n&quot;;</td></tr>
<tr><td class="h">15659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15660</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15662</td><td colspan="7"></td></tr><tr><td class="h">15663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub optimize_nat_networks {</td></tr>
<tr><td class="h">15664</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15664">10</a></div></td><td><div class="c0">0</div></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">15665</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>7</div><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @hardware = @{ $router-&gt;{hardware} };</td></tr>
<tr><td class="h">15666</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $in_hw (@hardware) {</td></tr>
<tr><td class="h">15667</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15667">100</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_nat = $in_hw-&gt;{src_nat} or next;</td></tr>
<tr><td class="h">15668</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_nat = $in_hw-&gt;{no_nat_set};</td></tr>
<tr><td class="h">15669</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_hw (@hardware) {</td></tr>
<tr><td class="h">15670</td><td colspan="7"></td></tr><tr><td class="h">15671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Value is { net =&gt; net, .. }</td></tr>
<tr><td class="h">15672</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15672">100</a></div></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_hash = $src_nat-&gt;{$out_hw} or next;</td></tr>
<tr><td class="h">15673</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_nat = $out_hw-&gt;{no_nat_set};</td></tr>
<tr><td class="h">15674</td><td colspan="7"></td></tr><tr><td class="h">15675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent duplicate entries from different networks</td></tr>
<tr><td class="h">15676</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# translated to one identical address.</td></tr>
<tr><td class="h">15677</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @has_indentical;</td></tr>
<tr><td class="h">15678</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %$net_hash) {</td></tr>
<tr><td class="h">15679</td><td><div class="c3">16</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15679">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $identical = $network-&gt;{is_identical} or next;</td></tr>
<tr><td class="h">15680</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $identical-&gt;{$in_nat};</td></tr>
<tr><td class="h">15681</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $identical-&gt;{$out_nat};</td></tr>
<tr><td class="h">15682</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15682">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15682">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($in &amp;&amp; $out &amp;&amp; $in eq $out) {</td></tr>
<tr><td class="h">15683</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @has_indentical, $network;</td></tr>
<tr><td class="h">15684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15685</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15686</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (@has_indentical) {</td></tr>
<tr><td class="h">15687</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $net_hash-&gt;{$network};</td></tr>
<tr><td class="h">15688</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $one_net = $network-&gt;{is_identical}-&gt;{$out_nat};</td></tr>
<tr><td class="h">15689</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net_hash-&gt;{$one_net} = $one_net;</td></tr>
<tr><td class="h">15690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15691</td><td colspan="7"></td></tr><tr><td class="h">15692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove redundant networks.</td></tr>
<tr><td class="h">15693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# A network is redundant if some enclosing network is found</td></tr>
<tr><td class="h">15694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# in both NAT domains of incoming and outgoing interface.</td></tr>
<tr><td class="h">15695</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $network (values %$net_hash) {</td></tr>
<tr><td class="h">15696</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net = $network-&gt;{is_in}-&gt;{$out_nat};</td></tr>
<tr><td class="h">15697</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ($net) {</td></tr>
<tr><td class="h">15698</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net2;</td></tr>
<tr><td class="h">15699</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15699">0</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15699">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;&nbsp;$net_hash-&gt;{$net}</td></tr>
<tr><td class="h">15700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $net2 = $network-&gt;{is_in}-&gt;{$in_nat}</td></tr>
<tr><td class="h">15701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and $net_hash-&gt;{$net2})</td></tr>
<tr><td class="h">15702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15703</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $net_hash-&gt;{$network};</td></tr>
<tr><td class="h">15704</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">15705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15707</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$net = $net-&gt;{is_in}-&gt;{$out_nat};</td></tr>
<tr><td class="h">15708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15713</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15715</td><td colspan="7"></td></tr><tr><td class="h">15716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_nat {</td></tr>
<tr><td class="h">15717</td><td><div class="c3">978</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15717">978</a></div></td><td><div class="c0">0</div></td><td><div>809</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">15718</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>889</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">15719</td><td colspan="7"></td></tr><tr><td class="h">15720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# NAT commands not implemented for other models.</td></tr>
<tr><td class="h">15721</td><td><div class="c3">978</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15721">100</a></div></td><td></td><td></td><td></td><td><div>2416</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not $model-&gt;{has_interface_level};</td></tr>
<tr><td class="h">15722</td><td colspan="7"></td></tr><tr><td class="h">15723</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;optimize_nat_networks($router);</td></tr>
<tr><td class="h">15724</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_pix_static($router);</td></tr>
<tr><td class="h">15725</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15727</td><td colspan="7"></td></tr><tr><td class="h">15728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">15729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Distributing rules to managed devices</td></tr>
<tr><td class="h">15730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">15731</td><td colspan="7"></td></tr><tr><td class="h">15732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub distribute_rule {</td></tr>
<tr><td class="h">15733</td><td><div class="c3">2224</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15733">2224</a></div></td><td><div class="c0">0</div></td><td><div>1992</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($rule, $in_intf, $out_intf) = @_;</td></tr>
<tr><td class="h">15734</td><td colspan="7"></td></tr><tr><td class="h">15735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Traffic from src reaches this router via in_intf</td></tr>
<tr><td class="h">15736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# and leaves it via out_intf.</td></tr>
<tr><td class="h">15737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# in_intf is undefined if src is an interface of current router.</td></tr>
<tr><td class="h">15738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# out_intf is undefined if dst is an interface of current router.</td></tr>
<tr><td class="h">15739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Outgoing packets from a router itself are never filtered.</td></tr>
<tr><td class="h">15740</td><td><div class="c3">2224</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15740">100</a></div></td><td></td><td></td><td></td><td><div>3104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $in_intf;</td></tr>
<tr><td class="h">15741</td><td><div class="c3">2120</div></td><td></td><td></td><td></td><td></td><td><div>1936</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router&nbsp;&nbsp;= $in_intf-&gt;{router};</td></tr>
<tr><td class="h">15742</td><td><div class="c3">2120</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15742">100</a></div></td><td></td><td></td><td></td><td><div>3312</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $managed = $router-&gt;{managed} or return;</td></tr>
<tr><td class="h">15743</td><td><div class="c3">2068</div></td><td></td><td></td><td></td><td></td><td><div>1807</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">15744</td><td colspan="7"></td></tr><tr><td class="h">15745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Rules of type stateless must only be processed at</td></tr>
<tr><td class="h">15746</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - stateless routers or</td></tr>
<tr><td class="h">15747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - routers which are stateless for packets destined for</td></tr>
<tr><td class="h">15748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;their own interfaces or</td></tr>
<tr><td class="h">15749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - stateless tunnel interfaces of ASA-VPN.</td></tr>
<tr><td class="h">15750</td><td><div class="c3">2068</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15750">100</a></div></td><td></td><td></td><td></td><td><div>2993</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($rule-&gt;{stateless}) {</td></tr>
<tr><td class="h">15751</td><td><div class="c3">276</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15751">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15751">50</a></div></td><td></td><td></td><td><div>621</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">15752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not($model-&gt;{stateless}</td></tr>
<tr><td class="h">15753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or not $out_intf and $model-&gt;{stateless_self})</td></tr>
<tr><td class="h">15754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">15755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15756</td><td><div class="c3">94</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15759</td><td colspan="7"></td></tr><tr><td class="h">15760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Rules of type stateless_icmp must only be processed at routers</td></tr>
<tr><td class="h">15761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# which don&#39;t handle stateless_icmp automatically;</td></tr>
<tr><td class="h">15762</td><td><div class="c3">1974</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15762">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15762">33</a></div></td><td></td><td></td><td><div>3322</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $rule-&gt;{stateless_icmp} and not $model-&gt;{stateless_icmp};</td></tr>
<tr><td class="h">15763</td><td colspan="7"></td></tr><tr><td class="h">15764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t generate code for src any:[interface:r.loopback] at router:r.</td></tr>
<tr><td class="h">15765</td><td><div class="c3">1974</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15765">50</a></div></td><td></td><td></td><td></td><td><div>2688</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $in_intf-&gt;{loopback};</td></tr>
<tr><td class="h">15766</td><td colspan="7"></td></tr><tr><td class="h">15767</td><td><div class="c3">1974</div></td><td></td><td></td><td></td><td></td><td><div>1680</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $dst_list = $rule-&gt;{dst};</td></tr>
<tr><td class="h">15768</td><td colspan="7"></td></tr><tr><td class="h">15769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Apply only matching rules to &#39;managed=local&#39; router.</td></tr>
<tr><td class="h">15770</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Filter out non matching elements from src_list and dst_list.</td></tr>
<tr><td class="h">15771</td><td><div class="c3">1974</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15771">100</a></div></td><td></td><td></td><td></td><td><div>2888</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $mark = $router-&gt;{local_mark}) {</td></tr>
<tr><td class="h">15772</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_list = $rule-&gt;{src};</td></tr>
<tr><td class="h">15773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $match = sub {</td></tr>
<tr><td class="h">15774</td><td><div class="c3">144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15774">144</a></div></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($obj) = @_;</td></tr>
<tr><td class="h">15775</td><td><div class="c3">144</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15775">67</a></div></td><td></td><td></td><td><div>342</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $obj-&gt;{network} || $obj;</td></tr>
<tr><td class="h">15776</td><td><div class="c3">144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15776">100</a></div></td><td></td><td></td><td></td><td><div>270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $filter_at = $net-&gt;{filter_at} or return;</td></tr>
<tr><td class="h">15777</td><td><div class="c3">130</div></td><td></td><td></td><td></td><td></td><td><div>330</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $filter_at-&gt;{$mark};</td></tr>
<tr><td class="h">15778</td><td><div class="c3">74</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15779</td><td colspan="7"></td></tr><tr><td class="h">15780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Filter src_list and dst_list. Ignore rule if no matching element.</td></tr>
<tr><td class="h">15781</td><td><div class="c3">74</div><div class="c3">74</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15781">100</a></div></td><td></td><td></td><td></td><td><div>88</div><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @matching_src = grep { $match-&gt;($_) } @$src_list or return;</td></tr>
<tr><td class="h">15782</td><td><div class="c3">70</div><div class="c3">70</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15782">100</a></div></td><td></td><td></td><td></td><td><div>65</div><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @matching_dst = grep { $match-&gt;($_) } @$dst_list or return;</td></tr>
<tr><td class="h">15783</td><td colspan="7"></td></tr><tr><td class="h">15784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create copy of rule. Try to reuse original src_list / dst_list.</td></tr>
<tr><td class="h">15785</td><td><div class="c3">60</div></td><td></td><td></td><td></td><td></td><td><div>224</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule = { %$rule };</td></tr>
<tr><td class="h">15786</td><td colspan="7"></td></tr><tr><td class="h">15787</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Overwrite only if list has changed.</td></tr>
<tr><td class="h">15788</td><td><div class="c3">60</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15788">50</a></div></td><td></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$src_list != @matching_src) {</td></tr>
<tr><td class="h">15789</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{src} = \@matching_src;</td></tr>
<tr><td class="h">15790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15791</td><td><div class="c3">60</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15791">50</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$dst_list != @matching_dst) {</td></tr>
<tr><td class="h">15792</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{dst} = \@matching_dst;</td></tr>
<tr><td class="h">15793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15795</td><td colspan="7"></td></tr><tr><td class="h">15796</td><td><div class="c3">1960</div></td><td></td><td></td><td></td><td></td><td><div>1385</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $key;</td></tr>
<tr><td class="h">15797</td><td colspan="7"></td></tr><tr><td class="h">15798</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Packets for the router itself.</td></tr>
<tr><td class="h">15799</td><td><div class="c3">1960</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15799">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15799">100</a></div></td><td></td><td></td><td></td><td><div>3480</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not $out_intf) {</td></tr>
<tr><td class="h">15800</td><td colspan="7"></td></tr><tr><td class="h">15801</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No ACL generated for traffic to device itself.</td></tr>
<tr><td class="h">15802</td><td><div class="c3">228</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15802">100</a></div></td><td></td><td></td><td></td><td><div>457</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if $model-&gt;{filter} eq &#39;PIX&#39;;</td></tr>
<tr><td class="h">15803</td><td colspan="7"></td></tr><tr><td class="h">15804</td><td><div class="c3">162</div></td><td></td><td></td><td></td><td></td><td><div>441</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key = &#39;intf_rules&#39;;</td></tr>
<tr><td class="h">15805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($out_intf-&gt;{hardware}-&gt;{need_out_acl}) {</td></tr>
<tr><td class="h">15807</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key = &#39;out_rules&#39;;</td></tr>
<tr><td class="h">15808</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15808">100</a></div></td><td></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $in_intf-&gt;{hardware}-&gt;{no_in_acl}) {</td></tr>
<tr><td class="h">15809</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $in_intf-&gt;{hardware}-&gt;{rules} }, $rule;</td></tr>
<tr><td class="h">15810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15813</td><td><div class="c3">1714</div></td><td></td><td></td><td></td><td></td><td><div>1474</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key = &#39;rules&#39;;</td></tr>
<tr><td class="h">15814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15815</td><td colspan="7"></td></tr><tr><td class="h">15816</td><td><div class="c3">1894</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15816">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15816">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15816">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L15816">100</a></div></td><td></td><td></td><td><div>6700</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($in_intf-&gt;{ip} eq &#39;tunnel&#39;) {</td></tr>
<tr><td class="h">15817</td><td colspan="7"></td></tr><tr><td class="h">15818</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Rules for single software clients are stored individually.</td></tr>
<tr><td class="h">15819</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Consistency checks have already been done at expand_crypto.</td></tr>
<tr><td class="h">15820</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Rules are needed at tunnel for generating split tunnel ACL</td></tr>
<tr><td class="h">15821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# regardless of $router-&gt;{no_crypto_filter} value.</td></tr>
<tr><td class="h">15822</td><td><div class="c3">50</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15822">100</a></div></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $id2rules = $in_intf-&gt;{id_rules}) {</td></tr>
<tr><td class="h">15823</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src_list = $rule-&gt;{src};</td></tr>
<tr><td class="h">15824</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %id2src_list;</td></tr>
<tr><td class="h">15825</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src (@$src_list) {</td></tr>
<tr><td class="h">15826</td><td><div class="c3">20</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15826">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15826">0</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_subnet $src) {</td></tr>
<tr><td class="h">15827</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15827">50</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id = $src-&gt;{id} or </td></tr>
<tr><td class="h">15828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;$src-&gt;{name} must have ID&quot;);</td></tr>
<tr><td class="h">15829</td><td><div class="c3">20</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>16</div><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $id2src_list{$id} }, $src;</td></tr>
<tr><td class="h">15830</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15831</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (is_network $src) {</td></tr>
<tr><td class="h">15832</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15832">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$src-&gt;{has_id_hosts} or </td></tr>
<tr><td class="h">15833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;$src-&gt;{name} must have ID-hosts&quot;);</td></tr>
<tr><td class="h">15834</td><td><div class="c0">0</div><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $id (map { $_-&gt;{id} } @{ $src-&gt;{hosts} }) {</td></tr>
<tr><td class="h">15835</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $id2src_list{$id} }, $src;</td></tr>
<tr><td class="h">15836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15837</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15839</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(</td></tr>
<tr><td class="h">15840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Unexpected $src-&gt;{name} without ID\n &quot;,</td></tr>
<tr><td class="h">15841</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_rule $rule);</td></tr>
<tr><td class="h">15842</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15843</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15844</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $id (keys %id2src_list) {</td></tr>
<tr><td class="h">15845</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id_src_list = $id2src_list{$id};</td></tr>
<tr><td class="h">15846</td><td colspan="7"></td></tr><tr><td class="h">15847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Try to reuse original rule for memory efficiency.</td></tr>
<tr><td class="h">15848</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_rule = $rule;</td></tr>
<tr><td class="h">15849</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15849">100</a></div></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$src_list != @$id_src_list) {</td></tr>
<tr><td class="h">15850</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule = { %$rule, src =&gt; $id_src_list };</td></tr>
<tr><td class="h">15851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15852</td><td><div class="c3">20</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>21</div><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $id2rules-&gt;{$id}-&gt;{$key} }, $new_rule;</td></tr>
<tr><td class="h">15853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15855</td><td colspan="7"></td></tr><tr><td class="h">15856</td><td><div class="c3">50</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15856">100</a></div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{no_crypto_filter}) {</td></tr>
<tr><td class="h">15857</td><td><div class="c3">38</div><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>28</div><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $in_intf-&gt;{real_interface}-&gt;{hardware}-&gt;{$key} }, $rule;</td></tr>
<tr><td class="h">15858</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15859</td><td colspan="7"></td></tr><tr><td class="h">15860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Rules are needed at tunnel for generating detailed_crypto_acl.</td></tr>
<tr><td class="h">15861</td><td><div class="c3">50</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15861">100</a></div></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $in_intf-&gt;{id_rules}) {</td></tr>
<tr><td class="h">15862</td><td><div class="c3">34</div><div class="c3">34</div></td><td></td><td></td><td></td><td></td><td><div>26</div><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $in_intf-&gt;{$key} }, $rule;</td></tr>
<tr><td class="h">15863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($key eq &#39;out_rules&#39;) {</td></tr>
<tr><td class="h">15866</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>20</div><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $out_intf-&gt;{hardware}-&gt;{$key} }, $rule;</td></tr>
<tr><td class="h">15867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15868</td><td colspan="7"></td></tr><tr><td class="h">15869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Remember outgoing interface.</td></tr>
<tr><td class="h">15870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($key eq &#39;rules&#39; and $model-&gt;{has_io_acl}) {</td></tr>
<tr><td class="h">15871</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>169</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push</td></tr>
<tr><td class="h">15872</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $in_intf-&gt;{hardware}-&gt;{io_rules}-&gt;{ $out_intf-&gt;{hardware}-&gt;{name} }</td></tr>
<tr><td class="h">15873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, $rule;</td></tr>
<tr><td class="h">15874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15876</td><td><div class="c3">1758</div><div class="c3">1758</div></td><td></td><td></td><td></td><td></td><td><div>1288</div><div>2956</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $in_intf-&gt;{hardware}-&gt;{$key} }, $rule;</td></tr>
<tr><td class="h">15877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15878</td><td><div class="c3">1894</div></td><td></td><td></td><td></td><td></td><td><div>2874</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15880</td><td colspan="7"></td></tr><tr><td class="h">15881</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $permit_any_rule;</td></tr>
<tr><td class="h">15882</td><td colspan="7"></td></tr><tr><td class="h">15883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_router_acls {</td></tr>
<tr><td class="h">15884</td><td><div class="c3">358</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L15884">358</a></div></td><td><div class="c0">0</div></td><td><div>445</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers) {</td></tr>
<tr><td class="h">15885</td><td><div class="c3">996</div></td><td></td><td></td><td></td><td></td><td><div>1015</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $has_io_acl = $router-&gt;{model}-&gt;{has_io_acl};</td></tr>
<tr><td class="h">15886</td><td><div class="c3">996</div><div class="c3">996</div></td><td></td><td></td><td></td><td></td><td><div>761</div><div>1212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">15887</td><td colspan="7"></td></tr><tr><td class="h">15888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Some managed devices are connected by a crosslink network.</td></tr>
<tr><td class="h">15889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Permit any traffic at the internal crosslink interface.</td></tr>
<tr><td class="h">15890</td><td><div class="c3">2084</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15890">100</a></div></td><td></td><td></td><td></td><td><div>2931</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hardware-&gt;{crosslink}) {</td></tr>
<tr><td class="h">15891</td><td colspan="7"></td></tr><tr><td class="h">15892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We can savely change rules at hardware interface</td></tr>
<tr><td class="h">15893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because it has been checked that no other logical</td></tr>
<tr><td class="h">15894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# networks are attached to the same hardware.</td></tr>
<tr><td class="h">15895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</td></tr>
<tr><td class="h">15896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Substitute rules for each outgoing interface.</td></tr>
<tr><td class="h">15897</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15897">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($has_io_acl) {</td></tr>
<tr><td class="h">15898</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rules (values %{ $hardware-&gt;{io_rules} }) {</td></tr>
<tr><td class="h">15899</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rules = [$permit_any_rule];</td></tr>
<tr><td class="h">15900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15903</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{rules} = [$permit_any_rule];</td></tr>
<tr><td class="h">15904</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15904">50</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hardware-&gt;{need_out_acl}) {</td></tr>
<tr><td class="h">15905</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{out_rules} = [$permit_any_rule];</td></tr>
<tr><td class="h">15906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15908</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{intf_rules} = [$permit_any_rule];</td></tr>
<tr><td class="h">15909</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">15910</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15911</td><td colspan="7"></td></tr><tr><td class="h">15912</td><td><div class="c3">2064</div><div class="c3">2064</div></td><td></td><td></td><td></td><td></td><td><div>1449</div><div>2353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $hardware-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">15913</td><td colspan="7"></td></tr><tr><td class="h">15914</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Current router is used as default router even for</td></tr>
<tr><td class="h">15915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# some internal networks.</td></tr>
<tr><td class="h">15916</td><td><div class="c3">2166</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15916">50</a></div></td><td></td><td></td><td></td><td><div>3001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{reroute_permit}) {</td></tr>
<tr><td class="h">15917</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net_list = $interface-&gt;{reroute_permit};</td></tr>
<tr><td class="h">15918</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rule = {</td></tr>
<tr><td class="h">15919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">15920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; $net_list,</td></tr>
<tr><td class="h">15921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt_ip ]</td></tr>
<tr><td class="h">15922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15923</td><td colspan="7"></td></tr><tr><td class="h">15924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepend to all other rules.</td></tr>
<tr><td class="h">15925</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15925">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($has_io_acl) {</td></tr>
<tr><td class="h">15926</td><td colspan="7"></td></tr><tr><td class="h">15927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Incoming and outgoing interface are equal.</td></tr>
<tr><td class="h">15928</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hw_name = $hardware-&gt;{name};</td></tr>
<tr><td class="h">15929</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unshift@{ $hardware-&gt;{io_rules}-&gt;{$hw_name} }, $rule;</td></tr>
<tr><td class="h">15930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">15932</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unshift @{ $hardware-&gt;{rules} }, $rule;</td></tr>
<tr><td class="h">15933</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15935</td><td colspan="7"></td></tr><tr><td class="h">15936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Is dynamic routing used?</td></tr>
<tr><td class="h">15937</td><td><div class="c3">2166</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15937">100</a></div></td><td></td><td></td><td></td><td><div>3096</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $routing = $interface-&gt;{routing}) {</td></tr>
<tr><td class="h">15938</td><td><div class="c3">384</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15938">100</a></div></td><td></td><td></td><td></td><td><div>945</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($routing-&gt;{name} !~ /^(?:manual|dynamic)$/) {</td></tr>
<tr><td class="h">15939</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt = $routing-&gt;{prt};</td></tr>
<tr><td class="h">15940</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15940">50</a></div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $dst_range = $prt-&gt;{dst_range}) {</td></tr>
<tr><td class="h">15941</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt = $dst_range;</td></tr>
<tr><td class="h">15942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15943</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt = [ $prt ];</td></tr>
<tr><td class="h">15944</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = [ $interface-&gt;{network} ];</td></tr>
<tr><td class="h">15945</td><td colspan="7"></td></tr><tr><td class="h">15946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Permit multicast packets from current network.</td></tr>
<tr><td class="h">15947</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mcast = $routing-&gt;{mcast};</td></tr>
<tr><td class="h">15948</td><td><div class="c3">8</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware-&gt;{intf_rules} },</td></tr>
<tr><td class="h">15949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; $network,</td></tr>
<tr><td class="h">15951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; $mcast,</td></tr>
<tr><td class="h">15952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; $prt</td></tr>
<tr><td class="h">15953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15954</td><td colspan="7"></td></tr><tr><td class="h">15955</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Additionally permit unicast packets.</td></tr>
<tr><td class="h">15956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# We use the network address as destination</td></tr>
<tr><td class="h">15957</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# instead of the interface address,</td></tr>
<tr><td class="h">15958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# because we get fewer rules if the interface has</td></tr>
<tr><td class="h">15959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# multiple addresses.</td></tr>
<tr><td class="h">15960</td><td><div class="c3">8</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware-&gt;{intf_rules} },</td></tr>
<tr><td class="h">15961</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; $network,</td></tr>
<tr><td class="h">15963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; $network,</td></tr>
<tr><td class="h">15964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; $prt</td></tr>
<tr><td class="h">15965</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15966</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15968</td><td colspan="7"></td></tr><tr><td class="h">15969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle multicast packets of redundancy protocols.</td></tr>
<tr><td class="h">15970</td><td><div class="c3">2166</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15970">100</a></div></td><td></td><td></td><td></td><td><div>2975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $type = $interface-&gt;{redundancy_type}) {</td></tr>
<tr><td class="h">15971</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $interface-&gt;{network};</td></tr>
<tr><td class="h">15972</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mcast&nbsp;&nbsp;&nbsp;= $xxrp_info{$type}-&gt;{mcast};</td></tr>
<tr><td class="h">15973</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $xxrp_info{$type}-&gt;{prt};</td></tr>
<tr><td class="h">15974</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15974">100</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $dst_range = $prt-&gt;{dst_range}) {</td></tr>
<tr><td class="h">15975</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prt = $dst_range;</td></tr>
<tr><td class="h">15976</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15977</td><td><div class="c3">28</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>19</div><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware-&gt;{intf_rules} },</td></tr>
<tr><td class="h">15978</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15979</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; [ $network ],</td></tr>
<tr><td class="h">15980</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $mcast ],</td></tr>
<tr><td class="h">15981</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt ]</td></tr>
<tr><td class="h">15982</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15983</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15984</td><td colspan="7"></td></tr><tr><td class="h">15985</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle DHCP requests.</td></tr>
<tr><td class="h">15986</td><td><div class="c3">2166</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L15986">100</a></div></td><td></td><td></td><td></td><td><div>5285</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($interface-&gt;{dhcp_server}) {</td></tr>
<tr><td class="h">15987</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware-&gt;{intf_rules} },</td></tr>
<tr><td class="h">15988</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">15989</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">15990</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">15991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt_bootps-&gt;{dst_range} ]</td></tr>
<tr><td class="h">15992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">15993</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15996</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">15997</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>374</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">15998</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">15999</td><td colspan="7"></td></tr><tr><td class="h">16000</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub create_general_permit_rules {</td></tr>
<tr><td class="h">16001</td><td><div class="c3">20</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16001">20</a></div></td><td><div class="c0">0</div></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($protocols) = @_;</td></tr>
<tr><td class="h">16002</td><td><div class="c3">20</div><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16002">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16002">100</a></div></td><td></td><td></td><td></td><td><div>25</div><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @prt = map {&nbsp;&nbsp;&nbsp;ref($_) eq &#39;ARRAY&#39; </td></tr>
<tr><td class="h">16003</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $_-&gt;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# take dst range; src range was error before.</td></tr>
<tr><td class="h">16004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $_-&gt;{main_prt} </td></tr>
<tr><td class="h">16005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $_-&gt;{main_prt} </td></tr>
<tr><td class="h">16006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $_ } @$protocols;</td></tr>
<tr><td class="h">16007</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $rule = {</td></tr>
<tr><td class="h">16008</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">16009</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">16010</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; \@prt,</td></tr>
<tr><td class="h">16011</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16012</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $rule;</td></tr>
<tr><td class="h">16013</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16014</td><td colspan="7"></td></tr><tr><td class="h">16015</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub distribute_general_permit {</td></tr>
<tr><td class="h">16016</td><td><div class="c3">358</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16016">358</a></div></td><td><div class="c0">0</div></td><td><div>436</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers) {</td></tr>
<tr><td class="h">16017</td><td><div class="c3">996</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16017">100</a></div></td><td></td><td></td><td></td><td><div>1893</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $general_permit = $router-&gt;{general_permit} or next;</td></tr>
<tr><td class="h">16018</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rule = create_general_permit_rules($general_permit);</td></tr>
<tr><td class="h">16019</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $need_protect = $router-&gt;{need_protect};</td></tr>
<tr><td class="h">16020</td><td><div class="c3">20</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>21</div><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $in_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">16021</td><td><div class="c3">36</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16021">50</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_intf-&gt;{main_interface};</td></tr>
<tr><td class="h">16022</td><td colspan="7"></td></tr><tr><td class="h">16023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# At VPN hub, don&#39;t permit any -&gt; any, but only traffic</td></tr>
<tr><td class="h">16024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# from each encrypted network.</td></tr>
<tr><td class="h">16025</td><td><div class="c3">36</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16025">100</a></div></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($in_intf-&gt;{is_hub}) {</td></tr>
<tr><td class="h">16026</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id_rules = $in_intf-&gt;{id_rules};</td></tr>
<tr><td class="h">16027</td><td><div class="c3">6</div><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16027">100</a></div></td><td></td><td></td><td></td><td><div>14</div><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $src (</td></tr>
<tr><td class="h">16028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id_rules</td></tr>
<tr><td class="h">16029</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? sort by_name map({ $_-&gt;{src} } values %$id_rules)</td></tr>
<tr><td class="h">16030</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: @{ $in_intf-&gt;{peer_networks} }</td></tr>
<tr><td class="h">16031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">16032</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">16033</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rule = {%$rule};</td></tr>
<tr><td class="h">16034</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule-&gt;{src} = [ $src ];</td></tr>
<tr><td class="h">16035</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">16036</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16036">100</a></div></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $in_intf;</td></tr>
<tr><td class="h">16037</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16037">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf-&gt;{ip} eq &#39;tunnel&#39;;</td></tr>
<tr><td class="h">16038</td><td colspan="7"></td></tr><tr><td class="h">16039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Traffic traverses the device. Traffic for</td></tr>
<tr><td class="h">16040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the device itself isn&#39;t needed at VPN hub.</td></tr>
<tr><td class="h">16041</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribute_rule($rule, $in_intf, $out_intf);</td></tr>
<tr><td class="h">16042</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16044</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16045</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16046</td><td><div class="c3">30</div><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>29</div><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_intf (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">16047</td><td><div class="c3">60</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16047">100</a></div></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf eq $in_intf;</td></tr>
<tr><td class="h">16048</td><td colspan="7"></td></tr><tr><td class="h">16049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For IOS and NX-OS print this rule only</td></tr>
<tr><td class="h">16050</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# once at interface filter rules below</td></tr>
<tr><td class="h">16051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# (for incoming ACL).</td></tr>
<tr><td class="h">16052</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16052">100</a></div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($need_protect) {</td></tr>
<tr><td class="h">16053</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out_hw = $out_intf-&gt;{hardware};</td></tr>
<tr><td class="h">16054</td><td colspan="7"></td></tr><tr><td class="h">16055</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For interface with outgoing ACLs</td></tr>
<tr><td class="h">16056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# we need to add the rule.</td></tr>
<tr><td class="h">16057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# distribute_rule would add rule to incoming,</td></tr>
<tr><td class="h">16058</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# hence we add rule directly to outgoing rules.</td></tr>
<tr><td class="h">16059</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16059">50</a></div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($out_hw-&gt;{need_out_acl}) {</td></tr>
<tr><td class="h">16060</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $out_hw-&gt;{out_rules} }, $rule;</td></tr>
<tr><td class="h">16061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16062</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">16063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16064</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16064">50</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $out_intf-&gt;{main_interface};</td></tr>
<tr><td class="h">16065</td><td colspan="7"></td></tr><tr><td class="h">16066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Traffic traverses the device.</td></tr>
<tr><td class="h">16067</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribute_rule($rule, $in_intf, $out_intf);</td></tr>
<tr><td class="h">16068</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16069</td><td colspan="7"></td></tr><tr><td class="h">16070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Traffic for the device itself.</td></tr>
<tr><td class="h">16071</td><td><div class="c3">30</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16071">50</a></div></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_intf-&gt;{ip} eq &#39;bridged&#39;;</td></tr>
<tr><td class="h">16072</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribute_rule($rule, $in_intf, undef);</td></tr>
<tr><td class="h">16073</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16074</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16076</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16077</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16078</td><td colspan="7"></td></tr><tr><td class="h">16079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub rules_distribution {</td></tr>
<tr><td class="h">16080</td><td><div class="c3">468</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16080">100</a></div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16080">468</a></div></td><td><div class="c0">0</div></td><td><div>566</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if fast_mode();</td></tr>
<tr><td class="h">16081</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>670</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Distributing rules&#39;);</td></tr>
<tr><td class="h">16082</td><td colspan="7"></td></tr><tr><td class="h">16083</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Deny rules</td></tr>
<tr><td class="h">16084</td><td><div class="c3">358</div><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>305</div><div>692</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $grouped_rules{deny} }) {</td></tr>
<tr><td class="h">16085</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path_walk($rule, \&amp;distribute_rule);</td></tr>
<tr><td class="h">16086</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16087</td><td colspan="7"></td></tr><tr><td class="h">16088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle global permit after deny rules.</td></tr>
<tr><td class="h">16089</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>536</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;distribute_general_permit();</td></tr>
<tr><td class="h">16090</td><td colspan="7"></td></tr><tr><td class="h">16091</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Permit rules</td></tr>
<tr><td class="h">16092</td><td><div class="c3">358</div><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>294</div><div>514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $grouped_rules{permit} }) {</td></tr>
<tr><td class="h">16093</td><td><div class="c3">1034</div></td><td></td><td></td><td></td><td></td><td><div>1500</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path_walk($rule, \&amp;distribute_rule, &#39;Router&#39;);</td></tr>
<tr><td class="h">16094</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16095</td><td colspan="7"></td></tr><tr><td class="h">16096</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>579</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;add_router_acls();</td></tr>
<tr><td class="h">16097</td><td colspan="7"></td></tr><tr><td class="h">16098</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No longer needed, free some memory.</td></tr>
<tr><td class="h">16099</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>509</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%obj2path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">16100</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>426</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%key2obj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">16101</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>312</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16103</td><td colspan="7"></td></tr><tr><td class="h">16104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">16105</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># ACL Generation</td></tr>
<tr><td class="h">16106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">16107</td><td colspan="7"></td></tr><tr><td class="h">16108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Returns [ ip, mask ] pair</td></tr>
<tr><td class="h">16109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub address {</td></tr>
<tr><td class="h">16110</td><td><div class="c3">3396</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16110">3396</a></div></td><td><div class="c0">0</div></td><td><div>3935</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $no_nat_set) = @_;</td></tr>
<tr><td class="h">16111</td><td><div class="c3">3396</div></td><td></td><td></td><td></td><td></td><td><div>3389</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">16112</td><td><div class="c3">3396</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16112">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16112">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16112">50</a></div><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16112">0</a></div></td><td></td><td></td><td></td><td><div>6208</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Network&#39;) {</td></tr>
<tr><td class="h">16113</td><td><div class="c3">1238</div></td><td></td><td></td><td></td><td></td><td><div>1479</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj = get_nat_network($obj, $no_nat_set);</td></tr>
<tr><td class="h">16114</td><td colspan="7"></td></tr><tr><td class="h">16115</td><td><div class="c3">1238</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16115">50</a></div></td><td></td><td></td><td></td><td><div>1912</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{ip} eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">16116</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;Unexpected unnumbered $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">16117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16119</td><td><div class="c3">1238</div></td><td></td><td></td><td></td><td></td><td><div>3172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $obj-&gt;{ip}, $obj-&gt;{mask} ];</td></tr>
<tr><td class="h">16120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16121</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Subnet&#39;) {</td></tr>
<tr><td class="h">16123</td><td><div class="c3">150</div></td><td></td><td></td><td></td><td></td><td><div>228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = get_nat_network($obj-&gt;{network}, $no_nat_set);</td></tr>
<tr><td class="h">16124</td><td><div class="c3">150</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16124">100</a></div></td><td></td><td></td><td></td><td><div>262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $nat_tag = $network-&gt;{dynamic}) {</td></tr>
<tr><td class="h">16125</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16125">100</a></div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = $obj-&gt;{nat}-&gt;{$nat_tag}) {</td></tr>
<tr><td class="h">16126</td><td colspan="7"></td></tr><tr><td class="h">16127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single static NAT IP for this host.</td></tr>
<tr><td class="h">16128</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $ip, 0xffffffff ];</td></tr>
<tr><td class="h">16129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16130</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16131</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $network-&gt;{ip}, $network-&gt;{mask} ];</td></tr>
<tr><td class="h">16132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16135</td><td colspan="7"></td></tr><tr><td class="h">16136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take higher bits from network NAT, lower bits from original IP.</td></tr>
<tr><td class="h">16137</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This works with and without NAT.</td></tr>
<tr><td class="h">16138</td><td><div class="c3">142</div></td><td></td><td></td><td></td><td></td><td><div>302</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip =</td></tr>
<tr><td class="h">16139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{ip} | $obj-&gt;{ip} &amp; complement_32bit $network-&gt;{mask};</td></tr>
<tr><td class="h">16140</td><td><div class="c3">142</div></td><td></td><td></td><td></td><td></td><td><div>364</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $ip, $obj-&gt;{mask} ];</td></tr>
<tr><td class="h">16141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">16144</td><td><div class="c3">2008</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16144">50</a></div></td><td></td><td></td><td></td><td><div>4842</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{ip} =~ /^(unnumbered|short)$/) {</td></tr>
<tr><td class="h">16145</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;Unexpected $obj-&gt;{ip} $obj-&gt;{name}&quot;);</td></tr>
<tr><td class="h">16146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16147</td><td colspan="7"></td></tr><tr><td class="h">16148</td><td><div class="c3">2008</div></td><td></td><td></td><td></td><td></td><td><div>2650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = get_nat_network($obj-&gt;{network}, $no_nat_set);</td></tr>
<tr><td class="h">16149</td><td colspan="7"></td></tr><tr><td class="h">16150</td><td><div class="c3">2008</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16150">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16150">100</a></div></td><td></td><td></td><td></td><td><div>3987</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{ip} eq &#39;negotiated&#39;) {</td></tr>
<tr><td class="h">16151</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($network_ip, $network_mask) = @{$network}{ &#39;ip&#39;, &#39;mask&#39; };</td></tr>
<tr><td class="h">16152</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $network_ip, $network_mask ];</td></tr>
<tr><td class="h">16153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif (my $nat_tag = $network-&gt;{dynamic}) {</td></tr>
<tr><td class="h">16155</td><td><div class="c3">10</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16155">50</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ip = $obj-&gt;{nat}-&gt;{$nat_tag}) {</td></tr>
<tr><td class="h">16156</td><td colspan="7"></td></tr><tr><td class="h">16157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single static NAT IP for this interface.</td></tr>
<tr><td class="h">16158</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $ip, 0xffffffff ];</td></tr>
<tr><td class="h">16159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16160</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16161</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $network-&gt;{ip}, $network-&gt;{mask} ];</td></tr>
<tr><td class="h">16162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16165</td><td colspan="7"></td></tr><tr><td class="h">16166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take higher bits from network NAT, lower bits from original IP.</td></tr>
<tr><td class="h">16167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This works with and without NAT.</td></tr>
<tr><td class="h">16168</td><td><div class="c3">1996</div></td><td></td><td></td><td></td><td></td><td><div>3781</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip =</td></tr>
<tr><td class="h">16169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$network-&gt;{ip} | $obj-&gt;{ip} &amp; complement_32bit $network-&gt;{mask};</td></tr>
<tr><td class="h">16170</td><td><div class="c3">1996</div></td><td></td><td></td><td></td><td></td><td><div>4469</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ $ip, 0xffffffff ];</td></tr>
<tr><td class="h">16171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($type eq &#39;Objectgroup&#39;) {</td></tr>
<tr><td class="h">16174</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $obj;</td></tr>
<tr><td class="h">16175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16177</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref $obj;</td></tr>
<tr><td class="h">16178</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_err(&quot;Unexpected object of type &#39;$type&#39;&quot;);</td></tr>
<tr><td class="h">16179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16181</td><td colspan="7"></td></tr><tr><td class="h">16182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub ios_route_code {</td></tr>
<tr><td class="h">16183</td><td><div class="c3">666</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16183">666</a></div></td><td><div class="c0">0</div></td><td><div>621</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($pair) = @_;</td></tr>
<tr><td class="h">16184</td><td><div class="c3">666</div></td><td></td><td></td><td></td><td></td><td><div>746</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @$pair;</td></tr>
<tr><td class="h">16185</td><td><div class="c3">666</div></td><td></td><td></td><td></td><td></td><td><div>712</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip_code&nbsp;&nbsp;&nbsp;= print_ip($ip);</td></tr>
<tr><td class="h">16186</td><td><div class="c3">666</div></td><td></td><td></td><td></td><td></td><td><div>817</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mask_code = print_ip($mask);</td></tr>
<tr><td class="h">16187</td><td><div class="c3">666</div></td><td></td><td></td><td></td><td></td><td><div>1243</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$ip_code $mask_code&quot;;</td></tr>
<tr><td class="h">16188</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16189</td><td colspan="7"></td></tr><tr><td class="h">16190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Given an IP and mask, return its address</td></tr>
<tr><td class="h">16191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># as &quot;x.x.x.x/x&quot; or &quot;x.x.x.x&quot; if prefix == 32.</td></tr>
<tr><td class="h">16192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub prefix_code {</td></tr>
<tr><td class="h">16193</td><td><div class="c3">116</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16193">116</a></div></td><td><div class="c0">0</div></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($pair) = @_;</td></tr>
<tr><td class="h">16194</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @$pair;</td></tr>
<tr><td class="h">16195</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip_code&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip($ip);</td></tr>
<tr><td class="h">16196</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td></td><td><div>201</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prefix_code = mask2prefix($mask);</td></tr>
<tr><td class="h">16197</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16197">100</a></div></td><td></td><td></td><td></td><td><div>366</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $prefix_code == 32 ? $ip_code : &quot;$ip_code/$prefix_code&quot;;</td></tr>
<tr><td class="h">16198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16199</td><td colspan="7"></td></tr><tr><td class="h">16200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub full_prefix_code {</td></tr>
<tr><td class="h">16201</td><td><div class="c3">3228</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16201">3228</a></div></td><td><div class="c0">0</div></td><td><div>2777</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($pair) = @_;</td></tr>
<tr><td class="h">16202</td><td><div class="c3">3228</div></td><td></td><td></td><td></td><td></td><td><div>3080</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($ip, $mask) = @$pair;</td></tr>
<tr><td class="h">16203</td><td><div class="c3">3228</div></td><td></td><td></td><td></td><td></td><td><div>3641</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ip_code&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip($ip);</td></tr>
<tr><td class="h">16204</td><td><div class="c3">3228</div></td><td></td><td></td><td></td><td></td><td><div>5134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prefix_code = mask2prefix($mask);</td></tr>
<tr><td class="h">16205</td><td><div class="c3">3228</div></td><td></td><td></td><td></td><td></td><td><div>11569</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$ip_code/$prefix_code&quot;;</td></tr>
<tr><td class="h">16206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16207</td><td colspan="7"></td></tr><tr><td class="h">16208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $deny_any_rule;</td></tr>
<tr><td class="h">16209</td><td colspan="7"></td></tr><tr><td class="h">16210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_acl_placeholder {</td></tr>
<tr><td class="h">16211</td><td><div class="c3">2144</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16211">2144</a></div></td><td><div class="c0">0</div></td><td><div>2002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($acl_name) = @_;</td></tr>
<tr><td class="h">16212</td><td><div class="c3">2144</div></td><td></td><td></td><td></td><td></td><td><div>4305</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;#insert $acl_name\n&quot;;</td></tr>
<tr><td class="h">16213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16214</td><td colspan="7"></td></tr><tr><td class="h">16215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Parameter: Interface</td></tr>
<tr><td class="h">16216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Analyzes dst_list of all rules collected at this interface.</td></tr>
<tr><td class="h">16217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Result:</td></tr>
<tr><td class="h">16218</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Array reference to sorted list of all networks which are allowed</td></tr>
<tr><td class="h">16219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># to pass this interface.</td></tr>
<tr><td class="h">16220</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_split_tunnel_nets {</td></tr>
<tr><td class="h">16221</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16221">8</a></div></td><td><div class="c0">0</div></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface) = @_;</td></tr>
<tr><td class="h">16222</td><td colspan="7"></td></tr><tr><td class="h">16223</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %split_tunnel_nets;</td></tr>
<tr><td class="h">16224</td><td><div class="c3">8</div><div class="c3">8</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>7</div><div>12</div><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@{ $interface-&gt;{rules} }, @{ $interface-&gt;{intf_rules} }) {</td></tr>
<tr><td class="h">16225</td><td><div class="c3">10</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16225">50</a></div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $rule-&gt;{deny};</td></tr>
<tr><td class="h">16226</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_list = $rule-&gt;{dst};</td></tr>
<tr><td class="h">16227</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $dst (@$dst_list) {</td></tr>
<tr><td class="h">16228</td><td><div class="c3">16</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16228">67</a></div></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $dst_network = $dst-&gt;{network} || $dst;</td></tr>
<tr><td class="h">16229</td><td colspan="7"></td></tr><tr><td class="h">16230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t add &#39;any&#39; (resulting from global:permit)</td></tr>
<tr><td class="h">16231</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# to split_tunnel networks.</td></tr>
<tr><td class="h">16232</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16232">100</a></div></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $dst_network-&gt;{mask} == 0;</td></tr>
<tr><td class="h">16233</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$split_tunnel_nets{$dst_network} = $dst_network;</td></tr>
<tr><td class="h">16234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16236</td><td><div class="c3">8</div><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16236">50</a></div></td><td></td><td></td><td></td><td><div>24</div><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ sort { $a-&gt;{ip} &lt;=&gt; $b-&gt;{ip} || $a-&gt;{mask} &lt;=&gt; $b-&gt;{mask} }</td></tr>
<tr><td class="h">16237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %split_tunnel_nets ];</td></tr>
<tr><td class="h">16238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16239</td><td colspan="7"></td></tr><tr><td class="h">16240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %asa_vpn_attr_need_value =</td></tr>
<tr><td class="h">16241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;map { $_ =&gt; 1 }</td></tr>
<tr><td class="h">16242</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;qw(banner dns-server default-domain split-dns wins-server address-pools</td></tr>
<tr><td class="h">16243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;split-tunnel-network-list vpn-filter);</td></tr>
<tr><td class="h">16244</td><td colspan="7"></td></tr><tr><td class="h">16245</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_asavpn {</td></tr>
<tr><td class="h">16246</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16246">6</a></div></td><td><div class="c0">0</div></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router)&nbsp;&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">16247</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">16248</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $router-&gt;{hardware}-&gt;[0]-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16249</td><td colspan="7"></td></tr><tr><td class="h">16250</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $global_group_name = &#39;global&#39;;</td></tr>
<tr><td class="h">16251</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16252</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">group-policy $global_group_name internal</td></tr>
<tr><td class="h">16253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">group-policy $global_group_name attributes</td></tr>
<tr><td class="h">16254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> pfs enable</td></tr>
<tr><td class="h">16255</td><td colspan="7"></td></tr><tr><td class="h">16256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16257</td><td colspan="7"></td></tr><tr><td class="h">16258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Define tunnel group used for single VPN users.</td></tr>
<tr><td class="h">16259</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $default_tunnel_group = &#39;VPN-single&#39;;</td></tr>
<tr><td class="h">16260</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $trust_point&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{trust_point};</td></tr>
<tr><td class="h">16261</td><td colspan="7"></td></tr><tr><td class="h">16262</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16263</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $default_tunnel_group type remote-access</td></tr>
<tr><td class="h">16264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $default_tunnel_group general-attributes</td></tr>
<tr><td class="h">16265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> authorization-server-group LOCAL</td></tr>
<tr><td class="h">16266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> default-group-policy $global_group_name</td></tr>
<tr><td class="h">16267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> authorization-required</td></tr>
<tr><td class="h">16268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> username-from-certificate EA</td></tr>
<tr><td class="h">16269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $default_tunnel_group ipsec-attributes</td></tr>
<tr><td class="h">16270</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> chain</td></tr>
<tr><td class="h">16271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16272</td><td colspan="7"></td></tr><tr><td class="h">16273</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> ikev1 trust-point $trust_point</td></tr>
<tr><td class="h">16275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> ikev1 user-authentication none</td></tr>
<tr><td class="h">16276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $default_tunnel_group webvpn-attributes</td></tr>
<tr><td class="h">16277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> authentication certificate</td></tr>
<tr><td class="h">16278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16279</td><td colspan="7"></td></tr><tr><td class="h">16280</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group-map default-group $default_tunnel_group</td></tr>
<tr><td class="h">16282</td><td colspan="7"></td></tr><tr><td class="h">16283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16284</td><td colspan="7"></td></tr><tr><td class="h">16285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $print_group_policy = sub {</td></tr>
<tr><td class="h">16286</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16286">8</a></div></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $attributes) = @_;</td></tr>
<tr><td class="h">16287</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;group-policy $name internal\n&quot;;</td></tr>
<tr><td class="h">16288</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;group-policy $name attributes\n&quot;;</td></tr>
<tr><td class="h">16289</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %$attributes) {</td></tr>
<tr><td class="h">16290</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = $attributes-&gt;{$key};</td></tr>
<tr><td class="h">16291</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out&nbsp;&nbsp;&nbsp;= $key;</td></tr>
<tr><td class="h">16292</td><td><div class="c3">20</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16292">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined($value)) {</td></tr>
<tr><td class="h">16293</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16293">100</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out .= &#39; value&#39; if $asa_vpn_attr_need_value{$key};</td></tr>
<tr><td class="h">16294</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out .= &quot; $value&quot;;</td></tr>
<tr><td class="h">16295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16296</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>44</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; $out\n&quot;;</td></tr>
<tr><td class="h">16297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16298</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16299</td><td colspan="7"></td></tr><tr><td class="h">16300</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %cert_group_map;</td></tr>
<tr><td class="h">16301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %single_cert_map;</td></tr>
<tr><td class="h">16302</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user_counter = 0;</td></tr>
<tr><td class="h">16303</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">16304</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16304">100</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if not $interface-&gt;{ip} eq &#39;tunnel&#39;;</td></tr>
<tr><td class="h">16305</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %split_t_cache;</td></tr>
<tr><td class="h">16306</td><td colspan="7"></td></tr><tr><td class="h">16307</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16307">100</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $hash = $interface-&gt;{id_rules}) {</td></tr>
<tr><td class="h">16308</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $id (sort keys %$hash) {</td></tr>
<tr><td class="h">16309</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id_intf = $hash-&gt;{$id};</td></tr>
<tr><td class="h">16310</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $src&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $id_intf-&gt;{src};</td></tr>
<tr><td class="h">16311</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_counter++;</td></tr>
<tr><td class="h">16312</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pool_name;</td></tr>
<tr><td class="h">16313</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attributes = {</td></tr>
<tr><td class="h">16314</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{ $router-&gt;{radius_attributes} },</td></tr>
<tr><td class="h">16315</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{ $src-&gt;{network}-&gt;{radius_attributes} },</td></tr>
<tr><td class="h">16316</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{ $src-&gt;{radius_attributes} },</td></tr>
<tr><td class="h">16317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16318</td><td colspan="7"></td></tr><tr><td class="h">16319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Define split tunnel ACL.</td></tr>
<tr><td class="h">16320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use default value if not defined.</td></tr>
<tr><td class="h">16321</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $split_tunnel_policy = $attributes-&gt;{&#39;split-tunnel-policy&#39;};</td></tr>
<tr><td class="h">16322</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16322">100</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16322">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16322">50</a></div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not defined $split_tunnel_policy) {</td></tr>
<tr><td class="h">16323</td><td colspan="7"></td></tr><tr><td class="h">16324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Do nothing.</td></tr>
<tr><td class="h">16325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($split_tunnel_policy eq &#39;tunnelall&#39;) {</td></tr>
<tr><td class="h">16327</td><td colspan="7"></td></tr><tr><td class="h">16328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is the default value.</td></tr>
<tr><td class="h">16329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prevent new group-policy to be created.</td></tr>
<tr><td class="h">16330</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $attributes-&gt;{&#39;split-tunnel-policy&#39;};</td></tr>
<tr><td class="h">16331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16332</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($split_tunnel_policy eq &#39;tunnelspecified&#39;) {</td></tr>
<tr><td class="h">16333</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $split_tunnel_nets = get_split_tunnel_nets($id_intf);</td></tr>
<tr><td class="h">16334</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_name;</td></tr>
<tr><td class="h">16335</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16335">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $href = $split_t_cache{@$split_tunnel_nets}) {</td></tr>
<tr><td class="h">16336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CACHED_NETS:</td></tr>
<tr><td class="h">16337</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $cached_name (keys %$href) {</td></tr>
<tr><td class="h">16338</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cached_nets = $href-&gt;{$cached_name};</td></tr>
<tr><td class="h">16339</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (my $i = 0 ; $i &lt; @$cached_nets ; $i++) {</td></tr>
<tr><td class="h">16340</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16340">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($split_tunnel_nets-&gt;[$i] ne</td></tr>
<tr><td class="h">16341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cached_nets-&gt;[$i])</td></tr>
<tr><td class="h">16342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">16343</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next CACHED_NETS;</td></tr>
<tr><td class="h">16344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16346</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_name = $cached_name;</td></tr>
<tr><td class="h">16347</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">16348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16350</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16350">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $acl_name) {</td></tr>
<tr><td class="h">16351</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_name = &quot;split-tunnel-$user_counter&quot;;</td></tr>
<tr><td class="h">16352</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules;</td></tr>
<tr><td class="h">16353</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16353">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$split_tunnel_nets) {</td></tr>
<tr><td class="h">16354</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rules = [ {</td></tr>
<tr><td class="h">16355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; $split_tunnel_nets,</td></tr>
<tr><td class="h">16356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">16357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt_ip ],</td></tr>
<tr><td class="h">16358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} ];</td></tr>
<tr><td class="h">16359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16361</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rules = [ $deny_any_rule ];</td></tr>
<tr><td class="h">16362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16363</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$split_t_cache{@$split_tunnel_nets}-&gt;{$acl_name} =</td></tr>
<tr><td class="h">16364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$split_tunnel_nets;</td></tr>
<tr><td class="h">16365</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16366</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $acl_name,</td></tr>
<tr><td class="h">16367</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $rules,</td></tr>
<tr><td class="h">16368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $no_nat_set,</td></tr>
<tr><td class="h">16369</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_std_acl&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">16370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_crypto_acl =&gt; 1,</td></tr>
<tr><td class="h">16371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16372</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16373</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($acl_name);</td></tr>
<tr><td class="h">16374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16375</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$attributes-&gt;{&#39;split-tunnel-network-list&#39;} = $acl_name;</td></tr>
<tr><td class="h">16376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16377</td><td colspan="7"></td></tr><tr><td class="h">16378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Access list will be bound to cleartext interface.</td></tr>
<tr><td class="h">16379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only check for valid source address at vpn-filter.</td></tr>
<tr><td class="h">16380</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id_intf-&gt;{rules}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [</td></tr>
<tr><td class="h">16381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">16382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; [ $src ],</td></tr>
<tr><td class="h">16383</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">16384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt_ip ],</td></tr>
<tr><td class="h">16385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];</td></tr>
<tr><td class="h">16387</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $filter_name = &quot;vpn-filter-$user_counter&quot;;</td></tr>
<tr><td class="h">16388</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $filter_name,</td></tr>
<tr><td class="h">16390</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; delete $id_intf-&gt;{rules},</td></tr>
<tr><td class="h">16391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_deny =&gt; 1,</td></tr>
<tr><td class="h">16392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16394</td><td><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>8</div><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16395</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($filter_name);</td></tr>
<tr><td class="h">16396</td><td colspan="7"></td></tr><tr><td class="h">16397</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= print_ip $src-&gt;{ip};</td></tr>
<tr><td class="h">16398</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $network = $src-&gt;{network};</td></tr>
<tr><td class="h">16399</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16399">100</a></div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($src-&gt;{mask} == 0xffffffff) {</td></tr>
<tr><td class="h">16400</td><td colspan="7"></td></tr><tr><td class="h">16401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For anyconnect clients.</td></tr>
<tr><td class="h">16402</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $domain) = ($id =~ /^(.*?)(\@.*)$/);</td></tr>
<tr><td class="h">16403</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$single_cert_map{$domain} = 1;</td></tr>
<tr><td class="h">16404</td><td colspan="7"></td></tr><tr><td class="h">16405</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = print_ip $network-&gt;{mask};</td></tr>
<tr><td class="h">16406</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group_policy_name;</td></tr>
<tr><td class="h">16407</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16407">100</a></div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (%$attributes) {</td></tr>
<tr><td class="h">16408</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$group_policy_name = &quot;VPN-group-$user_counter&quot;;</td></tr>
<tr><td class="h">16409</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print_group_policy-&gt;($group_policy_name, $attributes);</td></tr>
<tr><td class="h">16410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16411</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;username $id nopassword\n&quot;;</td></tr>
<tr><td class="h">16412</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;username $id attributes\n&quot;;</td></tr>
<tr><td class="h">16413</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; vpn-framed-ip-address $ip $mask\n&quot;;</td></tr>
<tr><td class="h">16414</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; service-type remote-access\n&quot;;</td></tr>
<tr><td class="h">16415</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; vpn-filter value $filter_name\n&quot;;</td></tr>
<tr><td class="h">16416</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16416">100</a></div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; vpn-group-policy $group_policy_name\n&quot;</td></tr>
<tr><td class="h">16417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $group_policy_name;</td></tr>
<tr><td class="h">16418</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">16419</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16421</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pool_name = &quot;pool-$user_counter&quot;;</td></tr>
<tr><td class="h">16422</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = print_ip $src-&gt;{mask};</td></tr>
<tr><td class="h">16423</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max =</td></tr>
<tr><td class="h">16424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_ip($src-&gt;{ip} | complement_32bit $src-&gt;{mask});</td></tr>
<tr><td class="h">16425</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subject_name =</td></tr>
<tr><td class="h">16426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $attributes-&gt;{&#39;check-subject-name&#39;};</td></tr>
<tr><td class="h">16427</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16427">100</a></div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($id =~ /^@/) {</td></tr>
<tr><td class="h">16428</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subject_name = &#39;ea&#39;;</td></tr>
<tr><td class="h">16429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16430</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $map_name = &quot;ca-map-$user_counter&quot;;</td></tr>
<tr><td class="h">16431</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto ca certificate map $map_name 10\n&quot;;</td></tr>
<tr><td class="h">16432</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; subject-name attr $subject_name co $id\n&quot;;</td></tr>
<tr><td class="h">16433</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;ip local pool $pool_name $ip-$max mask $mask\n&quot;;</td></tr>
<tr><td class="h">16434</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$attributes-&gt;{&#39;vpn-filter&#39;}&nbsp;&nbsp;&nbsp;&nbsp;= $filter_name;</td></tr>
<tr><td class="h">16435</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$attributes-&gt;{&#39;address-pools&#39;} = $pool_name;</td></tr>
<tr><td class="h">16436</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group_policy_name = &quot;VPN-group-$user_counter&quot;;</td></tr>
<tr><td class="h">16437</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @tunnel_gen_att =</td></tr>
<tr><td class="h">16438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&quot;default-group-policy $group_policy_name&quot;);</td></tr>
<tr><td class="h">16439</td><td colspan="7"></td></tr><tr><td class="h">16440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Select attributes for tunnel-group general-attributes.</td></tr>
<tr><td class="h">16441</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $key (sort keys %$attributes) {</td></tr>
<tr><td class="h">16442</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $spec = $asa_vpn_attributes{$key};</td></tr>
<tr><td class="h">16443</td><td><div class="c3">20</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16443">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16443">67</a></div></td><td></td><td></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($spec &amp;&amp; $spec-&gt;{tg_general}) {</td></tr>
<tr><td class="h">16444</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = delete $attributes-&gt;{$key};</td></tr>
<tr><td class="h">16445</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16445">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $out = defined($value) ? &quot;$key $value&quot; : $key;</td></tr>
<tr><td class="h">16446</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@tunnel_gen_att, $out);</td></tr>
<tr><td class="h">16447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16449</td><td colspan="7"></td></tr><tr><td class="h">16450</td><td><div class="c3">4</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16450">33</a></div></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $trustpoint2 = delete $attributes-&gt;{&#39;trust-point&#39;}</td></tr>
<tr><td class="h">16451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $trust_point;</td></tr>
<tr><td class="h">16452</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @tunnel_ipsec_att =</td></tr>
<tr><td class="h">16453</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</td></tr>
<tr><td class="h">16454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ikev1 trust-point $trustpoint2&quot;,</td></tr>
<tr><td class="h">16455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ikev1 user-authentication none&#39;</td></tr>
<tr><td class="h">16456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">16457</td><td colspan="7"></td></tr><tr><td class="h">16458</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print_group_policy-&gt;($group_policy_name, $attributes);</td></tr>
<tr><td class="h">16459</td><td colspan="7"></td></tr><tr><td class="h">16460</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tunnel_group_name = &quot;VPN-tunnel-$user_counter&quot;;</td></tr>
<tr><td class="h">16461</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $tunnel_group_name type remote-access</td></tr>
<tr><td class="h">16463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $tunnel_group_name general-attributes</td></tr>
<tr><td class="h">16464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16465</td><td colspan="7"></td></tr><tr><td class="h">16466</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $line (@tunnel_gen_att) {</td></tr>
<tr><td class="h">16467</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; $line\n&quot;;</td></tr>
<tr><td class="h">16468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16469</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $tunnel_group_name ipsec-attributes</td></tr>
<tr><td class="h">16471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16472</td><td colspan="7"></td></tr><tr><td class="h">16473</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $line (@tunnel_ipsec_att) {</td></tr>
<tr><td class="h">16474</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; $line\n&quot;;</td></tr>
<tr><td class="h">16475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16476</td><td colspan="7"></td></tr><tr><td class="h">16477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# For anyconnect clients.</td></tr>
<tr><td class="h">16478</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group $tunnel_group_name webvpn-attributes</td></tr>
<tr><td class="h">16480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"> authentication certificate</td></tr>
<tr><td class="h">16481</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16482</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cert_group_map{$map_name} = $tunnel_group_name;</td></tr>
<tr><td class="h">16483</td><td colspan="7"></td></tr><tr><td class="h">16484</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &lt;&lt;&quot;EOF&quot;;</td></tr>
<tr><td class="h">16485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">tunnel-group-map ca-map-$user_counter 10 $tunnel_group_name</td></tr>
<tr><td class="h">16486</td><td colspan="7"></td></tr><tr><td class="h">16487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">EOF</td></tr>
<tr><td class="h">16488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16491</td><td colspan="7"></td></tr><tr><td class="h">16492</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# A VPN network.</td></tr>
<tr><td class="h">16493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16494</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_counter++;</td></tr>
<tr><td class="h">16495</td><td colspan="7"></td></tr><tr><td class="h">16496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Access list will be bound to cleartext interface.</td></tr>
<tr><td class="h">16497</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only check for correct source address at vpn-filter.</td></tr>
<tr><td class="h">16498</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{intf_rules};</td></tr>
<tr><td class="h">16499</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $interface-&gt;{rules};</td></tr>
<tr><td class="h">16500</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules = [ { src =&gt; $interface-&gt;{peer_networks}, </td></tr>
<tr><td class="h">16501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $network_00 ], </td></tr>
<tr><td class="h">16502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt_ip ] } ];</td></tr>
<tr><td class="h">16503</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $filter_name = &quot;vpn-filter-$user_counter&quot;;</td></tr>
<tr><td class="h">16504</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $filter_name,</td></tr>
<tr><td class="h">16506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; $rules,</td></tr>
<tr><td class="h">16507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_deny =&gt; 1,</td></tr>
<tr><td class="h">16508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16510</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16511</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($filter_name);</td></tr>
<tr><td class="h">16512</td><td colspan="7"></td></tr><tr><td class="h">16513</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16513">50</a></div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id = $interface-&gt;{peers}-&gt;[0]-&gt;{id}</td></tr>
<tr><td class="h">16514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Missing ID at $interface-&gt;{peers}-&gt;[0]-&gt;{name}&quot;);</td></tr>
<tr><td class="h">16515</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $attributes = $router-&gt;{radius_attributes};</td></tr>
<tr><td class="h">16516</td><td colspan="7"></td></tr><tr><td class="h">16517</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group_policy_name;</td></tr>
<tr><td class="h">16518</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16518">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (keys %$attributes) {</td></tr>
<tr><td class="h">16519</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$group_policy_name = &quot;VPN-router-$user_counter&quot;;</td></tr>
<tr><td class="h">16520</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$print_group_policy-&gt;($group_policy_name, $attributes);</td></tr>
<tr><td class="h">16521</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16522</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;username $id nopassword\n&quot;;</td></tr>
<tr><td class="h">16523</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;username $id attributes\n&quot;;</td></tr>
<tr><td class="h">16524</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; service-type remote-access\n&quot;;</td></tr>
<tr><td class="h">16525</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; vpn-filter value $filter_name\n&quot;;</td></tr>
<tr><td class="h">16526</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16526">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; vpn-group-policy $group_policy_name\n&quot;</td></tr>
<tr><td class="h">16527</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $group_policy_name;</td></tr>
<tr><td class="h">16528</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">16529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16531</td><td colspan="7"></td></tr><tr><td class="h">16532</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Generate certificate-group-map for anyconnect/ikev2 clients.</td></tr>
<tr><td class="h">16533</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16533">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16533">100</a></div></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (keys %cert_group_map or keys %single_cert_map) {</td></tr>
<tr><td class="h">16534</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $id (sort keys %single_cert_map) {</td></tr>
<tr><td class="h">16535</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user_counter++;</td></tr>
<tr><td class="h">16536</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $map_name = &quot;ca-map-$user_counter&quot;;</td></tr>
<tr><td class="h">16537</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto ca certificate map $map_name 10\n&quot;;</td></tr>
<tr><td class="h">16538</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; subject-name attr ea co $id\n&quot;;</td></tr>
<tr><td class="h">16539</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cert_group_map{$map_name} = $default_tunnel_group;</td></tr>
<tr><td class="h">16540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16541</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;webvpn\n&quot;;</td></tr>
<tr><td class="h">16542</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $map_name (sort keys %cert_group_map) {</td></tr>
<tr><td class="h">16543</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tunnel_group_map = $cert_group_map{$map_name};</td></tr>
<tr><td class="h">16544</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; certificate-group-map $map_name 10 $tunnel_group_map\n&quot;;</td></tr>
<tr><td class="h">16545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16547</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16549</td><td colspan="7"></td></tr><tr><td class="h">16550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Pre-processing for all interfaces.</td></tr>
<tr><td class="h">16551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_acl_prefix {</td></tr>
<tr><td class="h">16552</td><td><div class="c3">972</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16552">972</a></div></td><td><div class="c0">0</div></td><td><div>870</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">16553</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>998</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">16554</td><td><div class="c3">972</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16554">100</a></div></td><td></td><td></td><td></td><td><div>1845</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $model-&gt;{filter} ne &#39;iptables&#39;;</td></tr>
<tr><td class="h">16555</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $comment_char = $model-&gt;{comment_char};</td></tr>
<tr><td class="h">16556</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$comment_char [ PREFIX ]\n&quot;;</td></tr>
<tr><td class="h">16557</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;#!/sbin/iptables-restore &lt;&lt;EOF\n&quot;;</td></tr>
<tr><td class="h">16558</td><td colspan="7"></td></tr><tr><td class="h">16559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Excempt loopback packets from connection tracking.</td></tr>
<tr><td class="h">16560</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;*raw\n&quot;;</td></tr>
<tr><td class="h">16561</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;:PREROUTING ACCEPT\n&quot;;</td></tr>
<tr><td class="h">16562</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;:OUTPUT ACCEPT\n&quot;;</td></tr>
<tr><td class="h">16563</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A PREROUTING -i lo -j NOTRACK\n&quot;;</td></tr>
<tr><td class="h">16564</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A OUTPUT -o lo -j NOTRACK\n&quot;;</td></tr>
<tr><td class="h">16565</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;COMMIT\n&quot;;</td></tr>
<tr><td class="h">16566</td><td colspan="7"></td></tr><tr><td class="h">16567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Start filter table</td></tr>
<tr><td class="h">16568</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;*filter\n&quot;;</td></tr>
<tr><td class="h">16569</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;:INPUT DROP\n&quot;;</td></tr>
<tr><td class="h">16570</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>63</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;:FORWARD DROP\n&quot;;</td></tr>
<tr><td class="h">16571</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>62</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;:OUTPUT ACCEPT\n&quot;;</td></tr>
<tr><td class="h">16572</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A INPUT -j ACCEPT -m state --state ESTABLISHED,RELATED\n&quot;;</td></tr>
<tr><td class="h">16573</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A FORWARD -j ACCEPT -m state --state ESTABLISHED,RELATED\n&quot;;</td></tr>
<tr><td class="h">16574</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A INPUT -j ACCEPT -i lo\n&quot;;</td></tr>
<tr><td class="h">16575</td><td colspan="7"></td></tr><tr><td class="h">16576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Add user defined chain &#39;droplog&#39;.</td></tr>
<tr><td class="h">16577</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;:droplog -\n&quot;;</td></tr>
<tr><td class="h">16578</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A droplog -j LOG --log-level debug\n&quot;;</td></tr>
<tr><td class="h">16579</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>59</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A droplog -j DROP\n&quot;;</td></tr>
<tr><td class="h">16580</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">16581</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16583</td><td colspan="7"></td></tr><tr><td class="h">16584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_acl_suffix {</td></tr>
<tr><td class="h">16585</td><td><div class="c3">972</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16585">972</a></div></td><td><div class="c0">0</div></td><td><div>891</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">16586</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>981</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">16587</td><td><div class="c3">972</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16587">100</a></div></td><td></td><td></td><td></td><td><div>1726</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $model-&gt;{filter} ne &#39;iptables&#39;;</td></tr>
<tr><td class="h">16588</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $comment_char = $model-&gt;{comment_char};</td></tr>
<tr><td class="h">16589</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$comment_char [ SUFFIX ]\n&quot;;</td></tr>
<tr><td class="h">16590</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A INPUT -j droplog\n&quot;;</td></tr>
<tr><td class="h">16591</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A FORWARD -j droplog\n&quot;;</td></tr>
<tr><td class="h">16592</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;COMMIT\n&quot;;</td></tr>
<tr><td class="h">16593</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;EOF\n&quot;;</td></tr>
<tr><td class="h">16594</td><td><div class="c3">68</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16596</td><td colspan="7"></td></tr><tr><td class="h">16597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_iptables_acls {</td></tr>
<tr><td class="h">16598</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16598">70</a></div></td><td><div class="c0">0</div></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">16599</td><td><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>57</div><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">16600</td><td colspan="7"></td></tr><tr><td class="h">16601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore if all logical interfaces are loopback interfaces.</td></tr>
<tr><td class="h">16602</td><td><div class="c3">124</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16602">100</a></div></td><td></td><td></td><td></td><td><div>215</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hardware-&gt;{loopback};</td></tr>
<tr><td class="h">16603</td><td colspan="7"></td></tr><tr><td class="h">16604</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $in_hw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $hardware-&gt;{name};</td></tr>
<tr><td class="h">16605</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $hardware-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16606</td><td colspan="7"></td></tr><tr><td class="h">16607</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect interface rules.</td></tr>
<tr><td class="h">16608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add call to chain in INPUT chain.</td></tr>
<tr><td class="h">16609</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>194</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf_acl_name = &quot;${in_hw}_self&quot;;</td></tr>
<tr><td class="h">16610</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>344</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf_acl_info = {</td></tr>
<tr><td class="h">16611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $intf_acl_name,</td></tr>
<tr><td class="h">16612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; delete $hardware-&gt;{intf_rules},</td></tr>
<tr><td class="h">16613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_deny =&gt; 1,</td></tr>
<tr><td class="h">16614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16616</td><td><div class="c3">120</div><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>101</div><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $intf_acl_info;</td></tr>
<tr><td class="h">16617</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($intf_acl_name);</td></tr>
<tr><td class="h">16618</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>256</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A INPUT -j $intf_acl_name -i $in_hw\n&quot;;</td></tr>
<tr><td class="h">16619</td><td colspan="7"></td></tr><tr><td class="h">16620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect forward rules.</td></tr>
<tr><td class="h">16621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# One chain for each pair of in_intf / out_intf.</td></tr>
<tr><td class="h">16622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add call to chain in FORRWARD chain.</td></tr>
<tr><td class="h">16623</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules_hash = $hardware-&gt;{io_rules};</td></tr>
<tr><td class="h">16624</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>292</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $out_hw (sort keys %$rules_hash) {</td></tr>
<tr><td class="h">16625</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_name = &quot;${in_hw}_$out_hw&quot;;</td></tr>
<tr><td class="h">16626</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $acl_name,</td></tr>
<tr><td class="h">16628</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; delete $rules_hash-&gt;{$out_hw},</td></tr>
<tr><td class="h">16629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_deny =&gt; 1,</td></tr>
<tr><td class="h">16630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16631</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16632</td><td><div class="c3">48</div><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>48</div><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16633</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($acl_name);</td></tr>
<tr><td class="h">16634</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;-A FORWARD -j $acl_name -i $in_hw -o $out_hw\n&quot;;</td></tr>
<tr><td class="h">16635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16636</td><td colspan="7"></td></tr><tr><td class="h">16637</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Empty line after each chain.</td></tr>
<tr><td class="h">16638</td><td><div class="c3">120</div></td><td></td><td></td><td></td><td></td><td><div>247</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">16639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16640</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16642</td><td colspan="7"></td></tr><tr><td class="h">16643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_cisco_acls {</td></tr>
<tr><td class="h">16644</td><td><div class="c3">908</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16644">908</a></div></td><td><div class="c0">0</div></td><td><div>762</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">16645</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>849</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">16646</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>827</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $model-&gt;{filter};</td></tr>
<tr><td class="h">16647</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>1381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $managed_local = $router-&gt;{managed} =~ /^local/;</td></tr>
<tr><td class="h">16648</td><td colspan="7"></td></tr><tr><td class="h">16649</td><td><div class="c3">908</div><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>745</div><div>1287</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">16650</td><td colspan="7"></td></tr><tr><td class="h">16651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore if all logical interfaces are loopback interfaces.</td></tr>
<tr><td class="h">16652</td><td><div class="c3">1960</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16652">100</a></div></td><td></td><td></td><td></td><td><div>3040</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hardware-&gt;{loopback};</td></tr>
<tr><td class="h">16653</td><td colspan="7"></td></tr><tr><td class="h">16654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore layer3 interface of ASA.</td></tr>
<tr><td class="h">16655</td><td><div class="c3">1934</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16655">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16655">67</a></div></td><td></td><td></td><td><div>3588</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $hardware-&gt;{name} eq &#39;device&#39; &amp;&amp; $model-&gt;{class} eq &#39;ASA&#39;;</td></tr>
<tr><td class="h">16656</td><td colspan="7"></td></tr><tr><td class="h">16657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Force valid array reference to prevent error</td></tr>
<tr><td class="h">16658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# when checking for non empty array.</td></tr>
<tr><td class="h">16659</td><td><div class="c3">1924</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16659">100</a></div></td><td></td><td></td><td><div>3860</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hardware-&gt;{rules} ||= [];</td></tr>
<tr><td class="h">16660</td><td colspan="7"></td></tr><tr><td class="h">16661</td><td><div class="c3">1924</div></td><td></td><td></td><td></td><td></td><td><div>1720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $hardware-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16662</td><td colspan="7"></td></tr><tr><td class="h">16663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Generate code for incoming and possibly for outgoing ACL.</td></tr>
<tr><td class="h">16664</td><td><div class="c3">1924</div></td><td></td><td></td><td></td><td></td><td><div>1942</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $suffix (&#39;in&#39;, &#39;out&#39;) {</td></tr>
<tr><td class="h">16665</td><td><div class="c3">3848</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16665">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16665">100</a></div></td><td></td><td></td><td><div>11410</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $suffix eq &#39;out&#39; and not $hardware-&gt;{need_out_acl};</td></tr>
<tr><td class="h">16666</td><td colspan="7"></td></tr><tr><td class="h">16667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t generate single &#39;permit ip any any&#39;.</td></tr>
<tr><td class="h">16668</td><td><div class="c3">1954</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16668">100</a></div></td><td></td><td></td><td></td><td><div>2906</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$model-&gt;{need_acl}) {</td></tr>
<tr><td class="h">16669</td><td><div class="c3">638</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16669">100</a></div></td><td></td><td></td><td></td><td><div>652</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">16670</td><td><div class="c3">1276</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16670">100</a></div></td><td></td><td></td><td><div>2700</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!grep {</td></tr>
<tr><td class="h">16671</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules = $hardware-&gt;{$_} || [];</td></tr>
<tr><td class="h">16672</td><td><div class="c3">1276</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16672">100</a></div></td><td></td><td></td><td></td><td><div>3880</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$rules != 1 || $rules-&gt;[0] ne $permit_any_rule</td></tr>
<tr><td class="h">16673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} (qw(rules intf_rules))</td></tr>
<tr><td class="h">16674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">16675</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">16676</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">16677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16679</td><td colspan="7"></td></tr><tr><td class="h">16680</td><td><div class="c3">1938</div></td><td></td><td></td><td></td><td></td><td><div>3919</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_name = &quot;$hardware-&gt;{name}_$suffix&quot;;</td></tr>
<tr><td class="h">16681</td><td><div class="c3">1938</div></td><td></td><td></td><td></td><td></td><td><div>3885</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $acl_name,</td></tr>
<tr><td class="h">16683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16685</td><td colspan="7"></td></tr><tr><td class="h">16686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - Collect incoming ACLs,</td></tr>
<tr><td class="h">16687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - protect own interfaces,</td></tr>
<tr><td class="h">16688</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - set {filter_any_src}.</td></tr>
<tr><td class="h">16689</td><td><div class="c3">1938</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16689">100</a></div></td><td></td><td></td><td></td><td><div>2535</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($suffix eq &#39;in&#39;) {</td></tr>
<tr><td class="h">16690</td><td><div class="c3">1908</div></td><td></td><td></td><td></td><td></td><td><div>2609</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{rules} = delete $hardware-&gt;{rules};</td></tr>
<tr><td class="h">16691</td><td colspan="7"></td></tr><tr><td class="h">16692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Marker: Generate protect_self rules, if available.</td></tr>
<tr><td class="h">16693</td><td><div class="c3">1908</div></td><td></td><td></td><td></td><td></td><td><div>1911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{protect_self} = 1;</td></tr>
<tr><td class="h">16694</td><td colspan="7"></td></tr><tr><td class="h">16695</td><td><div class="c3">1908</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16695">100</a></div></td><td></td><td></td><td></td><td><div>2942</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{need_protect}) {</td></tr>
<tr><td class="h">16696</td><td><div class="c3">596</div></td><td></td><td></td><td></td><td></td><td><div>711</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{intf_rules} = $hardware-&gt;{intf_rules};</td></tr>
<tr><td class="h">16697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16698</td><td><div class="c3">1908</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16698">100</a></div></td><td></td><td></td><td></td><td><div>2401</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($hardware-&gt;{no_in_acl}) {</td></tr>
<tr><td class="h">16699</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{add_permit} = 1;</td></tr>
<tr><td class="h">16700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16702</td><td><div class="c3">1896</div></td><td></td><td></td><td></td><td></td><td><div>1915</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{add_deny} = 1;</td></tr>
<tr><td class="h">16703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16704</td><td colspan="7"></td></tr><tr><td class="h">16705</td><td><div class="c3">1908</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16705">100</a></div></td><td></td><td></td><td></td><td><div>2657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($managed_local) {</td></tr>
<tr><td class="h">16706</td><td colspan="7"></td></tr><tr><td class="h">16707</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If attached zone has only one connection to this</td></tr>
<tr><td class="h">16708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# firewall than we don&#39;t need to check the source</td></tr>
<tr><td class="h">16709</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# address. It has already been checked, that all</td></tr>
<tr><td class="h">16710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# networks of this zone match {filter_only}.</td></tr>
<tr><td class="h">16711</td><td><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $intf_ok = 0;</td></tr>
<tr><td class="h">16712</td><td><div class="c3">88</div><div class="c3">88</div></td><td></td><td></td><td></td><td></td><td><div>74</div><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $hardware-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">16713</td><td><div class="c3">92</div></td><td></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $zone = $interface-&gt;{zone};</td></tr>
<tr><td class="h">16714</td><td><div class="c3">92</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16714">50</a></div></td><td></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$zone-&gt;{zone_cluster} and last;</td></tr>
<tr><td class="h">16715</td><td colspan="7"></td></tr><tr><td class="h">16716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore real interface of virtual interface.</td></tr>
<tr><td class="h">16717</td><td><div class="c3">174</div><div class="c3">92</div></td><td></td><td></td><td></td><td></td><td><div>293</div><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @interfaces = grep({ !$_-&gt;{main_interface} } </td></tr>
<tr><td class="h">16718</td><td><div class="c3">92</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $zone-&gt;{interfaces} });</td></tr>
<tr><td class="h">16719</td><td colspan="7"></td></tr><tr><td class="h">16720</td><td><div class="c3">92</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16720">100</a></div></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@interfaces &gt; 1) {</td></tr>
<tr><td class="h">16721</td><td colspan="7"></td></tr><tr><td class="h">16722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Multilpe interfaces belonging to one redundancy</td></tr>
<tr><td class="h">16723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# group can&#39;t be used to cross the zone.</td></tr>
<tr><td class="h">16724</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @redundant =</td></tr>
<tr><td class="h">16725</td><td><div class="c3">114</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_ }</td></tr>
<tr><td class="h">16726</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;{ $_-&gt;{redundancy_interfaces} } @interfaces;</td></tr>
<tr><td class="h">16727</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16727">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16727">67</a></div></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@redundant == @interfaces and equal(@redundant)</td></tr>
<tr><td class="h">16728</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or last;</td></tr>
<tr><td class="h">16729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16730</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$intf_ok++;</td></tr>
<tr><td class="h">16731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16732</td><td><div class="c3">88</div><div class="c3">88</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16732">100</a></div></td><td></td><td></td><td></td><td><div>89</div><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($intf_ok == @{ $hardware-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">16733</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>380</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{filter_any_src} = 1;</td></tr>
<tr><td class="h">16734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16737</td><td colspan="7"></td></tr><tr><td class="h">16738</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Outgoing ACL</td></tr>
<tr><td class="h">16739</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16740</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{rules} = delete $hardware-&gt;{out_rules};</td></tr>
<tr><td class="h">16741</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl_info-&gt;{add_deny} = 1;</td></tr>
<tr><td class="h">16742</td><td colspan="7"></td></tr><tr><td class="h">16743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16744</td><td colspan="7"></td></tr><tr><td class="h">16745</td><td><div class="c3">1938</div><div class="c3">1938</div></td><td></td><td></td><td></td><td></td><td><div>1490</div><div>2603</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16746</td><td><div class="c3">1938</div></td><td></td><td></td><td></td><td></td><td><div>2534</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($acl_name);</td></tr>
<tr><td class="h">16747</td><td colspan="7"></td></tr><tr><td class="h">16748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Post-processing for hardware interface</td></tr>
<tr><td class="h">16749</td><td><div class="c3">1938</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16749">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16749">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16749">50</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16749">100</a></div></td><td></td><td></td><td><div>6992</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($filter eq &#39;IOS&#39; || $filter eq &#39;NX-OS&#39;) {</td></tr>
<tr><td class="h">16750</td><td><div class="c3">606</div></td><td></td><td></td><td></td><td></td><td><div>1817</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">16751</td><td><div class="c3">606</div></td><td></td><td></td><td></td><td></td><td><div>473</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $hardware-&gt;{subcmd} },</td></tr>
<tr><td class="h">16752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ip access-group $acl_name $suffix&quot;</td></tr>
<tr><td class="h">16753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">16754</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($filter eq &#39;ACE&#39;) {</td></tr>
<tr><td class="h">16756</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">16757</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $hardware-&gt;{subcmd} },</td></tr>
<tr><td class="h">16758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;access-group ${suffix}put $acl_name&quot;</td></tr>
<tr><td class="h">16759</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">16760</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($filter eq &#39;PIX&#39;) {</td></tr>
<tr><td class="h">16762</td><td><div class="c3">1316</div></td><td></td><td></td><td></td><td></td><td><div>4364</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;access-group $acl_name $suffix interface&quot;,</td></tr>
<tr><td class="h">16763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; $hardware-&gt;{name}\n&quot;;</td></tr>
<tr><td class="h">16764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16765</td><td colspan="7"></td></tr><tr><td class="h">16766</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Empty line after each ACL.</td></tr>
<tr><td class="h">16767</td><td><div class="c3">1938</div></td><td></td><td></td><td></td><td></td><td><div>3108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">16768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16770</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>1190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16772</td><td colspan="7"></td></tr><tr><td class="h">16773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub generate_acls {</td></tr>
<tr><td class="h">16774</td><td><div class="c3">978</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16774">978</a></div></td><td><div class="c0">0</div></td><td><div>806</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">16775</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>883</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">16776</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>939</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $filter&nbsp;&nbsp;&nbsp;= $model-&gt;{filter};</td></tr>
<tr><td class="h">16777</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>1236</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_header($router, &#39;ACL&#39;);</td></tr>
<tr><td class="h">16778</td><td colspan="7"></td></tr><tr><td class="h">16779</td><td><div class="c3">978</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16779">100</a></div></td><td></td><td></td><td></td><td><div>1376</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($filter eq &#39;iptables&#39;) {</td></tr>
<tr><td class="h">16780</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_iptables_acls($router);</td></tr>
<tr><td class="h">16781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16783</td><td><div class="c3">908</div></td><td></td><td></td><td></td><td></td><td><div>1115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_cisco_acls($router);</td></tr>
<tr><td class="h">16784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16785</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>1654</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16786</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16787</td><td colspan="7"></td></tr><tr><td class="h">16788</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub gen_crypto_rules {</td></tr>
<tr><td class="h">16789</td><td><div class="c3">20</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16789">20</a></div></td><td><div class="c0">0</div></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($local, $remote) = @_;</td></tr>
<tr><td class="h">16790</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ { src =&gt; $local, dst =&gt; $remote, prt =&gt; [$prt_ip] } ];</td></tr>
<tr><td class="h">16791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16792</td><td colspan="7"></td></tr><tr><td class="h">16793</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_ezvpn {</td></tr>
<tr><td class="h">16794</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16794">2</a></div></td><td><div class="c0">0</div></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router)&nbsp;&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">16795</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">16796</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @interfaces = @{ $router-&gt;{interfaces} };</td></tr>
<tr><td class="h">16797</td><td><div class="c3">2</div><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @tunnel_intf = grep { $_-&gt;{ip} eq &#39;tunnel&#39; } @interfaces;</td></tr>
<tr><td class="h">16798</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16798">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@tunnel_intf == 1 or internal_err();</td></tr>
<tr><td class="h">16799</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($tunnel_intf) = @tunnel_intf;</td></tr>
<tr><td class="h">16800</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wan_intf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $tunnel_intf-&gt;{real_interface};</td></tr>
<tr><td class="h">16801</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wan_hw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $wan_intf-&gt;{hardware};</td></tr>
<tr><td class="h">16802</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set&nbsp;&nbsp;&nbsp;&nbsp;= $wan_hw-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16803</td><td><div class="c3">2</div><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16803">100</a></div></td><td></td><td></td><td></td><td><div>2</div><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @lan_intf = grep { $_ ne $wan_intf and $_ ne $tunnel_intf } @interfaces;</td></tr>
<tr><td class="h">16804</td><td colspan="7"></td></tr><tr><td class="h">16805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Ezvpn configuration.</td></tr>
<tr><td class="h">16806</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ezvpn_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &#39;vpn&#39;;</td></tr>
<tr><td class="h">16807</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_acl_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &#39;ACL-Split-Tunnel&#39;;</td></tr>
<tr><td class="h">16808</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_filter_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= &#39;ACL-crypto-filter&#39;;</td></tr>
<tr><td class="h">16809</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $virtual_interface_number = 1;</td></tr>
<tr><td class="h">16810</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto ipsec client ezvpn $ezvpn_name\n&quot;;</td></tr>
<tr><td class="h">16811</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; connect auto\n&quot;;</td></tr>
<tr><td class="h">16812</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; mode network-extension\n&quot;;</td></tr>
<tr><td class="h">16813</td><td colspan="7"></td></tr><tr><td class="h">16814</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@{ $tunnel_intf-&gt;{peers} }) {</td></tr>
<tr><td class="h">16815</td><td colspan="7"></td></tr><tr><td class="h">16816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Unnumbered, negotiated and short interfaces have been</td></tr>
<tr><td class="h">16817</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# rejected already.</td></tr>
<tr><td class="h">16818</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $peer_ip =</td></tr>
<tr><td class="h">16819</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prefix_code(address($peer-&gt;{real_interface}, $no_nat_set));</td></tr>
<tr><td class="h">16820</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; peer $peer_ip\n&quot;;</td></tr>
<tr><td class="h">16821</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16822</td><td colspan="7"></td></tr><tr><td class="h">16823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Bind split tunnel ACL.</td></tr>
<tr><td class="h">16824</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; acl $crypto_acl_name\n&quot;;</td></tr>
<tr><td class="h">16825</td><td colspan="7"></td></tr><tr><td class="h">16826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use virtual template defined above.</td></tr>
<tr><td class="h">16827</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; virtual-interface $virtual_interface_number\n&quot;;</td></tr>
<tr><td class="h">16828</td><td colspan="7"></td></tr><tr><td class="h">16829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# xauth is unused, but syntactically needed.</td></tr>
<tr><td class="h">16830</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; username test pass test\n&quot;;</td></tr>
<tr><td class="h">16831</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; xauth userid mode local\n&quot;;</td></tr>
<tr><td class="h">16832</td><td colspan="7"></td></tr><tr><td class="h">16833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Apply ezvpn to WAN and LAN interface.</td></tr>
<tr><td class="h">16834</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $lan_intf (@lan_intf) {</td></tr>
<tr><td class="h">16835</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $lan_hw = $lan_intf-&gt;{hardware};</td></tr>
<tr><td class="h">16836</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(</td></tr>
<tr><td class="h">16837</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $lan_hw-&gt;{subcmd} },</td></tr>
<tr><td class="h">16838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;crypto ipsec client ezvpn $ezvpn_name inside&quot;</td></tr>
<tr><td class="h">16839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">16840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16841</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $wan_hw-&gt;{subcmd} }, &quot;crypto ipsec client ezvpn $ezvpn_name&quot;);</td></tr>
<tr><td class="h">16842</td><td colspan="7"></td></tr><tr><td class="h">16843</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Crypto ACL controls which traffic needs to be encrypted.</td></tr>
<tr><td class="h">16844</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16844">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$tunnel_intf-&gt;{crypto}-&gt;{detailed_crypto_acl}</td></tr>
<tr><td class="h">16845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and internal_err(&quot;Unexpected attribute &#39;detailed_crypto_acl&#39;&quot;,</td></tr>
<tr><td class="h">16846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; at $router-&gt;{name}&quot;);</td></tr>
<tr><td class="h">16847</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_rules =</td></tr>
<tr><td class="h">16848</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen_crypto_rules($tunnel_intf-&gt;{peers}-&gt;[0]-&gt;{peer_networks},</td></tr>
<tr><td class="h">16849</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[$network_00]);</td></tr>
<tr><td class="h">16850</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $crypto_acl_name,</td></tr>
<tr><td class="h">16852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; $crypto_rules,</td></tr>
<tr><td class="h">16853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_crypto_acl =&gt; 1,</td></tr>
<tr><td class="h">16855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16856</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16857</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($crypto_acl_name);</td></tr>
<tr><td class="h">16858</td><td colspan="7"></td></tr><tr><td class="h">16859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Crypto filter ACL.</td></tr>
<tr><td class="h">16860</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$acl_info = {</td></tr>
<tr><td class="h">16861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $crypto_filter_name,</td></tr>
<tr><td class="h">16862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; delete $tunnel_intf-&gt;{rules},</td></tr>
<tr><td class="h">16863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intf_rules&nbsp;&nbsp;&nbsp;=&gt; delete $tunnel_intf-&gt;{intf_rules},</td></tr>
<tr><td class="h">16864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">16865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protect_self =&gt; 1,</td></tr>
<tr><td class="h">16866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set&nbsp;&nbsp;&nbsp;=&gt; $no_nat_set,</td></tr>
<tr><td class="h">16867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16868</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16869</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($crypto_filter_name);</td></tr>
<tr><td class="h">16870</td><td colspan="7"></td></tr><tr><td class="h">16871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Bind crypto filter ACL to virtual template.</td></tr>
<tr><td class="h">16872</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;interface Virtual-Template$virtual_interface_number type tunnel\n&quot;;</td></tr>
<tr><td class="h">16873</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; ip access-group $crypto_filter_name in\n&quot;;</td></tr>
<tr><td class="h">16874</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16876</td><td colspan="7"></td></tr><tr><td class="h">16877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Print crypto ACL.</td></tr>
<tr><td class="h">16878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># It controls which traffic needs to be encrypted.</td></tr>
<tr><td class="h">16879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_crypto_acl {</td></tr>
<tr><td class="h">16880</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16880">18</a></div></td><td><div class="c0">0</div></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $suffix, $crypto, $crypto_type) = @_;</td></tr>
<tr><td class="h">16881</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_acl_name = &quot;crypto-$suffix&quot;;</td></tr>
<tr><td class="h">16882</td><td colspan="7"></td></tr><tr><td class="h">16883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Generate crypto ACL entries.</td></tr>
<tr><td class="h">16884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - either generic from remote network to any or</td></tr>
<tr><td class="h">16885</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# - detailed to all networks which are used in rules.</td></tr>
<tr><td class="h">16886</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $is_hub&nbsp;&nbsp;&nbsp;= $interface-&gt;{is_hub};</td></tr>
<tr><td class="h">16887</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16887">100</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hub&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $is_hub ? $interface : $interface-&gt;{peers}-&gt;[0];</td></tr>
<tr><td class="h">16888</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $detailed = $crypto-&gt;{detailed_crypto_acl};</td></tr>
<tr><td class="h">16889</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16889">100</a></div></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $local&nbsp;&nbsp;&nbsp;&nbsp;= $detailed ? get_split_tunnel_nets($hub) : [$network_00];</td></tr>
<tr><td class="h">16890</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $remote&nbsp;&nbsp;&nbsp;= $hub-&gt;{peer_networks};</td></tr>
<tr><td class="h">16891</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16891">100</a></div></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$is_hub or ($local, $remote) = ($remote, $local);</td></tr>
<tr><td class="h">16892</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_rules = gen_crypto_rules($local, $remote);</td></tr>
<tr><td class="h">16893</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{router};</td></tr>
<tr><td class="h">16894</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set&nbsp;&nbsp;&nbsp;= $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16895</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; $crypto_acl_name,</td></tr>
<tr><td class="h">16897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; $crypto_rules,</td></tr>
<tr><td class="h">16898</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set =&gt; $no_nat_set,</td></tr>
<tr><td class="h">16899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_crypto_acl =&gt; 1,</td></tr>
<tr><td class="h">16900</td><td colspan="7"></td></tr><tr><td class="h">16901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16902</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>14</div><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16903</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($crypto_acl_name);</td></tr>
<tr><td class="h">16904</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $crypto_acl_name;</td></tr>
<tr><td class="h">16905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16906</td><td colspan="7"></td></tr><tr><td class="h">16907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Print filter ACL. It controls which traffic is allowed to leave from</td></tr>
<tr><td class="h">16908</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># crypto tunnel. This may be needed, if we don&#39;t fully trust our peer.</td></tr>
<tr><td class="h">16909</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_crypto_filter_acl {</td></tr>
<tr><td class="h">16910</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16910">18</a></div></td><td><div class="c0">0</div></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($interface, $suffix, $crypto_type) = @_;</td></tr>
<tr><td class="h">16911</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $interface-&gt;{router};</td></tr>
<tr><td class="h">16912</td><td colspan="7"></td></tr><tr><td class="h">16913</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16913">100</a></div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $router-&gt;{no_crypto_filter};</td></tr>
<tr><td class="h">16914</td><td colspan="7"></td></tr><tr><td class="h">16915</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_filter_name = &quot;crypto-filter-$suffix&quot;;</td></tr>
<tr><td class="h">16916</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">16917</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16918</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $acl_info = {</td></tr>
<tr><td class="h">16919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $crypto_filter_name,</td></tr>
<tr><td class="h">16920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; delete $interface-&gt;{rules},</td></tr>
<tr><td class="h">16921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intf_rules&nbsp;&nbsp;&nbsp;=&gt; delete $interface-&gt;{intf_rules},</td></tr>
<tr><td class="h">16922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_deny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 1,</td></tr>
<tr><td class="h">16923</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protect_self =&gt; 1,</td></tr>
<tr><td class="h">16924</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_nat_set&nbsp;&nbsp;&nbsp;=&gt; $no_nat_set,</td></tr>
<tr><td class="h">16925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">16926</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $router-&gt;{acl_list} }, $acl_info;</td></tr>
<tr><td class="h">16927</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_acl_placeholder($crypto_filter_name);</td></tr>
<tr><td class="h">16928</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $crypto_filter_name;</td></tr>
<tr><td class="h">16929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16930</td><td colspan="7"></td></tr><tr><td class="h">16931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Called for static and dynamic crypto maps.</td></tr>
<tr><td class="h">16932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_crypto_map_attributes {</td></tr>
<tr><td class="h">16933</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16933">18</a></div></td><td><div class="c0">0</div></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prefix, $model, $crypto_type, $crypto_acl_name, $crypto_filter_name,</td></tr>
<tr><td class="h">16934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$isakmp, $ipsec, $ipsec2trans_name)</td></tr>
<tr><td class="h">16935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">16936</td><td colspan="7"></td></tr><tr><td class="h">16937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Bind crypto ACL to crypto map.</td></tr>
<tr><td class="h">16938</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix match address $crypto_acl_name\n&quot;;</td></tr>
<tr><td class="h">16939</td><td colspan="7"></td></tr><tr><td class="h">16940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Bind crypto filter ACL to crypto map.</td></tr>
<tr><td class="h">16941</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16941">100</a></div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_filter_name) {</td></tr>
<tr><td class="h">16942</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set ip access-group $crypto_filter_name in\n&quot;;</td></tr>
<tr><td class="h">16943</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16944</td><td colspan="7"></td></tr><tr><td class="h">16945</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $transform_name = $ipsec2trans_name-&gt;{$ipsec};</td></tr>
<tr><td class="h">16946</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16946">100</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">16947</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16947">100</a></div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($isakmp-&gt;{ike_version} == 2) {</td></tr>
<tr><td class="h">16948</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set ikev2 ipsec-proposal $transform_name\n&quot;;</td></tr>
<tr><td class="h">16949</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16951</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set ikev1 transform-set $transform_name\n&quot;;</td></tr>
<tr><td class="h">16952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16955</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set transform-set $transform_name\n&quot;;</td></tr>
<tr><td class="h">16956</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16957</td><td colspan="7"></td></tr><tr><td class="h">16958</td><td><div class="c3">18</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16958">50</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $pfs_group = $ipsec-&gt;{pfs_group}) {</td></tr>
<tr><td class="h">16959</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set pfs group$pfs_group\n&quot;;</td></tr>
<tr><td class="h">16960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16961</td><td colspan="7"></td></tr><tr><td class="h">16962</td><td><div class="c3">18</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16962">50</a></div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $lifetime = $ipsec-&gt;{lifetime}) {</td></tr>
<tr><td class="h">16963</td><td colspan="7"></td></tr><tr><td class="h">16964</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t print default value for backend IOS.</td></tr>
<tr><td class="h">16965</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16965">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L16965">100</a></div></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not($lifetime == 3600 and $crypto_type eq &#39;IOS&#39;)) {</td></tr>
<tr><td class="h">16966</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</td></tr>
<tr><td class="h">16967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;$prefix set security-association&quot;,</td></tr>
<tr><td class="h">16968</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; lifetime seconds $lifetime\n&quot;</td></tr>
<tr><td class="h">16969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">16970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16972</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16973</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">16974</td><td colspan="7"></td></tr><tr><td class="h">16975</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_tunnel_group {</td></tr>
<tr><td class="h">16976</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L16976">16</a></div></td><td><div class="c0">0</div></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($name, $interface, $isakmp) = @_;</td></tr>
<tr><td class="h">16977</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{router}-&gt;{model};</td></tr>
<tr><td class="h">16978</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{no_nat_set};</td></tr>
<tr><td class="h">16979</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $authentication = $isakmp-&gt;{authentication};</td></tr>
<tr><td class="h">16980</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;tunnel-group $name type ipsec-l2l\n&quot;;</td></tr>
<tr><td class="h">16981</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;tunnel-group $name ipsec-attributes\n&quot;;</td></tr>
<tr><td class="h">16982</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16982">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($authentication eq &#39;rsasig&#39;) {</td></tr>
<tr><td class="h">16983</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $trust_point = $isakmp-&gt;{trust_point};</td></tr>
<tr><td class="h">16984</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L16984">100</a></div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($isakmp-&gt;{ike_version} == 2) {</td></tr>
<tr><td class="h">16985</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot; ikev2 local-authentication certificate&quot;, &quot; $trust_point\n&quot;);</td></tr>
<tr><td class="h">16986</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot; ikev2 remote-authentication certificate\n&quot;);</td></tr>
<tr><td class="h">16987</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16988</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16989</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; ikev1 trust-point $trust_point\n&quot;;</td></tr>
<tr><td class="h">16990</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; ikev1 user-authentication none\n&quot;;</td></tr>
<tr><td class="h">16991</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16992</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16993</td><td colspan="7"></td></tr><tr><td class="h">16994</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Preshared key is configured manually.</td></tr>
<tr><td class="h">16995</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">16996</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; peer-id-validate nocheck\n&quot;;</td></tr>
<tr><td class="h">16997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">16998</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">16999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17000</td><td colspan="7"></td></tr><tr><td class="h">17001</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_ca_and_tunnel_group_map {</td></tr>
<tr><td class="h">17002</td><td><div class="c3">12</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17002">12</a></div></td><td><div class="c0">0</div></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($id, $tg_name) = @_;</td></tr>
<tr><td class="h">17003</td><td colspan="7"></td></tr><tr><td class="h">17004</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Activate tunnel-group with tunnel-group-map.</td></tr>
<tr><td class="h">17005</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use $id as ca-map name.</td></tr>
<tr><td class="h">17006</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto ca certificate map $id 10\n&quot;;</td></tr>
<tr><td class="h">17007</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot; subject-name attr ea eq $id\n&quot;;</td></tr>
<tr><td class="h">17008</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;tunnel-group-map $id 10 $tg_name\n&quot;;</td></tr>
<tr><td class="h">17009</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17010</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17011</td><td colspan="7"></td></tr><tr><td class="h">17012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_static_crypto_map {</td></tr>
<tr><td class="h">17013</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17013">10</a></div></td><td><div class="c0">0</div></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $hardware, $map_name, $interfaces, $ipsec2trans_name) = @_;</td></tr>
<tr><td class="h">17014</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">17015</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_type = $model-&gt;{crypto};</td></tr>
<tr><td class="h">17016</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hw_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $hardware-&gt;{name};</td></tr>
<tr><td class="h">17017</td><td colspan="7"></td></tr><tr><td class="h">17018</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sequence number for parts of crypto map with different peers.</td></tr>
<tr><td class="h">17019</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $seq_num = 0;</td></tr>
<tr><td class="h">17020</td><td colspan="7"></td></tr><tr><td class="h">17021</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Crypto ACLs and peer IP must obey NAT.</td></tr>
<tr><td class="h">17022</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = $hardware-&gt;{no_nat_set};</td></tr>
<tr><td class="h">17023</td><td colspan="7"></td></tr><tr><td class="h">17024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort crypto maps by peer IP to get deterministic output.</td></tr>
<tr><td class="h">17025</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @sorted = sort(</td></tr>
<tr><td class="h">17026</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ $a-&gt;{peers}-&gt;[0]-&gt;{real_interface}-&gt;{ip}</td></tr>
<tr><td class="h">17027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&gt; $b-&gt;{peers}-&gt;[0]-&gt;{real_interface}-&gt;{ip} } @$interfaces);</td></tr>
<tr><td class="h">17028</td><td colspan="7"></td></tr><tr><td class="h">17029</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Build crypto map for each tunnel interface.</td></tr>
<tr><td class="h">17030</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@sorted) {</td></tr>
<tr><td class="h">17031</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seq_num++;</td></tr>
<tr><td class="h">17032</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $suffix = &quot;$hw_name-$seq_num&quot;;</td></tr>
<tr><td class="h">17033</td><td colspan="7"></td></tr><tr><td class="h">17034</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto = $interface-&gt;{crypto};</td></tr>
<tr><td class="h">17035</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ipsec&nbsp;&nbsp;= $crypto-&gt;{type};</td></tr>
<tr><td class="h">17036</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp = $ipsec-&gt;{key_exchange};</td></tr>
<tr><td class="h">17037</td><td colspan="7"></td></tr><tr><td class="h">17038</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_acl_name =</td></tr>
<tr><td class="h">17039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_crypto_acl($interface, $suffix, $crypto, $crypto_type);</td></tr>
<tr><td class="h">17040</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_filter_name =</td></tr>
<tr><td class="h">17041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_crypto_filter_acl($interface, $suffix, $crypto_type);</td></tr>
<tr><td class="h">17042</td><td colspan="7"></td></tr><tr><td class="h">17043</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Define crypto map.</td></tr>
<tr><td class="h">17044</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix;</td></tr>
<tr><td class="h">17045</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17045">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17045">50</a></div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;IOS&#39;) {</td></tr>
<tr><td class="h">17046</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prefix = &#39;&#39;;</td></tr>
<tr><td class="h">17047</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto map $map_name $seq_num ipsec-isakmp\n&quot;;</td></tr>
<tr><td class="h">17048</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17049</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">17050</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prefix = &quot;crypto map $map_name $seq_num&quot;;</td></tr>
<tr><td class="h">17051</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17052</td><td colspan="7"></td></tr><tr><td class="h">17053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set crypto peers.</td></tr>
<tr><td class="h">17054</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17054">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17054">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;IOS&#39;) {</td></tr>
<tr><td class="h">17055</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@{ $interface-&gt;{peers} }) {</td></tr>
<tr><td class="h">17056</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $peer_ip =</td></tr>
<tr><td class="h">17057</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prefix_code(address($peer-&gt;{real_interface}, $no_nat_set));</td></tr>
<tr><td class="h">17058</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set peer $peer_ip\n&quot;;</td></tr>
<tr><td class="h">17059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17060</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">17062</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix set peer &quot;,</td></tr>
<tr><td class="h">17063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39; &#39;,</td></tr>
<tr><td class="h">17064</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { prefix_code(address($_-&gt;{real_interface}, $no_nat_set)) }</td></tr>
<tr><td class="h">17065</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $interface-&gt;{peers} }),</td></tr>
<tr><td class="h">17066</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n&quot;;</td></tr>
<tr><td class="h">17067</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17068</td><td colspan="7"></td></tr><tr><td class="h">17069</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_crypto_map_attributes($prefix, $model, $crypto_type,</td></tr>
<tr><td class="h">17070</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto_acl_name, $crypto_filter_name,</td></tr>
<tr><td class="h">17071</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$isakmp, $ipsec, $ipsec2trans_name);</td></tr>
<tr><td class="h">17072</td><td colspan="7"></td></tr><tr><td class="h">17073</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17073">100</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">17074</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>11</div><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $peer (@{ $interface-&gt;{peers} }) {</td></tr>
<tr><td class="h">17075</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $peer_ip =</td></tr>
<tr><td class="h">17076</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prefix_code(address($peer-&gt;{real_interface}, $no_nat_set));</td></tr>
<tr><td class="h">17077</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_tunnel_group($peer_ip, $interface, $isakmp);</td></tr>
<tr><td class="h">17078</td><td colspan="7"></td></tr><tr><td class="h">17079</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Tunnel group needs to be activated, if certificate</td></tr>
<tr><td class="h">17080</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# is in use.</td></tr>
<tr><td class="h">17081</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17081">100</a></div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $id = $peer-&gt;{id}) {</td></tr>
<tr><td class="h">17082</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_ca_and_tunnel_group_map($id, $peer_ip);</td></tr>
<tr><td class="h">17083</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17084</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17085</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17086</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17087</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17088</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17089</td><td colspan="7"></td></tr><tr><td class="h">17090</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_dynamic_crypto_map {</td></tr>
<tr><td class="h">17091</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17091">2</a></div></td><td><div class="c0">0</div></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router, $hardware, $map_name, $interfaces, $ipsec2trans_name) = @_;</td></tr>
<tr><td class="h">17092</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">17093</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_type = $model-&gt;{crypto};</td></tr>
<tr><td class="h">17094</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17094">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$crypto_type eq &#39;ASA&#39; or internal_err();</td></tr>
<tr><td class="h">17095</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $hw_name = $hardware-&gt;{name};</td></tr>
<tr><td class="h">17096</td><td colspan="7"></td></tr><tr><td class="h">17097</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sequence number for parts of crypto map with different certificates.</td></tr>
<tr><td class="h">17098</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $seq_num = 65536;</td></tr>
<tr><td class="h">17099</td><td colspan="7"></td></tr><tr><td class="h">17100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort crypto maps by certificate to get deterministic output.</td></tr>
<tr><td class="h">17101</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @sorted =</td></tr>
<tr><td class="h">17102</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort({ $a-&gt;{peers}-&gt;[0]-&gt;{id} cmp $b-&gt;{peers}-&gt;[0]-&gt;{id} } @$interfaces);</td></tr>
<tr><td class="h">17103</td><td colspan="7"></td></tr><tr><td class="h">17104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Build crypto map for each tunnel interface.</td></tr>
<tr><td class="h">17105</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@sorted) {</td></tr>
<tr><td class="h">17106</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seq_num--;</td></tr>
<tr><td class="h">17107</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $suffix = &quot;$hw_name-$seq_num&quot;;</td></tr>
<tr><td class="h">17108</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $interface-&gt;{peers}-&gt;[0]-&gt;{id};</td></tr>
<tr><td class="h">17109</td><td colspan="7"></td></tr><tr><td class="h">17110</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto = $interface-&gt;{crypto};</td></tr>
<tr><td class="h">17111</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ipsec&nbsp;&nbsp;= $crypto-&gt;{type};</td></tr>
<tr><td class="h">17112</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp = $ipsec-&gt;{key_exchange};</td></tr>
<tr><td class="h">17113</td><td colspan="7"></td></tr><tr><td class="h">17114</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_acl_name =</td></tr>
<tr><td class="h">17115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_crypto_acl($interface, $suffix, $crypto, $crypto_type);</td></tr>
<tr><td class="h">17116</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_filter_name =</td></tr>
<tr><td class="h">17117</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_crypto_filter_acl($interface, $suffix, $crypto_type);</td></tr>
<tr><td class="h">17118</td><td colspan="7"></td></tr><tr><td class="h">17119</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Define dynamic crypto map.</td></tr>
<tr><td class="h">17120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use certificate as name.</td></tr>
<tr><td class="h">17121</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = &quot;crypto dynamic-map $id 10&quot;;</td></tr>
<tr><td class="h">17122</td><td colspan="7"></td></tr><tr><td class="h">17123</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_crypto_map_attributes($prefix, $model, $crypto_type,</td></tr>
<tr><td class="h">17124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto_acl_name, $crypto_filter_name,</td></tr>
<tr><td class="h">17125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$isakmp, $ipsec, $ipsec2trans_name);</td></tr>
<tr><td class="h">17126</td><td colspan="7"></td></tr><tr><td class="h">17127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Bind dynamic crypto map to crypto map.</td></tr>
<tr><td class="h">17128</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prefix = &quot;crypto map $map_name $seq_num&quot;;</td></tr>
<tr><td class="h">17129</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix ipsec-isakmp dynamic $id\n&quot;;</td></tr>
<tr><td class="h">17130</td><td colspan="7"></td></tr><tr><td class="h">17131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use $id as tunnel-group name</td></tr>
<tr><td class="h">17132</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_tunnel_group($id, $interface, $isakmp);</td></tr>
<tr><td class="h">17133</td><td colspan="7"></td></tr><tr><td class="h">17134</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Activate tunnel-group with tunnel-group-map.</td></tr>
<tr><td class="h">17135</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_ca_and_tunnel_group_map($id, $id);</td></tr>
<tr><td class="h">17136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17137</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17139</td><td colspan="7"></td></tr><tr><td class="h">17140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_crypto {</td></tr>
<tr><td class="h">17141</td><td><div class="c3">978</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17141">978</a></div></td><td><div class="c0">0</div></td><td><div>837</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">17142</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>1026</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">17143</td><td><div class="c3">978</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17143">100</a></div></td><td></td><td></td><td><div>1947</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $crypto_type = $model-&gt;{crypto} || &#39;&#39;;</td></tr>
<tr><td class="h">17144</td><td colspan="7"></td></tr><tr><td class="h">17145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# List of ipsec definitions used at current router.</td></tr>
<tr><td class="h">17146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort entries by name to get deterministic output.</td></tr>
<tr><td class="h">17147</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @ipsec = sort by_name unique(</td></tr>
<tr><td class="h">17148</td><td><div class="c3">2190</div></td><td></td><td></td><td></td><td></td><td><div>3855</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;&nbsp;{ $_-&gt;{crypto}-&gt;{type} }</td></tr>
<tr><td class="h">17149</td><td><div class="c3">978</div><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>924</div><div>1332</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { $_-&gt;{ip} eq &#39;tunnel&#39; } @{ $router-&gt;{interfaces} }</td></tr>
<tr><td class="h">17150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">17151</td><td colspan="7"></td></tr><tr><td class="h">17152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return if no crypto is used at current router.</td></tr>
<tr><td class="h">17153</td><td><div class="c3">978</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17153">100</a></div></td><td></td><td></td><td></td><td><div>2839</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless @ipsec;</td></tr>
<tr><td class="h">17154</td><td colspan="7"></td></tr><tr><td class="h">17155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# List of isakmp definitions used at current router.</td></tr>
<tr><td class="h">17156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Sort entries by name to get deterministic output.</td></tr>
<tr><td class="h">17157</td><td><div class="c3">20</div><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>24</div><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @isakmp = sort by_name unique(map { $_-&gt;{key_exchange} } @ipsec);</td></tr>
<tr><td class="h">17158</td><td colspan="7"></td></tr><tr><td class="h">17159</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print_header($router, &#39;Crypto&#39;);</td></tr>
<tr><td class="h">17160</td><td colspan="7"></td></tr><tr><td class="h">17161</td><td><div class="c3">20</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17161">100</a></div></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;EZVPN&#39;) {</td></tr>
<tr><td class="h">17162</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_ezvpn $router;</td></tr>
<tr><td class="h">17163</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17165</td><td colspan="7"></td></tr><tr><td class="h">17166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use interface access lists to filter incoming crypto traffic.</td></tr>
<tr><td class="h">17167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Group policy and per-user authorization access list can&#39;t be used</td></tr>
<tr><td class="h">17168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# because they are stateless.</td></tr>
<tr><td class="h">17169</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17169">100</a></div></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type =~ /^ASA/) {</td></tr>
<tr><td class="h">17170</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;! VPN traffic is filtered at interface ACL\n&quot;;</td></tr>
<tr><td class="h">17171</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;no sysopt connection permit-vpn\n&quot;;</td></tr>
<tr><td class="h">17172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17173</td><td colspan="7"></td></tr><tr><td class="h">17174</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17174">100</a></div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;ASA_VPN&#39;) {</td></tr>
<tr><td class="h">17175</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_asavpn $router;</td></tr>
<tr><td class="h">17176</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17178</td><td colspan="7"></td></tr><tr><td class="h">17179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Crypto config for ASA as EZVPN client is configured manually once.</td></tr>
<tr><td class="h">17180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No config is generated by netspoc.</td></tr>
<tr><td class="h">17181</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17181">50</a></div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;ASA_EZVPN&#39;) {</td></tr>
<tr><td class="h">17182</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17184</td><td colspan="7"></td></tr><tr><td class="h">17185</td><td><div class="c3">12</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17185">50</a></div></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$crypto_type =~ /^(:?IOS|ASA)$/</td></tr>
<tr><td class="h">17186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or internal_err(&quot;Unexptected crypto type $crypto_type&quot;);</td></tr>
<tr><td class="h">17187</td><td colspan="7"></td></tr><tr><td class="h">17188</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp_count = 0;</td></tr>
<tr><td class="h">17189</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $isakmp (@isakmp) {</td></tr>
<tr><td class="h">17190</td><td colspan="7"></td></tr><tr><td class="h">17191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Only print isakmp for IOS. Approve for ASA will ignore it anyway.</td></tr>
<tr><td class="h">17192</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17192">100</a></div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$crypto_type eq &#39;IOS&#39; or next;</td></tr>
<tr><td class="h">17193</td><td colspan="7"></td></tr><tr><td class="h">17194</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$isakmp_count++;</td></tr>
<tr><td class="h">17195</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto isakmp policy $isakmp_count\n&quot;;</td></tr>
<tr><td class="h">17196</td><td colspan="7"></td></tr><tr><td class="h">17197</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $authentication = $isakmp-&gt;{authentication};</td></tr>
<tr><td class="h">17198</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$authentication =~ s/preshare/pre-share/;</td></tr>
<tr><td class="h">17199</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$authentication =~ s/rsasig/rsa-sig/;</td></tr>
<tr><td class="h">17200</td><td colspan="7"></td></tr><tr><td class="h">17201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t print default value for backend IOS.</td></tr>
<tr><td class="h">17202</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17202">50</a></div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not($authentication eq &#39;rsa-sig&#39;)) {</td></tr>
<tr><td class="h">17203</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; authentication $authentication\n&quot;;</td></tr>
<tr><td class="h">17204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17205</td><td colspan="7"></td></tr><tr><td class="h">17206</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $encryption = $isakmp-&gt;{encryption};</td></tr>
<tr><td class="h">17207</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17207">50</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($encryption =~ /^aes(\d+)$/) {</td></tr>
<tr><td class="h">17208</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17208">50</a></div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $len = $crypto_type eq &#39;ASA&#39; ? &quot;-$1&quot; : &quot; $1&quot;;</td></tr>
<tr><td class="h">17209</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$encryption = &quot;aes$len&quot;;</td></tr>
<tr><td class="h">17210</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17211</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; encryption $encryption\n&quot;;</td></tr>
<tr><td class="h">17212</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hash = $isakmp-&gt;{hash};</td></tr>
<tr><td class="h">17213</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; hash $hash\n&quot;;</td></tr>
<tr><td class="h">17214</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $group = $isakmp-&gt;{group};</td></tr>
<tr><td class="h">17215</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; group $group\n&quot;;</td></tr>
<tr><td class="h">17216</td><td colspan="7"></td></tr><tr><td class="h">17217</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $lifetime = $isakmp-&gt;{lifetime};</td></tr>
<tr><td class="h">17218</td><td colspan="7"></td></tr><tr><td class="h">17219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t print default value for backend IOS.</td></tr>
<tr><td class="h">17220</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17220">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not($lifetime == 86400)) {</td></tr>
<tr><td class="h">17221</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; lifetime $lifetime\n&quot;;</td></tr>
<tr><td class="h">17222</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17223</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17224</td><td colspan="7"></td></tr><tr><td class="h">17225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Handle IPSEC definition.</td></tr>
<tr><td class="h">17226</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $transform_count = 0;</td></tr>
<tr><td class="h">17227</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %ipsec2trans_name;</td></tr>
<tr><td class="h">17228</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $ipsec (@ipsec) {</td></tr>
<tr><td class="h">17229</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$transform_count++;</td></tr>
<tr><td class="h">17230</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $transform_name = &quot;Trans$transform_count&quot;;</td></tr>
<tr><td class="h">17231</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ipsec2trans_name{$ipsec} = $transform_name;</td></tr>
<tr><td class="h">17232</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $isakmp = $ipsec-&gt;{key_exchange};</td></tr>
<tr><td class="h">17233</td><td colspan="7"></td></tr><tr><td class="h">17234</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# IKEv2 syntax for ASA.</td></tr>
<tr><td class="h">17235</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17235">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17235">100</a></div></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;ASA&#39; and $isakmp-&gt;{ike_version} == 2) {</td></tr>
<tr><td class="h">17236</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto ipsec ikev2 ipsec-proposal $transform_name\n&quot;;</td></tr>
<tr><td class="h">17237</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17237">50</a></div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ah = $ipsec-&gt;{ah}) {</td></tr>
<tr><td class="h">17238</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; protocol ah $ah\n&quot;;</td></tr>
<tr><td class="h">17239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17240</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $esp_encr;</td></tr>
<tr><td class="h">17241</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17241">50</a></div><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17241">50</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17241">50</a></div></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not(my $esp = $ipsec-&gt;{esp_encryption})) {</td></tr>
<tr><td class="h">17242</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$esp_encr = &#39;null&#39;;</td></tr>
<tr><td class="h">17243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($esp =~ /^(aes|des|3des)$/) {</td></tr>
<tr><td class="h">17245</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$esp_encr = $1;</td></tr>
<tr><td class="h">17246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($esp =~ /^aes(192|256)$/) {</td></tr>
<tr><td class="h">17248</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$esp_encr = &quot;aes-$1&quot;;</td></tr>
<tr><td class="h">17249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17250</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; protocol esp encryption $esp_encr\n&quot;;</td></tr>
<tr><td class="h">17251</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17251">50</a></div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $esp_ah = $ipsec-&gt;{esp_authentication}) {</td></tr>
<tr><td class="h">17252</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$esp_ah =~ s/^(.+?)(\d+)/$1-$2/;</td></tr>
<tr><td class="h">17253</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; protocol esp integrity $esp_ah\n&quot;;</td></tr>
<tr><td class="h">17254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17255</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17256</td><td colspan="7"></td></tr><tr><td class="h">17257</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# IKEv1 syntax of ASA is identical to IOS.</td></tr>
<tr><td class="h">17258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17259</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $transform = &#39;&#39;;</td></tr>
<tr><td class="h">17260</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17260">50</a></div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $ah = $ipsec-&gt;{ah}) {</td></tr>
<tr><td class="h">17261</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$transform .= &quot;ah-$ah-hmac &quot;;</td></tr>
<tr><td class="h">17262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17263</td><td><div class="c3">14</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17263">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17263">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17263">50</a></div></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not(my $esp = $ipsec-&gt;{esp_encryption})) {</td></tr>
<tr><td class="h">17264</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$transform .= &#39;esp-null &#39;;</td></tr>
<tr><td class="h">17265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17266</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($esp =~ /^(aes|des|3des)$/) {</td></tr>
<tr><td class="h">17267</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$transform .= &quot;esp-$1 &quot;;</td></tr>
<tr><td class="h">17268</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($esp =~ /^aes(192|256)$/) {</td></tr>
<tr><td class="h">17270</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17270">100</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $len = $crypto_type eq &#39;ASA&#39; ? &quot;-$1&quot; : &quot; $1&quot;;</td></tr>
<tr><td class="h">17271</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$transform .= &quot;esp-aes$len &quot;;</td></tr>
<tr><td class="h">17272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17273</td><td><div class="c3">14</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17273">50</a></div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $esp_ah = $ipsec-&gt;{esp_authentication}) {</td></tr>
<tr><td class="h">17274</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$transform .= &quot;esp-$esp_ah-hmac&quot;;</td></tr>
<tr><td class="h">17275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17276</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17276">100</a></div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prefix = ($crypto_type eq &#39;ASA&#39;)</td></tr>
<tr><td class="h">17277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? &#39;crypto ipsec ikev1&#39;</td></tr>
<tr><td class="h">17278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: &#39;crypto ipsec&#39;;</td></tr>
<tr><td class="h">17279</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$prefix transform-set $transform_name $transform\n&quot;;</td></tr>
<tr><td class="h">17280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17282</td><td colspan="7"></td></tr><tr><td class="h">17283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Collect tunnel interfaces attached to each hardware interface.</td></tr>
<tr><td class="h">17284</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Differentiate on peers having static or dynamic IP address.</td></tr>
<tr><td class="h">17285</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hardware2crypto;</td></tr>
<tr><td class="h">17286</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %hardware2dyn_crypto;</td></tr>
<tr><td class="h">17287</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>10</div><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $interface (@{ $router-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">17288</td><td><div class="c3">42</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17288">100</a></div></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface-&gt;{ip} eq &#39;tunnel&#39; or next;</td></tr>
<tr><td class="h">17289</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $interface-&gt;{peers}-&gt;[0]-&gt;{real_interface}-&gt;{ip};</td></tr>
<tr><td class="h">17290</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17290">100</a></div></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip =~ /^(?:negotiated|short|unnumbered)$/) {</td></tr>
<tr><td class="h">17291</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>4</div><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware2dyn_crypto{ $interface-&gt;{hardware} } },</td></tr>
<tr><td class="h">17292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interface;</td></tr>
<tr><td class="h">17293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17294</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17295</td><td><div class="c3">14</div><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>12</div><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @{ $hardware2crypto{ $interface-&gt;{hardware} } }, $interface;</td></tr>
<tr><td class="h">17296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17297</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17298</td><td colspan="7"></td></tr><tr><td class="h">17299</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>13</div><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">17300</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $hw_name = $hardware-&gt;{name};</td></tr>
<tr><td class="h">17301</td><td colspan="7"></td></tr><tr><td class="h">17302</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Name of crypto map.</td></tr>
<tr><td class="h">17303</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $map_name = &quot;crypto-$hw_name&quot;;</td></tr>
<tr><td class="h">17304</td><td colspan="7"></td></tr><tr><td class="h">17305</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $have_crypto_map;</td></tr>
<tr><td class="h">17306</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17306">100</a></div></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $interfaces = $hardware2crypto{$hardware}) {</td></tr>
<tr><td class="h">17307</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_static_crypto_map($router, $hardware, $map_name, $interfaces,</td></tr>
<tr><td class="h">17308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%ipsec2trans_name);</td></tr>
<tr><td class="h">17309</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$have_crypto_map = 1;</td></tr>
<tr><td class="h">17310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17311</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17311">100</a></div></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $interfaces = $hardware2dyn_crypto{$hardware}) {</td></tr>
<tr><td class="h">17312</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_dynamic_crypto_map($router, $hardware, $map_name,</td></tr>
<tr><td class="h">17313</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$interfaces, \%ipsec2trans_name);</td></tr>
<tr><td class="h">17314</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$have_crypto_map = 1;</td></tr>
<tr><td class="h">17315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17316</td><td colspan="7"></td></tr><tr><td class="h">17317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Bind crypto map to interface.</td></tr>
<tr><td class="h">17318</td><td><div class="c3">24</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17318">100</a></div></td><td></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$have_crypto_map or next;</td></tr>
<tr><td class="h">17319</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17319">100</a></div><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17319">50</a></div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($crypto_type eq &#39;IOS&#39;) {</td></tr>
<tr><td class="h">17320</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{ $hardware-&gt;{subcmd} }, &quot;crypto map $map_name&quot;);</td></tr>
<tr><td class="h">17321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17322</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($crypto_type eq &#39;ASA&#39;) {</td></tr>
<tr><td class="h">17323</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>40</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;crypto map $map_name interface $hw_name\n&quot;;</td></tr>
<tr><td class="h">17324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17326</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17328</td><td colspan="7"></td></tr><tr><td class="h">17329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_interface {</td></tr>
<tr><td class="h">17330</td><td><div class="c3">978</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17330">978</a></div></td><td><div class="c0">0</div></td><td><div>794</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($router) = @_;</td></tr>
<tr><td class="h">17331</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>919</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model = $router-&gt;{model};</td></tr>
<tr><td class="h">17332</td><td><div class="c3">978</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17332">100</a></div></td><td></td><td></td><td></td><td><div>2217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !$model-&gt;{print_interface};</td></tr>
<tr><td class="h">17333</td><td><div class="c3">270</div></td><td></td><td></td><td></td><td></td><td><div>283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $class&nbsp;&nbsp;&nbsp;&nbsp;= $model-&gt;{class};</td></tr>
<tr><td class="h">17334</td><td><div class="c3">270</div></td><td></td><td></td><td></td><td></td><td><div>332</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $stateful = not $model-&gt;{stateless};</td></tr>
<tr><td class="h">17335</td><td><div class="c3">270</div><div class="c3">270</div></td><td></td><td></td><td></td><td></td><td><div>233</div><div>375</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $hardware (@{ $router-&gt;{hardware} }) {</td></tr>
<tr><td class="h">17336</td><td><div class="c3">642</div></td><td></td><td></td><td></td><td></td><td><div>698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $name = $hardware-&gt;{name};</td></tr>
<tr><td class="h">17337</td><td><div class="c3">642</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17337">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17337">67</a></div></td><td></td><td></td><td><div>1159</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $name eq &#39;VIP&#39; and $model-&gt;{has_vip};</td></tr>
<tr><td class="h">17338</td><td><div class="c3">638</div></td><td></td><td></td><td></td><td></td><td><div>476</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @subcmd;</td></tr>
<tr><td class="h">17339</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $secondary;</td></tr>
<tr><td class="h">17340</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $addr_cmd;</td></tr>
<tr><td class="h">17341</td><td><div class="c3">638</div><div class="c3">638</div></td><td></td><td></td><td></td><td></td><td><div>500</div><div>810</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $intf (@{ $hardware-&gt;{interfaces} }) {</td></tr>
<tr><td class="h">17342</td><td><div class="c3">698</div></td><td></td><td></td><td></td><td></td><td><div>659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ip = $intf-&gt;{ip};</td></tr>
<tr><td class="h">17343</td><td><div class="c3">698</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17343">50</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17343">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17343">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17343">100</a></div></td><td></td><td></td><td></td><td><div>1919</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($ip eq &#39;tunnel&#39;) {</td></tr>
<tr><td class="h">17344</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">17345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($ip eq &#39;unnumbered&#39;) {</td></tr>
<tr><td class="h">17347</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$addr_cmd = &#39;ip unnumbered X&#39;;</td></tr>
<tr><td class="h">17348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($ip eq &#39;negotiated&#39;) {</td></tr>
<tr><td class="h">17350</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$addr_cmd = &#39;ip address negotiated&#39;;</td></tr>
<tr><td class="h">17351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($model-&gt;{use_prefix}) {</td></tr>
<tr><td class="h">17353</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $addr = print_ip($ip);</td></tr>
<tr><td class="h">17354</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = mask2prefix($intf-&gt;{network}-&gt;{mask});</td></tr>
<tr><td class="h">17355</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$addr_cmd = &quot;ip address $addr/$mask&quot;;</td></tr>
<tr><td class="h">17356</td><td><div class="c3">82</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17356">100</a></div></td><td></td><td></td><td></td><td><div>144</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$addr_cmd .= &#39; secondary&#39; if $secondary;</td></tr>
<tr><td class="h">17357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17358</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17359</td><td><div class="c3">606</div></td><td></td><td></td><td></td><td></td><td><div>734</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $addr = print_ip($ip);</td></tr>
<tr><td class="h">17360</td><td><div class="c3">606</div></td><td></td><td></td><td></td><td></td><td><div>966</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mask = print_ip($intf-&gt;{network}-&gt;{mask});</td></tr>
<tr><td class="h">17361</td><td><div class="c3">606</div></td><td></td><td></td><td></td><td></td><td><div>1041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$addr_cmd = &quot;ip address $addr $mask&quot;;</td></tr>
<tr><td class="h">17362</td><td><div class="c3">606</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17362">100</a></div></td><td></td><td></td><td></td><td><div>1017</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$addr_cmd .= &#39; secondary&#39; if $secondary;</td></tr>
<tr><td class="h">17363</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17364</td><td><div class="c3">698</div></td><td></td><td></td><td></td><td></td><td><div>711</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @subcmd, $addr_cmd;</td></tr>
<tr><td class="h">17365</td><td><div class="c3">698</div></td><td></td><td></td><td></td><td></td><td><div>1049</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$secondary = 1;</td></tr>
<tr><td class="h">17366</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17367</td><td><div class="c3">638</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17367">100</a></div></td><td></td><td></td><td></td><td><div>1138</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $vrf = $router-&gt;{vrf}) {</td></tr>
<tr><td class="h">17368</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17368">100</a></div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($class eq &#39;NX-OS&#39;) {</td></tr>
<tr><td class="h">17369</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @subcmd, &quot;vrf member $vrf&quot;;</td></tr>
<tr><td class="h">17370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17372</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @subcmd, &quot;ip vrf forwarding $vrf&quot;;</td></tr>
<tr><td class="h">17373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17375</td><td colspan="7"></td></tr><tr><td class="h">17376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add &quot;ip inspect&quot; as marker, that stateful filtering is expected.</td></tr>
<tr><td class="h">17377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The command is known to be incomplete, &quot;X&quot; is only used as</td></tr>
<tr><td class="h">17378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# placeholder.</td></tr>
<tr><td class="h">17379</td><td><div class="c3">638</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17379">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17379">100</a></div></td><td></td><td></td><td><div>2484</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($class eq &#39;IOS&#39; &amp;&amp; $stateful &amp;&amp; !$hardware-&gt;{loopback}) {</td></tr>
<tr><td class="h">17380</td><td><div class="c3">348</div></td><td></td><td></td><td></td><td></td><td><div>336</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @subcmd, &quot;ip inspect X in&quot;;</td></tr>
<tr><td class="h">17381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17382</td><td><div class="c3">638</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17382">100</a></div></td><td></td><td></td><td></td><td><div>1060</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $other = $hardware-&gt;{subcmd}) {</td></tr>
<tr><td class="h">17383</td><td><div class="c3">600</div></td><td></td><td></td><td></td><td></td><td><div>631</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @subcmd, @$other;</td></tr>
<tr><td class="h">17384</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17385</td><td colspan="7"></td></tr><tr><td class="h">17386</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Split name for ACE: &quot;vlan3029&quot; -&gt; &quot;vlan 3029&quot;</td></tr>
<tr><td class="h">17387</td><td><div class="c3">638</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17387">100</a></div></td><td></td><td></td><td></td><td><div>1041</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$name =~ s/(\d+)/ $1/ if ($class eq &#39;ACE&#39;);</td></tr>
<tr><td class="h">17388</td><td colspan="7"></td></tr><tr><td class="h">17389</td><td><div class="c3">638</div></td><td></td><td></td><td></td><td></td><td><div>1240</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;interface $name\n&quot;;</td></tr>
<tr><td class="h">17390</td><td><div class="c3">638</div></td><td></td><td></td><td></td><td></td><td><div>782</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $cmd (@subcmd) {</td></tr>
<tr><td class="h">17391</td><td><div class="c3">1692</div></td><td></td><td></td><td></td><td></td><td><div>3622</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot; $cmd\n&quot;;</td></tr>
<tr><td class="h">17392</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17393</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17394</td><td><div class="c3">270</div></td><td></td><td></td><td></td><td></td><td><div>317</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">17395</td><td><div class="c3">270</div></td><td></td><td></td><td></td><td></td><td><div>494</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17396</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17397</td><td colspan="7"></td></tr><tr><td class="h">17398</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %obj2nat2address;</td></tr>
<tr><td class="h">17399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_address {</td></tr>
<tr><td class="h">17400</td><td><div class="c3">4162</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17400">4162</a></div></td><td><div class="c0">0</div></td><td><div>3526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($obj, $no_nat_set) = @_;</td></tr>
<tr><td class="h">17401</td><td><div class="c3">4162</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17401">67</a></div></td><td></td><td></td><td><div>15562</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return($obj2nat2address{$obj}-&gt;{$no_nat_set} ||= </td></tr>
<tr><td class="h">17402</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_prefix_code(address($obj, $no_nat_set)));</td></tr>
<tr><td class="h">17403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17404</td><td colspan="7"></td></tr><tr><td class="h">17405</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %prt2code;</td></tr>
<tr><td class="h">17406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_prt {</td></tr>
<tr><td class="h">17407</td><td><div class="c3">2152</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17407">2152</a></div></td><td><div class="c0">0</div></td><td><div>1823</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($prt) = @_;</td></tr>
<tr><td class="h">17408</td><td><div class="c3">2152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17408">100</a></div></td><td></td><td></td><td></td><td><div>4216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $result = $prt2code{$prt}) {</td></tr>
<tr><td class="h">17409</td><td><div class="c3">1530</div></td><td></td><td></td><td></td><td></td><td><div>3427</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">17410</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17411</td><td><div class="c3">622</div></td><td></td><td></td><td></td><td></td><td><div>702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $proto = $prt-&gt;{proto};</td></tr>
<tr><td class="h">17412</td><td><div class="c3">622</div></td><td></td><td></td><td></td><td></td><td><div>872</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @result = ($proto);</td></tr>
<tr><td class="h">17413</td><td colspan="7"></td></tr><tr><td class="h">17414</td><td><div class="c3">622</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17414">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17414">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17414">100</a></div></td><td></td><td></td><td><div>1698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($proto eq &#39;tcp&#39; or $proto eq &#39;udp&#39;) {</td></tr>
<tr><td class="h">17415</td><td><div class="c3">488</div><div class="c3">488</div></td><td></td><td></td><td></td><td></td><td><div>405</div><div>850</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result,&nbsp;&nbsp;@{ $prt-&gt;{range} };</td></tr>
<tr><td class="h">17416</td><td><div class="c3">488</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17416">100</a></div></td><td></td><td></td><td></td><td><div>897</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, &#39;established&#39; if $prt-&gt;{established};</td></tr>
<tr><td class="h">17417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ($proto eq &#39;icmp&#39;) {</td></tr>
<tr><td class="h">17419</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17419">100</a></div></td><td></td><td></td><td></td><td><div>148</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $type = $prt-&gt;{type})) {</td></tr>
<tr><td class="h">17420</td><td><div class="c3">62</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $type;</td></tr>
<tr><td class="h">17421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17422</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17422">100</a></div></td><td></td><td></td><td></td><td><div>138</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined(my $code = $prt-&gt;{code})) {</td></tr>
<tr><td class="h">17423</td><td><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @result, $code;</td></tr>
<tr><td class="h">17424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17426</td><td><div class="c3">622</div></td><td></td><td></td><td></td><td></td><td><div>2766</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return($prt2code{$prt} = join(&#39; &#39;, @result));</td></tr>
<tr><td class="h">17427</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17428</td><td colspan="7"></td></tr><tr><td class="h">17429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_acls {</td></tr>
<tr><td class="h">17430</td><td><div class="c3">980</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17430">980</a></div></td><td><div class="c0">0</div></td><td><div>1012</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($vrf_members, $fh) = @_;</td></tr>
<tr><td class="h">17431</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>813</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @acl_list;</td></tr>
<tr><td class="h">17432</td><td colspan="7"></td></tr><tr><td class="h">17433</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@$vrf_members) {</td></tr>
<tr><td class="h">17434</td><td colspan="7"></td></tr><tr><td class="h">17435</td><td><div class="c3">988</div></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17435">100</a></div></td><td></td><td></td><td><div>1864</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $managed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{managed} || &#39;&#39;;</td></tr>
<tr><td class="h">17436</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>1252</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $secondary_filter = $managed =~ /secondary$/;</td></tr>
<tr><td class="h">17437</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>999</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $standard_filter&nbsp;&nbsp;= $managed eq &#39;standard&#39;;</td></tr>
<tr><td class="h">17438</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>939</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">17439</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>950</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $do_auth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $model-&gt;{do_auth};</td></tr>
<tr><td class="h">17440</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $active_log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{log};</td></tr>
<tr><td class="h">17441</td><td><div class="c3">988</div></td><td></td><td></td><td></td><td></td><td><div>718</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $need_protect;</td></tr>
<tr><td class="h">17442</td><td colspan="7"></td></tr><tr><td class="h">17443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect interfaces that need protection by additional deny rules.</td></tr>
<tr><td class="h">17444</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add list to each ACL separately, because IP may be changed by NAT.</td></tr>
<tr><td class="h">17445</td><td><div class="c3">988</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17445">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17445">100</a></div></td><td></td><td></td><td><div>3004</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</td></tr>
<tr><td class="h">17446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{need_protect}</td></tr>
<tr><td class="h">17447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</td></tr>
<tr><td class="h">17448</td><td colspan="7"></td></tr><tr><td class="h">17449</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ASA protects IOS router behind crosslink interface.</td></tr>
<tr><td class="h">17450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{crosslink_interfaces}</td></tr>
<tr><td class="h">17451</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">17452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">17453</td><td colspan="7"></td></tr><tr><td class="h">17454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Routers connected by crosslink networks are handled like</td></tr>
<tr><td class="h">17455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# one large router. Protect the collected interfaces of</td></tr>
<tr><td class="h">17456</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the whole cluster at each entry.</td></tr>
<tr><td class="h">17457</td><td><div class="c3">278</div></td><td></td><td></td><td></td><td></td><td><div>269</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_protect = $router-&gt;{crosslink_interfaces};</td></tr>
<tr><td class="h">17458</td><td><div class="c3">278</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17458">100</a></div></td><td></td><td></td><td></td><td><div>437</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!$need_protect) {</td></tr>
<tr><td class="h">17459</td><td><div class="c3">252</div></td><td></td><td></td><td></td><td></td><td><div>259</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_protect = $router-&gt;{interfaces};</td></tr>
<tr><td class="h">17460</td><td><div class="c3">668</div></td><td></td><td></td><td></td><td></td><td><div>1659</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_protect = [ </td></tr>
<tr><td class="h">17461</td><td><div class="c3">252</div></td><td></td><td></td><td></td><td></td><td><div>307</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep({ $_-&gt;{ip} !~ /^(?:unnumbered|negotiated|tunnel|bridged)$/ } </td></tr>
<tr><td class="h">17462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$need_protect) ];</td></tr>
<tr><td class="h">17463</td><td><div class="c3">252</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17463">100</a></div></td><td></td><td></td><td></td><td><div>502</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{has_vip}) {</td></tr>
<tr><td class="h">17464</td><td><div class="c3">10</div><div class="c3">20</div></td><td></td><td></td><td></td><td></td><td><div>18</div><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_protect = [ grep { !$_-&gt;{vip} } @$need_protect ];</td></tr>
<tr><td class="h">17465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17466</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17467</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17468</td><td colspan="7"></td></tr><tr><td class="h">17469</td><td><div class="c3">988</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17469">100</a></div></td><td></td><td></td><td></td><td><div>1992</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $aref = delete $router-&gt;{acl_list} or next;</td></tr>
<tr><td class="h">17470</td><td><div class="c3">978</div></td><td></td><td></td><td></td><td></td><td><div>1156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $acl (@$aref) {</td></tr>
<tr><td class="h">17471</td><td colspan="7"></td></tr><tr><td class="h">17472</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t modify loop variable.</td></tr>
<tr><td class="h">17473</td><td><div class="c3">2144</div></td><td></td><td></td><td></td><td></td><td><div>1737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl = $acl;</td></tr>
<tr><td class="h">17474</td><td colspan="7"></td></tr><tr><td class="h">17475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect networks used in secondary optimization.</td></tr>
<tr><td class="h">17476</td><td><div class="c3">2144</div></td><td></td><td></td><td></td><td></td><td><div>1611</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %opt_addr;</td></tr>
<tr><td class="h">17477</td><td colspan="7"></td></tr><tr><td class="h">17478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect networks forbidden in secondary optimization.</td></tr>
<tr><td class="h">17479</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %no_opt_addrs;</td></tr>
<tr><td class="h">17480</td><td colspan="7"></td></tr><tr><td class="h">17481</td><td><div class="c3">2144</div></td><td></td><td></td><td></td><td></td><td><div>2382</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $no_nat_set = delete $acl-&gt;{no_nat_set};</td></tr>
<tr><td class="h">17482</td><td colspan="7"></td></tr><tr><td class="h">17483</td><td><div class="c3">2144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17483">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17483">100</a></div></td><td></td><td></td><td><div>4701</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($need_protect and delete $acl-&gt;{protect_self}) {</td></tr>
<tr><td class="h">17484</td><td><div class="c3">1750</div></td><td></td><td></td><td></td><td></td><td><div>2270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl-&gt;{need_protect} = [</td></tr>
<tr><td class="h">17485</td><td colspan="7"></td></tr><tr><td class="h">17486</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove duplicate addresses from redundancy interfaces.</td></tr>
<tr><td class="h">17487</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unique</td></tr>
<tr><td class="h">17488</td><td><div class="c3">620</div></td><td></td><td></td><td></td><td></td><td><div>692</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map({ full_prefix_code(address($_, $no_nat_set)) }</td></tr>
<tr><td class="h">17489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$need_protect) ];</td></tr>
<tr><td class="h">17490</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17491</td><td colspan="7"></td></tr><tr><td class="h">17492</td><td><div class="c3">2144</div></td><td></td><td></td><td></td><td></td><td><div>2467</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $what (qw(intf_rules rules)) {</td></tr>
<tr><td class="h">17493</td><td><div class="c3">4288</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17493">100</a></div></td><td></td><td></td><td></td><td><div>7506</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rules = $acl-&gt;{$what} or next;</td></tr>
<tr><td class="h">17494</td><td><div class="c3">2134</div></td><td></td><td></td><td></td><td></td><td><div>2720</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $rule (@$rules) {</td></tr>
<tr><td class="h">17495</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>1958</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $new_rule = {};</td></tr>
<tr><td class="h">17496</td><td colspan="7"></td></tr><tr><td class="h">17497</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>1880</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $deny = $rule-&gt;{deny};</td></tr>
<tr><td class="h">17498</td><td><div class="c3">1964</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17498">100</a></div></td><td></td><td></td><td></td><td><div>2581</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{deny} = 1 if $deny;</td></tr>
<tr><td class="h">17499</td><td colspan="7"></td></tr><tr><td class="h">17500</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Add code for logging.</td></tr>
<tr><td class="h">17501</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This code is machine specific.</td></tr>
<tr><td class="h">17502</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>1433</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $log_code;</td></tr>
<tr><td class="h">17503</td><td><div class="c3">1964</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17503">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17503">100</a></div></td><td></td><td></td><td><div>3247</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($active_log &amp;&amp; (my $log = $rule-&gt;{log})) {</td></tr>
<tr><td class="h">17504</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $tag (@$log) {</td></tr>
<tr><td class="h">17505</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17505">100</a></div></td><td></td><td></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (exists $active_log-&gt;{$tag}) {</td></tr>
<tr><td class="h">17506</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17506">100</a></div></td><td></td><td></td><td></td><td><div>65</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $modifier = $active_log-&gt;{$tag}) {</td></tr>
<tr><td class="h">17507</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $normalized = </td></tr>
<tr><td class="h">17508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$model-&gt;{log_modifiers}-&gt;{$modifier};</td></tr>
<tr><td class="h">17509</td><td><div class="c3">38</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17509">100</a></div></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($normalized eq &#39;:subst&#39;) {</td></tr>
<tr><td class="h">17510</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_code = $modifier;</td></tr>
<tr><td class="h">17511</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17513</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_code = &quot;log $normalized&quot;;</td></tr>
<tr><td class="h">17514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17515</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17516</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17517</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_code = &#39;log&#39;;</td></tr>
<tr><td class="h">17518</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17519</td><td colspan="7"></td></tr><tr><td class="h">17520</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Take first of possibly several matching tags.</td></tr>
<tr><td class="h">17521</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">17522</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17525</td><td><div class="c3">1964</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17525">100</a></div><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17525">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17525">100</a></div></td><td></td><td></td><td><div>5525</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($log_code) {</td></tr>
<tr><td class="h">17526</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>68</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{log} = $log_code;</td></tr>
<tr><td class="h">17527</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17528</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ($router-&gt;{log_deny} &amp;&amp; $deny) {</td></tr>
<tr><td class="h">17529</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{log} = &#39;log&#39;;</td></tr>
<tr><td class="h">17530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17531</td><td colspan="7"></td></tr><tr><td class="h">17532</td><td><div class="c3">1964</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17532">100</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17532">71</a></div></td><td></td><td></td><td><div>8685</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (&nbsp;&nbsp;&nbsp;$secondary_filter &amp;&amp; $rule-&gt;{some_non_secondary}</td></tr>
<tr><td class="h">17533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| $standard_filter &amp;&amp; $rule-&gt;{some_primary})</td></tr>
<tr><td class="h">17534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">17535</td><td><div class="c3">76</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $where (qw(src dst)) {</td></tr>
<tr><td class="h">17536</td><td><div class="c3">152</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj_list = $rule-&gt;{$where};</td></tr>
<tr><td class="h">17537</td><td><div class="c3">152</div></td><td></td><td></td><td></td><td></td><td><div>153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $obj (@$obj_list) {</td></tr>
<tr><td class="h">17538</td><td colspan="7"></td></tr><tr><td class="h">17539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prepare secondary optimization.</td></tr>
<tr><td class="h">17540</td><td><div class="c3">152</div></td><td></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ref($obj);</td></tr>
<tr><td class="h">17541</td><td colspan="7"></td></tr><tr><td class="h">17542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Restrict secondary optimization at</td></tr>
<tr><td class="h">17543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# authenticating router to prevent</td></tr>
<tr><td class="h">17544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# unauthorized access with spoofed IP</td></tr>
<tr><td class="h">17545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# address.</td></tr>
<tr><td class="h">17546</td><td><div class="c3">152</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17546">50</a></div></td><td></td><td></td><td></td><td><div>217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($do_auth) {</td></tr>
<tr><td class="h">17547</td><td colspan="7"></td></tr><tr><td class="h">17548</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single ID-hosts must not be</td></tr>
<tr><td class="h">17549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# converted to network.</td></tr>
<tr><td class="h">17550</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17550">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Subnet&#39;) {</td></tr>
<tr><td class="h">17551</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17551">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $obj-&gt;{id};</td></tr>
<tr><td class="h">17552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17553</td><td colspan="7"></td></tr><tr><td class="h">17554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Network with ID-hosts must not</td></tr>
<tr><td class="h">17555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# be optimized at all.</td></tr>
<tr><td class="h">17556</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17556">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{has_id_hosts}) {</td></tr>
<tr><td class="h">17557</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_opt_addrs{$obj} = $obj;</td></tr>
<tr><td class="h">17558</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">17559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17561</td><td colspan="7"></td></tr><tr><td class="h">17562</td><td><div class="c3">152</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $subst;</td></tr>
<tr><td class="h">17563</td><td><div class="c3">152</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17563">100</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17563">100</a></div></td><td></td><td></td><td><div>373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($type eq &#39;Subnet&#39; or $type eq &#39;Interface&#39;) {</td></tr>
<tr><td class="h">17564</td><td><div class="c3">64</div></td><td></td><td></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $net = $obj-&gt;{network};</td></tr>
<tr><td class="h">17565</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17565">100</a></div></td><td></td><td></td><td></td><td><div>107</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $net-&gt;{has_other_subnet};</td></tr>
<tr><td class="h">17566</td><td><div class="c3">58</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17566">100</a></div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $no_opt = </td></tr>
<tr><td class="h">17567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{no_secondary_opt}) </td></tr>
<tr><td class="h">17568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="h">17569</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17569">50</a></div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($no_opt-&gt;{$net}) {</td></tr>
<tr><td class="h">17570</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_opt_addrs{$obj} = $obj;</td></tr>
<tr><td class="h">17571</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">17572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17574</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>38</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subst = $net;</td></tr>
<tr><td class="h">17575</td><td><div class="c3">52</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17575">50</a></div></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $max = $subst-&gt;{max_secondary_net}) {</td></tr>
<tr><td class="h">17576</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subst = $max;</td></tr>
<tr><td class="h">17577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17578</td><td colspan="7"></td></tr><tr><td class="h">17579</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore loopback network.</td></tr>
<tr><td class="h">17580</td><td><div class="c3">52</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17580">100</a></div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $subst-&gt;{mask} == 0xffffffff;</td></tr>
<tr><td class="h">17581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17582</td><td colspan="7"></td></tr><tr><td class="h">17583</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Network or aggregate.</td></tr>
<tr><td class="h">17584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17585</td><td colspan="7"></td></tr><tr><td class="h">17586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t modify protocol of rule</td></tr>
<tr><td class="h">17587</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# with {has_other_subnet}, because</td></tr>
<tr><td class="h">17588</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# this could introduce new missing</td></tr>
<tr><td class="h">17589</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# supernet rules.</td></tr>
<tr><td class="h">17590</td><td><div class="c3">88</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17590">100</a></div></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($obj-&gt;{has_other_subnet}) {</td></tr>
<tr><td class="h">17591</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$no_opt_addrs{$obj} = $obj;</td></tr>
<tr><td class="h">17592</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">17593</td><td colspan="7"></td></tr><tr><td class="h">17594</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17595</td><td><div class="c3">86</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17595">100</a></div></td><td></td><td></td><td></td><td><div>251</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $max = $obj-&gt;{max_secondary_net} or next;</td></tr>
<tr><td class="h">17596</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subst = $max;</td></tr>
<tr><td class="h">17597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17598</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>155</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$opt_addr{$subst} = $subst;</td></tr>
<tr><td class="h">17599</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17601</td><td><div class="c3">76</div></td><td></td><td></td><td></td><td></td><td><div>111</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{opt_secondary} = 1;</td></tr>
<tr><td class="h">17602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17603</td><td><div class="c3">2072</div><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>2693</div><div>2605</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{src} = [ map { print_address($_, $no_nat_set) } </td></tr>
<tr><td class="h">17604</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>1566</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $rule-&gt;{src} } ];</td></tr>
<tr><td class="h">17605</td><td><div class="c3">2050</div><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>2382</div><div>2353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{dst} = [ map { print_address($_, $no_nat_set) }</td></tr>
<tr><td class="h">17606</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>1995</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $rule-&gt;{dst} } ];</td></tr>
<tr><td class="h">17607</td><td><div class="c3">2100</div><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>2454</div><div>2262</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{prt} = [ map { print_prt($_) }</td></tr>
<tr><td class="h">17608</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>1906</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{ $rule-&gt;{prt} } ];</td></tr>
<tr><td class="h">17609</td><td><div class="c3">1964</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17609">100</a></div></td><td></td><td></td><td></td><td><div>3478</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $src_range = $rule-&gt;{src_range}) {</td></tr>
<tr><td class="h">17610</td><td><div class="c3">52</div></td><td></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$new_rule-&gt;{src_range} = print_prt($src_range);</td></tr>
<tr><td class="h">17611</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17612</td><td><div class="c3">1964</div></td><td></td><td></td><td></td><td></td><td><div>4299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rule = $new_rule;</td></tr>
<tr><td class="h">17613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17615</td><td colspan="7"></td></tr><tr><td class="h">17616</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Secondary optimization is done in pass 2.</td></tr>
<tr><td class="h">17617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It converts protocol to IP and </td></tr>
<tr><td class="h">17618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# src/dst address to network address.</td></tr>
<tr><td class="h">17619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# It is controlled by this three attributes:</td></tr>
<tr><td class="h">17620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - {opt_secondary} enables secondary optimization</td></tr>
<tr><td class="h">17621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - if enabled, then networks in {opt_networks} are used</td></tr>
<tr><td class="h">17622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;for optimization.</td></tr>
<tr><td class="h">17623</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# - if src/dst matches {no_opt_networks}, then</td></tr>
<tr><td class="h">17624</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;optimization is disabled for this single rule.</td></tr>
<tr><td class="h">17625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;This is needed because {opt_secondary} is set for</td></tr>
<tr><td class="h">17626</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;grouped rules and we need to control optimization </td></tr>
<tr><td class="h">17627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;for sinlge rules.</td></tr>
<tr><td class="h">17628</td><td><div class="c3">2144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17628">100</a></div></td><td></td><td></td><td></td><td><div>3563</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (values %opt_addr) {</td></tr>
<tr><td class="h">17629</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl-&gt;{opt_networks} = [ </td></tr>
<tr><td class="h">17630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort </td></tr>
<tr><td class="h">17631</td><td><div class="c3">24</div></td><td></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { print_address($_, $no_nat_set) } </td></tr>
<tr><td class="h">17632</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %opt_addr ];</td></tr>
<tr><td class="h">17633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17634</td><td><div class="c3">2144</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17634">100</a></div></td><td></td><td></td><td></td><td><div>2955</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (values %no_opt_addrs) {</td></tr>
<tr><td class="h">17635</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acl-&gt;{no_opt_addrs} = [ </td></tr>
<tr><td class="h">17636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort </td></tr>
<tr><td class="h">17637</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { print_address($_, $no_nat_set) } </td></tr>
<tr><td class="h">17638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values %no_opt_addrs ];</td></tr>
<tr><td class="h">17639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17640</td><td><div class="c3">2144</div></td><td></td><td></td><td></td><td></td><td><div>5017</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @acl_list, $acl;</td></tr>
<tr><td class="h">17641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17643</td><td colspan="7"></td></tr><tr><td class="h">17644</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1062</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $router = $vrf_members-&gt;[0];</td></tr>
<tr><td class="h">17645</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>953</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">17646</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2152</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = { model =&gt; $model-&gt;{class}, acls&nbsp;&nbsp;=&gt; \@acl_list };</td></tr>
<tr><td class="h">17647</td><td colspan="7"></td></tr><tr><td class="h">17648</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17648">100</a></div></td><td></td><td></td><td></td><td><div>1736</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (my $filter_only = $router-&gt;{filter_only}) {</td></tr>
<tr><td class="h">17649</td><td><div class="c3">46</div><div class="c3">58</div></td><td></td><td></td><td></td><td></td><td><div>62</div><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @list = map { prefix_code($_) } @$filter_only;</td></tr>
<tr><td class="h">17650</td><td><div class="c3">46</div></td><td></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{filter_only} = \@list;</td></tr>
<tr><td class="h">17651</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17652</td><td colspan="7"></td></tr><tr><td class="h">17653</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17653">100</a></div></td><td></td><td></td><td></td><td><div>1514</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($model-&gt;{can_objectgroup}) {</td></tr>
<tr><td class="h">17654</td><td><div class="c3">690</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17654">50</a></div></td><td></td><td></td><td></td><td><div>1043</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $router-&gt;{no_group_code}) {</td></tr>
<tr><td class="h">17655</td><td><div class="c3">690</div></td><td></td><td></td><td></td><td></td><td><div>786</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{do_objectgroup} = 1;</td></tr>
<tr><td class="h">17656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17658</td><td colspan="7"></td></tr><tr><td class="h">17659</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17659">100</a></div></td><td></td><td></td><td></td><td><div>1459</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{log_deny}) {</td></tr>
<tr><td class="h">17660</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{log_deny} = &#39;log&#39;;</td></tr>
<tr><td class="h">17661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17662</td><td colspan="7"></td></tr><tr><td class="h">17663</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>38478</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print $fh to_json($result, { pretty =&gt; 1, canonical =&gt; 1 });</td></tr>
<tr><td class="h">17664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17665</td><td colspan="7"></td></tr><tr><td class="h">17666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Make output directory available.</td></tr>
<tr><td class="h">17667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Move old content into subdirectory &quot;.prev/&quot; for reuse during pass 2.</td></tr>
<tr><td class="h">17668</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub check_output_dir {</td></tr>
<tr><td class="h">17669</td><td><div class="c3">358</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17669">358</a></div></td><td><div class="c0">0</div></td><td><div>368</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($dir) = @_;</td></tr>
<tr><td class="h">17670</td><td><div class="c3">358</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17670">50</a></div></td><td></td><td></td><td></td><td><div>1735</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (not -e $dir) {</td></tr>
<tr><td class="h">17671</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17671">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir $dir</td></tr>
<tr><td class="h">17672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or fatal_err(&quot;Can&#39;t create output directory $dir: $!&quot;);</td></tr>
<tr><td class="h">17673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17674</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17675</td><td><div class="c3">358</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17675">50</a></div></td><td></td><td></td><td></td><td><div>1054</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-d $dir or fatal_err(&quot;$dir isn&#39;t a directory&quot;);</td></tr>
<tr><td class="h">17676</td><td colspan="7"></td></tr><tr><td class="h">17677</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>555</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $prev = &quot;$dir/.prev&quot;;</td></tr>
<tr><td class="h">17678</td><td><div class="c3">358</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17678">50</a></div></td><td></td><td></td><td></td><td><div>2218</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not -d $prev) {</td></tr>
<tr><td class="h">17679</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>8632</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @old_files = glob(&quot;$dir/*&quot;);</td></tr>
<tr><td class="h">17680</td><td><div class="c3">358</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17680">50</a></div></td><td></td><td></td><td></td><td><div>1083</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $count = @old_files) {</td></tr>
<tr><td class="h">17681</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;progress(&quot;Moving $count old files in &#39;$dir&#39; to&quot;,</td></tr>
<tr><td class="h">17682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; subdirectory &#39;.prev&#39;&quot;);</td></tr>
<tr><td class="h">17683</td><td colspan="7"></td></tr><tr><td class="h">17684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Try to remove file or symlink with same name.</td></tr>
<tr><td class="h">17685</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink $prev;</td></tr>
<tr><td class="h">17686</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17686">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir $prev or </td></tr>
<tr><td class="h">17687</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fatal_err(&quot;Can&#39;t create directory $prev: $!&quot;);</td></tr>
<tr><td class="h">17688</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17688">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(&#39;mv&#39;, @old_files, $prev) == 0 or</td></tr>
<tr><td class="h">17689</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fatal_err(&quot;Can&#39;t mv old files to $prev: $!&quot;);</td></tr>
<tr><td class="h">17690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17691</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17693</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>401</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17695</td><td colspan="7"></td></tr><tr><td class="h">17696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Print generated code for each managed router.</td></tr>
<tr><td class="h">17697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub print_code {</td></tr>
<tr><td class="h">17698</td><td><div class="c3">358</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17698">358</a></div></td><td><div class="c0">0</div></td><td><div>430</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($dir) = @_;</td></tr>
<tr><td class="h">17699</td><td colspan="7"></td></tr><tr><td class="h">17700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Untaint $dir. This is necessary if running setuid.</td></tr>
<tr><td class="h">17701</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# We can trust value of $dir because it is set by setuid wrapper.</td></tr>
<tr><td class="h">17702</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>1167</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;($dir) = ($dir =~ /(.*)/);</td></tr>
<tr><td class="h">17703</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>619</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_output_dir($dir);</td></tr>
<tr><td class="h">17704</td><td colspan="7"></td></tr><tr><td class="h">17705</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>685</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&#39;Printing intermediate code&#39;);</td></tr>
<tr><td class="h">17706</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>291</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %seen;</td></tr>
<tr><td class="h">17707</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>510</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $router (@managed_routers, @routing_only_routers) {</td></tr>
<tr><td class="h">17708</td><td><div class="c3">1006</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17708">100</a></div></td><td></td><td></td><td></td><td><div>2255</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $seen{$router};</td></tr>
<tr><td class="h">17709</td><td colspan="7"></td></tr><tr><td class="h">17710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ignore splitted part.</td></tr>
<tr><td class="h">17711</td><td><div class="c3">998</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17711">100</a></div></td><td></td><td></td><td></td><td><div>1668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $router-&gt;{orig_router};</td></tr>
<tr><td class="h">17712</td><td colspan="7"></td></tr><tr><td class="h">17713</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $device_name = $router-&gt;{device_name};</td></tr>
<tr><td class="h">17714</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>899</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $device_name;</td></tr>
<tr><td class="h">17715</td><td colspan="7"></td></tr><tr><td class="h">17716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Untaint $file. It has already been checked for word characters,</td></tr>
<tr><td class="h">17717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# but check again for the case of a weird locale setting.</td></tr>
<tr><td class="h">17718</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>4306</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file =~ s/^(.*)/$1/;</td></tr>
<tr><td class="h">17719</td><td colspan="7"></td></tr><tr><td class="h">17720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# File for router config without ACLs.</td></tr>
<tr><td class="h">17721</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2281</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $config_file = &quot;$dir/$file.config&quot;;</td></tr>
<tr><td class="h">17722</td><td colspan="7"></td></tr><tr><td class="h">17723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;## no critic (RequireBriefOpen)</td></tr>
<tr><td class="h">17724</td><td><div class="c3">980</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17724">50</a></div></td><td></td><td></td><td></td><td><div>59892</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open(my $code_fd, &#39;&gt;&#39;, $config_file)</td></tr>
<tr><td class="h">17725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or fatal_err(&quot;Can&#39;t open $config_file for writing: $!&quot;);</td></tr>
<tr><td class="h">17726</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select $code_fd;</td></tr>
<tr><td class="h">17727</td><td colspan="7"></td></tr><tr><td class="h">17728</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1260</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $router-&gt;{model};</td></tr>
<tr><td class="h">17729</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1047</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $comment_char = $model-&gt;{comment_char};</td></tr>
<tr><td class="h">17730</td><td colspan="7"></td></tr><tr><td class="h">17731</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Restore interfaces of splitted router.</td></tr>
<tr><td class="h">17732</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17732">100</a></div></td><td></td><td></td><td></td><td><div>1668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $orig_interfaces = $router-&gt;{orig_interfaces}) {</td></tr>
<tr><td class="h">17733</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{interfaces} = $orig_interfaces;</td></tr>
<tr><td class="h">17734</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$router-&gt;{hardware}&nbsp;&nbsp;&nbsp;= $router-&gt;{orig_hardware};</td></tr>
<tr><td class="h">17735</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17736</td><td colspan="7"></td></tr><tr><td class="h">17737</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect VRF members.</td></tr>
<tr><td class="h">17738</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>733</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $vrf_members;</td></tr>
<tr><td class="h">17739</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17739">100</a></div></td><td></td><td></td><td></td><td><div>1449</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (my $members = $router-&gt;{vrf_members}) {</td></tr>
<tr><td class="h">17740</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>689</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vrf_members = $members;</td></tr>
<tr><td class="h">17741</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seen{$_} = 1 for @$members;</td></tr>
<tr><td class="h">17742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17743</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17744</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1394</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vrf_members = [$router];</td></tr>
<tr><td class="h">17745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17746</td><td colspan="7"></td></tr><tr><td class="h">17747</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>5253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$comment_char [ BEGIN $device_name ]\n&quot;;</td></tr>
<tr><td class="h">17748</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2038</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$comment_char [ Model = $model-&gt;{class} ]\n&quot;;</td></tr>
<tr><td class="h">17749</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17749">100</a></div></td><td></td><td></td><td></td><td><div>1630</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{policy_distribution_point}) {</td></tr>
<tr><td class="h">17750</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @ips = map({</td></tr>
<tr><td class="h">17751</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ips = $_-&gt;{admin_ip};</td></tr>
<tr><td class="h">17752</td><td><div class="c3">14</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17752">50</a></div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ips ? @$ips : ();</td></tr>
<tr><td class="h">17753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} @$vrf_members);</td></tr>
<tr><td class="h">17754</td><td><div class="c3">14</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17754">50</a></div></td><td></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@ips) {</td></tr>
<tr><td class="h">17755</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;$comment_char [ IP = %s ]\n&quot;, join(&#39;,&#39;, @ips));</td></tr>
<tr><td class="h">17756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17757</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $per_vrf = sub {</td></tr>
<tr><td class="h">17759</td><td><div class="c3">4868</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17759">4868</a></div></td><td></td><td><div>4136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($call) = @_;</td></tr>
<tr><td class="h">17760</td><td><div class="c3">4868</div></td><td></td><td></td><td></td><td></td><td><div>5316</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $vrouter (@$vrf_members) {</td></tr>
<tr><td class="h">17761</td><td><div class="c3">4900</div></td><td></td><td></td><td></td><td></td><td><div>5867</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$call-&gt;($vrouter);</td></tr>
<tr><td class="h">17762</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17763</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>3089</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17764</td><td><div class="c3">980</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17764">100</a></div></td><td></td><td></td><td></td><td><div>1513</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($router-&gt;{managed}) {</td></tr>
<tr><td class="h">17765</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1691</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$per_vrf-&gt;(\&amp;print_routes);</td></tr>
<tr><td class="h">17766</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1656</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$per_vrf-&gt;(\&amp;print_crypto);</td></tr>
<tr><td class="h">17767</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_prefix($router);</td></tr>
<tr><td class="h">17768</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1389</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$per_vrf-&gt;(\&amp;generate_acls);</td></tr>
<tr><td class="h">17769</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acl_suffix($router);</td></tr>
<tr><td class="h">17770</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1442</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$per_vrf-&gt;(\&amp;print_interface);</td></tr>
<tr><td class="h">17771</td><td><div class="c3">972</div></td><td></td><td></td><td></td><td></td><td><div>1433</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$per_vrf-&gt;(\&amp;print_nat);</td></tr>
<tr><td class="h">17772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">17774</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$per_vrf-&gt;(\&amp;print_routes);</td></tr>
<tr><td class="h">17775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17776</td><td colspan="7"></td></tr><tr><td class="h">17777</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$comment_char [ END $device_name ]\n\n&quot;;</td></tr>
<tr><td class="h">17778</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select STDOUT;</td></tr>
<tr><td class="h">17779</td><td><div class="c3">980</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17779">50</a></div></td><td></td><td></td><td></td><td><div>16825</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $code_fd or fatal_err(&quot;Can&#39;t close $config_file: $!&quot;);</td></tr>
<tr><td class="h">17780</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;## use critic</td></tr>
<tr><td class="h">17781</td><td colspan="7"></td></tr><tr><td class="h">17782</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print ACLs in machine independent format into separate file.</td></tr>
<tr><td class="h">17783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect ACLs from VRF parts.</td></tr>
<tr><td class="h">17784</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>2348</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $acl_file = &quot;$dir/$file.rules&quot;;</td></tr>
<tr><td class="h">17785</td><td><div class="c3">980</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17785">50</a></div></td><td></td><td></td><td></td><td><div>21271</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open(my $acl_fd, &#39;&gt;&#39;, $acl_file)</td></tr>
<tr><td class="h">17786</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or fatal_err(&quot;Can&#39;t open $acl_file for writing: $!&quot;);</td></tr>
<tr><td class="h">17787</td><td><div class="c3">980</div></td><td></td><td></td><td></td><td></td><td><div>1747</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_acls($vrf_members, $acl_fd);</td></tr>
<tr><td class="h">17788</td><td><div class="c3">980</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17788">50</a></div></td><td></td><td></td><td></td><td><div>21241</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $acl_fd or fatal_err(&quot;Can&#39;t close $acl_file: $!&quot;);</td></tr>
<tr><td class="h">17789</td><td colspan="7"></td></tr><tr><td class="h">17790</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17791</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>622</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17792</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17793</td><td colspan="7"></td></tr><tr><td class="h">17794</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub copy_raw {</td></tr>
<tr><td class="h">17795</td><td><div class="c3">358</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17795">358</a></div></td><td><div class="c0">0</div></td><td><div>500</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($in_path, $out_dir) = @_;</td></tr>
<tr><td class="h">17796</td><td><div class="c3">358</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17796">50</a></div></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17796">33</a></div></td><td></td><td></td><td><div>2221</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !(defined $in_path &amp;&amp; -d $in_path);</td></tr>
<tr><td class="h">17797</td><td><div class="c3">358</div></td><td><div class="c0" title="-/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17797">50</a></div></td><td></td><td></td><td></td><td><div>571</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if !defined $out_dir;</td></tr>
<tr><td class="h">17798</td><td colspan="7"></td></tr><tr><td class="h">17799</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Untaint $in_path, $out_dir. This is necessary if running setuid.</td></tr>
<tr><td class="h">17800</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Trusted because set by setuid wrapper.</td></tr>
<tr><td class="h">17801</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>1210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;($in_path) = ($in_path =~ /(.*)/);</td></tr>
<tr><td class="h">17802</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>755</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;($out_dir) = ($out_dir =~ /(.*)/);</td></tr>
<tr><td class="h">17803</td><td colspan="7"></td></tr><tr><td class="h">17804</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $out_dir has already been checked / created in print_code.</td></tr>
<tr><td class="h">17805</td><td colspan="7"></td></tr><tr><td class="h">17806</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>574</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $raw_dir = &quot;$in_path/raw&quot;;</td></tr>
<tr><td class="h">17807</td><td><div class="c3">358</div></td><td><div class="c0" title="T/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17807">50</a></div></td><td></td><td></td><td></td><td><div>2014</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if not -d $raw_dir;</td></tr>
<tr><td class="h">17808</td><td colspan="7"></td></tr><tr><td class="h">17809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Clean PATH if run in taint mode.</td></tr>
<tr><td class="h">17810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;## no critic (RequireLocalizedPunctuationVars)</td></tr>
<tr><td class="h">17811</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$ENV{PATH} = &#39;/usr/local/bin:/usr/bin:/bin&#39;;</td></tr>
<tr><td class="h">17812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;## use critic</td></tr>
<tr><td class="h">17813</td><td colspan="7"></td></tr><tr><td class="h">17814</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %device_names =</td></tr>
<tr><td class="h">17815</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $_-&gt;{device_name} =&gt; 1 } @managed_routers, @routing_only_routers;</td></tr>
<tr><td class="h">17816</td><td colspan="7"></td></tr><tr><td class="h">17817</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17817">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;opendir(my $dh, $raw_dir) or fatal_err(&quot;Can&#39;t opendir $raw_dir: $!&quot;);</td></tr>
<tr><td class="h">17818</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (my $file = Encode::decode($filename_encode, readdir $dh)) {</td></tr>
<tr><td class="h">17819</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17819">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ /^\./;</td></tr>
<tr><td class="h">17820</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17820">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $file =~ m/$config-&gt;{ignore_files}/o;</td></tr>
<tr><td class="h">17821</td><td colspan="7"></td></tr><tr><td class="h">17822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Untaint $file.</td></tr>
<tr><td class="h">17823</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($raw_file) = ($file =~ /^(.*)/);</td></tr>
<tr><td class="h">17824</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $raw_path = &quot;$raw_dir/$raw_file&quot;;</td></tr>
<tr><td class="h">17825</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17825">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not -f $raw_path) {</td></tr>
<tr><td class="h">17826</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Ignoring $raw_path&quot;);</td></tr>
<tr><td class="h">17827</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">17828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17829</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17829">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not $device_names{$file}) {</td></tr>
<tr><td class="h">17830</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn_msg(&quot;Found unused $raw_path&quot;);</td></tr>
<tr><td class="h">17831</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">17832</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17833</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $copy = &quot;$out_dir/$raw_file.raw&quot;;</td></tr>
<tr><td class="h">17834</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L17834">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(&quot;cp -f $raw_path $copy&quot;) == 0</td></tr>
<tr><td class="h">17835</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or fatal_err(&quot;Can&#39;t copy $raw_path to $copy: $!&quot;);</td></tr>
<tr><td class="h">17836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17837</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17838</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17839</td><td colspan="7"></td></tr><tr><td class="h">17840</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub show_version {</td></tr>
<tr><td class="h">17841</td><td><div class="c3">698</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17841">698</a></div></td><td><div class="c0">0</div></td><td><div>1924</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;progress(&quot;$program, version $version&quot;);</td></tr>
<tr><td class="h">17842</td><td><div class="c3">698</div></td><td></td><td></td><td></td><td></td><td><div>690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17843</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17844</td><td colspan="7"></td></tr><tr><td class="h">17845</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># These must be initialized on each run, because protocols are changed</td></tr>
<tr><td class="h">17846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># by prepare_prt_ordering.</td></tr>
<tr><td class="h">17847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub init_protocols {</td></tr>
<tr><td class="h">17848</td><td colspan="7"></td></tr><tr><td class="h">17849</td><td><div class="c3">736</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17849">736</a></div></td><td><div class="c0">0</div></td><td><div>2275</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%routing_info = (</td></tr>
<tr><td class="h">17850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EIGRP =&gt; {</td></tr>
<tr><td class="h">17851</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;=&gt; &#39;EIGRP&#39;,</td></tr>
<tr><td class="h">17852</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;=&gt; { name =&gt; &#39;auto_prt:EIGRP&#39;, proto =&gt; 88 },</td></tr>
<tr><td class="h">17853</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcast =&gt; [</td></tr>
<tr><td class="h">17854</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new(</td></tr>
<tr><td class="h">17855</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">17856</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;auto_network:EIGRP_multicast&quot;,</td></tr>
<tr><td class="h">17857</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; gen_ip(224, 0, 0, 10),</td></tr>
<tr><td class="h">17858</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; gen_ip(255, 255, 255, 255)</td></tr>
<tr><td class="h">17859</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">17860</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</td></tr>
<tr><td class="h">17861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17862</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSPF =&gt; {</td></tr>
<tr><td class="h">17863</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;=&gt; &#39;OSPF&#39;,</td></tr>
<tr><td class="h">17864</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;=&gt; { name =&gt; &#39;auto_prt:OSPF&#39;, proto =&gt; 89 },</td></tr>
<tr><td class="h">17865</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcast =&gt; [</td></tr>
<tr><td class="h">17866</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new(</td></tr>
<tr><td class="h">17867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">17868</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;auto_network:OSPF_multicast5&quot;,</td></tr>
<tr><td class="h">17869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; gen_ip(224, 0, 0, 5),</td></tr>
<tr><td class="h">17870</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; gen_ip(255, 255, 255, 255),</td></tr>
<tr><td class="h">17871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</td></tr>
<tr><td class="h">17872</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new(</td></tr>
<tr><td class="h">17873</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">17874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;auto_network:OSPF_multicast6&quot;,</td></tr>
<tr><td class="h">17875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; gen_ip(224, 0, 0, 6),</td></tr>
<tr><td class="h">17876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; gen_ip(255, 255, 255, 255)</td></tr>
<tr><td class="h">17877</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">17878</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</td></tr>
<tr><td class="h">17879</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17880</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamic =&gt; { name =&gt; &#39;dynamic&#39; },</td></tr>
<tr><td class="h">17881</td><td colspan="7"></td></tr><tr><td class="h">17882</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Identical to &#39;dynamic&#39;, but must only be applied to router.</td></tr>
<tr><td class="h">17883</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manual =&gt; { name =&gt; &#39;manual&#39; },</td></tr>
<tr><td class="h">17884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">17885</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%xxrp_info = (</td></tr>
<tr><td class="h">17886</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VRRP =&gt; {</td></tr>
<tr><td class="h">17887</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt&nbsp;&nbsp;&nbsp;=&gt; { name =&gt; &#39;auto_prt:VRRP&#39;, proto =&gt; 112 },</td></tr>
<tr><td class="h">17888</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcast =&gt; new(</td></tr>
<tr><td class="h">17889</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">17890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;auto_network:VRRP_multicast&quot;,</td></tr>
<tr><td class="h">17891</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; gen_ip(224, 0, 0, 18),</td></tr>
<tr><td class="h">17892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; gen_ip(255, 255, 255, 255)</td></tr>
<tr><td class="h">17893</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">17894</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSRP =&gt; {</td></tr>
<tr><td class="h">17896</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; {</td></tr>
<tr><td class="h">17897</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:HSRP&#39;,</td></tr>
<tr><td class="h">17898</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;udp&#39;,</td></tr>
<tr><td class="h">17899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; [ 1985, 1985 ],</td></tr>
<tr><td class="h">17900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17901</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcast =&gt; new(</td></tr>
<tr><td class="h">17902</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">17903</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;auto_network:HSRP_multicast&quot;,</td></tr>
<tr><td class="h">17904</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; gen_ip(224, 0, 0, 2),</td></tr>
<tr><td class="h">17905</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; gen_ip(255, 255, 255, 255)</td></tr>
<tr><td class="h">17906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">17907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17908</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSRPv2 =&gt; {</td></tr>
<tr><td class="h">17909</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; {</td></tr>
<tr><td class="h">17910</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:HSRPv2&#39;,</td></tr>
<tr><td class="h">17911</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;udp&#39;,</td></tr>
<tr><td class="h">17912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; [ 1985, 1985 ],</td></tr>
<tr><td class="h">17913</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17914</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcast =&gt; new(</td></tr>
<tr><td class="h">17915</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;Network&#39;,</td></tr>
<tr><td class="h">17916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name =&gt; &quot;auto_network:HSRPv2_multicast&quot;,</td></tr>
<tr><td class="h">17917</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;=&gt; gen_ip(224, 0, 0, 102),</td></tr>
<tr><td class="h">17918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mask =&gt; gen_ip(255, 255, 255, 255)</td></tr>
<tr><td class="h">17919</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">17920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">17921</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">17922</td><td colspan="7"></td></tr><tr><td class="h">17923</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1682</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_ip = { name =&gt; &#39;auto_prt:ip&#39;, proto =&gt; &#39;ip&#39; };</td></tr>
<tr><td class="h">17924</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_icmp = {</td></tr>
<tr><td class="h">17925</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;=&gt; &#39;auto_prt:icmp&#39;,</td></tr>
<tr><td class="h">17926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto =&gt; &#39;icmp&#39;</td></tr>
<tr><td class="h">17927</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17928</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1597</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_tcp = {</td></tr>
<tr><td class="h">17929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:tcp&#39;,</td></tr>
<tr><td class="h">17930</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;tcp&#39;,</td></tr>
<tr><td class="h">17931</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; $aref_tcp_any</td></tr>
<tr><td class="h">17932</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17933</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1502</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_udp = {</td></tr>
<tr><td class="h">17934</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:udp&#39;,</td></tr>
<tr><td class="h">17935</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;udp&#39;,</td></tr>
<tr><td class="h">17936</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; $aref_tcp_any</td></tr>
<tr><td class="h">17937</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17938</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1702</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_bootps = {</td></tr>
<tr><td class="h">17939</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:bootps&#39;,</td></tr>
<tr><td class="h">17940</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;udp&#39;,</td></tr>
<tr><td class="h">17941</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; [ 67, 67 ]</td></tr>
<tr><td class="h">17942</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17943</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2095</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_ike = {</td></tr>
<tr><td class="h">17944</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:IPSec_IKE&#39;,</td></tr>
<tr><td class="h">17945</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;udp&#39;,</td></tr>
<tr><td class="h">17946</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_range =&gt; [ 500, 500 ],</td></tr>
<tr><td class="h">17947</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; [ 500, 500 ]</td></tr>
<tr><td class="h">17948</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17949</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2139</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_natt = {</td></tr>
<tr><td class="h">17950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;auto_prt:IPSec_NATT&#39;,</td></tr>
<tr><td class="h">17951</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;udp&#39;,</td></tr>
<tr><td class="h">17952</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_range =&gt; [ 4500, 4500 ],</td></tr>
<tr><td class="h">17953</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_range =&gt; [ 4500, 4500 ]</td></tr>
<tr><td class="h">17954</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17955</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1299</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_esp = { name =&gt; &#39;auto_prt:IPSec_ESP&#39;, proto =&gt; 50, };</td></tr>
<tr><td class="h">17956</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1213</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$prt_ah&nbsp;&nbsp;= { name =&gt; &#39;auto_prt:IPSec_AH&#39;,&nbsp;&nbsp;proto =&gt; 51, };</td></tr>
<tr><td class="h">17957</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2018</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$permit_any_rule = {</td></tr>
<tr><td class="h">17958</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">17959</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst =&gt; [ $network_00 ],</td></tr>
<tr><td class="h">17960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prt =&gt; [ $prt_ip ]</td></tr>
<tr><td class="h">17961</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">17962</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2535</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$deny_any_rule = { %$permit_any_rule, deny =&gt; 1, };</td></tr>
<tr><td class="h">17963</td><td colspan="7"></td></tr><tr><td class="h">17964</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1390</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17965</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17966</td><td colspan="7"></td></tr><tr><td class="h">17967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub init_global_vars {</td></tr>
<tr><td class="h">17968</td><td><div class="c3">736</div></td><td></td><td><div class="c0"><a href="lib-Netspoc-Compiler-Pass1-pm--condition.html#L17968">33</a></div></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L17968">736</a></div></td><td><div class="c0">0</div></td><td><div>3573</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$start_time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $config-&gt;{start_time} || time();</td></tr>
<tr><td class="h">17969</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>687</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$error_counter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0;</td></tr>
<tr><td class="h">17970</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>657</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$abort_immediately&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= undef;</td></tr>
<tr><td class="h">17971</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>640</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$new_store_description = 0;</td></tr>
<tr><td class="h">17972</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1744</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $pair (values %global_type) {</td></tr>
<tr><td class="h">17973</td><td><div class="c3">9568</div><div class="c3">9568</div></td><td></td><td></td><td></td><td></td><td><div>6760</div><div>13568</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{ $pair-&gt;[1] } = ();</td></tr>
<tr><td class="h">17974</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">17975</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1687</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%interfaces&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= %hosts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17976</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>2931</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@managed_routers&nbsp;&nbsp;&nbsp;&nbsp;= @routing_only_routers = @router_fragments = ();</td></tr>
<tr><td class="h">17977</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1078</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@virtual_interfaces = @pathrestrictions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17978</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1438</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@managed_crypto_hubs = @routers = @networks = @zones = @areas = ();</td></tr>
<tr><td class="h">17979</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>799</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@natdomains&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17980</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>784</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%auto_interfaces&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17981</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>924</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%crypto2spokes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= %crypto2hubs = ();</td></tr>
<tr><td class="h">17982</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>3076</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%expanded_rules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= %rule_tree = %grouped_rules = ();</td></tr>
<tr><td class="h">17983</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>18096</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%prt_hash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= %ref2prt = %ref2obj = %token2regex = ();</td></tr>
<tr><td class="h">17984</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>915</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%ref2obj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= %ref2prt = ();</td></tr>
<tr><td class="h">17985</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>748</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%obj2zone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17986</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>736</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%obj2path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17987</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>719</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%key2obj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17988</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>711</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%border2obj2auto&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17989</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>664</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@deleted_rules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17990</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>906</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%unknown2services&nbsp;&nbsp;&nbsp;= %unknown2unknown = ();</td></tr>
<tr><td class="h">17991</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>868</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%supernet_rule_tree = %missing_supernet = ();</td></tr>
<tr><td class="h">17992</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%smaller_prt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">17993</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>843</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%known_log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= %key2log = ();</td></tr>
<tr><td class="h">17994</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1323</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%obj2nat2address&nbsp;&nbsp;&nbsp;&nbsp;= %prt2code = ();</td></tr>
<tr><td class="h">17995</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>1035</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;init_protocols();</td></tr>
<tr><td class="h">17996</td><td><div class="c3">736</div></td><td></td><td></td><td></td><td></td><td><div>664</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">17997</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">17998</td><td colspan="7"></td></tr><tr><td class="h">17999</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub compile {</td></tr>
<tr><td class="h">18000</td><td><div class="c3">670</div></td><td></td><td></td><td><div class="c3"><a href="lib-Netspoc-Compiler-Pass1-pm--subroutine.html#L18000">670</a></div></td><td><div class="c0">0</div></td><td><div>59789380</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($args) = @_;</td></tr>
<tr><td class="h">18001</td><td colspan="7"></td></tr><tr><td class="h">18002</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>707</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($in_path, $out_dir);</td></tr>
<tr><td class="h">18003</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>1231</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;($config, $in_path, $out_dir) = get_args($args);</td></tr>
<tr><td class="h">18004</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>2033</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;init_global_vars();</td></tr>
<tr><td class="h">18005</td><td colspan="7"></td></tr><tr><td class="h">18006</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Don&#39;t compile but check only for errors if no $out_dir is given.</td></tr>
<tr><td class="h">18007</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>994</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;fast_mode(!$out_dir);</td></tr>
<tr><td class="h">18008</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>820</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;show_version();</td></tr>
<tr><td class="h">18009</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>911</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;read_file_or_dir($in_path);</td></tr>
<tr><td class="h">18010</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>898</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;show_read_statistics();</td></tr>
<tr><td class="h">18011</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>904</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;order_protocols();</td></tr>
<tr><td class="h">18012</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>917</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;link_topology();</td></tr>
<tr><td class="h">18013</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>968</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;mark_disabled();</td></tr>
<tr><td class="h">18014</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>936</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;set_zone();</td></tr>
<tr><td class="h">18015</td><td><div class="c3">670</div></td><td></td><td></td><td></td><td></td><td><div>880</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;setpath();</td></tr>
<tr><td class="h">18016</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>857</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;distribute_nat_info();</td></tr>
<tr><td class="h">18017</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>929</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;find_subnets_in_zone();</td></tr>
<tr><td class="h">18018</td><td colspan="7"></td></tr><tr><td class="h">18019</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Call after find_subnets_in_zone, because original no_nat_set was</td></tr>
<tr><td class="h">18020</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# needed there.</td></tr>
<tr><td class="h">18021</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>943</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;adjust_crypto_nat();</td></tr>
<tr><td class="h">18022</td><td colspan="7"></td></tr><tr><td class="h">18023</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Call after find_subnets_in_zone, where $zone-&gt;{networks} has</td></tr>
<tr><td class="h">18024</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# been set up.</td></tr>
<tr><td class="h">18025</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>850</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;link_reroute_permit();</td></tr>
<tr><td class="h">18026</td><td colspan="7"></td></tr><tr><td class="h">18027</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>852</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;set_service_owner();</td></tr>
<tr><td class="h">18028</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>951</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;expand_services(1);&nbsp;&nbsp;&nbsp;&nbsp;# 1: expand hosts to subnets</td></tr>
<tr><td class="h">18029</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>896</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;check_dynamic_nat_rules();</td></tr>
<tr><td class="h">18030</td><td colspan="7"></td></tr><tr><td class="h">18031</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Abort now, if there had been syntax errors and simple semantic errors.</td></tr>
<tr><td class="h">18032</td><td><div class="c3">660</div></td><td></td><td></td><td></td><td></td><td><div>951</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;abort_on_error();</td></tr>
<tr><td class="h">18033</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>664</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;expand_crypto();</td></tr>
<tr><td class="h">18034</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>629</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;check_unused_groups();</td></tr>
<tr><td class="h">18035</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>662</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;set_policy_distribution_ip();</td></tr>
<tr><td class="h">18036</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>698</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;optimize_and_warn_deleted();</td></tr>
<tr><td class="h">18037</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>639</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;find_subnets_in_nat_domain();</td></tr>
<tr><td class="h">18038</td><td colspan="7"></td></tr><tr><td class="h">18039</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Call after {up} relation for anonymous aggregates in rules have</td></tr>
<tr><td class="h">18040</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# been set up and</td></tr>
<tr><td class="h">18041</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# after {is_in} relation has been set up.</td></tr>
<tr><td class="h">18042</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>706</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;mark_managed_local();</td></tr>
<tr><td class="h">18043</td><td colspan="7"></td></tr><tr><td class="h">18044</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>961</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;check_supernet_rules();</td></tr>
<tr><td class="h">18045</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>693</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;group_path_rules();</td></tr>
<tr><td class="h">18046</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>762</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;prepare_nat_commands();</td></tr>
<tr><td class="h">18047</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>729</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;find_active_routes();</td></tr>
<tr><td class="h">18048</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>718</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;gen_reverse_rules();</td></tr>
<tr><td class="h">18049</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>713</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;mark_secondary_rules();</td></tr>
<tr><td class="h">18050</td><td><div class="c3">486</div></td><td></td><td></td><td></td><td></td><td><div>632</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;abort_on_error();</td></tr>
<tr><td class="h">18051</td><td colspan="7"></td></tr><tr><td class="h">18052</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No errors expected after this point.</td></tr>
<tr><td class="h">18053</td><td><div class="c3">468</div></td><td></td><td></td><td></td><td></td><td><div>594</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;set_abort_immediately();</td></tr>
<tr><td class="h">18054</td><td><div class="c3">468</div></td><td></td><td></td><td></td><td></td><td><div>645</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;rules_distribution();</td></tr>
<tr><td class="h">18055</td><td colspan="7"></td></tr><tr><td class="h">18056</td><td><div class="c3">468</div></td><td><div class="c3" title="T/F"><a href="lib-Netspoc-Compiler-Pass1-pm--branch.html#L18056">100</a></div></td><td></td><td></td><td></td><td><div>763</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($out_dir) {</td></tr>
<tr><td class="h">18057</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>559</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;print_code($out_dir);</td></tr>
<tr><td class="h">18058</td><td><div class="c3">358</div></td><td></td><td></td><td></td><td></td><td><div>574</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_raw($in_path, $out_dir);</td></tr>
<tr><td class="h">18059</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">18060</td><td><div class="c3">468</div></td><td></td><td></td><td></td><td></td><td><div>775</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">18061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">18062</td><td colspan="7"></td></tr><tr><td class="h">18063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
